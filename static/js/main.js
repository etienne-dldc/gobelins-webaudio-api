!function e(t,n,r){function s(o,u){if(!n[o]){if(!t[o]){var a="function"==typeof require&&require;if(!u&&a)return a(o,!0);if(i)return i(o,!0);var f=new Error("Cannot find module '"+o+"'");throw f.code="MODULE_NOT_FOUND",f}var l=n[o]={exports:{}};t[o][0].call(l.exports,function(e){var n=t[o][1][e];return s(n?n:e)},l,l.exports,e,t,n,r)}return n[o].exports}for(var i="function"==typeof require&&require,o=0;o<r.length;o++)s(r[o]);return s}({1:[function(require,module,exports){"use strict";function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor))throw new TypeError("Cannot call a class as a function")}var _createClass=function(){function defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||!1,descriptor.configurable=!0,"value"in descriptor&&(descriptor.writable=!0),Object.defineProperty(target,descriptor.key,descriptor)}}return function(Constructor,protoProps,staticProps){return protoProps&&defineProperties(Constructor.prototype,protoProps),staticProps&&defineProperties(Constructor,staticProps),Constructor}}();Object.defineProperty(exports,"__esModule",{value:!0});var _lodash=(require("pixi.js"),require("lodash")),_lodash2=_interopRequireDefault(_lodash),_setts=require("./setts"),_setts2=_interopRequireDefault(_setts),_Scene=require("./classes/Scene"),_Scene2=_interopRequireDefault(_Scene),_AudioAnalyzer=require("./classes/AudioAnalyzer"),_AudioAnalyzer2=_interopRequireDefault(_AudioAnalyzer),_SoundExplorer=require("./classes/SoundExplorer"),_SoundExplorer2=_interopRequireDefault(_SoundExplorer),_AnimationManager=require("./classes/AnimationManager"),_AnimationManager2=_interopRequireDefault(_AnimationManager),_tools=require("./tools"),_tools2=_interopRequireDefault(_tools),_clone=require("clone"),App=(_interopRequireDefault(_clone),function(){function App(){_classCallCheck(this,App);var music="woodkid-run-boy-run";this.DELTA_TIME=0,this.LAST_TIME=Date.now(),this.width=window.innerWidth,this.height=window.innerHeight,this.diagonal=Math.sqrt(this.width*this.width+this.height*this.height),this.center={x:this.width/2,y:this.height/2},this.fps=1e3/60,this.lastCustomSyncRender=0,this.current={segment:{id:null},beat:{id:null},tatum:{id:null},section:{id:null},bar:{id:null},pitche:"",timbre:"",amplitude:0},this.scene=new _Scene2.default,this.scene.renderer.backgroundColor=2899536;var root=document.body.querySelector(".app");root.appendChild(this.scene.renderer.view),this.am=new _AnimationManager2.default(this.scene),this.currentMusic=_setts2.default.music,this.music=new _AudioAnalyzer2.default({url:"sounds/"+music+".mp3",onend:this.onMusicEnd.bind(this),loop:!0}),this.mySoundExplorer=new _SoundExplorer2.default("sounds/"+music+".json"),this.addListeners()}return _createClass(App,[{key:"addListeners",value:function(){window.addEventListener("resize",this.onResize.bind(this)),TweenMax.ticker.addEventListener("tick",this.update.bind(this))}},{key:"update",value:function(){var _this=this;if(_setts2.default.music!==this.currentMusic)return this.currentMusic=_setts2.default.music,void this.changeMusic(_setts2.default.music);this.DELTA_TIME=Date.now()-this.LAST_TIME,this.LAST_TIME=Date.now();var timeUnit=this.DELTA_TIME/this.fps,currentTime=this.music.pos()+_setts2.default.timeOffset/1e3;if(this.current.amplitude=this.music.getAmplitude(),this.am.setAmplitude(this.current.amplitude),this.currentData=this.mySoundExplorer.dataAtPos(currentTime),this.onNewEvent("segment",function(elem){_this.currentSegment=elem;var pitche=_this.findElemAuto(elem.pitches,.8);pitche!==_this.current.pitche&&(_this.current.pitche=pitche);var timbre=_this.findElemMax(elem.timbre);timbre!==_this.current.timbre&&(_this.current.timbre=timbre),"segment"==_setts2.default.syncEvent&&_this.addBoom()}),this.onNewEvent("bar",function(elem){"bar"==_setts2.default.syncEvent&&_this.addBoom()}),this.onNewEvent("beat",function(elem){"beat"==_setts2.default.syncEvent&&_this.addBoom(),_this.am.boom({size:500,angle:0,dist:0,type:0,color:_tools2.default.hsl2hex(_tools2.default.randomInt(0,360),20,50),rotation:0,rotationEnd:0,duration:3,opacity:.02,lines:!1})}),this.onNewEvent("tatum",function(elem){"tatum"==_setts2.default.syncEvent&&_this.addBoom()}),this.onNewEvent("section",function(elem){}),"custom"==_setts2.default.syncEvent){var timeDiff=Date.now()-this.lastCustomSyncRender;timeDiff>1e3/_setts2.default.customSyncFrequency&&(this.lastCustomSyncRender=Date.now(),this.addBoom())}null!==this.current.section.id?this.am.setGlobalRotation(_setts2.default.globalRotation*Math.pow(-1,this.current.section.id)):this.am.setGlobalRotation(_setts2.default.globalRotation),this.am.update(timeUnit),this.scene.render()}},{key:"onNewEvent",value:function(eventType,callback){if(null!==this.currentData[eventType]){var elem=this.currentData[eventType];this.current[eventType].id!==elem.id&&(this.current[eventType]=elem,callback(elem))}}},{key:"addBoom",value:function(){var cu=this.current,options=this.am.getBoomOptions(cu.pitche,cu.segment.duration,cu.segment.pitches);options.dist=_tools2.default.map(cu.amplitude,0,_setts2.default.amplitudeMap,0,this.diagonal/2),options.type=cu.timbre+2,options.size=Math.pow(_tools2.default.map(cu.segment.loudness_max,-60,0,1,1.8),10),this.am.boom(options)}},{key:"elemHas",value:function(pitche,list){_lodash2.default.isArray(list)||(list=[list]);for(var pitcheArr=pitche.split(""),i=0;i<list.length;i++){for(var searchArr=list[i].split(""),find=!0,i=0;i<searchArr.length;i++)find===!0&&-1===pitcheArr.indexOf(searchArr[i])&&(find=!1);if(find)return!0}return!1}},{key:"elemIs",value:function(pitche,search){_lodash2.default.isArray(search)||(search=[search]);for(var i=0;i<search.length;i++)if(search[i]===pitche)return!0;return!1}},{key:"findElemAuto",value:function(list){for(var averageUp=arguments.length<=1||void 0===arguments[1]?0:arguments[1],hex=[0,1,2,3,4,5,6,7,8,9,"a","b","c","d","e","f"],result=[],average=0,max=0,i=0;i<list.length;i++)average+=list[i],list[i]>list[max]&&(max=i);average/=list.length,average+=(list[max]-average)*averageUp;for(var i=0;i<list.length;i++)list[i]>average&&result.push(hex[i]);return result.join("")}},{key:"findElemMax",value:function(list){for(var max=0,i=0;i<list.length;i++)list[i]>list[max]&&(max=i);return max}},{key:"findMajorPitches",value:function(list,tolerance){void 0==tolerance&&(tolerance=.5);for(var result=[],i=0;i<list.length;i++)list[i]>=tolerance&&result.push({index:i,value:list[i]});return result.sort(function(left,right){return left.value-right.value}),result}},{key:"onMusicEnd",value:function(){console.log("end")}},{key:"onResize",value:function(evt){this.width=window.innerWidth,this.height=window.innerHeight,this.scene.resize(this.width,this.height)}},{key:"changeMusic",value:function(music){this.music.loadMusic("sounds/"+music+".mp3"),this.mySoundExplorer=new _SoundExplorer2.default("sounds/"+music+".json")}}]),App}());exports.default=App},{"./classes/AnimationManager":2,"./classes/AudioAnalyzer":3,"./classes/Scene":4,"./classes/SoundExplorer":5,"./setts":6,"./tools":7,clone:12,lodash:25,"pixi.js":121}],2:[function(require,module,exports){"use strict";function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor))throw new TypeError("Cannot call a class as a function")}var _createClass=function(){function defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||!1,descriptor.configurable=!0,"value"in descriptor&&(descriptor.writable=!0),Object.defineProperty(target,descriptor.key,descriptor)}}return function(Constructor,protoProps,staticProps){return protoProps&&defineProperties(Constructor.prototype,protoProps),staticProps&&defineProperties(Constructor,staticProps),Constructor}}();Object.defineProperty(exports,"__esModule",{value:!0});var _pixi=require("pixi.js"),_tools=require("../tools"),_tools2=_interopRequireDefault(_tools),_setts=require("../setts"),_setts2=_interopRequireDefault(_setts),AnimationManager=function(){function AnimationManager(scene){_classCallCheck(this,AnimationManager),this.scene=scene,this.width=window.innerWidth,this.height=window.innerHeight,this.center={x:this.width/2,y:this.height/2},this.amplitude=0,this.booms=[],this.boomsOptions={},this.amContainer=new _pixi.Graphics,this.amContainer.x=this.center.x,this.amContainer.y=this.center.y,this.scene.addChild(this.amContainer),this.globalRotation=.1,this.removeList=[],this.lastBoomPos={x:0,y:0}}return _createClass(AnimationManager,[{key:"update",value:function(timeUnit){this.updateGlobalRotation(timeUnit),this.updateBooms(timeUnit),this.clean()}},{key:"setAmplitude",value:function(amplitude){this.amplitude=amplitude}},{key:"boom",value:function(options){var newBoom={},hue=_tools2.default.map(options.type+Math.random(),2,14,0,360);newBoom.color=options.color||_tools2.default.hsl2hex(hue,100,60),newBoom.startTime=Date.now(),newBoom.duration=options.duration,newBoom.opacity=options.opacity||_setts2.default.shapeOpacity,newBoom.type=options.type,newBoom.x=options.dist*Math.cos(options.angle),newBoom.y=options.dist*Math.sin(options.angle),newBoom.size=1,newBoom.lines=void 0==options.lines?!0:options.lines,newBoom.lineWidth=2,newBoom.maxSize=options.size,newBoom.rotation=options.rotation,newBoom.rotationEnd=options.rotationEnd;var remove=function(elem){this.removeList.push({elem:elem,group:"booms"})}.bind(this);newBoom.tween=TweenMax.to(newBoom,newBoom.duration,{opacity:0,size:options.size,rotation:newBoom.rotationEnd,onComplete:remove,onCompleteParams:[newBoom]}),newBoom.graph=new _pixi.Graphics,this.amContainer.addChild(newBoom.graph),this.booms.push(newBoom)}},{key:"getBoomOptions",value:function(pitche,duration,pitcheDetails){if(void 0===this.boomsOptions[pitche]){for(var pitchesArr=[],i=0;i<pitcheDetails.length;i++)pitchesArr.push({value:pitcheDetails[i],index:i});pitchesArr.sort(function(left,right){return right.value-left.value});for(var angle=0,i=0;4>i;i++){var anglePart=2*Math.PI*Math.pow(1/12,i);angle+=pitchesArr[i].index*anglePart}var rotationMax=Math.PI/2,rotation=_tools2.default.random(0,2*Math.PI);this.boomsOptions[pitche]={size:10,angle:angle,dist:100,type:0,color:!1,rotation:rotation,rotationEnd:rotation+rotationMax/2-Math.random()*rotationMax,duration:2*duration}}return this.boomsOptions[pitche]}},{key:"setGlobalRotation",value:function(value){this.globalRotation=2*Math.PI*(value/360)}},{key:"updateGlobalRotation",value:function(timeUnit){this.amContainer.rotation+=this.globalRotation*timeUnit}},{key:"updateBooms",value:function(timeUnit){for(var i=0;i<this.booms.length;i++){var boom=this.booms[i];if(boom.graph.clear(),boom.lines&&(_setts2.default.displayLines&&(boom.graph.lineStyle(boom.lineWidth*_setts2.default.lineWidth,boom.color,boom.opacity),boom.graph.moveTo(this.lastBoomPos.x,this.lastBoomPos.y),this.lastBoomPos={x:boom.x,y:boom.y},boom.graph.lineTo(boom.x,boom.y)),_setts2.default.displayLinesFromCenter&&(boom.graph.lineStyle(boom.lineWidth*_setts2.default.lineWidth,boom.color,boom.opacity),boom.graph.moveTo(0,0),boom.graph.lineTo(boom.x,boom.y))),boom.graph.beginFill(boom.color,boom.opacity),boom.graph.lineStyle(0,16777215,0),boom.type<=2)boom.graph.drawCircle(boom.x,boom.y,boom.size);else{for(var points=[],angle=boom.rotation,j=0;j<boom.type;j++){var x=boom.x+boom.size*Math.cos(angle),y=boom.y+boom.size*Math.sin(angle);points.push(new _pixi.Point(x,y)),angle+=2*Math.PI/boom.type}boom.graph.drawPolygon(points)}boom.graph.endFill()}}},{key:"clean",value:function(){for(var i=0;i<this.removeList.length;i++){var removeElem=this.removeList[i],index=(this.amContainer.removeChild(removeElem.elem.graph),this[removeElem.group].indexOf(removeElem.elem));this[removeElem.group].slice(index,1)}this.removeList=[]}}]),AnimationManager}();exports.default=AnimationManager},{"../setts":6,"../tools":7,"pixi.js":121}],3:[function(require,module,exports){"use strict";function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor))throw new TypeError("Cannot call a class as a function")}var _createClass=function(){function defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||!1,descriptor.configurable=!0,"value"in descriptor&&(descriptor.writable=!0),Object.defineProperty(target,descriptor.key,descriptor)}}return function(Constructor,protoProps,staticProps){return protoProps&&defineProperties(Constructor.prototype,protoProps),staticProps&&defineProperties(Constructor,staticProps),Constructor}}();Object.defineProperty(exports,"__esModule",{value:!0});var _webaudioBufferLoader=require("webaudio-buffer-loader"),_webaudioBufferLoader2=_interopRequireDefault(_webaudioBufferLoader),AudioAnalyzer=function(){function AudioAnalyzer(options){_classCallCheck(this,AudioAnalyzer),this.soundUrl=options.url,this.loop=!1,void 0!==options.loop&&(this.loop=options.loop),this.onend=function(){},void 0!==options.onend&&(this.onend=options.onend),this.audioCtx=new AudioContext,this.analyser=this.audioCtx.createAnalyser(),this.frequencyData=new Uint8Array(this.analyser.frequencyBinCount),this.analyser.connect(this.audioCtx.destination),this.soundLoaded=!1,this.startTime=null,this.isPlaying=!1,this.nbrOfPlay=0,this.audioBuffer=null,this.audioSource=null,this.loadMusic(this.soundUrl)}return _createClass(AudioAnalyzer,[{key:"loadMusic",value:function(url){var _this=this;this.soundLoaded&&this.isPlaying&&(this.audioSource.stop(),this.isPlaying=!1),(0,_webaudioBufferLoader2.default)(url,this.audioCtx,function(err,loadedBuffer){_this.soundLoaded=!0,_this.soundBuffer=loadedBuffer,_this.playSound()})}},{key:"playSound",value:function(){var _this2=this;this.soundLoaded&&(this.isPlaying&&(this.audioSource.stop(),this.isPlaying=!1),(this.loop||this.nbrOfPlay<1)&&(this.audioSource=this.audioCtx.createBufferSource(),this.audioSource.buffer=this.soundBuffer,this.audioSource.connect(this.analyser),this.audioSource.onended=function(){_this2.audioSource.onended=function(){},_this2.onend(),_this2.soundLoaded&&_this2.playSound()},this.audioSource.start(0),this.isPlaying=!0,this.startTime=Date.now(),this.nbrOfPlay++))}},{key:"pos",value:function(){return this.soundLoaded&&this.isPlaying?(Date.now()-this.startTime)/1e3:0}},{key:"getFrequencyData",value:function(){return this.soundLoaded&&this.analyser.getByteFrequencyData(this.frequencyData),this.frequencyData}},{key:"getAverageFrequency",value:function(){for(var data=this.getFrequencyData(),total=0,pond=0,i=0;i<data.length;i++)total+=i*data[i],pond+=data[i];var result=pond?total/pond:0;return result}},{key:"getFrequencyBars",value:function(nbfOfBars){for(var data=this.getFrequencyData(),freqByBar=data.length/nbfOfBars,result=[],i=0;nbfOfBars>i;i++)result[i]=[];for(var i=0;i<data.length;i++){var resultIndex=Math.floor(i/freqByBar);result[resultIndex].push(data[i])}return result=result.map(function(list){var len=list.length,total=list.reduce(function(valeurPrecedente,valeurCourante,index,array){return valeurPrecedente+valeurCourante},0);return total/len})}},{key:"getAmplitude",value:function(){for(var data=this.getFrequencyData(),total=0,i=0;i<data.length;i++)total+=data[i];return total/data.length}}]),AudioAnalyzer}();exports.default=AudioAnalyzer},{"webaudio-buffer-loader":154}],4:[function(require,module,exports){"use strict";function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor))throw new TypeError("Cannot call a class as a function")}var _createClass=function(){function defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||!1,descriptor.configurable=!0,"value"in descriptor&&(descriptor.writable=!0),Object.defineProperty(target,descriptor.key,descriptor)}}return function(Constructor,protoProps,staticProps){return protoProps&&defineProperties(Constructor.prototype,protoProps),staticProps&&defineProperties(Constructor,staticProps),Constructor}}();Object.defineProperty(exports,"__esModule",{value:!0});var _pixi=require("pixi.js"),Scene=(require("pixi.js"),function(){function Scene(){_classCallCheck(this,Scene),this.width=window.innerWidth,this.height=window.innerHeight,this.renderer=new _pixi.WebGLRenderer(this.width,this.height,{antialias:!0}),this.stage=new _pixi.Container}return _createClass(Scene,[{key:"addChild",value:function(child){this.stage.addChild(child)}},{key:"removeChild",value:function(child){this.stage.removeChild(child)}},{key:"render",value:function(){this.renderer.render(this.stage)}},{key:"resize",value:function(newWidth,newHeight){this.renderer.resize(newWidth,newHeight)}}]),Scene}());exports.default=Scene},{"pixi.js":121}],5:[function(require,module,exports){"use strict";function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor))throw new TypeError("Cannot call a class as a function")}var _createClass=function(){function defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||!1,descriptor.configurable=!0,"value"in descriptor&&(descriptor.writable=!0),Object.defineProperty(target,descriptor.key,descriptor)}}return function(Constructor,protoProps,staticProps){return protoProps&&defineProperties(Constructor.prototype,protoProps),staticProps&&defineProperties(Constructor,staticProps),Constructor}}();Object.defineProperty(exports,"__esModule",{value:!0});var _clone=require("clone"),_clone2=_interopRequireDefault(_clone),SoundExplorer=function(){function SoundExplorer(dataFile){_classCallCheck(this,SoundExplorer),this.file=dataFile,this.data={},this.dataLoaded=!1,this.loadFile()}return _createClass(SoundExplorer,[{key:"loadFile",value:function(){var _this=this,request=new XMLHttpRequest;request.open("GET",this.file,!0),request.responseType="json",request.onload=function(){_this.data=request.response,_this.dataLoaded=!0},request.send()}},{key:"getData",value:function(){return this.dataLoaded?this.data:{meta:{analyzer_version:null,platform:null,detailed_status:null,filename:null,artist:null,album:null,title:null,genre:null,bitrate:null,sample_rate:null,seconds:null,status_code:null,timestamp:null,analysis_time:null},track:{num_samples:null,duration:null,sample_md5:null,decoder:null,decoder_version:null,offset_seconds:null,window_seconds:null,analysis_sample_rate:null,analysis_channels:null,end_of_fade_in:null,start_of_fade_out:null,loudness:null,tempo:null,tempo_confidence:null,time_signature:null,time_signature_confidence:null,key:null,key_confidence:null,mode:null,mode_confidence:null,codestring:null,code_version:null,echoprintstring:null,echoprint_version:null,synchstring:null,synch_version:null,rhythmstring:null,rhythm_version:null},bars:[],beats:[],tatums:[],sections:[],segments:[]}}},{key:"dataAtPos",value:function(pos){var result={bar:this.getBarAtPos(pos),beat:this.getBeatAtPos(pos),tatum:this.getTatumAtPos(pos),section:this.getSectionAtPos(pos),segment:this.getSegmentAtPos(pos)};return result}},{key:"parseDataList",value:function(listName,pos){var data=this.getData();if(void 0==data[listName])return null;for(var result=[],i=0;i<data[listName].length;i++){var elem=data[listName][i];if(elem.start<=pos&&elem.start+elem.duration>pos){var newElem=(0,_clone2.default)(elem);newElem.time=pos-elem.start,newElem.id=i,result=newElem;break}}return 0==result.length?null:result}},{key:"getBarAtPos",value:function(pos){return this.parseDataList("bars",pos)}},{key:"getBeatAtPos",value:function(pos){return this.parseDataList("beats",pos)}},{key:"getTatumAtPos",value:function(pos){return this.parseDataList("tatums",pos)}},{key:"getSectionAtPos",value:function(pos){return this.parseDataList("sections",pos)}},{key:"getSegmentAtPos",value:function(pos){return this.parseDataList("segments",pos)}}]),SoundExplorer}();exports.default=SoundExplorer},{clone:12}],6:[function(require,module,exports){"use strict";function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}Object.defineProperty(exports,"__esModule",{value:!0});var _datGui=require("dat-gui"),_datGui2=_interopRequireDefault(_datGui),setts={music:"woodkid-run-boy-run",timeOffset:0,amplitudeMap:200,shapeOpacity:.5,shapeTTL:2,pitcheFilter:.5,displayLines:!0,displayLinesFromCenter:!0,lineWidth:.8,syncEvent:"segment",customSyncFrequency:30,globalRotation:.5},saveData={preset:"Default",remembered:{Default:{0:{timeOffset:0,amplitudeMap:200,shapeOpacity:1,shapeTTL:2,pitcheFilter:.5,displayLines:!0,displayLinesFromCenter:!0,lineWidth:.8,syncEvent:"segment",customSyncFrequency:30,globalRotation:.5}},Cloud:{0:{timeOffset:0,amplitudeMap:200,shapeOpacity:.1,shapeTTL:2,pitcheFilter:.5,displayLines:!1,displayLinesFromCenter:!1,lineWidth:.8,syncEvent:"custom",customSyncFrequency:60,globalRotation:.5}}},closed:!1,folders:{}},gui=new _datGui2.default.GUI({load:saveData});gui.add(setts,"music",["woodkid-iron","woodkid-run-boy-run","awolnation-sail","hello","hanszimmer-interstellar","beethoven-lettre-a-elise"]),gui.add(setts,"timeOffset",-2e3,2e3),gui.add(setts,"amplitudeMap",1,255),gui.add(setts,"shapeOpacity",0,1),gui.add(setts,"shapeTTL",.1,10),gui.add(setts,"pitcheFilter",0,.9),gui.add(setts,"displayLines"),gui.add(setts,"displayLinesFromCenter"),gui.add(setts,"lineWidth",.5,10),gui.add(setts,"syncEvent",["tatum","beat","segment","bar","custom"]),gui.add(setts,"customSyncFrequency",1,60),gui.add(setts,"globalRotation",-1,1),gui.remember(setts),exports.default=setts},{"dat-gui":18}],7:[function(require,module,exports){"use strict";function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}Object.defineProperty(exports,"__esModule",{value:!0});var _color=require("color"),_color2=_interopRequireDefault(_color),Tools={map:function(num,min1,max1,min2,max2){var num1=(num-min1)/(max1-min1),num2=num1*(max2-min2)+min2;return num2},hex2rgb:function(hex){return hex="#"==hex.substr(0,1)?hex.substr(1):hex,[parseInt(hex.substr(0,2),16),parseInt(hex.substr(2,2),16),parseInt(hex.substr(4,2),16)]},hsl2hex:function(h,s,l){var c=(0,_color2.default)().hsl([h,s,l]);return c=c.rgb(),this.rgb2hex(c.r,c.g,c.b)},rgb2hex:function(r,g,b){return r*Math.pow(16,4)+g*Math.pow(16,2)+b},random:function(min,max){return min+Math.random()*(max-min)},randomInt:function(min,max){return Math.floor(Tools.random(min,max))},toRadians:function(degree){return degree*(Math.PI/180)},toDegree:function(radians){return radians*(180/Math.PI)}};exports.default=Tools},{color:17}],8:[function(require,module,exports){"use strict";function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}var _app=require("./app"),_app2=_interopRequireDefault(_app);new _app2.default},{"./app":1}],9:[function(require,module,exports){(function(process,global){!function(){function noop(){}function identity(v){return v}function toBool(v){return!!v}function notId(v){return!v}function only_once(fn){return function(){if(null===fn)throw new Error("Callback was already called.");fn.apply(this,arguments),fn=null}}function _once(fn){return function(){null!==fn&&(fn.apply(this,arguments),fn=null)}}function _isArrayLike(arr){return _isArray(arr)||"number"==typeof arr.length&&arr.length>=0&&arr.length%1===0}function _arrayEach(arr,iterator){for(var index=-1,length=arr.length;++index<length;)iterator(arr[index],index,arr)}function _map(arr,iterator){for(var index=-1,length=arr.length,result=Array(length);++index<length;)result[index]=iterator(arr[index],index,arr);return result}function _range(count){return _map(Array(count),function(v,i){return i})}function _reduce(arr,iterator,memo){return _arrayEach(arr,function(x,i,a){memo=iterator(memo,x,i,a)}),memo}function _forEachOf(object,iterator){_arrayEach(_keys(object),function(key){iterator(object[key],key)})}function _indexOf(arr,item){for(var i=0;i<arr.length;i++)if(arr[i]===item)return i;return-1}function _keyIterator(coll){var len,keys,i=-1;return _isArrayLike(coll)?(len=coll.length,function(){return i++,len>i?i:null}):(keys=_keys(coll),len=keys.length,function(){return i++,len>i?keys[i]:null})}function _restParam(func,startIndex){return startIndex=null==startIndex?func.length-1:+startIndex,function(){for(var length=Math.max(arguments.length-startIndex,0),rest=Array(length),index=0;length>index;index++)rest[index]=arguments[index+startIndex];switch(startIndex){case 0:return func.call(this,rest);case 1:return func.call(this,arguments[0],rest)}}}function _withoutIndex(iterator){return function(value,index,callback){return iterator(value,callback)}}function _eachOfLimit(limit){return function(obj,iterator,callback){callback=_once(callback||noop),obj=obj||[];var nextKey=_keyIterator(obj);if(0>=limit)return callback(null);var done=!1,running=0,errored=!1;!function replenish(){if(done&&0>=running)return callback(null);for(;limit>running&&!errored;){var key=nextKey();if(null===key)return done=!0,void(0>=running&&callback(null));running+=1,iterator(obj[key],key,only_once(function(err){running-=1,err?(callback(err),errored=!0):replenish()}))}}()}}function doParallel(fn){return function(obj,iterator,callback){return fn(async.eachOf,obj,iterator,callback)}}function doParallelLimit(fn){return function(obj,limit,iterator,callback){return fn(_eachOfLimit(limit),obj,iterator,callback)}}function doSeries(fn){return function(obj,iterator,callback){return fn(async.eachOfSeries,obj,iterator,callback)}}function _asyncMap(eachfn,arr,iterator,callback){callback=_once(callback||noop),arr=arr||[];var results=_isArrayLike(arr)?[]:{};eachfn(arr,function(value,index,callback){iterator(value,function(err,v){results[index]=v,callback(err)})},function(err){callback(err,results)})}function _filter(eachfn,arr,iterator,callback){var results=[];eachfn(arr,function(x,index,callback){iterator(x,function(v){v&&results.push({index:index,value:x}),callback()})},function(){callback(_map(results.sort(function(a,b){return a.index-b.index}),function(x){return x.value}))})}function _reject(eachfn,arr,iterator,callback){_filter(eachfn,arr,function(value,cb){iterator(value,function(v){cb(!v)})},callback)}function _createTester(eachfn,check,getResult){return function(arr,limit,iterator,cb){function done(){cb&&cb(getResult(!1,void 0))}function iteratee(x,_,callback){return cb?void iterator(x,function(v){cb&&check(v)&&(cb(getResult(!0,x)),cb=iterator=!1),callback()}):callback()}arguments.length>3?eachfn(arr,limit,iteratee,done):(cb=iterator,iterator=limit,eachfn(arr,iteratee,done))}}function _findGetResult(v,x){return x}function _parallel(eachfn,tasks,callback){callback=callback||noop;var results=_isArrayLike(tasks)?[]:{};eachfn(tasks,function(task,key,callback){task(_restParam(function(err,args){args.length<=1&&(args=args[0]),results[key]=args,callback(err)}))},function(err){callback(err,results)})}function _concat(eachfn,arr,fn,callback){var result=[];eachfn(arr,function(x,index,cb){fn(x,function(err,y){result=result.concat(y||[]),cb(err)})},function(err){callback(err,result)})}function _queue(worker,concurrency,payload){function _insert(q,data,pos,callback){if(null!=callback&&"function"!=typeof callback)throw new Error("task callback must be a function");return q.started=!0,_isArray(data)||(data=[data]),0===data.length&&q.idle()?async.setImmediate(function(){q.drain()}):(_arrayEach(data,function(task){var item={data:task,callback:callback||noop};pos?q.tasks.unshift(item):q.tasks.push(item),q.tasks.length===q.concurrency&&q.saturated()}),void async.setImmediate(q.process))}function _next(q,tasks){return function(){workers-=1;var removed=!1,args=arguments;_arrayEach(tasks,function(task){_arrayEach(workersList,function(worker,index){worker!==task||removed||(workersList.splice(index,1),removed=!0)}),task.callback.apply(task,args)}),q.tasks.length+workers===0&&q.drain(),q.process()}}if(null==concurrency)concurrency=1;else if(0===concurrency)throw new Error("Concurrency must not be zero");var workers=0,workersList=[],q={tasks:[],concurrency:concurrency,payload:payload,saturated:noop,empty:noop,drain:noop,started:!1,paused:!1,push:function(data,callback){_insert(q,data,!1,callback)},kill:function(){q.drain=noop,q.tasks=[]},unshift:function(data,callback){_insert(q,data,!0,callback)},process:function(){if(!q.paused&&workers<q.concurrency&&q.tasks.length)for(;workers<q.concurrency&&q.tasks.length;){var tasks=q.payload?q.tasks.splice(0,q.payload):q.tasks.splice(0,q.tasks.length),data=_map(tasks,function(task){return task.data});0===q.tasks.length&&q.empty(),workers+=1,workersList.push(tasks[0]);var cb=only_once(_next(q,tasks));worker(data,cb)}},length:function(){return q.tasks.length},running:function(){return workers},workersList:function(){return workersList},idle:function(){return q.tasks.length+workers===0},pause:function(){q.paused=!0},resume:function(){if(q.paused!==!1){q.paused=!1;for(var resumeCount=Math.min(q.concurrency,q.tasks.length),w=1;resumeCount>=w;w++)async.setImmediate(q.process)}}};return q}function _console_fn(name){return _restParam(function(fn,args){fn.apply(null,args.concat([_restParam(function(err,args){"object"==typeof console&&(err?console.error&&console.error(err):console[name]&&_arrayEach(args,function(x){console[name](x)}))})]))})}function _times(mapper){return function(count,iterator,callback){mapper(_range(count),iterator,callback)}}function _applyEach(eachfn){return _restParam(function(fns,args){var go=_restParam(function(args){var that=this,callback=args.pop();return eachfn(fns,function(fn,_,cb){fn.apply(that,args.concat([cb]))},callback)});return args.length?go.apply(this,args):go})}function ensureAsync(fn){return _restParam(function(args){var callback=args.pop();args.push(function(){var innerArgs=arguments;sync?async.setImmediate(function(){callback.apply(null,innerArgs)}):callback.apply(null,innerArgs)});var sync=!0;fn.apply(this,args),sync=!1})}var previous_async,async={},root="object"==typeof self&&self.self===self&&self||"object"==typeof global&&global.global===global&&global||this;null!=root&&(previous_async=root.async),async.noConflict=function(){return root.async=previous_async,async};var _toString=Object.prototype.toString,_isArray=Array.isArray||function(obj){return"[object Array]"===_toString.call(obj)},_isObject=function(obj){var type=typeof obj;return"function"===type||"object"===type&&!!obj},_keys=Object.keys||function(obj){var keys=[];for(var k in obj)obj.hasOwnProperty(k)&&keys.push(k);return keys},_setImmediate="function"==typeof setImmediate&&setImmediate,_delay=_setImmediate?function(fn){_setImmediate(fn)}:function(fn){setTimeout(fn,0)};"object"==typeof process&&"function"==typeof process.nextTick?async.nextTick=process.nextTick:async.nextTick=_delay,async.setImmediate=_setImmediate?_delay:async.nextTick,async.forEach=async.each=function(arr,iterator,callback){return async.eachOf(arr,_withoutIndex(iterator),callback)},async.forEachSeries=async.eachSeries=function(arr,iterator,callback){return async.eachOfSeries(arr,_withoutIndex(iterator),callback)},async.forEachLimit=async.eachLimit=function(arr,limit,iterator,callback){return _eachOfLimit(limit)(arr,_withoutIndex(iterator),callback)},async.forEachOf=async.eachOf=function(object,iterator,callback){function done(err){completed--,err?callback(err):null===key&&0>=completed&&callback(null)}callback=_once(callback||noop),object=object||[];for(var key,iter=_keyIterator(object),completed=0;null!=(key=iter());)completed+=1,iterator(object[key],key,only_once(done));0===completed&&callback(null)},async.forEachOfSeries=async.eachOfSeries=function(obj,iterator,callback){function iterate(){var sync=!0;return null===key?callback(null):(iterator(obj[key],key,only_once(function(err){
if(err)callback(err);else{if(key=nextKey(),null===key)return callback(null);sync?async.setImmediate(iterate):iterate()}})),void(sync=!1))}callback=_once(callback||noop),obj=obj||[];var nextKey=_keyIterator(obj),key=nextKey();iterate()},async.forEachOfLimit=async.eachOfLimit=function(obj,limit,iterator,callback){_eachOfLimit(limit)(obj,iterator,callback)},async.map=doParallel(_asyncMap),async.mapSeries=doSeries(_asyncMap),async.mapLimit=doParallelLimit(_asyncMap),async.inject=async.foldl=async.reduce=function(arr,memo,iterator,callback){async.eachOfSeries(arr,function(x,i,callback){iterator(memo,x,function(err,v){memo=v,callback(err)})},function(err){callback(err,memo)})},async.foldr=async.reduceRight=function(arr,memo,iterator,callback){var reversed=_map(arr,identity).reverse();async.reduce(reversed,memo,iterator,callback)},async.transform=function(arr,memo,iterator,callback){3===arguments.length&&(callback=iterator,iterator=memo,memo=_isArray(arr)?[]:{}),async.eachOf(arr,function(v,k,cb){iterator(memo,v,k,cb)},function(err){callback(err,memo)})},async.select=async.filter=doParallel(_filter),async.selectLimit=async.filterLimit=doParallelLimit(_filter),async.selectSeries=async.filterSeries=doSeries(_filter),async.reject=doParallel(_reject),async.rejectLimit=doParallelLimit(_reject),async.rejectSeries=doSeries(_reject),async.any=async.some=_createTester(async.eachOf,toBool,identity),async.someLimit=_createTester(async.eachOfLimit,toBool,identity),async.all=async.every=_createTester(async.eachOf,notId,notId),async.everyLimit=_createTester(async.eachOfLimit,notId,notId),async.detect=_createTester(async.eachOf,identity,_findGetResult),async.detectSeries=_createTester(async.eachOfSeries,identity,_findGetResult),async.detectLimit=_createTester(async.eachOfLimit,identity,_findGetResult),async.sortBy=function(arr,iterator,callback){function comparator(left,right){var a=left.criteria,b=right.criteria;return b>a?-1:a>b?1:0}async.map(arr,function(x,callback){iterator(x,function(err,criteria){err?callback(err):callback(null,{value:x,criteria:criteria})})},function(err,results){return err?callback(err):void callback(null,_map(results.sort(comparator),function(x){return x.value}))})},async.auto=function(tasks,concurrency,callback){function addListener(fn){listeners.unshift(fn)}function removeListener(fn){var idx=_indexOf(listeners,fn);idx>=0&&listeners.splice(idx,1)}function taskComplete(){remainingTasks--,_arrayEach(listeners.slice(0),function(fn){fn()})}callback||(callback=concurrency,concurrency=null),callback=_once(callback||noop);var keys=_keys(tasks),remainingTasks=keys.length;if(!remainingTasks)return callback(null);concurrency||(concurrency=remainingTasks);var results={},runningTasks=0,listeners=[];addListener(function(){remainingTasks||callback(null,results)}),_arrayEach(keys,function(k){function ready(){return concurrency>runningTasks&&_reduce(requires,function(a,x){return a&&results.hasOwnProperty(x)},!0)&&!results.hasOwnProperty(k)}function listener(){ready()&&(runningTasks++,removeListener(listener),task[task.length-1](taskCallback,results))}for(var dep,task=_isArray(tasks[k])?tasks[k]:[tasks[k]],taskCallback=_restParam(function(err,args){if(runningTasks--,args.length<=1&&(args=args[0]),err){var safeResults={};_forEachOf(results,function(val,rkey){safeResults[rkey]=val}),safeResults[k]=args,callback(err,safeResults)}else results[k]=args,async.setImmediate(taskComplete)}),requires=task.slice(0,task.length-1),len=requires.length;len--;){if(!(dep=tasks[requires[len]]))throw new Error("Has inexistant dependency");if(_isArray(dep)&&_indexOf(dep,k)>=0)throw new Error("Has cyclic dependencies")}ready()?(runningTasks++,task[task.length-1](taskCallback,results)):addListener(listener)})},async.retry=function(times,task,callback){function parseTimes(acc,t){if("number"==typeof t)acc.times=parseInt(t,10)||DEFAULT_TIMES;else{if("object"!=typeof t)throw new Error("Unsupported argument type for 'times': "+typeof t);acc.times=parseInt(t.times,10)||DEFAULT_TIMES,acc.interval=parseInt(t.interval,10)||DEFAULT_INTERVAL}}function wrappedTask(wrappedCallback,wrappedResults){function retryAttempt(task,finalAttempt){return function(seriesCallback){task(function(err,result){seriesCallback(!err||finalAttempt,{err:err,result:result})},wrappedResults)}}function retryInterval(interval){return function(seriesCallback){setTimeout(function(){seriesCallback(null)},interval)}}for(;opts.times;){var finalAttempt=!(opts.times-=1);attempts.push(retryAttempt(opts.task,finalAttempt)),!finalAttempt&&opts.interval>0&&attempts.push(retryInterval(opts.interval))}async.series(attempts,function(done,data){data=data[data.length-1],(wrappedCallback||opts.callback)(data.err,data.result)})}var DEFAULT_TIMES=5,DEFAULT_INTERVAL=0,attempts=[],opts={times:DEFAULT_TIMES,interval:DEFAULT_INTERVAL},length=arguments.length;if(1>length||length>3)throw new Error("Invalid arguments - must be either (task), (task, callback), (times, task) or (times, task, callback)");return 2>=length&&"function"==typeof times&&(callback=task,task=times),"function"!=typeof times&&parseTimes(opts,times),opts.callback=callback,opts.task=task,opts.callback?wrappedTask():wrappedTask},async.waterfall=function(tasks,callback){function wrapIterator(iterator){return _restParam(function(err,args){if(err)callback.apply(null,[err].concat(args));else{var next=iterator.next();next?args.push(wrapIterator(next)):args.push(callback),ensureAsync(iterator).apply(null,args)}})}if(callback=_once(callback||noop),!_isArray(tasks)){var err=new Error("First argument to waterfall must be an array of functions");return callback(err)}return tasks.length?void wrapIterator(async.iterator(tasks))():callback()},async.parallel=function(tasks,callback){_parallel(async.eachOf,tasks,callback)},async.parallelLimit=function(tasks,limit,callback){_parallel(_eachOfLimit(limit),tasks,callback)},async.series=function(tasks,callback){_parallel(async.eachOfSeries,tasks,callback)},async.iterator=function(tasks){function makeCallback(index){function fn(){return tasks.length&&tasks[index].apply(null,arguments),fn.next()}return fn.next=function(){return index<tasks.length-1?makeCallback(index+1):null},fn}return makeCallback(0)},async.apply=_restParam(function(fn,args){return _restParam(function(callArgs){return fn.apply(null,args.concat(callArgs))})}),async.concat=doParallel(_concat),async.concatSeries=doSeries(_concat),async.whilst=function(test,iterator,callback){if(callback=callback||noop,test()){var next=_restParam(function(err,args){err?callback(err):test.apply(this,args)?iterator(next):callback(null)});iterator(next)}else callback(null)},async.doWhilst=function(iterator,test,callback){var calls=0;return async.whilst(function(){return++calls<=1||test.apply(this,arguments)},iterator,callback)},async.until=function(test,iterator,callback){return async.whilst(function(){return!test.apply(this,arguments)},iterator,callback)},async.doUntil=function(iterator,test,callback){return async.doWhilst(iterator,function(){return!test.apply(this,arguments)},callback)},async.during=function(test,iterator,callback){callback=callback||noop;var next=_restParam(function(err,args){err?callback(err):(args.push(check),test.apply(this,args))}),check=function(err,truth){err?callback(err):truth?iterator(next):callback(null)};test(check)},async.doDuring=function(iterator,test,callback){var calls=0;async.during(function(next){calls++<1?next(null,!0):test.apply(this,arguments)},iterator,callback)},async.queue=function(worker,concurrency){var q=_queue(function(items,cb){worker(items[0],cb)},concurrency,1);return q},async.priorityQueue=function(worker,concurrency){function _compareTasks(a,b){return a.priority-b.priority}function _binarySearch(sequence,item,compare){for(var beg=-1,end=sequence.length-1;end>beg;){var mid=beg+(end-beg+1>>>1);compare(item,sequence[mid])>=0?beg=mid:end=mid-1}return beg}function _insert(q,data,priority,callback){if(null!=callback&&"function"!=typeof callback)throw new Error("task callback must be a function");return q.started=!0,_isArray(data)||(data=[data]),0===data.length?async.setImmediate(function(){q.drain()}):void _arrayEach(data,function(task){var item={data:task,priority:priority,callback:"function"==typeof callback?callback:noop};q.tasks.splice(_binarySearch(q.tasks,item,_compareTasks)+1,0,item),q.tasks.length===q.concurrency&&q.saturated(),async.setImmediate(q.process)})}var q=async.queue(worker,concurrency);return q.push=function(data,priority,callback){_insert(q,data,priority,callback)},delete q.unshift,q},async.cargo=function(worker,payload){return _queue(worker,1,payload)},async.log=_console_fn("log"),async.dir=_console_fn("dir"),async.memoize=function(fn,hasher){var memo={},queues={};hasher=hasher||identity;var memoized=_restParam(function(args){var callback=args.pop(),key=hasher.apply(null,args);key in memo?async.setImmediate(function(){callback.apply(null,memo[key])}):key in queues?queues[key].push(callback):(queues[key]=[callback],fn.apply(null,args.concat([_restParam(function(args){memo[key]=args;var q=queues[key];delete queues[key];for(var i=0,l=q.length;l>i;i++)q[i].apply(null,args)})])))});return memoized.memo=memo,memoized.unmemoized=fn,memoized},async.unmemoize=function(fn){return function(){return(fn.unmemoized||fn).apply(null,arguments)}},async.times=_times(async.map),async.timesSeries=_times(async.mapSeries),async.timesLimit=function(count,limit,iterator,callback){return async.mapLimit(_range(count),limit,iterator,callback)},async.seq=function(){var fns=arguments;return _restParam(function(args){var that=this,callback=args[args.length-1];"function"==typeof callback?args.pop():callback=noop,async.reduce(fns,args,function(newargs,fn,cb){fn.apply(that,newargs.concat([_restParam(function(err,nextargs){cb(err,nextargs)})]))},function(err,results){callback.apply(that,[err].concat(results))})})},async.compose=function(){return async.seq.apply(null,Array.prototype.reverse.call(arguments))},async.applyEach=_applyEach(async.eachOf),async.applyEachSeries=_applyEach(async.eachOfSeries),async.forever=function(fn,callback){function next(err){return err?done(err):void task(next)}var done=only_once(callback||noop),task=ensureAsync(fn);next()},async.ensureAsync=ensureAsync,async.constant=_restParam(function(values){var args=[null].concat(values);return function(callback){return callback.apply(this,args)}}),async.wrapSync=async.asyncify=function(func){return _restParam(function(args){var result,callback=args.pop();try{result=func.apply(this,args)}catch(e){return callback(e)}_isObject(result)&&"function"==typeof result.then?result.then(function(value){callback(null,value)}).catch(function(err){callback(err.message?err:new Error(err))}):callback(null,result)})},"object"==typeof module&&module.exports?module.exports=async:"function"==typeof define&&define.amd?define([],function(){return async}):root.async=async}()}).call(this,require("_process"),"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{_process:140}],10:[function(require,module,exports){var lookup="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/";!function(exports){"use strict";function decode(elt){var code=elt.charCodeAt(0);return code===PLUS||code===PLUS_URL_SAFE?62:code===SLASH||code===SLASH_URL_SAFE?63:NUMBER>code?-1:NUMBER+10>code?code-NUMBER+26+26:UPPER+26>code?code-UPPER:LOWER+26>code?code-LOWER+26:void 0}function b64ToByteArray(b64){function push(v){arr[L++]=v}var i,j,l,tmp,placeHolders,arr;if(b64.length%4>0)throw new Error("Invalid string. Length must be a multiple of 4");var len=b64.length;placeHolders="="===b64.charAt(len-2)?2:"="===b64.charAt(len-1)?1:0,arr=new Arr(3*b64.length/4-placeHolders),l=placeHolders>0?b64.length-4:b64.length;var L=0;for(i=0,j=0;l>i;i+=4,j+=3)tmp=decode(b64.charAt(i))<<18|decode(b64.charAt(i+1))<<12|decode(b64.charAt(i+2))<<6|decode(b64.charAt(i+3)),push((16711680&tmp)>>16),push((65280&tmp)>>8),push(255&tmp);return 2===placeHolders?(tmp=decode(b64.charAt(i))<<2|decode(b64.charAt(i+1))>>4,push(255&tmp)):1===placeHolders&&(tmp=decode(b64.charAt(i))<<10|decode(b64.charAt(i+1))<<4|decode(b64.charAt(i+2))>>2,push(tmp>>8&255),push(255&tmp)),arr}function uint8ToBase64(uint8){function encode(num){return lookup.charAt(num)}function tripletToBase64(num){return encode(num>>18&63)+encode(num>>12&63)+encode(num>>6&63)+encode(63&num)}var i,temp,length,extraBytes=uint8.length%3,output="";for(i=0,length=uint8.length-extraBytes;length>i;i+=3)temp=(uint8[i]<<16)+(uint8[i+1]<<8)+uint8[i+2],output+=tripletToBase64(temp);switch(extraBytes){case 1:temp=uint8[uint8.length-1],output+=encode(temp>>2),output+=encode(temp<<4&63),output+="==";break;case 2:temp=(uint8[uint8.length-2]<<8)+uint8[uint8.length-1],output+=encode(temp>>10),output+=encode(temp>>4&63),output+=encode(temp<<2&63),output+="="}return output}var Arr="undefined"!=typeof Uint8Array?Uint8Array:Array,PLUS="+".charCodeAt(0),SLASH="/".charCodeAt(0),NUMBER="0".charCodeAt(0),LOWER="a".charCodeAt(0),UPPER="A".charCodeAt(0),PLUS_URL_SAFE="-".charCodeAt(0),SLASH_URL_SAFE="_".charCodeAt(0);exports.toByteArray=b64ToByteArray,exports.fromByteArray=uint8ToBase64}("undefined"==typeof exports?this.base64js={}:exports)},{}],11:[function(require,module,exports){(function(global){function typedArraySupport(){function Bar(){}try{var arr=new Uint8Array(1);return arr.foo=function(){return 42},arr.constructor=Bar,42===arr.foo()&&arr.constructor===Bar&&"function"==typeof arr.subarray&&0===arr.subarray(1,1).byteLength}catch(e){return!1}}function kMaxLength(){return Buffer.TYPED_ARRAY_SUPPORT?2147483647:1073741823}function Buffer(arg){return this instanceof Buffer?(this.length=0,this.parent=void 0,"number"==typeof arg?fromNumber(this,arg):"string"==typeof arg?fromString(this,arg,arguments.length>1?arguments[1]:"utf8"):fromObject(this,arg)):arguments.length>1?new Buffer(arg,arguments[1]):new Buffer(arg)}function fromNumber(that,length){if(that=allocate(that,0>length?0:0|checked(length)),!Buffer.TYPED_ARRAY_SUPPORT)for(var i=0;length>i;i++)that[i]=0;return that}function fromString(that,string,encoding){("string"!=typeof encoding||""===encoding)&&(encoding="utf8");var length=0|byteLength(string,encoding);return that=allocate(that,length),that.write(string,encoding),that}function fromObject(that,object){if(Buffer.isBuffer(object))return fromBuffer(that,object);if(isArray(object))return fromArray(that,object);if(null==object)throw new TypeError("must start with number, buffer, array or string");if("undefined"!=typeof ArrayBuffer){if(object.buffer instanceof ArrayBuffer)return fromTypedArray(that,object);if(object instanceof ArrayBuffer)return fromArrayBuffer(that,object)}return object.length?fromArrayLike(that,object):fromJsonObject(that,object)}function fromBuffer(that,buffer){var length=0|checked(buffer.length);return that=allocate(that,length),buffer.copy(that,0,0,length),that}function fromArray(that,array){var length=0|checked(array.length);that=allocate(that,length);for(var i=0;length>i;i+=1)that[i]=255&array[i];return that}function fromTypedArray(that,array){var length=0|checked(array.length);that=allocate(that,length);for(var i=0;length>i;i+=1)that[i]=255&array[i];return that}function fromArrayBuffer(that,array){return Buffer.TYPED_ARRAY_SUPPORT?(array.byteLength,that=Buffer._augment(new Uint8Array(array))):that=fromTypedArray(that,new Uint8Array(array)),that}function fromArrayLike(that,array){var length=0|checked(array.length);that=allocate(that,length);for(var i=0;length>i;i+=1)that[i]=255&array[i];return that}function fromJsonObject(that,object){var array,length=0;"Buffer"===object.type&&isArray(object.data)&&(array=object.data,length=0|checked(array.length)),that=allocate(that,length);for(var i=0;length>i;i+=1)that[i]=255&array[i];return that}function allocate(that,length){Buffer.TYPED_ARRAY_SUPPORT?(that=Buffer._augment(new Uint8Array(length)),that.__proto__=Buffer.prototype):(that.length=length,that._isBuffer=!0);var fromPool=0!==length&&length<=Buffer.poolSize>>>1;return fromPool&&(that.parent=rootParent),that}function checked(length){if(length>=kMaxLength())throw new RangeError("Attempt to allocate Buffer larger than maximum size: 0x"+kMaxLength().toString(16)+" bytes");return 0|length}function SlowBuffer(subject,encoding){if(!(this instanceof SlowBuffer))return new SlowBuffer(subject,encoding);var buf=new Buffer(subject,encoding);return delete buf.parent,buf}function byteLength(string,encoding){"string"!=typeof string&&(string=""+string);var len=string.length;if(0===len)return 0;for(var loweredCase=!1;;)switch(encoding){case"ascii":case"binary":case"raw":case"raws":return len;case"utf8":case"utf-8":return utf8ToBytes(string).length;case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return 2*len;case"hex":return len>>>1;case"base64":return base64ToBytes(string).length;default:if(loweredCase)return utf8ToBytes(string).length;encoding=(""+encoding).toLowerCase(),loweredCase=!0}}function slowToString(encoding,start,end){var loweredCase=!1;if(start=0|start,end=void 0===end||end===1/0?this.length:0|end,encoding||(encoding="utf8"),0>start&&(start=0),end>this.length&&(end=this.length),start>=end)return"";for(;;)switch(encoding){case"hex":return hexSlice(this,start,end);case"utf8":case"utf-8":return utf8Slice(this,start,end);case"ascii":return asciiSlice(this,start,end);case"binary":return binarySlice(this,start,end);case"base64":return base64Slice(this,start,end);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return utf16leSlice(this,start,end);default:if(loweredCase)throw new TypeError("Unknown encoding: "+encoding);encoding=(encoding+"").toLowerCase(),loweredCase=!0}}function hexWrite(buf,string,offset,length){offset=Number(offset)||0;var remaining=buf.length-offset;length?(length=Number(length),length>remaining&&(length=remaining)):length=remaining;var strLen=string.length;if(strLen%2!==0)throw new Error("Invalid hex string");length>strLen/2&&(length=strLen/2);for(var i=0;length>i;i++){var parsed=parseInt(string.substr(2*i,2),16);if(isNaN(parsed))throw new Error("Invalid hex string");buf[offset+i]=parsed}return i}function utf8Write(buf,string,offset,length){return blitBuffer(utf8ToBytes(string,buf.length-offset),buf,offset,length)}function asciiWrite(buf,string,offset,length){return blitBuffer(asciiToBytes(string),buf,offset,length)}function binaryWrite(buf,string,offset,length){return asciiWrite(buf,string,offset,length)}function base64Write(buf,string,offset,length){return blitBuffer(base64ToBytes(string),buf,offset,length)}function ucs2Write(buf,string,offset,length){return blitBuffer(utf16leToBytes(string,buf.length-offset),buf,offset,length)}function base64Slice(buf,start,end){return 0===start&&end===buf.length?base64.fromByteArray(buf):base64.fromByteArray(buf.slice(start,end))}function utf8Slice(buf,start,end){end=Math.min(buf.length,end);for(var res=[],i=start;end>i;){var firstByte=buf[i],codePoint=null,bytesPerSequence=firstByte>239?4:firstByte>223?3:firstByte>191?2:1;if(end>=i+bytesPerSequence){var secondByte,thirdByte,fourthByte,tempCodePoint;switch(bytesPerSequence){case 1:128>firstByte&&(codePoint=firstByte);break;case 2:secondByte=buf[i+1],128===(192&secondByte)&&(tempCodePoint=(31&firstByte)<<6|63&secondByte,tempCodePoint>127&&(codePoint=tempCodePoint));break;case 3:secondByte=buf[i+1],thirdByte=buf[i+2],128===(192&secondByte)&&128===(192&thirdByte)&&(tempCodePoint=(15&firstByte)<<12|(63&secondByte)<<6|63&thirdByte,tempCodePoint>2047&&(55296>tempCodePoint||tempCodePoint>57343)&&(codePoint=tempCodePoint));break;case 4:secondByte=buf[i+1],thirdByte=buf[i+2],fourthByte=buf[i+3],128===(192&secondByte)&&128===(192&thirdByte)&&128===(192&fourthByte)&&(tempCodePoint=(15&firstByte)<<18|(63&secondByte)<<12|(63&thirdByte)<<6|63&fourthByte,tempCodePoint>65535&&1114112>tempCodePoint&&(codePoint=tempCodePoint))}}null===codePoint?(codePoint=65533,bytesPerSequence=1):codePoint>65535&&(codePoint-=65536,res.push(codePoint>>>10&1023|55296),codePoint=56320|1023&codePoint),res.push(codePoint),i+=bytesPerSequence}return decodeCodePointsArray(res)}function decodeCodePointsArray(codePoints){var len=codePoints.length;if(MAX_ARGUMENTS_LENGTH>=len)return String.fromCharCode.apply(String,codePoints);for(var res="",i=0;len>i;)res+=String.fromCharCode.apply(String,codePoints.slice(i,i+=MAX_ARGUMENTS_LENGTH));return res}function asciiSlice(buf,start,end){var ret="";end=Math.min(buf.length,end);for(var i=start;end>i;i++)ret+=String.fromCharCode(127&buf[i]);return ret}function binarySlice(buf,start,end){var ret="";end=Math.min(buf.length,end);for(var i=start;end>i;i++)ret+=String.fromCharCode(buf[i]);return ret}function hexSlice(buf,start,end){var len=buf.length;(!start||0>start)&&(start=0),(!end||0>end||end>len)&&(end=len);for(var out="",i=start;end>i;i++)out+=toHex(buf[i]);return out}function utf16leSlice(buf,start,end){for(var bytes=buf.slice(start,end),res="",i=0;i<bytes.length;i+=2)res+=String.fromCharCode(bytes[i]+256*bytes[i+1]);return res}function checkOffset(offset,ext,length){if(offset%1!==0||0>offset)throw new RangeError("offset is not uint");if(offset+ext>length)throw new RangeError("Trying to access beyond buffer length")}function checkInt(buf,value,offset,ext,max,min){if(!Buffer.isBuffer(buf))throw new TypeError("buffer must be a Buffer instance");if(value>max||min>value)throw new RangeError("value is out of bounds");if(offset+ext>buf.length)throw new RangeError("index out of range")}function objectWriteUInt16(buf,value,offset,littleEndian){0>value&&(value=65535+value+1);for(var i=0,j=Math.min(buf.length-offset,2);j>i;i++)buf[offset+i]=(value&255<<8*(littleEndian?i:1-i))>>>8*(littleEndian?i:1-i)}function objectWriteUInt32(buf,value,offset,littleEndian){0>value&&(value=4294967295+value+1);for(var i=0,j=Math.min(buf.length-offset,4);j>i;i++)buf[offset+i]=value>>>8*(littleEndian?i:3-i)&255}function checkIEEE754(buf,value,offset,ext,max,min){if(value>max||min>value)throw new RangeError("value is out of bounds");if(offset+ext>buf.length)throw new RangeError("index out of range");if(0>offset)throw new RangeError("index out of range")}function writeFloat(buf,value,offset,littleEndian,noAssert){return noAssert||checkIEEE754(buf,value,offset,4,3.4028234663852886e38,-3.4028234663852886e38),ieee754.write(buf,value,offset,littleEndian,23,4),offset+4}function writeDouble(buf,value,offset,littleEndian,noAssert){return noAssert||checkIEEE754(buf,value,offset,8,1.7976931348623157e308,-1.7976931348623157e308),ieee754.write(buf,value,offset,littleEndian,52,8),offset+8}function base64clean(str){if(str=stringtrim(str).replace(INVALID_BASE64_RE,""),str.length<2)return"";for(;str.length%4!==0;)str+="=";return str}function stringtrim(str){return str.trim?str.trim():str.replace(/^\s+|\s+$/g,"")}function toHex(n){return 16>n?"0"+n.toString(16):n.toString(16)}function utf8ToBytes(string,units){units=units||1/0;for(var codePoint,length=string.length,leadSurrogate=null,bytes=[],i=0;length>i;i++){if(codePoint=string.charCodeAt(i),codePoint>55295&&57344>codePoint){if(!leadSurrogate){if(codePoint>56319){(units-=3)>-1&&bytes.push(239,191,189);continue}if(i+1===length){(units-=3)>-1&&bytes.push(239,191,189);continue}leadSurrogate=codePoint;continue}if(56320>codePoint){(units-=3)>-1&&bytes.push(239,191,189),leadSurrogate=codePoint;continue}codePoint=(leadSurrogate-55296<<10|codePoint-56320)+65536}else leadSurrogate&&(units-=3)>-1&&bytes.push(239,191,189);if(leadSurrogate=null,128>codePoint){if((units-=1)<0)break;bytes.push(codePoint)}else if(2048>codePoint){if((units-=2)<0)break;bytes.push(codePoint>>6|192,63&codePoint|128)}else if(65536>codePoint){if((units-=3)<0)break;bytes.push(codePoint>>12|224,codePoint>>6&63|128,63&codePoint|128)}else{if(!(1114112>codePoint))throw new Error("Invalid code point");if((units-=4)<0)break;bytes.push(codePoint>>18|240,codePoint>>12&63|128,codePoint>>6&63|128,63&codePoint|128)}}return bytes}function asciiToBytes(str){for(var byteArray=[],i=0;i<str.length;i++)byteArray.push(255&str.charCodeAt(i));return byteArray}function utf16leToBytes(str,units){for(var c,hi,lo,byteArray=[],i=0;i<str.length&&!((units-=2)<0);i++)c=str.charCodeAt(i),hi=c>>8,lo=c%256,byteArray.push(lo),byteArray.push(hi);return byteArray}function base64ToBytes(str){return base64.toByteArray(base64clean(str))}function blitBuffer(src,dst,offset,length){for(var i=0;length>i&&!(i+offset>=dst.length||i>=src.length);i++)dst[i+offset]=src[i];return i}var base64=require("base64-js"),ieee754=require("ieee754"),isArray=require("is-array");exports.Buffer=Buffer,exports.SlowBuffer=SlowBuffer,exports.INSPECT_MAX_BYTES=50,Buffer.poolSize=8192;var rootParent={};Buffer.TYPED_ARRAY_SUPPORT=void 0!==global.TYPED_ARRAY_SUPPORT?global.TYPED_ARRAY_SUPPORT:typedArraySupport(),Buffer.TYPED_ARRAY_SUPPORT&&(Buffer.prototype.__proto__=Uint8Array.prototype,Buffer.__proto__=Uint8Array),Buffer.isBuffer=function(b){return!(null==b||!b._isBuffer)},Buffer.compare=function(a,b){if(!Buffer.isBuffer(a)||!Buffer.isBuffer(b))throw new TypeError("Arguments must be Buffers");if(a===b)return 0;for(var x=a.length,y=b.length,i=0,len=Math.min(x,y);len>i&&a[i]===b[i];)++i;return i!==len&&(x=a[i],y=b[i]),y>x?-1:x>y?1:0},Buffer.isEncoding=function(encoding){switch(String(encoding).toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"binary":case"base64":case"raw":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return!0;default:return!1}},Buffer.concat=function(list,length){if(!isArray(list))throw new TypeError("list argument must be an Array of Buffers.");if(0===list.length)return new Buffer(0);var i;if(void 0===length)for(length=0,i=0;i<list.length;i++)length+=list[i].length;var buf=new Buffer(length),pos=0;for(i=0;i<list.length;i++){var item=list[i];item.copy(buf,pos),pos+=item.length}return buf},Buffer.byteLength=byteLength,Buffer.prototype.length=void 0,Buffer.prototype.parent=void 0,Buffer.prototype.toString=function(){var length=0|this.length;return 0===length?"":0===arguments.length?utf8Slice(this,0,length):slowToString.apply(this,arguments)},Buffer.prototype.equals=function(b){if(!Buffer.isBuffer(b))throw new TypeError("Argument must be a Buffer");return this===b?!0:0===Buffer.compare(this,b)},Buffer.prototype.inspect=function(){var str="",max=exports.INSPECT_MAX_BYTES;return this.length>0&&(str=this.toString("hex",0,max).match(/.{2}/g).join(" "),this.length>max&&(str+=" ... ")),"<Buffer "+str+">"},Buffer.prototype.compare=function(b){if(!Buffer.isBuffer(b))throw new TypeError("Argument must be a Buffer");return this===b?0:Buffer.compare(this,b)},Buffer.prototype.indexOf=function(val,byteOffset){function arrayIndexOf(arr,val,byteOffset){for(var foundIndex=-1,i=0;byteOffset+i<arr.length;i++)if(arr[byteOffset+i]===val[-1===foundIndex?0:i-foundIndex]){if(-1===foundIndex&&(foundIndex=i),i-foundIndex+1===val.length)return byteOffset+foundIndex}else foundIndex=-1;return-1}if(byteOffset>2147483647?byteOffset=2147483647:-2147483648>byteOffset&&(byteOffset=-2147483648),byteOffset>>=0,0===this.length)return-1;if(byteOffset>=this.length)return-1;if(0>byteOffset&&(byteOffset=Math.max(this.length+byteOffset,0)),"string"==typeof val)return 0===val.length?-1:String.prototype.indexOf.call(this,val,byteOffset);if(Buffer.isBuffer(val))return arrayIndexOf(this,val,byteOffset);if("number"==typeof val)return Buffer.TYPED_ARRAY_SUPPORT&&"function"===Uint8Array.prototype.indexOf?Uint8Array.prototype.indexOf.call(this,val,byteOffset):arrayIndexOf(this,[val],byteOffset);throw new TypeError("val must be string, number or Buffer")},Buffer.prototype.get=function(offset){return console.log(".get() is deprecated. Access using array indexes instead."),this.readUInt8(offset)},Buffer.prototype.set=function(v,offset){return console.log(".set() is deprecated. Access using array indexes instead."),this.writeUInt8(v,offset)},Buffer.prototype.write=function(string,offset,length,encoding){if(void 0===offset)encoding="utf8",length=this.length,offset=0;else if(void 0===length&&"string"==typeof offset)encoding=offset,length=this.length,offset=0;else if(isFinite(offset))offset=0|offset,isFinite(length)?(length=0|length,void 0===encoding&&(encoding="utf8")):(encoding=length,length=void 0);else{var swap=encoding;encoding=offset,offset=0|length,length=swap}var remaining=this.length-offset;if((void 0===length||length>remaining)&&(length=remaining),string.length>0&&(0>length||0>offset)||offset>this.length)throw new RangeError("attempt to write outside buffer bounds");encoding||(encoding="utf8");for(var loweredCase=!1;;)switch(encoding){case"hex":return hexWrite(this,string,offset,length);case"utf8":case"utf-8":return utf8Write(this,string,offset,length);case"ascii":return asciiWrite(this,string,offset,length);case"binary":return binaryWrite(this,string,offset,length);case"base64":return base64Write(this,string,offset,length);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return ucs2Write(this,string,offset,length);default:if(loweredCase)throw new TypeError("Unknown encoding: "+encoding);encoding=(""+encoding).toLowerCase(),loweredCase=!0}},Buffer.prototype.toJSON=function(){return{type:"Buffer",data:Array.prototype.slice.call(this._arr||this,0)}};var MAX_ARGUMENTS_LENGTH=4096;Buffer.prototype.slice=function(start,end){var len=this.length;start=~~start,end=void 0===end?len:~~end,0>start?(start+=len,0>start&&(start=0)):start>len&&(start=len),0>end?(end+=len,0>end&&(end=0)):end>len&&(end=len),start>end&&(end=start);var newBuf;if(Buffer.TYPED_ARRAY_SUPPORT)newBuf=Buffer._augment(this.subarray(start,end));else{var sliceLen=end-start;newBuf=new Buffer(sliceLen,void 0);for(var i=0;sliceLen>i;i++)newBuf[i]=this[i+start]}return newBuf.length&&(newBuf.parent=this.parent||this),newBuf},Buffer.prototype.readUIntLE=function(offset,byteLength,noAssert){offset=0|offset,byteLength=0|byteLength,noAssert||checkOffset(offset,byteLength,this.length);for(var val=this[offset],mul=1,i=0;++i<byteLength&&(mul*=256);)val+=this[offset+i]*mul;return val},Buffer.prototype.readUIntBE=function(offset,byteLength,noAssert){offset=0|offset,byteLength=0|byteLength,noAssert||checkOffset(offset,byteLength,this.length);for(var val=this[offset+--byteLength],mul=1;byteLength>0&&(mul*=256);)val+=this[offset+--byteLength]*mul;return val},Buffer.prototype.readUInt8=function(offset,noAssert){return noAssert||checkOffset(offset,1,this.length),this[offset]},Buffer.prototype.readUInt16LE=function(offset,noAssert){return noAssert||checkOffset(offset,2,this.length),this[offset]|this[offset+1]<<8},Buffer.prototype.readUInt16BE=function(offset,noAssert){return noAssert||checkOffset(offset,2,this.length),this[offset]<<8|this[offset+1]},Buffer.prototype.readUInt32LE=function(offset,noAssert){return noAssert||checkOffset(offset,4,this.length),(this[offset]|this[offset+1]<<8|this[offset+2]<<16)+16777216*this[offset+3]},Buffer.prototype.readUInt32BE=function(offset,noAssert){return noAssert||checkOffset(offset,4,this.length),16777216*this[offset]+(this[offset+1]<<16|this[offset+2]<<8|this[offset+3])},Buffer.prototype.readIntLE=function(offset,byteLength,noAssert){offset=0|offset,byteLength=0|byteLength,noAssert||checkOffset(offset,byteLength,this.length);for(var val=this[offset],mul=1,i=0;++i<byteLength&&(mul*=256);)val+=this[offset+i]*mul;return mul*=128,val>=mul&&(val-=Math.pow(2,8*byteLength)),val},Buffer.prototype.readIntBE=function(offset,byteLength,noAssert){offset=0|offset,byteLength=0|byteLength,noAssert||checkOffset(offset,byteLength,this.length);for(var i=byteLength,mul=1,val=this[offset+--i];i>0&&(mul*=256);)val+=this[offset+--i]*mul;return mul*=128,val>=mul&&(val-=Math.pow(2,8*byteLength)),val},Buffer.prototype.readInt8=function(offset,noAssert){return noAssert||checkOffset(offset,1,this.length),128&this[offset]?-1*(255-this[offset]+1):this[offset]},Buffer.prototype.readInt16LE=function(offset,noAssert){noAssert||checkOffset(offset,2,this.length);var val=this[offset]|this[offset+1]<<8;return 32768&val?4294901760|val:val},Buffer.prototype.readInt16BE=function(offset,noAssert){
noAssert||checkOffset(offset,2,this.length);var val=this[offset+1]|this[offset]<<8;return 32768&val?4294901760|val:val},Buffer.prototype.readInt32LE=function(offset,noAssert){return noAssert||checkOffset(offset,4,this.length),this[offset]|this[offset+1]<<8|this[offset+2]<<16|this[offset+3]<<24},Buffer.prototype.readInt32BE=function(offset,noAssert){return noAssert||checkOffset(offset,4,this.length),this[offset]<<24|this[offset+1]<<16|this[offset+2]<<8|this[offset+3]},Buffer.prototype.readFloatLE=function(offset,noAssert){return noAssert||checkOffset(offset,4,this.length),ieee754.read(this,offset,!0,23,4)},Buffer.prototype.readFloatBE=function(offset,noAssert){return noAssert||checkOffset(offset,4,this.length),ieee754.read(this,offset,!1,23,4)},Buffer.prototype.readDoubleLE=function(offset,noAssert){return noAssert||checkOffset(offset,8,this.length),ieee754.read(this,offset,!0,52,8)},Buffer.prototype.readDoubleBE=function(offset,noAssert){return noAssert||checkOffset(offset,8,this.length),ieee754.read(this,offset,!1,52,8)},Buffer.prototype.writeUIntLE=function(value,offset,byteLength,noAssert){value=+value,offset=0|offset,byteLength=0|byteLength,noAssert||checkInt(this,value,offset,byteLength,Math.pow(2,8*byteLength),0);var mul=1,i=0;for(this[offset]=255&value;++i<byteLength&&(mul*=256);)this[offset+i]=value/mul&255;return offset+byteLength},Buffer.prototype.writeUIntBE=function(value,offset,byteLength,noAssert){value=+value,offset=0|offset,byteLength=0|byteLength,noAssert||checkInt(this,value,offset,byteLength,Math.pow(2,8*byteLength),0);var i=byteLength-1,mul=1;for(this[offset+i]=255&value;--i>=0&&(mul*=256);)this[offset+i]=value/mul&255;return offset+byteLength},Buffer.prototype.writeUInt8=function(value,offset,noAssert){return value=+value,offset=0|offset,noAssert||checkInt(this,value,offset,1,255,0),Buffer.TYPED_ARRAY_SUPPORT||(value=Math.floor(value)),this[offset]=255&value,offset+1},Buffer.prototype.writeUInt16LE=function(value,offset,noAssert){return value=+value,offset=0|offset,noAssert||checkInt(this,value,offset,2,65535,0),Buffer.TYPED_ARRAY_SUPPORT?(this[offset]=255&value,this[offset+1]=value>>>8):objectWriteUInt16(this,value,offset,!0),offset+2},Buffer.prototype.writeUInt16BE=function(value,offset,noAssert){return value=+value,offset=0|offset,noAssert||checkInt(this,value,offset,2,65535,0),Buffer.TYPED_ARRAY_SUPPORT?(this[offset]=value>>>8,this[offset+1]=255&value):objectWriteUInt16(this,value,offset,!1),offset+2},Buffer.prototype.writeUInt32LE=function(value,offset,noAssert){return value=+value,offset=0|offset,noAssert||checkInt(this,value,offset,4,4294967295,0),Buffer.TYPED_ARRAY_SUPPORT?(this[offset+3]=value>>>24,this[offset+2]=value>>>16,this[offset+1]=value>>>8,this[offset]=255&value):objectWriteUInt32(this,value,offset,!0),offset+4},Buffer.prototype.writeUInt32BE=function(value,offset,noAssert){return value=+value,offset=0|offset,noAssert||checkInt(this,value,offset,4,4294967295,0),Buffer.TYPED_ARRAY_SUPPORT?(this[offset]=value>>>24,this[offset+1]=value>>>16,this[offset+2]=value>>>8,this[offset+3]=255&value):objectWriteUInt32(this,value,offset,!1),offset+4},Buffer.prototype.writeIntLE=function(value,offset,byteLength,noAssert){if(value=+value,offset=0|offset,!noAssert){var limit=Math.pow(2,8*byteLength-1);checkInt(this,value,offset,byteLength,limit-1,-limit)}var i=0,mul=1,sub=0>value?1:0;for(this[offset]=255&value;++i<byteLength&&(mul*=256);)this[offset+i]=(value/mul>>0)-sub&255;return offset+byteLength},Buffer.prototype.writeIntBE=function(value,offset,byteLength,noAssert){if(value=+value,offset=0|offset,!noAssert){var limit=Math.pow(2,8*byteLength-1);checkInt(this,value,offset,byteLength,limit-1,-limit)}var i=byteLength-1,mul=1,sub=0>value?1:0;for(this[offset+i]=255&value;--i>=0&&(mul*=256);)this[offset+i]=(value/mul>>0)-sub&255;return offset+byteLength},Buffer.prototype.writeInt8=function(value,offset,noAssert){return value=+value,offset=0|offset,noAssert||checkInt(this,value,offset,1,127,-128),Buffer.TYPED_ARRAY_SUPPORT||(value=Math.floor(value)),0>value&&(value=255+value+1),this[offset]=255&value,offset+1},Buffer.prototype.writeInt16LE=function(value,offset,noAssert){return value=+value,offset=0|offset,noAssert||checkInt(this,value,offset,2,32767,-32768),Buffer.TYPED_ARRAY_SUPPORT?(this[offset]=255&value,this[offset+1]=value>>>8):objectWriteUInt16(this,value,offset,!0),offset+2},Buffer.prototype.writeInt16BE=function(value,offset,noAssert){return value=+value,offset=0|offset,noAssert||checkInt(this,value,offset,2,32767,-32768),Buffer.TYPED_ARRAY_SUPPORT?(this[offset]=value>>>8,this[offset+1]=255&value):objectWriteUInt16(this,value,offset,!1),offset+2},Buffer.prototype.writeInt32LE=function(value,offset,noAssert){return value=+value,offset=0|offset,noAssert||checkInt(this,value,offset,4,2147483647,-2147483648),Buffer.TYPED_ARRAY_SUPPORT?(this[offset]=255&value,this[offset+1]=value>>>8,this[offset+2]=value>>>16,this[offset+3]=value>>>24):objectWriteUInt32(this,value,offset,!0),offset+4},Buffer.prototype.writeInt32BE=function(value,offset,noAssert){return value=+value,offset=0|offset,noAssert||checkInt(this,value,offset,4,2147483647,-2147483648),0>value&&(value=4294967295+value+1),Buffer.TYPED_ARRAY_SUPPORT?(this[offset]=value>>>24,this[offset+1]=value>>>16,this[offset+2]=value>>>8,this[offset+3]=255&value):objectWriteUInt32(this,value,offset,!1),offset+4},Buffer.prototype.writeFloatLE=function(value,offset,noAssert){return writeFloat(this,value,offset,!0,noAssert)},Buffer.prototype.writeFloatBE=function(value,offset,noAssert){return writeFloat(this,value,offset,!1,noAssert)},Buffer.prototype.writeDoubleLE=function(value,offset,noAssert){return writeDouble(this,value,offset,!0,noAssert)},Buffer.prototype.writeDoubleBE=function(value,offset,noAssert){return writeDouble(this,value,offset,!1,noAssert)},Buffer.prototype.copy=function(target,targetStart,start,end){if(start||(start=0),end||0===end||(end=this.length),targetStart>=target.length&&(targetStart=target.length),targetStart||(targetStart=0),end>0&&start>end&&(end=start),end===start)return 0;if(0===target.length||0===this.length)return 0;if(0>targetStart)throw new RangeError("targetStart out of bounds");if(0>start||start>=this.length)throw new RangeError("sourceStart out of bounds");if(0>end)throw new RangeError("sourceEnd out of bounds");end>this.length&&(end=this.length),target.length-targetStart<end-start&&(end=target.length-targetStart+start);var i,len=end-start;if(this===target&&targetStart>start&&end>targetStart)for(i=len-1;i>=0;i--)target[i+targetStart]=this[i+start];else if(1e3>len||!Buffer.TYPED_ARRAY_SUPPORT)for(i=0;len>i;i++)target[i+targetStart]=this[i+start];else target._set(this.subarray(start,start+len),targetStart);return len},Buffer.prototype.fill=function(value,start,end){if(value||(value=0),start||(start=0),end||(end=this.length),start>end)throw new RangeError("end < start");if(end!==start&&0!==this.length){if(0>start||start>=this.length)throw new RangeError("start out of bounds");if(0>end||end>this.length)throw new RangeError("end out of bounds");var i;if("number"==typeof value)for(i=start;end>i;i++)this[i]=value;else{var bytes=utf8ToBytes(value.toString()),len=bytes.length;for(i=start;end>i;i++)this[i]=bytes[i%len]}return this}},Buffer.prototype.toArrayBuffer=function(){if("undefined"!=typeof Uint8Array){if(Buffer.TYPED_ARRAY_SUPPORT)return new Buffer(this).buffer;for(var buf=new Uint8Array(this.length),i=0,len=buf.length;len>i;i+=1)buf[i]=this[i];return buf.buffer}throw new TypeError("Buffer.toArrayBuffer not supported in this browser")};var BP=Buffer.prototype;Buffer._augment=function(arr){return arr.constructor=Buffer,arr._isBuffer=!0,arr._set=arr.set,arr.get=BP.get,arr.set=BP.set,arr.write=BP.write,arr.toString=BP.toString,arr.toLocaleString=BP.toString,arr.toJSON=BP.toJSON,arr.equals=BP.equals,arr.compare=BP.compare,arr.indexOf=BP.indexOf,arr.copy=BP.copy,arr.slice=BP.slice,arr.readUIntLE=BP.readUIntLE,arr.readUIntBE=BP.readUIntBE,arr.readUInt8=BP.readUInt8,arr.readUInt16LE=BP.readUInt16LE,arr.readUInt16BE=BP.readUInt16BE,arr.readUInt32LE=BP.readUInt32LE,arr.readUInt32BE=BP.readUInt32BE,arr.readIntLE=BP.readIntLE,arr.readIntBE=BP.readIntBE,arr.readInt8=BP.readInt8,arr.readInt16LE=BP.readInt16LE,arr.readInt16BE=BP.readInt16BE,arr.readInt32LE=BP.readInt32LE,arr.readInt32BE=BP.readInt32BE,arr.readFloatLE=BP.readFloatLE,arr.readFloatBE=BP.readFloatBE,arr.readDoubleLE=BP.readDoubleLE,arr.readDoubleBE=BP.readDoubleBE,arr.writeUInt8=BP.writeUInt8,arr.writeUIntLE=BP.writeUIntLE,arr.writeUIntBE=BP.writeUIntBE,arr.writeUInt16LE=BP.writeUInt16LE,arr.writeUInt16BE=BP.writeUInt16BE,arr.writeUInt32LE=BP.writeUInt32LE,arr.writeUInt32BE=BP.writeUInt32BE,arr.writeIntLE=BP.writeIntLE,arr.writeIntBE=BP.writeIntBE,arr.writeInt8=BP.writeInt8,arr.writeInt16LE=BP.writeInt16LE,arr.writeInt16BE=BP.writeInt16BE,arr.writeInt32LE=BP.writeInt32LE,arr.writeInt32BE=BP.writeInt32BE,arr.writeFloatLE=BP.writeFloatLE,arr.writeFloatBE=BP.writeFloatBE,arr.writeDoubleLE=BP.writeDoubleLE,arr.writeDoubleBE=BP.writeDoubleBE,arr.fill=BP.fill,arr.inspect=BP.inspect,arr.toArrayBuffer=BP.toArrayBuffer,arr};var INVALID_BASE64_RE=/[^+\/0-9A-Za-z-_]/g}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{"base64-js":10,ieee754:23,"is-array":24}],12:[function(require,module,exports){(function(Buffer){var clone=function(){"use strict";function clone(parent,circular,depth,prototype){function _clone(parent,depth){if(null===parent)return null;if(0==depth)return parent;var child,proto;if("object"!=typeof parent)return parent;if(clone.__isArray(parent))child=[];else if(clone.__isRegExp(parent))child=new RegExp(parent.source,__getRegExpFlags(parent)),parent.lastIndex&&(child.lastIndex=parent.lastIndex);else if(clone.__isDate(parent))child=new Date(parent.getTime());else{if(useBuffer&&Buffer.isBuffer(parent))return child=new Buffer(parent.length),parent.copy(child),child;"undefined"==typeof prototype?(proto=Object.getPrototypeOf(parent),child=Object.create(proto)):(child=Object.create(prototype),proto=prototype)}if(circular){var index=allParents.indexOf(parent);if(-1!=index)return allChildren[index];allParents.push(parent),allChildren.push(child)}for(var i in parent){var attrs;proto&&(attrs=Object.getOwnPropertyDescriptor(proto,i)),attrs&&null==attrs.set||(child[i]=_clone(parent[i],depth-1))}return child}var filter;"object"==typeof circular&&(depth=circular.depth,prototype=circular.prototype,filter=circular.filter,circular=circular.circular);var allParents=[],allChildren=[],useBuffer="undefined"!=typeof Buffer;return"undefined"==typeof circular&&(circular=!0),"undefined"==typeof depth&&(depth=1/0),_clone(parent,depth)}function __objToStr(o){return Object.prototype.toString.call(o)}function __isDate(o){return"object"==typeof o&&"[object Date]"===__objToStr(o)}function __isArray(o){return"object"==typeof o&&"[object Array]"===__objToStr(o)}function __isRegExp(o){return"object"==typeof o&&"[object RegExp]"===__objToStr(o)}function __getRegExpFlags(re){var flags="";return re.global&&(flags+="g"),re.ignoreCase&&(flags+="i"),re.multiline&&(flags+="m"),flags}return clone.clonePrototype=function(parent){if(null===parent)return null;var c=function(){};return c.prototype=parent,new c},clone.__objToStr=__objToStr,clone.__isDate=__isDate,clone.__isArray=__isArray,clone.__isRegExp=__isRegExp,clone.__getRegExpFlags=__getRegExpFlags,clone}();"object"==typeof module&&module.exports&&(module.exports=clone)}).call(this,require("buffer").Buffer)},{buffer:11}],13:[function(require,module,exports){function rgb2hsl(rgb){var h,s,l,r=rgb[0]/255,g=rgb[1]/255,b=rgb[2]/255,min=Math.min(r,g,b),max=Math.max(r,g,b),delta=max-min;return max==min?h=0:r==max?h=(g-b)/delta:g==max?h=2+(b-r)/delta:b==max&&(h=4+(r-g)/delta),h=Math.min(60*h,360),0>h&&(h+=360),l=(min+max)/2,s=max==min?0:.5>=l?delta/(max+min):delta/(2-max-min),[h,100*s,100*l]}function rgb2hsv(rgb){var h,s,v,r=rgb[0],g=rgb[1],b=rgb[2],min=Math.min(r,g,b),max=Math.max(r,g,b),delta=max-min;return s=0==max?0:delta/max*1e3/10,max==min?h=0:r==max?h=(g-b)/delta:g==max?h=2+(b-r)/delta:b==max&&(h=4+(r-g)/delta),h=Math.min(60*h,360),0>h&&(h+=360),v=max/255*1e3/10,[h,s,v]}function rgb2hwb(rgb){var r=rgb[0],g=rgb[1],b=rgb[2],h=rgb2hsl(rgb)[0],w=1/255*Math.min(r,Math.min(g,b)),b=1-1/255*Math.max(r,Math.max(g,b));return[h,100*w,100*b]}function rgb2cmyk(rgb){var c,m,y,k,r=rgb[0]/255,g=rgb[1]/255,b=rgb[2]/255;return k=Math.min(1-r,1-g,1-b),c=(1-r-k)/(1-k)||0,m=(1-g-k)/(1-k)||0,y=(1-b-k)/(1-k)||0,[100*c,100*m,100*y,100*k]}function rgb2keyword(rgb){return reverseKeywords[JSON.stringify(rgb)]}function rgb2xyz(rgb){var r=rgb[0]/255,g=rgb[1]/255,b=rgb[2]/255;r=r>.04045?Math.pow((r+.055)/1.055,2.4):r/12.92,g=g>.04045?Math.pow((g+.055)/1.055,2.4):g/12.92,b=b>.04045?Math.pow((b+.055)/1.055,2.4):b/12.92;var x=.4124*r+.3576*g+.1805*b,y=.2126*r+.7152*g+.0722*b,z=.0193*r+.1192*g+.9505*b;return[100*x,100*y,100*z]}function rgb2lab(rgb){var l,a,b,xyz=rgb2xyz(rgb),x=xyz[0],y=xyz[1],z=xyz[2];return x/=95.047,y/=100,z/=108.883,x=x>.008856?Math.pow(x,1/3):7.787*x+16/116,y=y>.008856?Math.pow(y,1/3):7.787*y+16/116,z=z>.008856?Math.pow(z,1/3):7.787*z+16/116,l=116*y-16,a=500*(x-y),b=200*(y-z),[l,a,b]}function rgb2lch(args){return lab2lch(rgb2lab(args))}function hsl2rgb(hsl){var t1,t2,t3,rgb,val,h=hsl[0]/360,s=hsl[1]/100,l=hsl[2]/100;if(0==s)return val=255*l,[val,val,val];t2=.5>l?l*(1+s):l+s-l*s,t1=2*l-t2,rgb=[0,0,0];for(var i=0;3>i;i++)t3=h+1/3*-(i-1),0>t3&&t3++,t3>1&&t3--,val=1>6*t3?t1+6*(t2-t1)*t3:1>2*t3?t2:2>3*t3?t1+(t2-t1)*(2/3-t3)*6:t1,rgb[i]=255*val;return rgb}function hsl2hsv(hsl){var sv,v,h=hsl[0],s=hsl[1]/100,l=hsl[2]/100;return 0===l?[0,0,0]:(l*=2,s*=1>=l?l:2-l,v=(l+s)/2,sv=2*s/(l+s),[h,100*sv,100*v])}function hsl2hwb(args){return rgb2hwb(hsl2rgb(args))}function hsl2cmyk(args){return rgb2cmyk(hsl2rgb(args))}function hsl2keyword(args){return rgb2keyword(hsl2rgb(args))}function hsv2rgb(hsv){var h=hsv[0]/60,s=hsv[1]/100,v=hsv[2]/100,hi=Math.floor(h)%6,f=h-Math.floor(h),p=255*v*(1-s),q=255*v*(1-s*f),t=255*v*(1-s*(1-f)),v=255*v;switch(hi){case 0:return[v,t,p];case 1:return[q,v,p];case 2:return[p,v,t];case 3:return[p,q,v];case 4:return[t,p,v];case 5:return[v,p,q]}}function hsv2hsl(hsv){var sl,l,h=hsv[0],s=hsv[1]/100,v=hsv[2]/100;return l=(2-s)*v,sl=s*v,sl/=1>=l?l:2-l,sl=sl||0,l/=2,[h,100*sl,100*l]}function hsv2hwb(args){return rgb2hwb(hsv2rgb(args))}function hsv2cmyk(args){return rgb2cmyk(hsv2rgb(args))}function hsv2keyword(args){return rgb2keyword(hsv2rgb(args))}function hwb2rgb(hwb){var i,v,f,n,h=hwb[0]/360,wh=hwb[1]/100,bl=hwb[2]/100,ratio=wh+bl;switch(ratio>1&&(wh/=ratio,bl/=ratio),i=Math.floor(6*h),v=1-bl,f=6*h-i,0!=(1&i)&&(f=1-f),n=wh+f*(v-wh),i){default:case 6:case 0:r=v,g=n,b=wh;break;case 1:r=n,g=v,b=wh;break;case 2:r=wh,g=v,b=n;break;case 3:r=wh,g=n,b=v;break;case 4:r=n,g=wh,b=v;break;case 5:r=v,g=wh,b=n}return[255*r,255*g,255*b]}function hwb2hsl(args){return rgb2hsl(hwb2rgb(args))}function hwb2hsv(args){return rgb2hsv(hwb2rgb(args))}function hwb2cmyk(args){return rgb2cmyk(hwb2rgb(args))}function hwb2keyword(args){return rgb2keyword(hwb2rgb(args))}function cmyk2rgb(cmyk){var r,g,b,c=cmyk[0]/100,m=cmyk[1]/100,y=cmyk[2]/100,k=cmyk[3]/100;return r=1-Math.min(1,c*(1-k)+k),g=1-Math.min(1,m*(1-k)+k),b=1-Math.min(1,y*(1-k)+k),[255*r,255*g,255*b]}function cmyk2hsl(args){return rgb2hsl(cmyk2rgb(args))}function cmyk2hsv(args){return rgb2hsv(cmyk2rgb(args))}function cmyk2hwb(args){return rgb2hwb(cmyk2rgb(args))}function cmyk2keyword(args){return rgb2keyword(cmyk2rgb(args))}function xyz2rgb(xyz){var r,g,b,x=xyz[0]/100,y=xyz[1]/100,z=xyz[2]/100;return r=3.2406*x+-1.5372*y+z*-.4986,g=x*-.9689+1.8758*y+.0415*z,b=.0557*x+y*-.204+1.057*z,r=r>.0031308?1.055*Math.pow(r,1/2.4)-.055:r=12.92*r,g=g>.0031308?1.055*Math.pow(g,1/2.4)-.055:g=12.92*g,b=b>.0031308?1.055*Math.pow(b,1/2.4)-.055:b=12.92*b,r=Math.min(Math.max(0,r),1),g=Math.min(Math.max(0,g),1),b=Math.min(Math.max(0,b),1),[255*r,255*g,255*b]}function xyz2lab(xyz){var l,a,b,x=xyz[0],y=xyz[1],z=xyz[2];return x/=95.047,y/=100,z/=108.883,x=x>.008856?Math.pow(x,1/3):7.787*x+16/116,y=y>.008856?Math.pow(y,1/3):7.787*y+16/116,z=z>.008856?Math.pow(z,1/3):7.787*z+16/116,l=116*y-16,a=500*(x-y),b=200*(y-z),[l,a,b]}function xyz2lch(args){return lab2lch(xyz2lab(args))}function lab2xyz(lab){var x,y,z,y2,l=lab[0],a=lab[1],b=lab[2];return 8>=l?(y=100*l/903.3,y2=7.787*(y/100)+16/116):(y=100*Math.pow((l+16)/116,3),y2=Math.pow(y/100,1/3)),x=.008856>=x/95.047?x=95.047*(a/500+y2-16/116)/7.787:95.047*Math.pow(a/500+y2,3),z=.008859>=z/108.883?z=108.883*(y2-b/200-16/116)/7.787:108.883*Math.pow(y2-b/200,3),[x,y,z]}function lab2lch(lab){var hr,h,c,l=lab[0],a=lab[1],b=lab[2];return hr=Math.atan2(b,a),h=360*hr/2/Math.PI,0>h&&(h+=360),c=Math.sqrt(a*a+b*b),[l,c,h]}function lab2rgb(args){return xyz2rgb(lab2xyz(args))}function lch2lab(lch){var a,b,hr,l=lch[0],c=lch[1],h=lch[2];return hr=h/360*2*Math.PI,a=c*Math.cos(hr),b=c*Math.sin(hr),[l,a,b]}function lch2xyz(args){return lab2xyz(lch2lab(args))}function lch2rgb(args){return lab2rgb(lch2lab(args))}function keyword2rgb(keyword){return cssKeywords[keyword]}function keyword2hsl(args){return rgb2hsl(keyword2rgb(args))}function keyword2hsv(args){return rgb2hsv(keyword2rgb(args))}function keyword2hwb(args){return rgb2hwb(keyword2rgb(args))}function keyword2cmyk(args){return rgb2cmyk(keyword2rgb(args))}function keyword2lab(args){return rgb2lab(keyword2rgb(args))}function keyword2xyz(args){return rgb2xyz(keyword2rgb(args))}module.exports={rgb2hsl:rgb2hsl,rgb2hsv:rgb2hsv,rgb2hwb:rgb2hwb,rgb2cmyk:rgb2cmyk,rgb2keyword:rgb2keyword,rgb2xyz:rgb2xyz,rgb2lab:rgb2lab,rgb2lch:rgb2lch,hsl2rgb:hsl2rgb,hsl2hsv:hsl2hsv,hsl2hwb:hsl2hwb,hsl2cmyk:hsl2cmyk,hsl2keyword:hsl2keyword,hsv2rgb:hsv2rgb,hsv2hsl:hsv2hsl,hsv2hwb:hsv2hwb,hsv2cmyk:hsv2cmyk,hsv2keyword:hsv2keyword,hwb2rgb:hwb2rgb,hwb2hsl:hwb2hsl,hwb2hsv:hwb2hsv,hwb2cmyk:hwb2cmyk,hwb2keyword:hwb2keyword,cmyk2rgb:cmyk2rgb,cmyk2hsl:cmyk2hsl,cmyk2hsv:cmyk2hsv,cmyk2hwb:cmyk2hwb,cmyk2keyword:cmyk2keyword,keyword2rgb:keyword2rgb,keyword2hsl:keyword2hsl,keyword2hsv:keyword2hsv,keyword2hwb:keyword2hwb,keyword2cmyk:keyword2cmyk,keyword2lab:keyword2lab,keyword2xyz:keyword2xyz,xyz2rgb:xyz2rgb,xyz2lab:xyz2lab,xyz2lch:xyz2lch,lab2xyz:lab2xyz,lab2rgb:lab2rgb,lab2lch:lab2lch,lch2lab:lch2lab,lch2xyz:lch2xyz,lch2rgb:lch2rgb};var cssKeywords={aliceblue:[240,248,255],antiquewhite:[250,235,215],aqua:[0,255,255],aquamarine:[127,255,212],azure:[240,255,255],beige:[245,245,220],bisque:[255,228,196],black:[0,0,0],blanchedalmond:[255,235,205],blue:[0,0,255],blueviolet:[138,43,226],brown:[165,42,42],burlywood:[222,184,135],cadetblue:[95,158,160],chartreuse:[127,255,0],chocolate:[210,105,30],coral:[255,127,80],cornflowerblue:[100,149,237],cornsilk:[255,248,220],crimson:[220,20,60],cyan:[0,255,255],darkblue:[0,0,139],darkcyan:[0,139,139],darkgoldenrod:[184,134,11],darkgray:[169,169,169],darkgreen:[0,100,0],darkgrey:[169,169,169],darkkhaki:[189,183,107],darkmagenta:[139,0,139],darkolivegreen:[85,107,47],darkorange:[255,140,0],darkorchid:[153,50,204],darkred:[139,0,0],darksalmon:[233,150,122],darkseagreen:[143,188,143],darkslateblue:[72,61,139],darkslategray:[47,79,79],darkslategrey:[47,79,79],darkturquoise:[0,206,209],darkviolet:[148,0,211],deeppink:[255,20,147],deepskyblue:[0,191,255],dimgray:[105,105,105],dimgrey:[105,105,105],dodgerblue:[30,144,255],firebrick:[178,34,34],floralwhite:[255,250,240],forestgreen:[34,139,34],fuchsia:[255,0,255],gainsboro:[220,220,220],ghostwhite:[248,248,255],gold:[255,215,0],goldenrod:[218,165,32],gray:[128,128,128],green:[0,128,0],greenyellow:[173,255,47],grey:[128,128,128],honeydew:[240,255,240],hotpink:[255,105,180],indianred:[205,92,92],indigo:[75,0,130],ivory:[255,255,240],khaki:[240,230,140],lavender:[230,230,250],lavenderblush:[255,240,245],lawngreen:[124,252,0],lemonchiffon:[255,250,205],lightblue:[173,216,230],lightcoral:[240,128,128],lightcyan:[224,255,255],lightgoldenrodyellow:[250,250,210],lightgray:[211,211,211],lightgreen:[144,238,144],lightgrey:[211,211,211],lightpink:[255,182,193],lightsalmon:[255,160,122],lightseagreen:[32,178,170],lightskyblue:[135,206,250],lightslategray:[119,136,153],lightslategrey:[119,136,153],lightsteelblue:[176,196,222],lightyellow:[255,255,224],lime:[0,255,0],limegreen:[50,205,50],linen:[250,240,230],magenta:[255,0,255],maroon:[128,0,0],mediumaquamarine:[102,205,170],mediumblue:[0,0,205],mediumorchid:[186,85,211],mediumpurple:[147,112,219],mediumseagreen:[60,179,113],mediumslateblue:[123,104,238],mediumspringgreen:[0,250,154],mediumturquoise:[72,209,204],mediumvioletred:[199,21,133],midnightblue:[25,25,112],mintcream:[245,255,250],mistyrose:[255,228,225],moccasin:[255,228,181],navajowhite:[255,222,173],navy:[0,0,128],oldlace:[253,245,230],olive:[128,128,0],olivedrab:[107,142,35],orange:[255,165,0],orangered:[255,69,0],orchid:[218,112,214],palegoldenrod:[238,232,170],palegreen:[152,251,152],paleturquoise:[175,238,238],palevioletred:[219,112,147],papayawhip:[255,239,213],peachpuff:[255,218,185],peru:[205,133,63],pink:[255,192,203],plum:[221,160,221],powderblue:[176,224,230],purple:[128,0,128],rebeccapurple:[102,51,153],red:[255,0,0],rosybrown:[188,143,143],royalblue:[65,105,225],saddlebrown:[139,69,19],salmon:[250,128,114],sandybrown:[244,164,96],seagreen:[46,139,87],seashell:[255,245,238],sienna:[160,82,45],silver:[192,192,192],skyblue:[135,206,235],slateblue:[106,90,205],slategray:[112,128,144],slategrey:[112,128,144],snow:[255,250,250],springgreen:[0,255,127],steelblue:[70,130,180],tan:[210,180,140],teal:[0,128,128],thistle:[216,191,216],tomato:[255,99,71],turquoise:[64,224,208],violet:[238,130,238],wheat:[245,222,179],white:[255,255,255],whitesmoke:[245,245,245],yellow:[255,255,0],yellowgreen:[154,205,50]},reverseKeywords={};for(var key in cssKeywords)reverseKeywords[JSON.stringify(cssKeywords[key])]=key},{}],14:[function(require,module,exports){var conversions=require("./conversions"),convert=function(){return new Converter};for(var func in conversions){convert[func+"Raw"]=function(func){return function(arg){return"number"==typeof arg&&(arg=Array.prototype.slice.call(arguments)),conversions[func](arg)}}(func);var pair=/(\w+)2(\w+)/.exec(func),from=pair[1],to=pair[2];convert[from]=convert[from]||{},convert[from][to]=convert[func]=function(func){return function(arg){"number"==typeof arg&&(arg=Array.prototype.slice.call(arguments));var val=conversions[func](arg);if("string"==typeof val||void 0===val)return val;for(var i=0;i<val.length;i++)val[i]=Math.round(val[i]);return val}}(func)}var Converter=function(){this.convs={}};Converter.prototype.routeSpace=function(space,args){var values=args[0];return void 0===values?this.getValues(space):("number"==typeof values&&(values=Array.prototype.slice.call(args)),this.setValues(space,values))},Converter.prototype.setValues=function(space,values){return this.space=space,this.convs={},this.convs[space]=values,this},Converter.prototype.getValues=function(space){var vals=this.convs[space];if(!vals){var fspace=this.space,from=this.convs[fspace];vals=convert[fspace][space](from),this.convs[space]=vals}return vals},["rgb","hsl","hsv","cmyk","keyword"].forEach(function(space){Converter.prototype[space]=function(vals){return this.routeSpace(space,arguments)}}),module.exports=convert},{"./conversions":13}],15:[function(require,module,exports){module.exports={aliceblue:[240,248,255],antiquewhite:[250,235,215],aqua:[0,255,255],aquamarine:[127,255,212],azure:[240,255,255],beige:[245,245,220],bisque:[255,228,196],black:[0,0,0],blanchedalmond:[255,235,205],blue:[0,0,255],blueviolet:[138,43,226],brown:[165,42,42],burlywood:[222,184,135],cadetblue:[95,158,160],chartreuse:[127,255,0],chocolate:[210,105,30],coral:[255,127,80],cornflowerblue:[100,149,237],cornsilk:[255,248,220],crimson:[220,20,60],cyan:[0,255,255],darkblue:[0,0,139],darkcyan:[0,139,139],darkgoldenrod:[184,134,11],darkgray:[169,169,169],darkgreen:[0,100,0],darkgrey:[169,169,169],darkkhaki:[189,183,107],darkmagenta:[139,0,139],darkolivegreen:[85,107,47],darkorange:[255,140,0],darkorchid:[153,50,204],darkred:[139,0,0],darksalmon:[233,150,122],darkseagreen:[143,188,143],darkslateblue:[72,61,139],darkslategray:[47,79,79],darkslategrey:[47,79,79],darkturquoise:[0,206,209],darkviolet:[148,0,211],deeppink:[255,20,147],deepskyblue:[0,191,255],dimgray:[105,105,105],dimgrey:[105,105,105],dodgerblue:[30,144,255],firebrick:[178,34,34],floralwhite:[255,250,240],forestgreen:[34,139,34],fuchsia:[255,0,255],gainsboro:[220,220,220],ghostwhite:[248,248,255],gold:[255,215,0],goldenrod:[218,165,32],gray:[128,128,128],green:[0,128,0],greenyellow:[173,255,47],grey:[128,128,128],honeydew:[240,255,240],hotpink:[255,105,180],indianred:[205,92,92],indigo:[75,0,130],ivory:[255,255,240],khaki:[240,230,140],lavender:[230,230,250],lavenderblush:[255,240,245],lawngreen:[124,252,0],lemonchiffon:[255,250,205],lightblue:[173,216,230],lightcoral:[240,128,128],lightcyan:[224,255,255],lightgoldenrodyellow:[250,250,210],lightgray:[211,211,211],lightgreen:[144,238,144],lightgrey:[211,211,211],lightpink:[255,182,193],lightsalmon:[255,160,122],lightseagreen:[32,178,170],lightskyblue:[135,206,250],lightslategray:[119,136,153],lightslategrey:[119,136,153],lightsteelblue:[176,196,222],lightyellow:[255,255,224],lime:[0,255,0],limegreen:[50,205,50],linen:[250,240,230],magenta:[255,0,255],maroon:[128,0,0],mediumaquamarine:[102,205,170],mediumblue:[0,0,205],mediumorchid:[186,85,211],mediumpurple:[147,112,219],mediumseagreen:[60,179,113],mediumslateblue:[123,104,238],mediumspringgreen:[0,250,154],mediumturquoise:[72,209,204],mediumvioletred:[199,21,133],midnightblue:[25,25,112],mintcream:[245,255,250],mistyrose:[255,228,225],moccasin:[255,228,181],navajowhite:[255,222,173],navy:[0,0,128],oldlace:[253,245,230],olive:[128,128,0],olivedrab:[107,142,35],orange:[255,165,0],orangered:[255,69,0],orchid:[218,112,214],palegoldenrod:[238,232,170],palegreen:[152,251,152],paleturquoise:[175,238,238],palevioletred:[219,112,147],papayawhip:[255,239,213],peachpuff:[255,218,185],peru:[205,133,63],pink:[255,192,203],plum:[221,160,221],powderblue:[176,224,230],purple:[128,0,128],rebeccapurple:[102,51,153],red:[255,0,0],rosybrown:[188,143,143],royalblue:[65,105,225],saddlebrown:[139,69,19],salmon:[250,128,114],sandybrown:[244,164,96],seagreen:[46,139,87],seashell:[255,245,238],sienna:[160,82,45],silver:[192,192,192],skyblue:[135,206,235],slateblue:[106,90,205],slategray:[112,128,144],slategrey:[112,128,144],snow:[255,250,250],springgreen:[0,255,127],steelblue:[70,130,180],tan:[210,180,140],teal:[0,128,128],thistle:[216,191,216],tomato:[255,99,71],turquoise:[64,224,208],violet:[238,130,238],wheat:[245,222,179],white:[255,255,255],whitesmoke:[245,245,245],yellow:[255,255,0],yellowgreen:[154,205,50]}},{}],16:[function(require,module,exports){function getRgba(string){if(string){var abbr=/^#([a-fA-F0-9]{3})$/,hex=/^#([a-fA-F0-9]{6})$/,rgba=/^rgba?\(\s*([+-]?\d+)\s*,\s*([+-]?\d+)\s*,\s*([+-]?\d+)\s*(?:,\s*([+-]?[\d\.]+)\s*)?\)$/,per=/^rgba?\(\s*([+-]?[\d\.]+)\%\s*,\s*([+-]?[\d\.]+)\%\s*,\s*([+-]?[\d\.]+)\%\s*(?:,\s*([+-]?[\d\.]+)\s*)?\)$/,keyword=/(\D+)/,rgb=[0,0,0],a=1,match=string.match(abbr);if(match){match=match[1];for(var i=0;i<rgb.length;i++)rgb[i]=parseInt(match[i]+match[i],16)}else if(match=string.match(hex)){match=match[1];for(var i=0;i<rgb.length;i++)rgb[i]=parseInt(match.slice(2*i,2*i+2),16)}else if(match=string.match(rgba)){for(var i=0;i<rgb.length;i++)rgb[i]=parseInt(match[i+1]);a=parseFloat(match[4])}else if(match=string.match(per)){for(var i=0;i<rgb.length;i++)rgb[i]=Math.round(2.55*parseFloat(match[i+1]));a=parseFloat(match[4])}else if(match=string.match(keyword)){if("transparent"==match[1])return[0,0,0,0];if(rgb=colorNames[match[1]],!rgb)return}for(var i=0;i<rgb.length;i++)rgb[i]=scale(rgb[i],0,255);return a=a||0==a?scale(a,0,1):1,rgb[3]=a,rgb}}function getHsla(string){if(string){var hsl=/^hsla?\(\s*([+-]?\d+)(?:deg)?\s*,\s*([+-]?[\d\.]+)%\s*,\s*([+-]?[\d\.]+)%\s*(?:,\s*([+-]?[\d\.]+)\s*)?\)/,match=string.match(hsl);if(match){var alpha=parseFloat(match[4]),h=scale(parseInt(match[1]),0,360),s=scale(parseFloat(match[2]),0,100),l=scale(parseFloat(match[3]),0,100),a=scale(isNaN(alpha)?1:alpha,0,1);return[h,s,l,a]}}}function getHwb(string){if(string){var hwb=/^hwb\(\s*([+-]?\d+)(?:deg)?\s*,\s*([+-]?[\d\.]+)%\s*,\s*([+-]?[\d\.]+)%\s*(?:,\s*([+-]?[\d\.]+)\s*)?\)/,match=string.match(hwb);if(match){var alpha=parseFloat(match[4]),h=scale(parseInt(match[1]),0,360),w=scale(parseFloat(match[2]),0,100),b=scale(parseFloat(match[3]),0,100),a=scale(isNaN(alpha)?1:alpha,0,1);return[h,w,b,a]}}}function getRgb(string){var rgba=getRgba(string);return rgba&&rgba.slice(0,3)}function getHsl(string){var hsla=getHsla(string);return hsla&&hsla.slice(0,3)}function getAlpha(string){var vals=getRgba(string);return vals?vals[3]:(vals=getHsla(string))?vals[3]:(vals=getHwb(string))?vals[3]:void 0}function hexString(rgb){return"#"+hexDouble(rgb[0])+hexDouble(rgb[1])+hexDouble(rgb[2])}function rgbString(rgba,alpha){return 1>alpha||rgba[3]&&rgba[3]<1?rgbaString(rgba,alpha):"rgb("+rgba[0]+", "+rgba[1]+", "+rgba[2]+")"}function rgbaString(rgba,alpha){return void 0===alpha&&(alpha=void 0!==rgba[3]?rgba[3]:1),"rgba("+rgba[0]+", "+rgba[1]+", "+rgba[2]+", "+alpha+")"}function percentString(rgba,alpha){if(1>alpha||rgba[3]&&rgba[3]<1)return percentaString(rgba,alpha);var r=Math.round(rgba[0]/255*100),g=Math.round(rgba[1]/255*100),b=Math.round(rgba[2]/255*100);return"rgb("+r+"%, "+g+"%, "+b+"%)"}function percentaString(rgba,alpha){var r=Math.round(rgba[0]/255*100),g=Math.round(rgba[1]/255*100),b=Math.round(rgba[2]/255*100);return"rgba("+r+"%, "+g+"%, "+b+"%, "+(alpha||rgba[3]||1)+")"}function hslString(hsla,alpha){return 1>alpha||hsla[3]&&hsla[3]<1?hslaString(hsla,alpha):"hsl("+hsla[0]+", "+hsla[1]+"%, "+hsla[2]+"%)"}function hslaString(hsla,alpha){return void 0===alpha&&(alpha=void 0!==hsla[3]?hsla[3]:1),"hsla("+hsla[0]+", "+hsla[1]+"%, "+hsla[2]+"%, "+alpha+")"}function hwbString(hwb,alpha){return void 0===alpha&&(alpha=void 0!==hwb[3]?hwb[3]:1),"hwb("+hwb[0]+", "+hwb[1]+"%, "+hwb[2]+"%"+(void 0!==alpha&&1!==alpha?", "+alpha:"")+")"}function keyword(rgb){return reverseNames[rgb.slice(0,3)]}function scale(num,min,max){return Math.min(Math.max(min,num),max)}function hexDouble(num){var str=num.toString(16).toUpperCase();return str.length<2?"0"+str:str}var colorNames=require("color-name");module.exports={getRgba:getRgba,getHsla:getHsla,getRgb:getRgb,getHsl:getHsl,getHwb:getHwb,getAlpha:getAlpha,hexString:hexString,rgbString:rgbString,rgbaString:rgbaString,percentString:percentString,percentaString:percentaString,hslString:hslString,hslaString:hslaString,hwbString:hwbString,keyword:keyword};var reverseNames={};for(var name in colorNames)reverseNames[colorNames[name]]=name},{"color-name":15}],17:[function(require,module,exports){var convert=require("color-convert"),string=require("color-string"),Color=function(obj){if(obj instanceof Color)return obj;if(!(this instanceof Color))return new Color(obj);if(this.values={rgb:[0,0,0],hsl:[0,0,0],hsv:[0,0,0],hwb:[0,0,0],cmyk:[0,0,0,0],alpha:1},"string"==typeof obj){var vals=string.getRgba(obj);if(vals)this.setValues("rgb",vals);else if(vals=string.getHsla(obj))this.setValues("hsl",vals);else{if(!(vals=string.getHwb(obj)))throw new Error('Unable to parse color from string "'+obj+'"');this.setValues("hwb",vals)}}else if("object"==typeof obj){var vals=obj;if(void 0!==vals.r||void 0!==vals.red)this.setValues("rgb",vals);else if(void 0!==vals.l||void 0!==vals.lightness)this.setValues("hsl",vals);else if(void 0!==vals.v||void 0!==vals.value)this.setValues("hsv",vals);else if(void 0!==vals.w||void 0!==vals.whiteness)this.setValues("hwb",vals);else{if(void 0===vals.c&&void 0===vals.cyan)throw new Error("Unable to parse color from object "+JSON.stringify(obj));this.setValues("cmyk",vals)}}};Color.prototype={rgb:function(vals){return this.setSpace("rgb",arguments)},hsl:function(vals){return this.setSpace("hsl",arguments)},hsv:function(vals){
return this.setSpace("hsv",arguments)},hwb:function(vals){return this.setSpace("hwb",arguments)},cmyk:function(vals){return this.setSpace("cmyk",arguments)},rgbArray:function(){return this.values.rgb},hslArray:function(){return this.values.hsl},hsvArray:function(){return this.values.hsv},hwbArray:function(){return 1!==this.values.alpha?this.values.hwb.concat([this.values.alpha]):this.values.hwb},cmykArray:function(){return this.values.cmyk},rgbaArray:function(){var rgb=this.values.rgb;return rgb.concat([this.values.alpha])},hslaArray:function(){var hsl=this.values.hsl;return hsl.concat([this.values.alpha])},alpha:function(val){return void 0===val?this.values.alpha:(this.setValues("alpha",val),this)},red:function(val){return this.setChannel("rgb",0,val)},green:function(val){return this.setChannel("rgb",1,val)},blue:function(val){return this.setChannel("rgb",2,val)},hue:function(val){return this.setChannel("hsl",0,val)},saturation:function(val){return this.setChannel("hsl",1,val)},lightness:function(val){return this.setChannel("hsl",2,val)},saturationv:function(val){return this.setChannel("hsv",1,val)},whiteness:function(val){return this.setChannel("hwb",1,val)},blackness:function(val){return this.setChannel("hwb",2,val)},value:function(val){return this.setChannel("hsv",2,val)},cyan:function(val){return this.setChannel("cmyk",0,val)},magenta:function(val){return this.setChannel("cmyk",1,val)},yellow:function(val){return this.setChannel("cmyk",2,val)},black:function(val){return this.setChannel("cmyk",3,val)},hexString:function(){return string.hexString(this.values.rgb)},rgbString:function(){return string.rgbString(this.values.rgb,this.values.alpha)},rgbaString:function(){return string.rgbaString(this.values.rgb,this.values.alpha)},percentString:function(){return string.percentString(this.values.rgb,this.values.alpha)},hslString:function(){return string.hslString(this.values.hsl,this.values.alpha)},hslaString:function(){return string.hslaString(this.values.hsl,this.values.alpha)},hwbString:function(){return string.hwbString(this.values.hwb,this.values.alpha)},keyword:function(){return string.keyword(this.values.rgb,this.values.alpha)},rgbNumber:function(){return this.values.rgb[0]<<16|this.values.rgb[1]<<8|this.values.rgb[2]},luminosity:function(){for(var rgb=this.values.rgb,lum=[],i=0;i<rgb.length;i++){var chan=rgb[i]/255;lum[i]=.03928>=chan?chan/12.92:Math.pow((chan+.055)/1.055,2.4)}return.2126*lum[0]+.7152*lum[1]+.0722*lum[2]},contrast:function(color2){var lum1=this.luminosity(),lum2=color2.luminosity();return lum1>lum2?(lum1+.05)/(lum2+.05):(lum2+.05)/(lum1+.05)},level:function(color2){var contrastRatio=this.contrast(color2);return contrastRatio>=7.1?"AAA":contrastRatio>=4.5?"AA":""},dark:function(){var rgb=this.values.rgb,yiq=(299*rgb[0]+587*rgb[1]+114*rgb[2])/1e3;return 128>yiq},light:function(){return!this.dark()},negate:function(){for(var rgb=[],i=0;3>i;i++)rgb[i]=255-this.values.rgb[i];return this.setValues("rgb",rgb),this},lighten:function(ratio){return this.values.hsl[2]+=this.values.hsl[2]*ratio,this.setValues("hsl",this.values.hsl),this},darken:function(ratio){return this.values.hsl[2]-=this.values.hsl[2]*ratio,this.setValues("hsl",this.values.hsl),this},saturate:function(ratio){return this.values.hsl[1]+=this.values.hsl[1]*ratio,this.setValues("hsl",this.values.hsl),this},desaturate:function(ratio){return this.values.hsl[1]-=this.values.hsl[1]*ratio,this.setValues("hsl",this.values.hsl),this},whiten:function(ratio){return this.values.hwb[1]+=this.values.hwb[1]*ratio,this.setValues("hwb",this.values.hwb),this},blacken:function(ratio){return this.values.hwb[2]+=this.values.hwb[2]*ratio,this.setValues("hwb",this.values.hwb),this},greyscale:function(){var rgb=this.values.rgb,val=.3*rgb[0]+.59*rgb[1]+.11*rgb[2];return this.setValues("rgb",[val,val,val]),this},clearer:function(ratio){return this.setValues("alpha",this.values.alpha-this.values.alpha*ratio),this},opaquer:function(ratio){return this.setValues("alpha",this.values.alpha+this.values.alpha*ratio),this},rotate:function(degrees){var hue=this.values.hsl[0];return hue=(hue+degrees)%360,hue=0>hue?360+hue:hue,this.values.hsl[0]=hue,this.setValues("hsl",this.values.hsl),this},mix:function(mixinColor,weight){var color1=this,color2=mixinColor,p=void 0!==weight?weight:.5,w=2*p-1,a=color1.alpha()-color2.alpha(),w1=((w*a==-1?w:(w+a)/(1+w*a))+1)/2,w2=1-w1;return this.rgb(w1*color1.red()+w2*color2.red(),w1*color1.green()+w2*color2.green(),w1*color1.blue()+w2*color2.blue()).alpha(color1.alpha()*p+color2.alpha()*(1-p))},toJSON:function(){return this.rgb()},clone:function(){return new Color(this.rgb())}},Color.prototype.getValues=function(space){for(var vals={},i=0;i<space.length;i++)vals[space.charAt(i)]=this.values[space][i];return 1!=this.values.alpha&&(vals.a=this.values.alpha),vals},Color.prototype.setValues=function(space,vals){var spaces={rgb:["red","green","blue"],hsl:["hue","saturation","lightness"],hsv:["hue","saturation","value"],hwb:["hue","whiteness","blackness"],cmyk:["cyan","magenta","yellow","black"]},maxes={rgb:[255,255,255],hsl:[360,100,100],hsv:[360,100,100],hwb:[360,100,100],cmyk:[100,100,100,100]},alpha=1;if("alpha"==space)alpha=vals;else if(vals.length)this.values[space]=vals.slice(0,space.length),alpha=vals[space.length];else if(void 0!==vals[space.charAt(0)]){for(var i=0;i<space.length;i++)this.values[space][i]=vals[space.charAt(i)];alpha=vals.a}else if(void 0!==vals[spaces[space][0]]){for(var chans=spaces[space],i=0;i<space.length;i++)this.values[space][i]=vals[chans[i]];alpha=vals.alpha}if(this.values.alpha=Math.max(0,Math.min(1,void 0!==alpha?alpha:this.values.alpha)),"alpha"!=space){for(var i=0;i<space.length;i++){var capped=Math.max(0,Math.min(maxes[space][i],this.values[space][i]));this.values[space][i]=Math.round(capped)}for(var sname in spaces){sname!=space&&(this.values[sname]=convert[space][sname](this.values[space]));for(var i=0;i<sname.length;i++){var capped=Math.max(0,Math.min(maxes[sname][i],this.values[sname][i]));this.values[sname][i]=Math.round(capped)}}return!0}},Color.prototype.setSpace=function(space,args){var vals=args[0];return void 0===vals?this.getValues(space):("number"==typeof vals&&(vals=Array.prototype.slice.call(args)),this.setValues(space,vals),this)},Color.prototype.setChannel=function(space,index,val){return void 0===val?this.values[space][index]:(this.values[space][index]=val,this.setValues(space,this.values[space]),this)},module.exports=Color},{"color-convert":14,"color-string":16}],18:[function(require,module,exports){module.exports=require("./vendor/dat.gui"),module.exports.color=require("./vendor/dat.color")},{"./vendor/dat.color":19,"./vendor/dat.gui":20}],19:[function(require,module,exports){var dat=module.exports=dat||{};dat.color=dat.color||{},dat.utils=dat.utils||{},dat.utils.common=function(){var ARR_EACH=Array.prototype.forEach,ARR_SLICE=Array.prototype.slice;return{BREAK:{},extend:function(target){return this.each(ARR_SLICE.call(arguments,1),function(obj){for(var key in obj)this.isUndefined(obj[key])||(target[key]=obj[key])},this),target},defaults:function(target){return this.each(ARR_SLICE.call(arguments,1),function(obj){for(var key in obj)this.isUndefined(target[key])&&(target[key]=obj[key])},this),target},compose:function(){var toCall=ARR_SLICE.call(arguments);return function(){for(var args=ARR_SLICE.call(arguments),i=toCall.length-1;i>=0;i--)args=[toCall[i].apply(this,args)];return args[0]}},each:function(obj,itr,scope){if(ARR_EACH&&obj.forEach===ARR_EACH)obj.forEach(itr,scope);else if(obj.length===obj.length+0){for(var key=0,l=obj.length;l>key;key++)if(key in obj&&itr.call(scope,obj[key],key)===this.BREAK)return}else for(var key in obj)if(itr.call(scope,obj[key],key)===this.BREAK)return},defer:function(fnc){setTimeout(fnc,0)},toArray:function(obj){return obj.toArray?obj.toArray():ARR_SLICE.call(obj)},isUndefined:function(obj){return void 0===obj},isNull:function(obj){return null===obj},isNaN:function(obj){return obj!==obj},isArray:Array.isArray||function(obj){return obj.constructor===Array},isObject:function(obj){return obj===Object(obj)},isNumber:function(obj){return obj===obj+0},isString:function(obj){return obj===obj+""},isBoolean:function(obj){return obj===!1||obj===!0},isFunction:function(obj){return"[object Function]"===Object.prototype.toString.call(obj)}}}(),dat.color.toString=function(common){return function(color){if(1==color.a||common.isUndefined(color.a)){for(var s=color.hex.toString(16);s.length<6;)s="0"+s;return"#"+s}return"rgba("+Math.round(color.r)+","+Math.round(color.g)+","+Math.round(color.b)+","+color.a+")"}}(dat.utils.common),dat.Color=dat.color.Color=function(interpret,math,toString,common){function defineRGBComponent(target,component,componentHexIndex){Object.defineProperty(target,component,{get:function(){return"RGB"===this.__state.space?this.__state[component]:(recalculateRGB(this,component,componentHexIndex),this.__state[component])},set:function(v){"RGB"!==this.__state.space&&(recalculateRGB(this,component,componentHexIndex),this.__state.space="RGB"),this.__state[component]=v}})}function defineHSVComponent(target,component){Object.defineProperty(target,component,{get:function(){return"HSV"===this.__state.space?this.__state[component]:(recalculateHSV(this),this.__state[component])},set:function(v){"HSV"!==this.__state.space&&(recalculateHSV(this),this.__state.space="HSV"),this.__state[component]=v}})}function recalculateRGB(color,component,componentHexIndex){if("HEX"===color.__state.space)color.__state[component]=math.component_from_hex(color.__state.hex,componentHexIndex);else{if("HSV"!==color.__state.space)throw"Corrupted color state";common.extend(color.__state,math.hsv_to_rgb(color.__state.h,color.__state.s,color.__state.v))}}function recalculateHSV(color){var result=math.rgb_to_hsv(color.r,color.g,color.b);common.extend(color.__state,{s:result.s,v:result.v}),common.isNaN(result.h)?common.isUndefined(color.__state.h)&&(color.__state.h=0):color.__state.h=result.h}var Color=function(){if(this.__state=interpret.apply(this,arguments),this.__state===!1)throw"Failed to interpret color arguments";this.__state.a=this.__state.a||1};return Color.COMPONENTS=["r","g","b","h","s","v","hex","a"],common.extend(Color.prototype,{toString:function(){return toString(this)},toOriginal:function(){return this.__state.conversion.write(this)}}),defineRGBComponent(Color.prototype,"r",2),defineRGBComponent(Color.prototype,"g",1),defineRGBComponent(Color.prototype,"b",0),defineHSVComponent(Color.prototype,"h"),defineHSVComponent(Color.prototype,"s"),defineHSVComponent(Color.prototype,"v"),Object.defineProperty(Color.prototype,"a",{get:function(){return this.__state.a},set:function(v){this.__state.a=v}}),Object.defineProperty(Color.prototype,"hex",{get:function(){return"HEX"!==!this.__state.space&&(this.__state.hex=math.rgb_to_hex(this.r,this.g,this.b)),this.__state.hex},set:function(v){this.__state.space="HEX",this.__state.hex=v}}),Color}(dat.color.interpret=function(toString,common){var result,toReturn,interpret=function(){toReturn=!1;var original=arguments.length>1?common.toArray(arguments):arguments[0];return common.each(INTERPRETATIONS,function(family){return family.litmus(original)?(common.each(family.conversions,function(conversion,conversionName){return result=conversion.read(original),toReturn===!1&&result!==!1?(toReturn=result,result.conversionName=conversionName,result.conversion=conversion,common.BREAK):void 0}),common.BREAK):void 0}),toReturn},INTERPRETATIONS=[{litmus:common.isString,conversions:{THREE_CHAR_HEX:{read:function(original){var test=original.match(/^#([A-F0-9])([A-F0-9])([A-F0-9])$/i);return null===test?!1:{space:"HEX",hex:parseInt("0x"+test[1].toString()+test[1].toString()+test[2].toString()+test[2].toString()+test[3].toString()+test[3].toString())}},write:toString},SIX_CHAR_HEX:{read:function(original){var test=original.match(/^#([A-F0-9]{6})$/i);return null===test?!1:{space:"HEX",hex:parseInt("0x"+test[1].toString())}},write:toString},CSS_RGB:{read:function(original){var test=original.match(/^rgb\(\s*(.+)\s*,\s*(.+)\s*,\s*(.+)\s*\)/);return null===test?!1:{space:"RGB",r:parseFloat(test[1]),g:parseFloat(test[2]),b:parseFloat(test[3])}},write:toString},CSS_RGBA:{read:function(original){var test=original.match(/^rgba\(\s*(.+)\s*,\s*(.+)\s*,\s*(.+)\s*\,\s*(.+)\s*\)/);return null===test?!1:{space:"RGB",r:parseFloat(test[1]),g:parseFloat(test[2]),b:parseFloat(test[3]),a:parseFloat(test[4])}},write:toString}}},{litmus:common.isNumber,conversions:{HEX:{read:function(original){return{space:"HEX",hex:original,conversionName:"HEX"}},write:function(color){return color.hex}}}},{litmus:common.isArray,conversions:{RGB_ARRAY:{read:function(original){return 3!=original.length?!1:{space:"RGB",r:original[0],g:original[1],b:original[2]}},write:function(color){return[color.r,color.g,color.b]}},RGBA_ARRAY:{read:function(original){return 4!=original.length?!1:{space:"RGB",r:original[0],g:original[1],b:original[2],a:original[3]}},write:function(color){return[color.r,color.g,color.b,color.a]}}}},{litmus:common.isObject,conversions:{RGBA_OBJ:{read:function(original){return common.isNumber(original.r)&&common.isNumber(original.g)&&common.isNumber(original.b)&&common.isNumber(original.a)?{space:"RGB",r:original.r,g:original.g,b:original.b,a:original.a}:!1},write:function(color){return{r:color.r,g:color.g,b:color.b,a:color.a}}},RGB_OBJ:{read:function(original){return common.isNumber(original.r)&&common.isNumber(original.g)&&common.isNumber(original.b)?{space:"RGB",r:original.r,g:original.g,b:original.b}:!1},write:function(color){return{r:color.r,g:color.g,b:color.b}}},HSVA_OBJ:{read:function(original){return common.isNumber(original.h)&&common.isNumber(original.s)&&common.isNumber(original.v)&&common.isNumber(original.a)?{space:"HSV",h:original.h,s:original.s,v:original.v,a:original.a}:!1},write:function(color){return{h:color.h,s:color.s,v:color.v,a:color.a}}},HSV_OBJ:{read:function(original){return common.isNumber(original.h)&&common.isNumber(original.s)&&common.isNumber(original.v)?{space:"HSV",h:original.h,s:original.s,v:original.v}:!1},write:function(color){return{h:color.h,s:color.s,v:color.v}}}}}];return interpret}(dat.color.toString,dat.utils.common),dat.color.math=function(){var tmpComponent;return{hsv_to_rgb:function(h,s,v){var hi=Math.floor(h/60)%6,f=h/60-Math.floor(h/60),p=v*(1-s),q=v*(1-f*s),t=v*(1-(1-f)*s),c=[[v,t,p],[q,v,p],[p,v,t],[p,q,v],[t,p,v],[v,p,q]][hi];return{r:255*c[0],g:255*c[1],b:255*c[2]}},rgb_to_hsv:function(r,g,b){var h,s,min=Math.min(r,g,b),max=Math.max(r,g,b),delta=max-min;return 0==max?{h:NaN,s:0,v:0}:(s=delta/max,h=r==max?(g-b)/delta:g==max?2+(b-r)/delta:4+(r-g)/delta,h/=6,0>h&&(h+=1),{h:360*h,s:s,v:max/255})},rgb_to_hex:function(r,g,b){var hex=this.hex_with_component(0,2,r);return hex=this.hex_with_component(hex,1,g),hex=this.hex_with_component(hex,0,b)},component_from_hex:function(hex,componentIndex){return hex>>8*componentIndex&255},hex_with_component:function(hex,componentIndex,value){return value<<(tmpComponent=8*componentIndex)|hex&~(255<<tmpComponent)}}}(),dat.color.toString,dat.utils.common)},{}],20:[function(require,module,exports){var dat=module.exports=dat||{};dat.gui=dat.gui||{},dat.utils=dat.utils||{},dat.controllers=dat.controllers||{},dat.dom=dat.dom||{},dat.color=dat.color||{},dat.utils.css=function(){return{load:function(url,doc){doc=doc||document;var link=doc.createElement("link");link.type="text/css",link.rel="stylesheet",link.href=url,doc.getElementsByTagName("head")[0].appendChild(link)},inject:function(css,doc){doc=doc||document;var injected=document.createElement("style");injected.type="text/css",injected.innerHTML=css,doc.getElementsByTagName("head")[0].appendChild(injected)}}}(),dat.utils.common=function(){var ARR_EACH=Array.prototype.forEach,ARR_SLICE=Array.prototype.slice;return{BREAK:{},extend:function(target){return this.each(ARR_SLICE.call(arguments,1),function(obj){for(var key in obj)this.isUndefined(obj[key])||(target[key]=obj[key])},this),target},defaults:function(target){return this.each(ARR_SLICE.call(arguments,1),function(obj){for(var key in obj)this.isUndefined(target[key])&&(target[key]=obj[key])},this),target},compose:function(){var toCall=ARR_SLICE.call(arguments);return function(){for(var args=ARR_SLICE.call(arguments),i=toCall.length-1;i>=0;i--)args=[toCall[i].apply(this,args)];return args[0]}},each:function(obj,itr,scope){if(ARR_EACH&&obj.forEach===ARR_EACH)obj.forEach(itr,scope);else if(obj.length===obj.length+0){for(var key=0,l=obj.length;l>key;key++)if(key in obj&&itr.call(scope,obj[key],key)===this.BREAK)return}else for(var key in obj)if(itr.call(scope,obj[key],key)===this.BREAK)return},defer:function(fnc){setTimeout(fnc,0)},toArray:function(obj){return obj.toArray?obj.toArray():ARR_SLICE.call(obj)},isUndefined:function(obj){return void 0===obj},isNull:function(obj){return null===obj},isNaN:function(obj){return obj!==obj},isArray:Array.isArray||function(obj){return obj.constructor===Array},isObject:function(obj){return obj===Object(obj)},isNumber:function(obj){return obj===obj+0},isString:function(obj){return obj===obj+""},isBoolean:function(obj){return obj===!1||obj===!0},isFunction:function(obj){return"[object Function]"===Object.prototype.toString.call(obj)}}}(),dat.controllers.Controller=function(common){var Controller=function(object,property){this.initialValue=object[property],this.domElement=document.createElement("div"),this.object=object,this.property=property,this.__onChange=void 0,this.__onFinishChange=void 0};return common.extend(Controller.prototype,{onChange:function(fnc){return this.__onChange=fnc,this},onFinishChange:function(fnc){return this.__onFinishChange=fnc,this},setValue:function(newValue){return this.object[this.property]=newValue,this.__onChange&&this.__onChange.call(this,newValue),this.updateDisplay(),this},getValue:function(){return this.object[this.property]},updateDisplay:function(){return this},isModified:function(){return this.initialValue!==this.getValue()}}),Controller}(dat.utils.common),dat.dom.dom=function(common){function cssValueToPixels(val){if("0"===val||common.isUndefined(val))return 0;var match=val.match(CSS_VALUE_PIXELS);return common.isNull(match)?0:parseFloat(match[1])}var EVENT_MAP={HTMLEvents:["change"],MouseEvents:["click","mousemove","mousedown","mouseup","mouseover"],KeyboardEvents:["keydown"]},EVENT_MAP_INV={};common.each(EVENT_MAP,function(v,k){common.each(v,function(e){EVENT_MAP_INV[e]=k})});var CSS_VALUE_PIXELS=/(\d+(\.\d+)?)px/,dom={makeSelectable:function(elem,selectable){void 0!==elem&&void 0!==elem.style&&(elem.onselectstart=selectable?function(){return!1}:function(){},elem.style.MozUserSelect=selectable?"auto":"none",elem.style.KhtmlUserSelect=selectable?"auto":"none",elem.unselectable=selectable?"on":"off")},makeFullscreen:function(elem,horizontal,vertical){common.isUndefined(horizontal)&&(horizontal=!0),common.isUndefined(vertical)&&(vertical=!0),elem.style.position="absolute",horizontal&&(elem.style.left=0,elem.style.right=0),vertical&&(elem.style.top=0,elem.style.bottom=0)},fakeEvent:function(elem,eventType,params,aux){params=params||{};var className=EVENT_MAP_INV[eventType];if(!className)throw new Error("Event type "+eventType+" not supported.");var evt=document.createEvent(className);switch(className){case"MouseEvents":var clientX=params.x||params.clientX||0,clientY=params.y||params.clientY||0;evt.initMouseEvent(eventType,params.bubbles||!1,params.cancelable||!0,window,params.clickCount||1,0,0,clientX,clientY,!1,!1,!1,!1,0,null);break;case"KeyboardEvents":var init=evt.initKeyboardEvent||evt.initKeyEvent;common.defaults(params,{cancelable:!0,ctrlKey:!1,altKey:!1,shiftKey:!1,metaKey:!1,keyCode:void 0,charCode:void 0}),init(eventType,params.bubbles||!1,params.cancelable,window,params.ctrlKey,params.altKey,params.shiftKey,params.metaKey,params.keyCode,params.charCode);break;default:evt.initEvent(eventType,params.bubbles||!1,params.cancelable||!0)}common.defaults(evt,aux),elem.dispatchEvent(evt)},bind:function(elem,event,func,bool){return bool=bool||!1,elem.addEventListener?elem.addEventListener(event,func,bool):elem.attachEvent&&elem.attachEvent("on"+event,func),dom},unbind:function(elem,event,func,bool){return bool=bool||!1,elem.removeEventListener?elem.removeEventListener(event,func,bool):elem.detachEvent&&elem.detachEvent("on"+event,func),dom},addClass:function(elem,className){if(void 0===elem.className)elem.className=className;else if(elem.className!==className){var classes=elem.className.split(/ +/);-1==classes.indexOf(className)&&(classes.push(className),elem.className=classes.join(" ").replace(/^\s+/,"").replace(/\s+$/,""))}return dom},removeClass:function(elem,className){if(className)if(void 0===elem.className);else if(elem.className===className)elem.removeAttribute("class");else{var classes=elem.className.split(/ +/),index=classes.indexOf(className);-1!=index&&(classes.splice(index,1),elem.className=classes.join(" "))}else elem.className=void 0;return dom},hasClass:function(elem,className){return new RegExp("(?:^|\\s+)"+className+"(?:\\s+|$)").test(elem.className)||!1},getWidth:function(elem){var style=getComputedStyle(elem);return cssValueToPixels(style["border-left-width"])+cssValueToPixels(style["border-right-width"])+cssValueToPixels(style["padding-left"])+cssValueToPixels(style["padding-right"])+cssValueToPixels(style.width)},getHeight:function(elem){var style=getComputedStyle(elem);return cssValueToPixels(style["border-top-width"])+cssValueToPixels(style["border-bottom-width"])+cssValueToPixels(style["padding-top"])+cssValueToPixels(style["padding-bottom"])+cssValueToPixels(style.height)},getOffset:function(elem){var offset={left:0,top:0};if(elem.offsetParent)do offset.left+=elem.offsetLeft,offset.top+=elem.offsetTop;while(elem=elem.offsetParent);return offset},isActive:function(elem){return elem===document.activeElement&&(elem.type||elem.href)}};return dom}(dat.utils.common),dat.controllers.OptionController=function(Controller,dom,common){var OptionController=function(object,property,options){OptionController.superclass.call(this,object,property);var _this=this;if(this.__select=document.createElement("select"),common.isArray(options)){var map={};common.each(options,function(element){map[element]=element}),options=map}common.each(options,function(value,key){var opt=document.createElement("option");opt.innerHTML=key,opt.setAttribute("value",value),_this.__select.appendChild(opt)}),this.updateDisplay(),dom.bind(this.__select,"change",function(){var desiredValue=this.options[this.selectedIndex].value;_this.setValue(desiredValue)}),this.domElement.appendChild(this.__select)};return OptionController.superclass=Controller,common.extend(OptionController.prototype,Controller.prototype,{setValue:function(v){var toReturn=OptionController.superclass.prototype.setValue.call(this,v);return this.__onFinishChange&&this.__onFinishChange.call(this,this.getValue()),toReturn},updateDisplay:function(){return this.__select.value=this.getValue(),OptionController.superclass.prototype.updateDisplay.call(this)}}),OptionController}(dat.controllers.Controller,dat.dom.dom,dat.utils.common),dat.controllers.NumberController=function(Controller,common){function numDecimals(x){return x=x.toString(),x.indexOf(".")>-1?x.length-x.indexOf(".")-1:0}var NumberController=function(object,property,params){NumberController.superclass.call(this,object,property),params=params||{},this.__min=params.min,this.__max=params.max,this.__step=params.step,common.isUndefined(this.__step)?0==this.initialValue?this.__impliedStep=1:this.__impliedStep=Math.pow(10,Math.floor(Math.log(this.initialValue)/Math.LN10))/10:this.__impliedStep=this.__step,this.__precision=numDecimals(this.__impliedStep)};return NumberController.superclass=Controller,common.extend(NumberController.prototype,Controller.prototype,{setValue:function(v){return void 0!==this.__min&&v<this.__min?v=this.__min:void 0!==this.__max&&v>this.__max&&(v=this.__max),void 0!==this.__step&&v%this.__step!=0&&(v=Math.round(v/this.__step)*this.__step),NumberController.superclass.prototype.setValue.call(this,v)},min:function(v){return this.__min=v,this},max:function(v){return this.__max=v,this},step:function(v){return this.__step=v,this}}),NumberController}(dat.controllers.Controller,dat.utils.common),dat.controllers.NumberControllerBox=function(NumberController,dom,common){function roundToDecimal(value,decimals){var tenTo=Math.pow(10,decimals);return Math.round(value*tenTo)/tenTo}var NumberControllerBox=function(object,property,params){function onChange(){var attempted=parseFloat(_this.__input.value);common.isNaN(attempted)||_this.setValue(attempted)}function onBlur(){onChange(),_this.__onFinishChange&&_this.__onFinishChange.call(_this,_this.getValue())}function onMouseDown(e){dom.bind(window,"mousemove",onMouseDrag),dom.bind(window,"mouseup",onMouseUp),prev_y=e.clientY}function onMouseDrag(e){var diff=prev_y-e.clientY;_this.setValue(_this.getValue()+diff*_this.__impliedStep),prev_y=e.clientY}function onMouseUp(){dom.unbind(window,"mousemove",onMouseDrag),dom.unbind(window,"mouseup",onMouseUp)}this.__truncationSuspended=!1,NumberControllerBox.superclass.call(this,object,property,params);var prev_y,_this=this;this.__input=document.createElement("input"),this.__input.setAttribute("type","text"),dom.bind(this.__input,"change",onChange),dom.bind(this.__input,"blur",onBlur),dom.bind(this.__input,"mousedown",onMouseDown),dom.bind(this.__input,"keydown",function(e){13===e.keyCode&&(_this.__truncationSuspended=!0,this.blur(),_this.__truncationSuspended=!1)}),this.updateDisplay(),this.domElement.appendChild(this.__input)};return NumberControllerBox.superclass=NumberController,common.extend(NumberControllerBox.prototype,NumberController.prototype,{updateDisplay:function(){return this.__input.value=this.__truncationSuspended?this.getValue():roundToDecimal(this.getValue(),this.__precision),NumberControllerBox.superclass.prototype.updateDisplay.call(this)}}),NumberControllerBox}(dat.controllers.NumberController,dat.dom.dom,dat.utils.common),dat.controllers.NumberControllerSlider=function(NumberController,dom,css,common,styleSheet){function map(v,i1,i2,o1,o2){return o1+(o2-o1)*((v-i1)/(i2-i1))}var NumberControllerSlider=function(object,property,min,max,step){function onMouseDown(e){dom.bind(window,"mousemove",onMouseDrag),dom.bind(window,"mouseup",onMouseUp),onMouseDrag(e)}function onMouseDrag(e){e.preventDefault();var offset=dom.getOffset(_this.__background),width=dom.getWidth(_this.__background);return _this.setValue(map(e.clientX,offset.left,offset.left+width,_this.__min,_this.__max)),!1}function onMouseUp(){dom.unbind(window,"mousemove",onMouseDrag),dom.unbind(window,"mouseup",onMouseUp),_this.__onFinishChange&&_this.__onFinishChange.call(_this,_this.getValue())}NumberControllerSlider.superclass.call(this,object,property,{min:min,max:max,step:step});var _this=this;this.__background=document.createElement("div"),this.__foreground=document.createElement("div"),dom.bind(this.__background,"mousedown",onMouseDown),dom.addClass(this.__background,"slider"),dom.addClass(this.__foreground,"slider-fg"),this.updateDisplay(),this.__background.appendChild(this.__foreground),this.domElement.appendChild(this.__background)};return NumberControllerSlider.superclass=NumberController,NumberControllerSlider.useDefaultStyles=function(){css.inject(styleSheet)},common.extend(NumberControllerSlider.prototype,NumberController.prototype,{updateDisplay:function(){var pct=(this.getValue()-this.__min)/(this.__max-this.__min);return this.__foreground.style.width=100*pct+"%",NumberControllerSlider.superclass.prototype.updateDisplay.call(this)}}),NumberControllerSlider}(dat.controllers.NumberController,dat.dom.dom,dat.utils.css,dat.utils.common,".slider {\n  box-shadow: inset 0 2px 4px rgba(0,0,0,0.15);\n  height: 1em;\n  border-radius: 1em;\n  background-color: #eee;\n  padding: 0 0.5em;\n  overflow: hidden;\n}\n\n.slider-fg {\n  padding: 1px 0 2px 0;\n  background-color: #aaa;\n  height: 1em;\n  margin-left: -0.5em;\n  padding-right: 0.5em;\n  border-radius: 1em 0 0 1em;\n}\n\n.slider-fg:after {\n  display: inline-block;\n  border-radius: 1em;\n  background-color: #fff;\n  border:  1px solid #aaa;\n  content: '';\n  float: right;\n  margin-right: -1em;\n  margin-top: -1px;\n  height: 0.9em;\n  width: 0.9em;\n}"),dat.controllers.FunctionController=function(Controller,dom,common){var FunctionController=function(object,property,text){FunctionController.superclass.call(this,object,property);var _this=this;this.__button=document.createElement("div"),this.__button.innerHTML=void 0===text?"Fire":text,dom.bind(this.__button,"click",function(e){return e.preventDefault(),_this.fire(),!1}),dom.addClass(this.__button,"button"),this.domElement.appendChild(this.__button)};return FunctionController.superclass=Controller,common.extend(FunctionController.prototype,Controller.prototype,{fire:function(){this.__onChange&&this.__onChange.call(this),this.__onFinishChange&&this.__onFinishChange.call(this,this.getValue()),this.getValue().call(this.object)}}),FunctionController}(dat.controllers.Controller,dat.dom.dom,dat.utils.common),dat.controllers.BooleanController=function(Controller,dom,common){var BooleanController=function(object,property){function onChange(){_this.setValue(!_this.__prev)}BooleanController.superclass.call(this,object,property);var _this=this;this.__prev=this.getValue(),this.__checkbox=document.createElement("input"),this.__checkbox.setAttribute("type","checkbox"),dom.bind(this.__checkbox,"change",onChange,!1),this.domElement.appendChild(this.__checkbox),this.updateDisplay()};return BooleanController.superclass=Controller,common.extend(BooleanController.prototype,Controller.prototype,{setValue:function(v){var toReturn=BooleanController.superclass.prototype.setValue.call(this,v);return this.__onFinishChange&&this.__onFinishChange.call(this,this.getValue()),this.__prev=this.getValue(),toReturn},updateDisplay:function(){return this.getValue()===!0?(this.__checkbox.setAttribute("checked","checked"),this.__checkbox.checked=!0):this.__checkbox.checked=!1,BooleanController.superclass.prototype.updateDisplay.call(this)}}),BooleanController}(dat.controllers.Controller,dat.dom.dom,dat.utils.common),dat.color.toString=function(common){return function(color){if(1==color.a||common.isUndefined(color.a)){for(var s=color.hex.toString(16);s.length<6;)s="0"+s;return"#"+s}return"rgba("+Math.round(color.r)+","+Math.round(color.g)+","+Math.round(color.b)+","+color.a+")"}}(dat.utils.common),dat.color.interpret=function(toString,common){var result,toReturn,interpret=function(){toReturn=!1;var original=arguments.length>1?common.toArray(arguments):arguments[0];return common.each(INTERPRETATIONS,function(family){return family.litmus(original)?(common.each(family.conversions,function(conversion,conversionName){return result=conversion.read(original),toReturn===!1&&result!==!1?(toReturn=result,result.conversionName=conversionName,result.conversion=conversion,common.BREAK):void 0}),common.BREAK):void 0}),toReturn},INTERPRETATIONS=[{litmus:common.isString,conversions:{THREE_CHAR_HEX:{read:function(original){var test=original.match(/^#([A-F0-9])([A-F0-9])([A-F0-9])$/i);return null===test?!1:{space:"HEX",hex:parseInt("0x"+test[1].toString()+test[1].toString()+test[2].toString()+test[2].toString()+test[3].toString()+test[3].toString())}},write:toString},SIX_CHAR_HEX:{read:function(original){var test=original.match(/^#([A-F0-9]{6})$/i);return null===test?!1:{space:"HEX",hex:parseInt("0x"+test[1].toString())}},write:toString},CSS_RGB:{read:function(original){var test=original.match(/^rgb\(\s*(.+)\s*,\s*(.+)\s*,\s*(.+)\s*\)/);return null===test?!1:{space:"RGB",r:parseFloat(test[1]),g:parseFloat(test[2]),b:parseFloat(test[3])}},write:toString},CSS_RGBA:{read:function(original){var test=original.match(/^rgba\(\s*(.+)\s*,\s*(.+)\s*,\s*(.+)\s*\,\s*(.+)\s*\)/);return null===test?!1:{space:"RGB",
r:parseFloat(test[1]),g:parseFloat(test[2]),b:parseFloat(test[3]),a:parseFloat(test[4])}},write:toString}}},{litmus:common.isNumber,conversions:{HEX:{read:function(original){return{space:"HEX",hex:original,conversionName:"HEX"}},write:function(color){return color.hex}}}},{litmus:common.isArray,conversions:{RGB_ARRAY:{read:function(original){return 3!=original.length?!1:{space:"RGB",r:original[0],g:original[1],b:original[2]}},write:function(color){return[color.r,color.g,color.b]}},RGBA_ARRAY:{read:function(original){return 4!=original.length?!1:{space:"RGB",r:original[0],g:original[1],b:original[2],a:original[3]}},write:function(color){return[color.r,color.g,color.b,color.a]}}}},{litmus:common.isObject,conversions:{RGBA_OBJ:{read:function(original){return common.isNumber(original.r)&&common.isNumber(original.g)&&common.isNumber(original.b)&&common.isNumber(original.a)?{space:"RGB",r:original.r,g:original.g,b:original.b,a:original.a}:!1},write:function(color){return{r:color.r,g:color.g,b:color.b,a:color.a}}},RGB_OBJ:{read:function(original){return common.isNumber(original.r)&&common.isNumber(original.g)&&common.isNumber(original.b)?{space:"RGB",r:original.r,g:original.g,b:original.b}:!1},write:function(color){return{r:color.r,g:color.g,b:color.b}}},HSVA_OBJ:{read:function(original){return common.isNumber(original.h)&&common.isNumber(original.s)&&common.isNumber(original.v)&&common.isNumber(original.a)?{space:"HSV",h:original.h,s:original.s,v:original.v,a:original.a}:!1},write:function(color){return{h:color.h,s:color.s,v:color.v,a:color.a}}},HSV_OBJ:{read:function(original){return common.isNumber(original.h)&&common.isNumber(original.s)&&common.isNumber(original.v)?{space:"HSV",h:original.h,s:original.s,v:original.v}:!1},write:function(color){return{h:color.h,s:color.s,v:color.v}}}}}];return interpret}(dat.color.toString,dat.utils.common),dat.GUI=dat.gui.GUI=function(css,saveDialogueContents,styleSheet,controllerFactory,Controller,BooleanController,FunctionController,NumberControllerBox,NumberControllerSlider,OptionController,ColorController,requestAnimationFrame,CenteredDiv,dom,common){function add(gui,object,property,params){if(void 0===object[property])throw new Error("Object "+object+' has no property "'+property+'"');var controller;if(params.color)controller=new ColorController(object,property);else{var factoryArgs=[object,property].concat(params.factoryArgs);controller=controllerFactory.apply(gui,factoryArgs)}params.before instanceof Controller&&(params.before=params.before.__li),recallSavedValue(gui,controller),dom.addClass(controller.domElement,"c");var name=document.createElement("span");dom.addClass(name,"property-name"),name.innerHTML=controller.property;var container=document.createElement("div");container.appendChild(name),container.appendChild(controller.domElement);var li=addRow(gui,container,params.before);return dom.addClass(li,GUI.CLASS_CONTROLLER_ROW),dom.addClass(li,typeof controller.getValue()),augmentController(gui,li,controller),gui.__controllers.push(controller),controller}function addRow(gui,dom,liBefore){var li=document.createElement("li");return dom&&li.appendChild(dom),liBefore?gui.__ul.insertBefore(li,params.before):gui.__ul.appendChild(li),gui.onResize(),li}function augmentController(gui,li,controller){if(controller.__li=li,controller.__gui=gui,common.extend(controller,{options:function(options){return arguments.length>1?(controller.remove(),add(gui,controller.object,controller.property,{before:controller.__li.nextElementSibling,factoryArgs:[common.toArray(arguments)]})):common.isArray(options)||common.isObject(options)?(controller.remove(),add(gui,controller.object,controller.property,{before:controller.__li.nextElementSibling,factoryArgs:[options]})):void 0},name:function(v){return controller.__li.firstElementChild.firstElementChild.innerHTML=v,controller},listen:function(){return controller.__gui.listen(controller),controller},remove:function(){return controller.__gui.remove(controller),controller}}),controller instanceof NumberControllerSlider){var box=new NumberControllerBox(controller.object,controller.property,{min:controller.__min,max:controller.__max,step:controller.__step});common.each(["updateDisplay","onChange","onFinishChange"],function(method){var pc=controller[method],pb=box[method];controller[method]=box[method]=function(){var args=Array.prototype.slice.call(arguments);return pc.apply(controller,args),pb.apply(box,args)}}),dom.addClass(li,"has-slider"),controller.domElement.insertBefore(box.domElement,controller.domElement.firstElementChild)}else if(controller instanceof NumberControllerBox){var r=function(returned){return common.isNumber(controller.__min)&&common.isNumber(controller.__max)?(controller.remove(),add(gui,controller.object,controller.property,{before:controller.__li.nextElementSibling,factoryArgs:[controller.__min,controller.__max,controller.__step]})):returned};controller.min=common.compose(r,controller.min),controller.max=common.compose(r,controller.max)}else controller instanceof BooleanController?(dom.bind(li,"click",function(){dom.fakeEvent(controller.__checkbox,"click")}),dom.bind(controller.__checkbox,"click",function(e){e.stopPropagation()})):controller instanceof FunctionController?(dom.bind(li,"click",function(){dom.fakeEvent(controller.__button,"click")}),dom.bind(li,"mouseover",function(){dom.addClass(controller.__button,"hover")}),dom.bind(li,"mouseout",function(){dom.removeClass(controller.__button,"hover")})):controller instanceof ColorController&&(dom.addClass(li,"color"),controller.updateDisplay=common.compose(function(r){return li.style.borderLeftColor=controller.__color.toString(),r},controller.updateDisplay),controller.updateDisplay());controller.setValue=common.compose(function(r){return gui.getRoot().__preset_select&&controller.isModified()&&markPresetModified(gui.getRoot(),!0),r},controller.setValue)}function recallSavedValue(gui,controller){var root=gui.getRoot(),matched_index=root.__rememberedObjects.indexOf(controller.object);if(-1!=matched_index){var controller_map=root.__rememberedObjectIndecesToControllers[matched_index];if(void 0===controller_map&&(controller_map={},root.__rememberedObjectIndecesToControllers[matched_index]=controller_map),controller_map[controller.property]=controller,root.load&&root.load.remembered){var preset,preset_map=root.load.remembered;if(preset_map[gui.preset])preset=preset_map[gui.preset];else{if(!preset_map[DEFAULT_DEFAULT_PRESET_NAME])return;preset=preset_map[DEFAULT_DEFAULT_PRESET_NAME]}if(preset[matched_index]&&void 0!==preset[matched_index][controller.property]){var value=preset[matched_index][controller.property];controller.initialValue=value,controller.setValue(value)}}}}function getLocalStorageHash(gui,key){return document.location.href+"."+key}function addSaveMenu(gui){function showHideExplain(){explain.style.display=gui.useLocalStorage?"block":"none"}var div=gui.__save_row=document.createElement("li");dom.addClass(gui.domElement,"has-save"),gui.__ul.insertBefore(div,gui.__ul.firstChild),dom.addClass(div,"save-row");var gears=document.createElement("span");gears.innerHTML="&nbsp;",dom.addClass(gears,"button gears");var button=document.createElement("span");button.innerHTML="Save",dom.addClass(button,"button"),dom.addClass(button,"save");var button2=document.createElement("span");button2.innerHTML="New",dom.addClass(button2,"button"),dom.addClass(button2,"save-as");var button3=document.createElement("span");button3.innerHTML="Revert",dom.addClass(button3,"button"),dom.addClass(button3,"revert");var select=gui.__preset_select=document.createElement("select");if(gui.load&&gui.load.remembered?common.each(gui.load.remembered,function(value,key){addPresetOption(gui,key,key==gui.preset)}):addPresetOption(gui,DEFAULT_DEFAULT_PRESET_NAME,!1),dom.bind(select,"change",function(){for(var index=0;index<gui.__preset_select.length;index++)gui.__preset_select[index].innerHTML=gui.__preset_select[index].value;gui.preset=this.value}),div.appendChild(select),div.appendChild(gears),div.appendChild(button),div.appendChild(button2),div.appendChild(button3),SUPPORTS_LOCAL_STORAGE){var saveLocally=document.getElementById("dg-save-locally"),explain=document.getElementById("dg-local-explain");saveLocally.style.display="block";var localStorageCheckBox=document.getElementById("dg-local-storage");"true"===localStorage.getItem(getLocalStorageHash(gui,"isLocal"))&&localStorageCheckBox.setAttribute("checked","checked"),showHideExplain(),dom.bind(localStorageCheckBox,"change",function(){gui.useLocalStorage=!gui.useLocalStorage,showHideExplain()})}var newConstructorTextArea=document.getElementById("dg-new-constructor");dom.bind(newConstructorTextArea,"keydown",function(e){!e.metaKey||67!==e.which&&67!=e.keyCode||SAVE_DIALOGUE.hide()}),dom.bind(gears,"click",function(){newConstructorTextArea.innerHTML=JSON.stringify(gui.getSaveObject(),void 0,2),SAVE_DIALOGUE.show(),newConstructorTextArea.focus(),newConstructorTextArea.select()}),dom.bind(button,"click",function(){gui.save()}),dom.bind(button2,"click",function(){var presetName=prompt("Enter a new preset name.");presetName&&gui.saveAs(presetName)}),dom.bind(button3,"click",function(){gui.revert()})}function addResizeHandle(gui){function dragStart(e){return e.preventDefault(),pmouseX=e.clientX,dom.addClass(gui.__closeButton,GUI.CLASS_DRAG),dom.bind(window,"mousemove",drag),dom.bind(window,"mouseup",dragStop),!1}function drag(e){return e.preventDefault(),gui.width+=pmouseX-e.clientX,gui.onResize(),pmouseX=e.clientX,!1}function dragStop(){dom.removeClass(gui.__closeButton,GUI.CLASS_DRAG),dom.unbind(window,"mousemove",drag),dom.unbind(window,"mouseup",dragStop)}gui.__resize_handle=document.createElement("div"),common.extend(gui.__resize_handle.style,{width:"6px",marginLeft:"-3px",height:"200px",cursor:"ew-resize",position:"absolute"});var pmouseX;dom.bind(gui.__resize_handle,"mousedown",dragStart),dom.bind(gui.__closeButton,"mousedown",dragStart),gui.domElement.insertBefore(gui.__resize_handle,gui.domElement.firstElementChild)}function setWidth(gui,w){gui.domElement.style.width=w+"px",gui.__save_row&&gui.autoPlace&&(gui.__save_row.style.width=w+"px"),gui.__closeButton&&(gui.__closeButton.style.width=w+"px")}function getCurrentPreset(gui,useInitialValues){var toReturn={};return common.each(gui.__rememberedObjects,function(val,index){var saved_values={},controller_map=gui.__rememberedObjectIndecesToControllers[index];common.each(controller_map,function(controller,property){saved_values[property]=useInitialValues?controller.initialValue:controller.getValue()}),toReturn[index]=saved_values}),toReturn}function addPresetOption(gui,name,setSelected){var opt=document.createElement("option");opt.innerHTML=name,opt.value=name,gui.__preset_select.appendChild(opt),setSelected&&(gui.__preset_select.selectedIndex=gui.__preset_select.length-1)}function setPresetSelectIndex(gui){for(var index=0;index<gui.__preset_select.length;index++)gui.__preset_select[index].value==gui.preset&&(gui.__preset_select.selectedIndex=index)}function markPresetModified(gui,modified){var opt=gui.__preset_select[gui.__preset_select.selectedIndex];modified?opt.innerHTML=opt.value+"*":opt.innerHTML=opt.value}function updateDisplays(controllerArray){0!=controllerArray.length&&requestAnimationFrame(function(){updateDisplays(controllerArray)}),common.each(controllerArray,function(c){c.updateDisplay()})}css.inject(styleSheet);var SAVE_DIALOGUE,auto_place_container,CSS_NAMESPACE="dg",HIDE_KEY_CODE=72,CLOSE_BUTTON_HEIGHT=20,DEFAULT_DEFAULT_PRESET_NAME="Default",SUPPORTS_LOCAL_STORAGE=function(){try{return"localStorage"in window&&null!==window.localStorage}catch(e){return!1}}(),auto_place_virgin=!0,hide=!1,hideable_guis=[],GUI=function(params){function saveToLocalStorage(){localStorage.setItem(getLocalStorageHash(_this,"gui"),JSON.stringify(_this.getSaveObject()))}function resetWidth(){var root=_this.getRoot();root.width+=1,common.defer(function(){root.width-=1})}var _this=this;this.domElement=document.createElement("div"),this.__ul=document.createElement("ul"),this.domElement.appendChild(this.__ul),dom.addClass(this.domElement,CSS_NAMESPACE),this.__folders={},this.__controllers=[],this.__rememberedObjects=[],this.__rememberedObjectIndecesToControllers=[],this.__listening=[],params=params||{},params=common.defaults(params,{autoPlace:!0,width:GUI.DEFAULT_WIDTH}),params=common.defaults(params,{resizable:params.autoPlace,hideable:params.autoPlace}),common.isUndefined(params.load)?params.load={preset:DEFAULT_DEFAULT_PRESET_NAME}:params.preset&&(params.load.preset=params.preset),common.isUndefined(params.parent)&&params.hideable&&hideable_guis.push(this),params.resizable=common.isUndefined(params.parent)&&params.resizable,params.autoPlace&&common.isUndefined(params.scrollable)&&(params.scrollable=!0);var use_local_storage=SUPPORTS_LOCAL_STORAGE&&"true"===localStorage.getItem(getLocalStorageHash(this,"isLocal"));if(Object.defineProperties(this,{parent:{get:function(){return params.parent}},scrollable:{get:function(){return params.scrollable}},autoPlace:{get:function(){return params.autoPlace}},preset:{get:function(){return _this.parent?_this.getRoot().preset:params.load.preset},set:function(v){_this.parent?_this.getRoot().preset=v:params.load.preset=v,setPresetSelectIndex(this),_this.revert()}},width:{get:function(){return params.width},set:function(v){params.width=v,setWidth(_this,v)}},name:{get:function(){return params.name},set:function(v){params.name=v,title_row_name&&(title_row_name.innerHTML=params.name)}},closed:{get:function(){return params.closed},set:function(v){params.closed=v,params.closed?dom.addClass(_this.__ul,GUI.CLASS_CLOSED):dom.removeClass(_this.__ul,GUI.CLASS_CLOSED),this.onResize(),_this.__closeButton&&(_this.__closeButton.innerHTML=v?GUI.TEXT_OPEN:GUI.TEXT_CLOSED)}},load:{get:function(){return params.load}},useLocalStorage:{get:function(){return use_local_storage},set:function(bool){SUPPORTS_LOCAL_STORAGE&&(use_local_storage=bool,bool?dom.bind(window,"unload",saveToLocalStorage):dom.unbind(window,"unload",saveToLocalStorage),localStorage.setItem(getLocalStorageHash(_this,"isLocal"),bool))}}}),common.isUndefined(params.parent)){if(params.closed=!1,dom.addClass(this.domElement,GUI.CLASS_MAIN),dom.makeSelectable(this.domElement,!1),SUPPORTS_LOCAL_STORAGE&&use_local_storage){_this.useLocalStorage=!0;var saved_gui=localStorage.getItem(getLocalStorageHash(this,"gui"));saved_gui&&(params.load=JSON.parse(saved_gui))}this.__closeButton=document.createElement("div"),this.__closeButton.innerHTML=GUI.TEXT_CLOSED,dom.addClass(this.__closeButton,GUI.CLASS_CLOSE_BUTTON),this.domElement.appendChild(this.__closeButton),dom.bind(this.__closeButton,"click",function(){_this.closed=!_this.closed})}else{void 0===params.closed&&(params.closed=!0);var title_row_name=document.createTextNode(params.name);dom.addClass(title_row_name,"controller-name");var title_row=addRow(_this,title_row_name),on_click_title=function(e){return e.preventDefault(),_this.closed=!_this.closed,!1};dom.addClass(this.__ul,GUI.CLASS_CLOSED),dom.addClass(title_row,"title"),dom.bind(title_row,"click",on_click_title),params.closed||(this.closed=!1)}params.autoPlace&&(common.isUndefined(params.parent)&&(auto_place_virgin&&(auto_place_container=document.createElement("div"),dom.addClass(auto_place_container,CSS_NAMESPACE),dom.addClass(auto_place_container,GUI.CLASS_AUTO_PLACE_CONTAINER),document.body.appendChild(auto_place_container),auto_place_virgin=!1),auto_place_container.appendChild(this.domElement),dom.addClass(this.domElement,GUI.CLASS_AUTO_PLACE)),this.parent||setWidth(_this,params.width)),dom.bind(window,"resize",function(){_this.onResize()}),dom.bind(this.__ul,"webkitTransitionEnd",function(){_this.onResize()}),dom.bind(this.__ul,"transitionend",function(){_this.onResize()}),dom.bind(this.__ul,"oTransitionEnd",function(){_this.onResize()}),this.onResize(),params.resizable&&addResizeHandle(this);_this.getRoot();params.parent||resetWidth()};return GUI.toggleHide=function(){hide=!hide,common.each(hideable_guis,function(gui){gui.domElement.style.zIndex=hide?-999:999,gui.domElement.style.opacity=hide?0:1})},GUI.CLASS_AUTO_PLACE="a",GUI.CLASS_AUTO_PLACE_CONTAINER="ac",GUI.CLASS_MAIN="main",GUI.CLASS_CONTROLLER_ROW="cr",GUI.CLASS_TOO_TALL="taller-than-window",GUI.CLASS_CLOSED="closed",GUI.CLASS_CLOSE_BUTTON="close-button",GUI.CLASS_DRAG="drag",GUI.DEFAULT_WIDTH=245,GUI.TEXT_CLOSED="Close Controls",GUI.TEXT_OPEN="Open Controls",dom.bind(window,"keydown",function(e){"text"===document.activeElement.type||e.which!==HIDE_KEY_CODE&&e.keyCode!=HIDE_KEY_CODE||GUI.toggleHide()},!1),common.extend(GUI.prototype,{add:function(object,property){return add(this,object,property,{factoryArgs:Array.prototype.slice.call(arguments,2)})},addColor:function(object,property){return add(this,object,property,{color:!0})},remove:function(controller){this.__ul.removeChild(controller.__li),this.__controllers.slice(this.__controllers.indexOf(controller),1);var _this=this;common.defer(function(){_this.onResize()})},destroy:function(){this.autoPlace&&auto_place_container.removeChild(this.domElement)},addFolder:function(name){if(void 0!==this.__folders[name])throw new Error('You already have a folder in this GUI by the name "'+name+'"');var new_gui_params={name:name,parent:this};new_gui_params.autoPlace=this.autoPlace,this.load&&this.load.folders&&this.load.folders[name]&&(new_gui_params.closed=this.load.folders[name].closed,new_gui_params.load=this.load.folders[name]);var gui=new GUI(new_gui_params);this.__folders[name]=gui;var li=addRow(this,gui.domElement);return dom.addClass(li,"folder"),gui},open:function(){this.closed=!1},close:function(){this.closed=!0},onResize:function(){var root=this.getRoot();if(root.scrollable){var top=dom.getOffset(root.__ul).top,h=0;common.each(root.__ul.childNodes,function(node){root.autoPlace&&node===root.__save_row||(h+=dom.getHeight(node))}),window.innerHeight-top-CLOSE_BUTTON_HEIGHT<h?(dom.addClass(root.domElement,GUI.CLASS_TOO_TALL),root.__ul.style.height=window.innerHeight-top-CLOSE_BUTTON_HEIGHT+"px"):(dom.removeClass(root.domElement,GUI.CLASS_TOO_TALL),root.__ul.style.height="auto")}root.__resize_handle&&common.defer(function(){root.__resize_handle.style.height=root.__ul.offsetHeight+"px"}),root.__closeButton&&(root.__closeButton.style.width=root.width+"px")},remember:function(){if(common.isUndefined(SAVE_DIALOGUE)&&(SAVE_DIALOGUE=new CenteredDiv,SAVE_DIALOGUE.domElement.innerHTML=saveDialogueContents),this.parent)throw new Error("You can only call remember on a top level GUI.");var _this=this;common.each(Array.prototype.slice.call(arguments),function(object){0==_this.__rememberedObjects.length&&addSaveMenu(_this),-1==_this.__rememberedObjects.indexOf(object)&&_this.__rememberedObjects.push(object)}),this.autoPlace&&setWidth(this,this.width)},getRoot:function(){for(var gui=this;gui.parent;)gui=gui.parent;return gui},getSaveObject:function(){var toReturn=this.load;return toReturn.closed=this.closed,this.__rememberedObjects.length>0&&(toReturn.preset=this.preset,toReturn.remembered||(toReturn.remembered={}),toReturn.remembered[this.preset]=getCurrentPreset(this)),toReturn.folders={},common.each(this.__folders,function(element,key){toReturn.folders[key]=element.getSaveObject()}),toReturn},save:function(){this.load.remembered||(this.load.remembered={}),this.load.remembered[this.preset]=getCurrentPreset(this),markPresetModified(this,!1)},saveAs:function(presetName){this.load.remembered||(this.load.remembered={},this.load.remembered[DEFAULT_DEFAULT_PRESET_NAME]=getCurrentPreset(this,!0)),this.load.remembered[presetName]=getCurrentPreset(this),this.preset=presetName,addPresetOption(this,presetName,!0)},revert:function(gui){common.each(this.__controllers,function(controller){this.getRoot().load.remembered?recallSavedValue(gui||this.getRoot(),controller):controller.setValue(controller.initialValue)},this),common.each(this.__folders,function(folder){folder.revert(folder)}),gui||markPresetModified(this.getRoot(),!1)},listen:function(controller){var init=0==this.__listening.length;this.__listening.push(controller),init&&updateDisplays(this.__listening)}}),GUI}(dat.utils.css,'<div id="dg-save" class="dg dialogue">\n\n  Here\'s the new load parameter for your <code>GUI</code>\'s constructor:\n\n  <textarea id="dg-new-constructor"></textarea>\n\n  <div id="dg-save-locally">\n\n    <input id="dg-local-storage" type="checkbox"/> Automatically save\n    values to <code>localStorage</code> on exit.\n\n    <div id="dg-local-explain">The values saved to <code>localStorage</code> will\n      override those passed to <code>dat.GUI</code>\'s constructor. This makes it\n      easier to work incrementally, but <code>localStorage</code> is fragile,\n      and your friends may not see the same values you do.\n      \n    </div>\n    \n  </div>\n\n</div>',".dg ul{list-style:none;margin:0;padding:0;width:100%;clear:both}.dg.ac{position:fixed;top:0;left:0;right:0;height:0;z-index:0}.dg:not(.ac) .main{overflow:hidden}.dg.main{-webkit-transition:opacity 0.1s linear;-o-transition:opacity 0.1s linear;-moz-transition:opacity 0.1s linear;transition:opacity 0.1s linear}.dg.main.taller-than-window{overflow-y:auto}.dg.main.taller-than-window .close-button{opacity:1;margin-top:-1px;border-top:1px solid #2c2c2c}.dg.main ul.closed .close-button{opacity:1 !important}.dg.main:hover .close-button,.dg.main .close-button.drag{opacity:1}.dg.main .close-button{-webkit-transition:opacity 0.1s linear;-o-transition:opacity 0.1s linear;-moz-transition:opacity 0.1s linear;transition:opacity 0.1s linear;border:0;position:absolute;line-height:19px;height:20px;cursor:pointer;text-align:center;background-color:#000}.dg.main .close-button:hover{background-color:#111}.dg.a{float:right;margin-right:15px;overflow-x:hidden}.dg.a.has-save ul{margin-top:27px}.dg.a.has-save ul.closed{margin-top:0}.dg.a .save-row{position:fixed;top:0;z-index:1002}.dg li{-webkit-transition:height 0.1s ease-out;-o-transition:height 0.1s ease-out;-moz-transition:height 0.1s ease-out;transition:height 0.1s ease-out}.dg li:not(.folder){cursor:auto;height:27px;line-height:27px;overflow:hidden;padding:0 4px 0 5px}.dg li.folder{padding:0;border-left:4px solid rgba(0,0,0,0)}.dg li.title{cursor:pointer;margin-left:-4px}.dg .closed li:not(.title),.dg .closed ul li,.dg .closed ul li > *{height:0;overflow:hidden;border:0}.dg .cr{clear:both;padding-left:3px;height:27px}.dg .property-name{cursor:default;float:left;clear:left;width:40%;overflow:hidden;text-overflow:ellipsis}.dg .c{float:left;width:60%}.dg .c input[type=text]{border:0;margin-top:4px;padding:3px;width:100%;float:right}.dg .has-slider input[type=text]{width:30%;margin-left:0}.dg .slider{float:left;width:66%;margin-left:-5px;margin-right:0;height:19px;margin-top:4px}.dg .slider-fg{height:100%}.dg .c input[type=checkbox]{margin-top:9px}.dg .c select{margin-top:5px}.dg .cr.function,.dg .cr.function .property-name,.dg .cr.function *,.dg .cr.boolean,.dg .cr.boolean *{cursor:pointer}.dg .selector{display:none;position:absolute;margin-left:-9px;margin-top:23px;z-index:10}.dg .c:hover .selector,.dg .selector.drag{display:block}.dg li.save-row{padding:0}.dg li.save-row .button{display:inline-block;padding:0px 6px}.dg.dialogue{background-color:#222;width:460px;padding:15px;font-size:13px;line-height:15px}#dg-new-constructor{padding:10px;color:#222;font-family:Monaco, monospace;font-size:10px;border:0;resize:none;box-shadow:inset 1px 1px 1px #888;word-wrap:break-word;margin:12px 0;display:block;width:440px;overflow-y:scroll;height:100px;position:relative}#dg-local-explain{display:none;font-size:11px;line-height:17px;border-radius:3px;background-color:#333;padding:8px;margin-top:10px}#dg-local-explain code{font-size:10px}#dat-gui-save-locally{display:none}.dg{color:#eee;font:11px 'Lucida Grande', sans-serif;text-shadow:0 -1px 0 #111}.dg.main::-webkit-scrollbar{width:5px;background:#1a1a1a}.dg.main::-webkit-scrollbar-corner{height:0;display:none}.dg.main::-webkit-scrollbar-thumb{border-radius:5px;background:#676767}.dg li:not(.folder){background:#1a1a1a;border-bottom:1px solid #2c2c2c}.dg li.save-row{line-height:25px;background:#dad5cb;border:0}.dg li.save-row select{margin-left:5px;width:108px}.dg li.save-row .button{margin-left:5px;margin-top:1px;border-radius:2px;font-size:9px;line-height:7px;padding:4px 4px 5px 4px;background:#c5bdad;color:#fff;text-shadow:0 1px 0 #b0a58f;box-shadow:0 -1px 0 #b0a58f;cursor:pointer}.dg li.save-row .button.gears{background:#c5bdad url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAsAAAANCAYAAAB/9ZQ7AAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAAQJJREFUeNpiYKAU/P//PwGIC/ApCABiBSAW+I8AClAcgKxQ4T9hoMAEUrxx2QSGN6+egDX+/vWT4e7N82AMYoPAx/evwWoYoSYbACX2s7KxCxzcsezDh3evFoDEBYTEEqycggWAzA9AuUSQQgeYPa9fPv6/YWm/Acx5IPb7ty/fw+QZblw67vDs8R0YHyQhgObx+yAJkBqmG5dPPDh1aPOGR/eugW0G4vlIoTIfyFcA+QekhhHJhPdQxbiAIguMBTQZrPD7108M6roWYDFQiIAAv6Aow/1bFwXgis+f2LUAynwoIaNcz8XNx3Dl7MEJUDGQpx9gtQ8YCueB+D26OECAAQDadt7e46D42QAAAABJRU5ErkJggg==) 2px 1px no-repeat;height:7px;width:8px}.dg li.save-row .button:hover{background-color:#bab19e;box-shadow:0 -1px 0 #b0a58f}.dg li.folder{border-bottom:0}.dg li.title{padding-left:16px;background:#000 url(data:image/gif;base64,R0lGODlhBQAFAJEAAP////Pz8////////yH5BAEAAAIALAAAAAAFAAUAAAIIlI+hKgFxoCgAOw==) 6px 10px no-repeat;cursor:pointer;border-bottom:1px solid rgba(255,255,255,0.2)}.dg .closed li.title{background-image:url(data:image/gif;base64,R0lGODlhBQAFAJEAAP////Pz8////////yH5BAEAAAIALAAAAAAFAAUAAAIIlGIWqMCbWAEAOw==)}.dg .cr.boolean{border-left:3px solid #806787}.dg .cr.function{border-left:3px solid #e61d5f}.dg .cr.number{border-left:3px solid #2fa1d6}.dg .cr.number input[type=text]{color:#2fa1d6}.dg .cr.string{border-left:3px solid #1ed36f}.dg .cr.string input[type=text]{color:#1ed36f}.dg .cr.function:hover,.dg .cr.boolean:hover{background:#111}.dg .c input[type=text]{background:#303030;outline:none}.dg .c input[type=text]:hover{background:#3c3c3c}.dg .c input[type=text]:focus{background:#494949;color:#fff}.dg .c .slider{background:#303030;cursor:ew-resize}.dg .c .slider-fg{background:#2fa1d6}.dg .c .slider:hover{background:#3c3c3c}.dg .c .slider:hover .slider-fg{background:#44abda}\n",dat.controllers.factory=function(OptionController,NumberControllerBox,NumberControllerSlider,StringController,FunctionController,BooleanController,common){return function(object,property){var initialValue=object[property];return common.isArray(arguments[2])||common.isObject(arguments[2])?new OptionController(object,property,arguments[2]):common.isNumber(initialValue)?common.isNumber(arguments[2])&&common.isNumber(arguments[3])?new NumberControllerSlider(object,property,arguments[2],arguments[3]):new NumberControllerBox(object,property,{min:arguments[2],max:arguments[3]}):common.isString(initialValue)?new StringController(object,property):common.isFunction(initialValue)?new FunctionController(object,property,""):common.isBoolean(initialValue)?new BooleanController(object,property):void 0}}(dat.controllers.OptionController,dat.controllers.NumberControllerBox,dat.controllers.NumberControllerSlider,dat.controllers.StringController=function(Controller,dom,common){var StringController=function(object,property){function onChange(){_this.setValue(_this.__input.value)}function onBlur(){_this.__onFinishChange&&_this.__onFinishChange.call(_this,_this.getValue())}StringController.superclass.call(this,object,property);var _this=this;this.__input=document.createElement("input"),this.__input.setAttribute("type","text"),dom.bind(this.__input,"keyup",onChange),dom.bind(this.__input,"change",onChange),dom.bind(this.__input,"blur",onBlur),dom.bind(this.__input,"keydown",function(e){13===e.keyCode&&this.blur()}),this.updateDisplay(),this.domElement.appendChild(this.__input)};return StringController.superclass=Controller,common.extend(StringController.prototype,Controller.prototype,{updateDisplay:function(){return dom.isActive(this.__input)||(this.__input.value=this.getValue()),StringController.superclass.prototype.updateDisplay.call(this)}}),StringController}(dat.controllers.Controller,dat.dom.dom,dat.utils.common),dat.controllers.FunctionController,dat.controllers.BooleanController,dat.utils.common),dat.controllers.Controller,dat.controllers.BooleanController,dat.controllers.FunctionController,dat.controllers.NumberControllerBox,dat.controllers.NumberControllerSlider,dat.controllers.OptionController,dat.controllers.ColorController=function(Controller,dom,Color,interpret,common){function linearGradient(elem,x,a,b){elem.style.background="",common.each(vendors,function(vendor){elem.style.cssText+="background: "+vendor+"linear-gradient("+x+", "+a+" 0%, "+b+" 100%); "})}function hueGradient(elem){elem.style.background="",elem.style.cssText+="background: -moz-linear-gradient(top,  #ff0000 0%, #ff00ff 17%, #0000ff 34%, #00ffff 50%, #00ff00 67%, #ffff00 84%, #ff0000 100%);",elem.style.cssText+="background: -webkit-linear-gradient(top,  #ff0000 0%,#ff00ff 17%,#0000ff 34%,#00ffff 50%,#00ff00 67%,#ffff00 84%,#ff0000 100%);",elem.style.cssText+="background: -o-linear-gradient(top,  #ff0000 0%,#ff00ff 17%,#0000ff 34%,#00ffff 50%,#00ff00 67%,#ffff00 84%,#ff0000 100%);",elem.style.cssText+="background: -ms-linear-gradient(top,  #ff0000 0%,#ff00ff 17%,#0000ff 34%,#00ffff 50%,#00ff00 67%,#ffff00 84%,#ff0000 100%);",elem.style.cssText+="background: linear-gradient(top,  #ff0000 0%,#ff00ff 17%,#0000ff 34%,#00ffff 50%,#00ff00 67%,#ffff00 84%,#ff0000 100%);"}var ColorController=function(object,property){function fieldDown(e){setSV(e),dom.bind(window,"mousemove",setSV),dom.bind(window,"mouseup",unbindSV)}function unbindSV(){dom.unbind(window,"mousemove",setSV),dom.unbind(window,"mouseup",unbindSV)}function onBlur(){var i=interpret(this.value);i!==!1?(_this.__color.__state=i,_this.setValue(_this.__color.toOriginal())):this.value=_this.__color.toString()}function unbindH(){dom.unbind(window,"mousemove",setH),dom.unbind(window,"mouseup",unbindH)}function setSV(e){e.preventDefault();var w=dom.getWidth(_this.__saturation_field),o=dom.getOffset(_this.__saturation_field),s=(e.clientX-o.left+document.body.scrollLeft)/w,v=1-(e.clientY-o.top+document.body.scrollTop)/w;return v>1?v=1:0>v&&(v=0),s>1?s=1:0>s&&(s=0),_this.__color.v=v,_this.__color.s=s,_this.setValue(_this.__color.toOriginal()),!1}function setH(e){e.preventDefault();var s=dom.getHeight(_this.__hue_field),o=dom.getOffset(_this.__hue_field),h=1-(e.clientY-o.top+document.body.scrollTop)/s;return h>1?h=1:0>h&&(h=0),_this.__color.h=360*h,_this.setValue(_this.__color.toOriginal()),!1}ColorController.superclass.call(this,object,property),this.__color=new Color(this.getValue()),this.__temp=new Color(0);var _this=this;this.domElement=document.createElement("div"),dom.makeSelectable(this.domElement,!1),this.__selector=document.createElement("div"),this.__selector.className="selector",this.__saturation_field=document.createElement("div"),this.__saturation_field.className="saturation-field",this.__field_knob=document.createElement("div"),this.__field_knob.className="field-knob",this.__field_knob_border="2px solid ",this.__hue_knob=document.createElement("div"),this.__hue_knob.className="hue-knob",this.__hue_field=document.createElement("div"),this.__hue_field.className="hue-field",this.__input=document.createElement("input"),this.__input.type="text",this.__input_textShadow="0 1px 1px ",dom.bind(this.__input,"keydown",function(e){13===e.keyCode&&onBlur.call(this)}),dom.bind(this.__input,"blur",onBlur),dom.bind(this.__selector,"mousedown",function(e){dom.addClass(this,"drag").bind(window,"mouseup",function(e){dom.removeClass(_this.__selector,"drag")})});var value_field=document.createElement("div");common.extend(this.__selector.style,{width:"122px",height:"102px",padding:"3px",backgroundColor:"#222",boxShadow:"0px 1px 3px rgba(0,0,0,0.3)"}),common.extend(this.__field_knob.style,{position:"absolute",width:"12px",height:"12px",border:this.__field_knob_border+(this.__color.v<.5?"#fff":"#000"),
boxShadow:"0px 1px 3px rgba(0,0,0,0.5)",borderRadius:"12px",zIndex:1}),common.extend(this.__hue_knob.style,{position:"absolute",width:"15px",height:"2px",borderRight:"4px solid #fff",zIndex:1}),common.extend(this.__saturation_field.style,{width:"100px",height:"100px",border:"1px solid #555",marginRight:"3px",display:"inline-block",cursor:"pointer"}),common.extend(value_field.style,{width:"100%",height:"100%",background:"none"}),linearGradient(value_field,"top","rgba(0,0,0,0)","#000"),common.extend(this.__hue_field.style,{width:"15px",height:"100px",display:"inline-block",border:"1px solid #555",cursor:"ns-resize"}),hueGradient(this.__hue_field),common.extend(this.__input.style,{outline:"none",textAlign:"center",color:"#fff",border:0,fontWeight:"bold",textShadow:this.__input_textShadow+"rgba(0,0,0,0.7)"}),dom.bind(this.__saturation_field,"mousedown",fieldDown),dom.bind(this.__field_knob,"mousedown",fieldDown),dom.bind(this.__hue_field,"mousedown",function(e){setH(e),dom.bind(window,"mousemove",setH),dom.bind(window,"mouseup",unbindH)}),this.__saturation_field.appendChild(value_field),this.__selector.appendChild(this.__field_knob),this.__selector.appendChild(this.__saturation_field),this.__selector.appendChild(this.__hue_field),this.__hue_field.appendChild(this.__hue_knob),this.domElement.appendChild(this.__input),this.domElement.appendChild(this.__selector),this.updateDisplay()};ColorController.superclass=Controller,common.extend(ColorController.prototype,Controller.prototype,{updateDisplay:function(){var i=interpret(this.getValue());if(i!==!1){var mismatch=!1;common.each(Color.COMPONENTS,function(component){return common.isUndefined(i[component])||common.isUndefined(this.__color.__state[component])||i[component]===this.__color.__state[component]?void 0:(mismatch=!0,{})},this),mismatch&&common.extend(this.__color.__state,i)}common.extend(this.__temp.__state,this.__color.__state),this.__temp.a=1;var flip=this.__color.v<.5||this.__color.s>.5?255:0,_flip=255-flip;common.extend(this.__field_knob.style,{marginLeft:100*this.__color.s-7+"px",marginTop:100*(1-this.__color.v)-7+"px",backgroundColor:this.__temp.toString(),border:this.__field_knob_border+"rgb("+flip+","+flip+","+flip+")"}),this.__hue_knob.style.marginTop=100*(1-this.__color.h/360)+"px",this.__temp.s=1,this.__temp.v=1,linearGradient(this.__saturation_field,"left","#fff",this.__temp.toString()),common.extend(this.__input.style,{backgroundColor:this.__input.value=this.__color.toString(),color:"rgb("+flip+","+flip+","+flip+")",textShadow:this.__input_textShadow+"rgba("+_flip+","+_flip+","+_flip+",.7)"})}});var vendors=["-moz-","-o-","-webkit-","-ms-",""];return ColorController}(dat.controllers.Controller,dat.dom.dom,dat.color.Color=function(interpret,math,toString,common){function defineRGBComponent(target,component,componentHexIndex){Object.defineProperty(target,component,{get:function(){return"RGB"===this.__state.space?this.__state[component]:(recalculateRGB(this,component,componentHexIndex),this.__state[component])},set:function(v){"RGB"!==this.__state.space&&(recalculateRGB(this,component,componentHexIndex),this.__state.space="RGB"),this.__state[component]=v}})}function defineHSVComponent(target,component){Object.defineProperty(target,component,{get:function(){return"HSV"===this.__state.space?this.__state[component]:(recalculateHSV(this),this.__state[component])},set:function(v){"HSV"!==this.__state.space&&(recalculateHSV(this),this.__state.space="HSV"),this.__state[component]=v}})}function recalculateRGB(color,component,componentHexIndex){if("HEX"===color.__state.space)color.__state[component]=math.component_from_hex(color.__state.hex,componentHexIndex);else{if("HSV"!==color.__state.space)throw"Corrupted color state";common.extend(color.__state,math.hsv_to_rgb(color.__state.h,color.__state.s,color.__state.v))}}function recalculateHSV(color){var result=math.rgb_to_hsv(color.r,color.g,color.b);common.extend(color.__state,{s:result.s,v:result.v}),common.isNaN(result.h)?common.isUndefined(color.__state.h)&&(color.__state.h=0):color.__state.h=result.h}var Color=function(){if(this.__state=interpret.apply(this,arguments),this.__state===!1)throw"Failed to interpret color arguments";this.__state.a=this.__state.a||1};return Color.COMPONENTS=["r","g","b","h","s","v","hex","a"],common.extend(Color.prototype,{toString:function(){return toString(this)},toOriginal:function(){return this.__state.conversion.write(this)}}),defineRGBComponent(Color.prototype,"r",2),defineRGBComponent(Color.prototype,"g",1),defineRGBComponent(Color.prototype,"b",0),defineHSVComponent(Color.prototype,"h"),defineHSVComponent(Color.prototype,"s"),defineHSVComponent(Color.prototype,"v"),Object.defineProperty(Color.prototype,"a",{get:function(){return this.__state.a},set:function(v){this.__state.a=v}}),Object.defineProperty(Color.prototype,"hex",{get:function(){return"HEX"!==!this.__state.space&&(this.__state.hex=math.rgb_to_hex(this.r,this.g,this.b)),this.__state.hex},set:function(v){this.__state.space="HEX",this.__state.hex=v}}),Color}(dat.color.interpret,dat.color.math=function(){var tmpComponent;return{hsv_to_rgb:function(h,s,v){var hi=Math.floor(h/60)%6,f=h/60-Math.floor(h/60),p=v*(1-s),q=v*(1-f*s),t=v*(1-(1-f)*s),c=[[v,t,p],[q,v,p],[p,v,t],[p,q,v],[t,p,v],[v,p,q]][hi];return{r:255*c[0],g:255*c[1],b:255*c[2]}},rgb_to_hsv:function(r,g,b){var h,s,min=Math.min(r,g,b),max=Math.max(r,g,b),delta=max-min;return 0==max?{h:NaN,s:0,v:0}:(s=delta/max,h=r==max?(g-b)/delta:g==max?2+(b-r)/delta:4+(r-g)/delta,h/=6,0>h&&(h+=1),{h:360*h,s:s,v:max/255})},rgb_to_hex:function(r,g,b){var hex=this.hex_with_component(0,2,r);return hex=this.hex_with_component(hex,1,g),hex=this.hex_with_component(hex,0,b)},component_from_hex:function(hex,componentIndex){return hex>>8*componentIndex&255},hex_with_component:function(hex,componentIndex,value){return value<<(tmpComponent=8*componentIndex)|hex&~(255<<tmpComponent)}}}(),dat.color.toString,dat.utils.common),dat.color.interpret,dat.utils.common),dat.utils.requestAnimationFrame=function(){return window.webkitRequestAnimationFrame||window.mozRequestAnimationFrame||window.oRequestAnimationFrame||window.msRequestAnimationFrame||function(callback,element){window.setTimeout(callback,1e3/60)}}(),dat.dom.CenteredDiv=function(dom,common){var CenteredDiv=function(){this.backgroundElement=document.createElement("div"),common.extend(this.backgroundElement.style,{backgroundColor:"rgba(0,0,0,0.8)",top:0,left:0,display:"none",zIndex:"1000",opacity:0,WebkitTransition:"opacity 0.2s linear"}),dom.makeFullscreen(this.backgroundElement),this.backgroundElement.style.position="fixed",this.domElement=document.createElement("div"),common.extend(this.domElement.style,{position:"fixed",display:"none",zIndex:"1001",opacity:0,WebkitTransition:"-webkit-transform 0.2s ease-out, opacity 0.2s linear"}),document.body.appendChild(this.backgroundElement),document.body.appendChild(this.domElement);var _this=this;dom.bind(this.backgroundElement,"click",function(){_this.hide()})};return CenteredDiv.prototype.show=function(){var _this=this;this.backgroundElement.style.display="block",this.domElement.style.display="block",this.domElement.style.opacity=0,this.domElement.style.webkitTransform="scale(1.1)",this.layout(),common.defer(function(){_this.backgroundElement.style.opacity=1,_this.domElement.style.opacity=1,_this.domElement.style.webkitTransform="scale(1)"})},CenteredDiv.prototype.hide=function(){var _this=this,hide=function(){_this.domElement.style.display="none",_this.backgroundElement.style.display="none",dom.unbind(_this.domElement,"webkitTransitionEnd",hide),dom.unbind(_this.domElement,"transitionend",hide),dom.unbind(_this.domElement,"oTransitionEnd",hide)};dom.bind(this.domElement,"webkitTransitionEnd",hide),dom.bind(this.domElement,"transitionend",hide),dom.bind(this.domElement,"oTransitionEnd",hide),this.backgroundElement.style.opacity=0,this.domElement.style.opacity=0,this.domElement.style.webkitTransform="scale(1.1)"},CenteredDiv.prototype.layout=function(){this.domElement.style.left=window.innerWidth/2-dom.getWidth(this.domElement)/2+"px",this.domElement.style.top=window.innerHeight/2-dom.getHeight(this.domElement)/2+"px"},CenteredDiv}(dat.dom.dom,dat.utils.common),dat.dom.dom,dat.utils.common)},{}],21:[function(require,module,exports){"use strict";function earcut(data,holeIndices,dim){dim=dim||2;var hasHoles=holeIndices&&holeIndices.length,outerLen=hasHoles?holeIndices[0]*dim:data.length,outerNode=filterPoints(linkedList(data,0,outerLen,dim,!0)),triangles=[];if(!outerNode)return triangles;var minX,minY,maxX,maxY,x,y,size;if(hasHoles&&(outerNode=eliminateHoles(data,holeIndices,outerNode,dim)),data.length>80*dim){minX=maxX=data[0],minY=maxY=data[1];for(var i=dim;outerLen>i;i+=dim)x=data[i],y=data[i+1],minX>x&&(minX=x),minY>y&&(minY=y),x>maxX&&(maxX=x),y>maxY&&(maxY=y);size=Math.max(maxX-minX,maxY-minY)}return earcutLinked(outerNode,triangles,dim,minX,minY,size),triangles}function linkedList(data,start,end,dim,clockwise){var i,j,last,sum=0;for(i=start,j=end-dim;end>i;i+=dim)sum+=(data[j]-data[i])*(data[i+1]+data[j+1]),j=i;if(clockwise===sum>0)for(i=start;end>i;i+=dim)last=insertNode(i,data[i],data[i+1],last);else for(i=end-dim;i>=start;i-=dim)last=insertNode(i,data[i],data[i+1],last);return last}function filterPoints(start,end){if(!start)return start;end||(end=start);var again,p=start;do if(again=!1,p.steiner||!equals(p,p.next)&&0!==area(p.prev,p,p.next))p=p.next;else{if(removeNode(p),p=end=p.prev,p===p.next)return null;again=!0}while(again||p!==end);return end}function earcutLinked(ear,triangles,dim,minX,minY,size,pass){if(ear){!pass&&size&&indexCurve(ear,minX,minY,size);for(var prev,next,stop=ear;ear.prev!==ear.next;)if(prev=ear.prev,next=ear.next,size?isEarHashed(ear,minX,minY,size):isEar(ear))triangles.push(prev.i/dim),triangles.push(ear.i/dim),triangles.push(next.i/dim),removeNode(ear),ear=next.next,stop=next.next;else if(ear=next,ear===stop){pass?1===pass?(ear=cureLocalIntersections(ear,triangles,dim),earcutLinked(ear,triangles,dim,minX,minY,size,2)):2===pass&&splitEarcut(ear,triangles,dim,minX,minY,size):earcutLinked(filterPoints(ear),triangles,dim,minX,minY,size,1);break}}}function isEar(ear){var a=ear.prev,b=ear,c=ear.next;if(area(a,b,c)>=0)return!1;for(var p=ear.next.next;p!==ear.prev;){if(pointInTriangle(a.x,a.y,b.x,b.y,c.x,c.y,p.x,p.y)&&area(p.prev,p,p.next)>=0)return!1;p=p.next}return!0}function isEarHashed(ear,minX,minY,size){var a=ear.prev,b=ear,c=ear.next;if(area(a,b,c)>=0)return!1;for(var minTX=a.x<b.x?a.x<c.x?a.x:c.x:b.x<c.x?b.x:c.x,minTY=a.y<b.y?a.y<c.y?a.y:c.y:b.y<c.y?b.y:c.y,maxTX=a.x>b.x?a.x>c.x?a.x:c.x:b.x>c.x?b.x:c.x,maxTY=a.y>b.y?a.y>c.y?a.y:c.y:b.y>c.y?b.y:c.y,minZ=zOrder(minTX,minTY,minX,minY,size),maxZ=zOrder(maxTX,maxTY,minX,minY,size),p=ear.nextZ;p&&p.z<=maxZ;){if(p!==ear.prev&&p!==ear.next&&pointInTriangle(a.x,a.y,b.x,b.y,c.x,c.y,p.x,p.y)&&area(p.prev,p,p.next)>=0)return!1;p=p.nextZ}for(p=ear.prevZ;p&&p.z>=minZ;){if(p!==ear.prev&&p!==ear.next&&pointInTriangle(a.x,a.y,b.x,b.y,c.x,c.y,p.x,p.y)&&area(p.prev,p,p.next)>=0)return!1;p=p.prevZ}return!0}function cureLocalIntersections(start,triangles,dim){var p=start;do{var a=p.prev,b=p.next.next;intersects(a,p,p.next,b)&&locallyInside(a,b)&&locallyInside(b,a)&&(triangles.push(a.i/dim),triangles.push(p.i/dim),triangles.push(b.i/dim),removeNode(p),removeNode(p.next),p=start=b),p=p.next}while(p!==start);return p}function splitEarcut(start,triangles,dim,minX,minY,size){var a=start;do{for(var b=a.next.next;b!==a.prev;){if(a.i!==b.i&&isValidDiagonal(a,b)){var c=splitPolygon(a,b);return a=filterPoints(a,a.next),c=filterPoints(c,c.next),earcutLinked(a,triangles,dim,minX,minY,size),void earcutLinked(c,triangles,dim,minX,minY,size)}b=b.next}a=a.next}while(a!==start)}function eliminateHoles(data,holeIndices,outerNode,dim){var i,len,start,end,list,queue=[];for(i=0,len=holeIndices.length;len>i;i++)start=holeIndices[i]*dim,end=len-1>i?holeIndices[i+1]*dim:data.length,list=linkedList(data,start,end,dim,!1),list===list.next&&(list.steiner=!0),list=filterPoints(list),list&&queue.push(getLeftmost(list));for(queue.sort(compareX),i=0;i<queue.length;i++)eliminateHole(queue[i],outerNode),outerNode=filterPoints(outerNode,outerNode.next);return outerNode}function compareX(a,b){return a.x-b.x}function eliminateHole(hole,outerNode){if(outerNode=findHoleBridge(hole,outerNode)){var b=splitPolygon(outerNode,hole);filterPoints(b,b.next)}}function findHoleBridge(hole,outerNode){var m,p=outerNode,hx=hole.x,hy=hole.y,qx=-(1/0);do{if(hy<=p.y&&hy>=p.next.y){var x=p.x+(hy-p.y)*(p.next.x-p.x)/(p.next.y-p.y);hx>=x&&x>qx&&(qx=x,m=p.x<p.next.x?p:p.next)}p=p.next}while(p!==outerNode);if(!m)return null;var tan,stop=m,tanMin=1/0;for(p=m.next;p!==stop;)hx>=p.x&&p.x>=m.x&&pointInTriangle(hy<m.y?hx:qx,hy,m.x,m.y,hy<m.y?qx:hx,hy,p.x,p.y)&&(tan=Math.abs(hy-p.y)/(hx-p.x),(tanMin>tan||tan===tanMin&&p.x>m.x)&&locallyInside(p,hole)&&(m=p,tanMin=tan)),p=p.next;return m}function indexCurve(start,minX,minY,size){var p=start;do null===p.z&&(p.z=zOrder(p.x,p.y,minX,minY,size)),p.prevZ=p.prev,p.nextZ=p.next,p=p.next;while(p!==start);p.prevZ.nextZ=null,p.prevZ=null,sortLinked(p)}function sortLinked(list){var i,p,q,e,tail,numMerges,pSize,qSize,inSize=1;do{for(p=list,list=null,tail=null,numMerges=0;p;){for(numMerges++,q=p,pSize=0,i=0;inSize>i&&(pSize++,q=q.nextZ,q);i++);for(qSize=inSize;pSize>0||qSize>0&&q;)0===pSize?(e=q,q=q.nextZ,qSize--):0!==qSize&&q?p.z<=q.z?(e=p,p=p.nextZ,pSize--):(e=q,q=q.nextZ,qSize--):(e=p,p=p.nextZ,pSize--),tail?tail.nextZ=e:list=e,e.prevZ=tail,tail=e;p=q}tail.nextZ=null,inSize*=2}while(numMerges>1);return list}function zOrder(x,y,minX,minY,size){return x=32767*(x-minX)/size,y=32767*(y-minY)/size,x=16711935&(x|x<<8),x=252645135&(x|x<<4),x=858993459&(x|x<<2),x=1431655765&(x|x<<1),y=16711935&(y|y<<8),y=252645135&(y|y<<4),y=858993459&(y|y<<2),y=1431655765&(y|y<<1),x|y<<1}function getLeftmost(start){var p=start,leftmost=start;do p.x<leftmost.x&&(leftmost=p),p=p.next;while(p!==start);return leftmost}function pointInTriangle(ax,ay,bx,by,cx,cy,px,py){return(cx-px)*(ay-py)-(ax-px)*(cy-py)>=0&&(ax-px)*(by-py)-(bx-px)*(ay-py)>=0&&(bx-px)*(cy-py)-(cx-px)*(by-py)>=0}function isValidDiagonal(a,b){return equals(a,b)||a.next.i!==b.i&&a.prev.i!==b.i&&!intersectsPolygon(a,b)&&locallyInside(a,b)&&locallyInside(b,a)&&middleInside(a,b)}function area(p,q,r){return(q.y-p.y)*(r.x-q.x)-(q.x-p.x)*(r.y-q.y)}function equals(p1,p2){return p1.x===p2.x&&p1.y===p2.y}function intersects(p1,q1,p2,q2){return area(p1,q1,p2)>0!=area(p1,q1,q2)>0&&area(p2,q2,p1)>0!=area(p2,q2,q1)>0}function intersectsPolygon(a,b){var p=a;do{if(p.i!==a.i&&p.next.i!==a.i&&p.i!==b.i&&p.next.i!==b.i&&intersects(p,p.next,a,b))return!0;p=p.next}while(p!==a);return!1}function locallyInside(a,b){return area(a.prev,a,a.next)<0?area(a,b,a.next)>=0&&area(a,a.prev,b)>=0:area(a,b,a.prev)<0||area(a,a.next,b)<0}function middleInside(a,b){var p=a,inside=!1,px=(a.x+b.x)/2,py=(a.y+b.y)/2;do p.y>py!=p.next.y>py&&px<(p.next.x-p.x)*(py-p.y)/(p.next.y-p.y)+p.x&&(inside=!inside),p=p.next;while(p!==a);return inside}function splitPolygon(a,b){var a2=new Node(a.i,a.x,a.y),b2=new Node(b.i,b.x,b.y),an=a.next,bp=b.prev;return a.next=b,b.prev=a,a2.next=an,an.prev=a2,b2.next=a2,a2.prev=b2,bp.next=b2,b2.prev=bp,b2}function insertNode(i,x,y,last){var p=new Node(i,x,y);return last?(p.next=last.next,p.prev=last,last.next.prev=p,last.next=p):(p.prev=p,p.next=p),p}function removeNode(p){p.next.prev=p.prev,p.prev.next=p.next,p.prevZ&&(p.prevZ.nextZ=p.nextZ),p.nextZ&&(p.nextZ.prevZ=p.prevZ)}function Node(i,x,y){this.i=i,this.x=x,this.y=y,this.prev=null,this.next=null,this.z=null,this.prevZ=null,this.nextZ=null,this.steiner=!1}module.exports=earcut},{}],22:[function(require,module,exports){"use strict";function EE(fn,context,once){this.fn=fn,this.context=context,this.once=once||!1}function EventEmitter(){}var prefix="function"!=typeof Object.create?"~":!1;EventEmitter.prototype._events=void 0,EventEmitter.prototype.listeners=function(event,exists){var evt=prefix?prefix+event:event,available=this._events&&this._events[evt];if(exists)return!!available;if(!available)return[];if(available.fn)return[available.fn];for(var i=0,l=available.length,ee=new Array(l);l>i;i++)ee[i]=available[i].fn;return ee},EventEmitter.prototype.emit=function(event,a1,a2,a3,a4,a5){var evt=prefix?prefix+event:event;if(!this._events||!this._events[evt])return!1;var args,i,listeners=this._events[evt],len=arguments.length;if("function"==typeof listeners.fn){switch(listeners.once&&this.removeListener(event,listeners.fn,void 0,!0),len){case 1:return listeners.fn.call(listeners.context),!0;case 2:return listeners.fn.call(listeners.context,a1),!0;case 3:return listeners.fn.call(listeners.context,a1,a2),!0;case 4:return listeners.fn.call(listeners.context,a1,a2,a3),!0;case 5:return listeners.fn.call(listeners.context,a1,a2,a3,a4),!0;case 6:return listeners.fn.call(listeners.context,a1,a2,a3,a4,a5),!0}for(i=1,args=new Array(len-1);len>i;i++)args[i-1]=arguments[i];listeners.fn.apply(listeners.context,args)}else{var j,length=listeners.length;for(i=0;length>i;i++)switch(listeners[i].once&&this.removeListener(event,listeners[i].fn,void 0,!0),len){case 1:listeners[i].fn.call(listeners[i].context);break;case 2:listeners[i].fn.call(listeners[i].context,a1);break;case 3:listeners[i].fn.call(listeners[i].context,a1,a2);break;default:if(!args)for(j=1,args=new Array(len-1);len>j;j++)args[j-1]=arguments[j];listeners[i].fn.apply(listeners[i].context,args)}}return!0},EventEmitter.prototype.on=function(event,fn,context){var listener=new EE(fn,context||this),evt=prefix?prefix+event:event;return this._events||(this._events=prefix?{}:Object.create(null)),this._events[evt]?this._events[evt].fn?this._events[evt]=[this._events[evt],listener]:this._events[evt].push(listener):this._events[evt]=listener,this},EventEmitter.prototype.once=function(event,fn,context){var listener=new EE(fn,context||this,!0),evt=prefix?prefix+event:event;return this._events||(this._events=prefix?{}:Object.create(null)),this._events[evt]?this._events[evt].fn?this._events[evt]=[this._events[evt],listener]:this._events[evt].push(listener):this._events[evt]=listener,this},EventEmitter.prototype.removeListener=function(event,fn,context,once){var evt=prefix?prefix+event:event;if(!this._events||!this._events[evt])return this;var listeners=this._events[evt],events=[];if(fn)if(listeners.fn)(listeners.fn!==fn||once&&!listeners.once||context&&listeners.context!==context)&&events.push(listeners);else for(var i=0,length=listeners.length;length>i;i++)(listeners[i].fn!==fn||once&&!listeners[i].once||context&&listeners[i].context!==context)&&events.push(listeners[i]);return events.length?this._events[evt]=1===events.length?events[0]:events:delete this._events[evt],this},EventEmitter.prototype.removeAllListeners=function(event){return this._events?(event?delete this._events[prefix?prefix+event:event]:this._events=prefix?{}:Object.create(null),this):this},EventEmitter.prototype.off=EventEmitter.prototype.removeListener,EventEmitter.prototype.addListener=EventEmitter.prototype.on,EventEmitter.prototype.setMaxListeners=function(){return this},EventEmitter.prefixed=prefix,"undefined"!=typeof module&&(module.exports=EventEmitter)},{}],23:[function(require,module,exports){exports.read=function(buffer,offset,isLE,mLen,nBytes){var e,m,eLen=8*nBytes-mLen-1,eMax=(1<<eLen)-1,eBias=eMax>>1,nBits=-7,i=isLE?nBytes-1:0,d=isLE?-1:1,s=buffer[offset+i];for(i+=d,e=s&(1<<-nBits)-1,s>>=-nBits,nBits+=eLen;nBits>0;e=256*e+buffer[offset+i],i+=d,nBits-=8);for(m=e&(1<<-nBits)-1,e>>=-nBits,nBits+=mLen;nBits>0;m=256*m+buffer[offset+i],i+=d,nBits-=8);if(0===e)e=1-eBias;else{if(e===eMax)return m?NaN:(s?-1:1)*(1/0);m+=Math.pow(2,mLen),e-=eBias}return(s?-1:1)*m*Math.pow(2,e-mLen)},exports.write=function(buffer,value,offset,isLE,mLen,nBytes){var e,m,c,eLen=8*nBytes-mLen-1,eMax=(1<<eLen)-1,eBias=eMax>>1,rt=23===mLen?Math.pow(2,-24)-Math.pow(2,-77):0,i=isLE?0:nBytes-1,d=isLE?1:-1,s=0>value||0===value&&0>1/value?1:0;for(value=Math.abs(value),isNaN(value)||value===1/0?(m=isNaN(value)?1:0,e=eMax):(e=Math.floor(Math.log(value)/Math.LN2),value*(c=Math.pow(2,-e))<1&&(e--,c*=2),value+=e+eBias>=1?rt/c:rt*Math.pow(2,1-eBias),value*c>=2&&(e++,c/=2),e+eBias>=eMax?(m=0,e=eMax):e+eBias>=1?(m=(value*c-1)*Math.pow(2,mLen),e+=eBias):(m=value*Math.pow(2,eBias-1)*Math.pow(2,mLen),e=0));mLen>=8;buffer[offset+i]=255&m,i+=d,m/=256,mLen-=8);for(e=e<<mLen|m,eLen+=mLen;eLen>0;buffer[offset+i]=255&e,i+=d,e/=256,eLen-=8);buffer[offset+i-d]|=128*s}},{}],24:[function(require,module,exports){var isArray=Array.isArray,str=Object.prototype.toString;module.exports=isArray||function(val){return!!val&&"[object Array]"==str.call(val)}},{}],25:[function(require,module,exports){(function(global){(function(){function baseCompareAscending(value,other){if(value!==other){var valIsNull=null===value,valIsUndef=value===undefined,valIsReflexive=value===value,othIsNull=null===other,othIsUndef=other===undefined,othIsReflexive=other===other;if(value>other&&!othIsNull||!valIsReflexive||valIsNull&&!othIsUndef&&othIsReflexive||valIsUndef&&othIsReflexive)return 1;if(other>value&&!valIsNull||!othIsReflexive||othIsNull&&!valIsUndef&&valIsReflexive||othIsUndef&&valIsReflexive)return-1}return 0}function baseFindIndex(array,predicate,fromRight){for(var length=array.length,index=fromRight?length:-1;fromRight?index--:++index<length;)if(predicate(array[index],index,array))return index;return-1}function baseIndexOf(array,value,fromIndex){if(value!==value)return indexOfNaN(array,fromIndex);for(var index=fromIndex-1,length=array.length;++index<length;)if(array[index]===value)return index;return-1}function baseIsFunction(value){return"function"==typeof value||!1}function baseToString(value){return null==value?"":value+""}function charsLeftIndex(string,chars){for(var index=-1,length=string.length;++index<length&&chars.indexOf(string.charAt(index))>-1;);return index}function charsRightIndex(string,chars){for(var index=string.length;index--&&chars.indexOf(string.charAt(index))>-1;);return index}function compareAscending(object,other){return baseCompareAscending(object.criteria,other.criteria)||object.index-other.index}function compareMultiple(object,other,orders){for(var index=-1,objCriteria=object.criteria,othCriteria=other.criteria,length=objCriteria.length,ordersLength=orders.length;++index<length;){var result=baseCompareAscending(objCriteria[index],othCriteria[index]);if(result){if(index>=ordersLength)return result;var order=orders[index];return result*("asc"===order||order===!0?1:-1)}}return object.index-other.index}function deburrLetter(letter){return deburredLetters[letter]}function escapeHtmlChar(chr){return htmlEscapes[chr]}function escapeRegExpChar(chr,leadingChar,whitespaceChar){return leadingChar?chr=regexpEscapes[chr]:whitespaceChar&&(chr=stringEscapes[chr]),"\\"+chr}function escapeStringChar(chr){return"\\"+stringEscapes[chr]}function indexOfNaN(array,fromIndex,fromRight){for(var length=array.length,index=fromIndex+(fromRight?0:-1);fromRight?index--:++index<length;){var other=array[index];if(other!==other)return index}return-1}function isObjectLike(value){return!!value&&"object"==typeof value}function isSpace(charCode){return 160>=charCode&&charCode>=9&&13>=charCode||32==charCode||160==charCode||5760==charCode||6158==charCode||charCode>=8192&&(8202>=charCode||8232==charCode||8233==charCode||8239==charCode||8287==charCode||12288==charCode||65279==charCode)}function replaceHolders(array,placeholder){for(var index=-1,length=array.length,resIndex=-1,result=[];++index<length;)array[index]===placeholder&&(array[index]=PLACEHOLDER,result[++resIndex]=index);return result}function sortedUniq(array,iteratee){for(var seen,index=-1,length=array.length,resIndex=-1,result=[];++index<length;){var value=array[index],computed=iteratee?iteratee(value,index,array):value;index&&seen===computed||(seen=computed,result[++resIndex]=value)}return result}function trimmedLeftIndex(string){for(var index=-1,length=string.length;++index<length&&isSpace(string.charCodeAt(index)););return index}function trimmedRightIndex(string){for(var index=string.length;index--&&isSpace(string.charCodeAt(index)););return index}function unescapeHtmlChar(chr){return htmlUnescapes[chr]}function runInContext(context){function lodash(value){if(isObjectLike(value)&&!isArray(value)&&!(value instanceof LazyWrapper)){if(value instanceof LodashWrapper)return value;if(hasOwnProperty.call(value,"__chain__")&&hasOwnProperty.call(value,"__wrapped__"))return wrapperClone(value)}return new LodashWrapper(value)}function baseLodash(){}function LodashWrapper(value,chainAll,actions){this.__wrapped__=value,this.__actions__=actions||[],this.__chain__=!!chainAll}function LazyWrapper(value){this.__wrapped__=value,this.__actions__=[],this.__dir__=1,this.__filtered__=!1,this.__iteratees__=[],this.__takeCount__=POSITIVE_INFINITY,this.__views__=[]}function lazyClone(){var result=new LazyWrapper(this.__wrapped__);return result.__actions__=arrayCopy(this.__actions__),result.__dir__=this.__dir__,result.__filtered__=this.__filtered__,result.__iteratees__=arrayCopy(this.__iteratees__),result.__takeCount__=this.__takeCount__,result.__views__=arrayCopy(this.__views__),result}function lazyReverse(){if(this.__filtered__){var result=new LazyWrapper(this);result.__dir__=-1,result.__filtered__=!0}else result=this.clone(),result.__dir__*=-1;return result}function lazyValue(){var array=this.__wrapped__.value(),dir=this.__dir__,isArr=isArray(array),isRight=0>dir,arrLength=isArr?array.length:0,view=getView(0,arrLength,this.__views__),start=view.start,end=view.end,length=end-start,index=isRight?end:start-1,iteratees=this.__iteratees__,iterLength=iteratees.length,resIndex=0,takeCount=nativeMin(length,this.__takeCount__);if(!isArr||LARGE_ARRAY_SIZE>arrLength||arrLength==length&&takeCount==length)return baseWrapperValue(isRight&&isArr?array.reverse():array,this.__actions__);var result=[];outer:for(;length--&&takeCount>resIndex;){index+=dir;for(var iterIndex=-1,value=array[index];++iterIndex<iterLength;){var data=iteratees[iterIndex],iteratee=data.iteratee,type=data.type,computed=iteratee(value);if(type==LAZY_MAP_FLAG)value=computed;else if(!computed){if(type==LAZY_FILTER_FLAG)continue outer;break outer}}result[resIndex++]=value}return result}function MapCache(){this.__data__={}}function mapDelete(key){return this.has(key)&&delete this.__data__[key]}function mapGet(key){return"__proto__"==key?undefined:this.__data__[key]}function mapHas(key){return"__proto__"!=key&&hasOwnProperty.call(this.__data__,key)}function mapSet(key,value){return"__proto__"!=key&&(this.__data__[key]=value),this}function SetCache(values){var length=values?values.length:0;for(this.data={hash:nativeCreate(null),set:new Set};length--;)this.push(values[length])}function cacheIndexOf(cache,value){var data=cache.data,result="string"==typeof value||isObject(value)?data.set.has(value):data.hash[value];return result?0:-1}function cachePush(value){var data=this.data;"string"==typeof value||isObject(value)?data.set.add(value):data.hash[value]=!0}function arrayConcat(array,other){for(var index=-1,length=array.length,othIndex=-1,othLength=other.length,result=Array(length+othLength);++index<length;)result[index]=array[index];for(;++othIndex<othLength;)result[index++]=other[othIndex];return result}function arrayCopy(source,array){var index=-1,length=source.length;for(array||(array=Array(length));++index<length;)array[index]=source[index];return array}function arrayEach(array,iteratee){for(var index=-1,length=array.length;++index<length&&iteratee(array[index],index,array)!==!1;);return array}function arrayEachRight(array,iteratee){for(var length=array.length;length--&&iteratee(array[length],length,array)!==!1;);return array}function arrayEvery(array,predicate){for(var index=-1,length=array.length;++index<length;)if(!predicate(array[index],index,array))return!1;return!0}function arrayExtremum(array,iteratee,comparator,exValue){for(var index=-1,length=array.length,computed=exValue,result=computed;++index<length;){var value=array[index],current=+iteratee(value);comparator(current,computed)&&(computed=current,result=value)}return result}function arrayFilter(array,predicate){for(var index=-1,length=array.length,resIndex=-1,result=[];++index<length;){var value=array[index];predicate(value,index,array)&&(result[++resIndex]=value)}return result}function arrayMap(array,iteratee){for(var index=-1,length=array.length,result=Array(length);++index<length;)result[index]=iteratee(array[index],index,array);return result}function arrayPush(array,values){for(var index=-1,length=values.length,offset=array.length;++index<length;)array[offset+index]=values[index];return array}function arrayReduce(array,iteratee,accumulator,initFromArray){var index=-1,length=array.length;for(initFromArray&&length&&(accumulator=array[++index]);++index<length;)accumulator=iteratee(accumulator,array[index],index,array);return accumulator}function arrayReduceRight(array,iteratee,accumulator,initFromArray){var length=array.length;for(initFromArray&&length&&(accumulator=array[--length]);length--;)accumulator=iteratee(accumulator,array[length],length,array);return accumulator}function arraySome(array,predicate){for(var index=-1,length=array.length;++index<length;)if(predicate(array[index],index,array))return!0;return!1}function arraySum(array,iteratee){for(var length=array.length,result=0;length--;)result+=+iteratee(array[length])||0;return result}function assignDefaults(objectValue,sourceValue){return objectValue===undefined?sourceValue:objectValue}function assignOwnDefaults(objectValue,sourceValue,key,object){return objectValue!==undefined&&hasOwnProperty.call(object,key)?objectValue:sourceValue}function assignWith(object,source,customizer){for(var index=-1,props=keys(source),length=props.length;++index<length;){var key=props[index],value=object[key],result=customizer(value,source[key],key,object,source);(result===result?result===value:value!==value)&&(value!==undefined||key in object)||(object[key]=result)}return object}function baseAssign(object,source){return null==source?object:baseCopy(source,keys(source),object)}function baseAt(collection,props){for(var index=-1,isNil=null==collection,isArr=!isNil&&isArrayLike(collection),length=isArr?collection.length:0,propsLength=props.length,result=Array(propsLength);++index<propsLength;){var key=props[index];isArr?result[index]=isIndex(key,length)?collection[key]:undefined:result[index]=isNil?undefined:collection[key]}return result}function baseCopy(source,props,object){object||(object={});for(var index=-1,length=props.length;++index<length;){var key=props[index];object[key]=source[key]}return object}function baseCallback(func,thisArg,argCount){var type=typeof func;return"function"==type?thisArg===undefined?func:bindCallback(func,thisArg,argCount):null==func?identity:"object"==type?baseMatches(func):thisArg===undefined?property(func):baseMatchesProperty(func,thisArg)}function baseClone(value,isDeep,customizer,key,object,stackA,stackB){var result;if(customizer&&(result=object?customizer(value,key,object):customizer(value)),result!==undefined)return result;if(!isObject(value))return value;var isArr=isArray(value);if(isArr){if(result=initCloneArray(value),!isDeep)return arrayCopy(value,result)}else{var tag=objToString.call(value),isFunc=tag==funcTag;if(tag!=objectTag&&tag!=argsTag&&(!isFunc||object))return cloneableTags[tag]?initCloneByTag(value,tag,isDeep):object?value:{};if(result=initCloneObject(isFunc?{}:value),!isDeep)return baseAssign(result,value)}stackA||(stackA=[]),stackB||(stackB=[]);for(var length=stackA.length;length--;)if(stackA[length]==value)return stackB[length];return stackA.push(value),stackB.push(result),(isArr?arrayEach:baseForOwn)(value,function(subValue,key){result[key]=baseClone(subValue,isDeep,customizer,key,value,stackA,stackB)}),result}function baseDelay(func,wait,args){if("function"!=typeof func)throw new TypeError(FUNC_ERROR_TEXT);
return setTimeout(function(){func.apply(undefined,args)},wait)}function baseDifference(array,values){var length=array?array.length:0,result=[];if(!length)return result;var index=-1,indexOf=getIndexOf(),isCommon=indexOf==baseIndexOf,cache=isCommon&&values.length>=LARGE_ARRAY_SIZE?createCache(values):null,valuesLength=values.length;cache&&(indexOf=cacheIndexOf,isCommon=!1,values=cache);outer:for(;++index<length;){var value=array[index];if(isCommon&&value===value){for(var valuesIndex=valuesLength;valuesIndex--;)if(values[valuesIndex]===value)continue outer;result.push(value)}else indexOf(values,value,0)<0&&result.push(value)}return result}function baseEvery(collection,predicate){var result=!0;return baseEach(collection,function(value,index,collection){return result=!!predicate(value,index,collection)}),result}function baseExtremum(collection,iteratee,comparator,exValue){var computed=exValue,result=computed;return baseEach(collection,function(value,index,collection){var current=+iteratee(value,index,collection);(comparator(current,computed)||current===exValue&&current===result)&&(computed=current,result=value)}),result}function baseFill(array,value,start,end){var length=array.length;for(start=null==start?0:+start||0,0>start&&(start=-start>length?0:length+start),end=end===undefined||end>length?length:+end||0,0>end&&(end+=length),length=start>end?0:end>>>0,start>>>=0;length>start;)array[start++]=value;return array}function baseFilter(collection,predicate){var result=[];return baseEach(collection,function(value,index,collection){predicate(value,index,collection)&&result.push(value)}),result}function baseFind(collection,predicate,eachFunc,retKey){var result;return eachFunc(collection,function(value,key,collection){return predicate(value,key,collection)?(result=retKey?key:value,!1):void 0}),result}function baseFlatten(array,isDeep,isStrict,result){result||(result=[]);for(var index=-1,length=array.length;++index<length;){var value=array[index];isObjectLike(value)&&isArrayLike(value)&&(isStrict||isArray(value)||isArguments(value))?isDeep?baseFlatten(value,isDeep,isStrict,result):arrayPush(result,value):isStrict||(result[result.length]=value)}return result}function baseForIn(object,iteratee){return baseFor(object,iteratee,keysIn)}function baseForOwn(object,iteratee){return baseFor(object,iteratee,keys)}function baseForOwnRight(object,iteratee){return baseForRight(object,iteratee,keys)}function baseFunctions(object,props){for(var index=-1,length=props.length,resIndex=-1,result=[];++index<length;){var key=props[index];isFunction(object[key])&&(result[++resIndex]=key)}return result}function baseGet(object,path,pathKey){if(null!=object){pathKey!==undefined&&pathKey in toObject(object)&&(path=[pathKey]);for(var index=0,length=path.length;null!=object&&length>index;)object=object[path[index++]];return index&&index==length?object:undefined}}function baseIsEqual(value,other,customizer,isLoose,stackA,stackB){return value===other?!0:null==value||null==other||!isObject(value)&&!isObjectLike(other)?value!==value&&other!==other:baseIsEqualDeep(value,other,baseIsEqual,customizer,isLoose,stackA,stackB)}function baseIsEqualDeep(object,other,equalFunc,customizer,isLoose,stackA,stackB){var objIsArr=isArray(object),othIsArr=isArray(other),objTag=arrayTag,othTag=arrayTag;objIsArr||(objTag=objToString.call(object),objTag==argsTag?objTag=objectTag:objTag!=objectTag&&(objIsArr=isTypedArray(object))),othIsArr||(othTag=objToString.call(other),othTag==argsTag?othTag=objectTag:othTag!=objectTag&&(othIsArr=isTypedArray(other)));var objIsObj=objTag==objectTag,othIsObj=othTag==objectTag,isSameTag=objTag==othTag;if(isSameTag&&!objIsArr&&!objIsObj)return equalByTag(object,other,objTag);if(!isLoose){var objIsWrapped=objIsObj&&hasOwnProperty.call(object,"__wrapped__"),othIsWrapped=othIsObj&&hasOwnProperty.call(other,"__wrapped__");if(objIsWrapped||othIsWrapped)return equalFunc(objIsWrapped?object.value():object,othIsWrapped?other.value():other,customizer,isLoose,stackA,stackB)}if(!isSameTag)return!1;stackA||(stackA=[]),stackB||(stackB=[]);for(var length=stackA.length;length--;)if(stackA[length]==object)return stackB[length]==other;stackA.push(object),stackB.push(other);var result=(objIsArr?equalArrays:equalObjects)(object,other,equalFunc,customizer,isLoose,stackA,stackB);return stackA.pop(),stackB.pop(),result}function baseIsMatch(object,matchData,customizer){var index=matchData.length,length=index,noCustomizer=!customizer;if(null==object)return!length;for(object=toObject(object);index--;){var data=matchData[index];if(noCustomizer&&data[2]?data[1]!==object[data[0]]:!(data[0]in object))return!1}for(;++index<length;){data=matchData[index];var key=data[0],objValue=object[key],srcValue=data[1];if(noCustomizer&&data[2]){if(objValue===undefined&&!(key in object))return!1}else{var result=customizer?customizer(objValue,srcValue,key):undefined;if(!(result===undefined?baseIsEqual(srcValue,objValue,customizer,!0):result))return!1}}return!0}function baseMap(collection,iteratee){var index=-1,result=isArrayLike(collection)?Array(collection.length):[];return baseEach(collection,function(value,key,collection){result[++index]=iteratee(value,key,collection)}),result}function baseMatches(source){var matchData=getMatchData(source);if(1==matchData.length&&matchData[0][2]){var key=matchData[0][0],value=matchData[0][1];return function(object){return null==object?!1:object[key]===value&&(value!==undefined||key in toObject(object))}}return function(object){return baseIsMatch(object,matchData)}}function baseMatchesProperty(path,srcValue){var isArr=isArray(path),isCommon=isKey(path)&&isStrictComparable(srcValue),pathKey=path+"";return path=toPath(path),function(object){if(null==object)return!1;var key=pathKey;if(object=toObject(object),(isArr||!isCommon)&&!(key in object)){if(object=1==path.length?object:baseGet(object,baseSlice(path,0,-1)),null==object)return!1;key=last(path),object=toObject(object)}return object[key]===srcValue?srcValue!==undefined||key in object:baseIsEqual(srcValue,object[key],undefined,!0)}}function baseMerge(object,source,customizer,stackA,stackB){if(!isObject(object))return object;var isSrcArr=isArrayLike(source)&&(isArray(source)||isTypedArray(source)),props=isSrcArr?undefined:keys(source);return arrayEach(props||source,function(srcValue,key){if(props&&(key=srcValue,srcValue=source[key]),isObjectLike(srcValue))stackA||(stackA=[]),stackB||(stackB=[]),baseMergeDeep(object,source,key,baseMerge,customizer,stackA,stackB);else{var value=object[key],result=customizer?customizer(value,srcValue,key,object,source):undefined,isCommon=result===undefined;isCommon&&(result=srcValue),result===undefined&&(!isSrcArr||key in object)||!isCommon&&(result===result?result===value:value!==value)||(object[key]=result)}}),object}function baseMergeDeep(object,source,key,mergeFunc,customizer,stackA,stackB){for(var length=stackA.length,srcValue=source[key];length--;)if(stackA[length]==srcValue)return void(object[key]=stackB[length]);var value=object[key],result=customizer?customizer(value,srcValue,key,object,source):undefined,isCommon=result===undefined;isCommon&&(result=srcValue,isArrayLike(srcValue)&&(isArray(srcValue)||isTypedArray(srcValue))?result=isArray(value)?value:isArrayLike(value)?arrayCopy(value):[]:isPlainObject(srcValue)||isArguments(srcValue)?result=isArguments(value)?toPlainObject(value):isPlainObject(value)?value:{}:isCommon=!1),stackA.push(srcValue),stackB.push(result),isCommon?object[key]=mergeFunc(result,srcValue,customizer,stackA,stackB):(result===result?result!==value:value===value)&&(object[key]=result)}function baseProperty(key){return function(object){return null==object?undefined:object[key]}}function basePropertyDeep(path){var pathKey=path+"";return path=toPath(path),function(object){return baseGet(object,path,pathKey)}}function basePullAt(array,indexes){for(var length=array?indexes.length:0;length--;){var index=indexes[length];if(index!=previous&&isIndex(index)){var previous=index;splice.call(array,index,1)}}return array}function baseRandom(min,max){return min+nativeFloor(nativeRandom()*(max-min+1))}function baseReduce(collection,iteratee,accumulator,initFromCollection,eachFunc){return eachFunc(collection,function(value,index,collection){accumulator=initFromCollection?(initFromCollection=!1,value):iteratee(accumulator,value,index,collection)}),accumulator}function baseSlice(array,start,end){var index=-1,length=array.length;start=null==start?0:+start||0,0>start&&(start=-start>length?0:length+start),end=end===undefined||end>length?length:+end||0,0>end&&(end+=length),length=start>end?0:end-start>>>0,start>>>=0;for(var result=Array(length);++index<length;)result[index]=array[index+start];return result}function baseSome(collection,predicate){var result;return baseEach(collection,function(value,index,collection){return result=predicate(value,index,collection),!result}),!!result}function baseSortBy(array,comparer){var length=array.length;for(array.sort(comparer);length--;)array[length]=array[length].value;return array}function baseSortByOrder(collection,iteratees,orders){var callback=getCallback(),index=-1;iteratees=arrayMap(iteratees,function(iteratee){return callback(iteratee)});var result=baseMap(collection,function(value){var criteria=arrayMap(iteratees,function(iteratee){return iteratee(value)});return{criteria:criteria,index:++index,value:value}});return baseSortBy(result,function(object,other){return compareMultiple(object,other,orders)})}function baseSum(collection,iteratee){var result=0;return baseEach(collection,function(value,index,collection){result+=+iteratee(value,index,collection)||0}),result}function baseUniq(array,iteratee){var index=-1,indexOf=getIndexOf(),length=array.length,isCommon=indexOf==baseIndexOf,isLarge=isCommon&&length>=LARGE_ARRAY_SIZE,seen=isLarge?createCache():null,result=[];seen?(indexOf=cacheIndexOf,isCommon=!1):(isLarge=!1,seen=iteratee?[]:result);outer:for(;++index<length;){var value=array[index],computed=iteratee?iteratee(value,index,array):value;if(isCommon&&value===value){for(var seenIndex=seen.length;seenIndex--;)if(seen[seenIndex]===computed)continue outer;iteratee&&seen.push(computed),result.push(value)}else indexOf(seen,computed,0)<0&&((iteratee||isLarge)&&seen.push(computed),result.push(value))}return result}function baseValues(object,props){for(var index=-1,length=props.length,result=Array(length);++index<length;)result[index]=object[props[index]];return result}function baseWhile(array,predicate,isDrop,fromRight){for(var length=array.length,index=fromRight?length:-1;(fromRight?index--:++index<length)&&predicate(array[index],index,array););return isDrop?baseSlice(array,fromRight?0:index,fromRight?index+1:length):baseSlice(array,fromRight?index+1:0,fromRight?length:index)}function baseWrapperValue(value,actions){var result=value;result instanceof LazyWrapper&&(result=result.value());for(var index=-1,length=actions.length;++index<length;){var action=actions[index];result=action.func.apply(action.thisArg,arrayPush([result],action.args))}return result}function binaryIndex(array,value,retHighest){var low=0,high=array?array.length:low;if("number"==typeof value&&value===value&&HALF_MAX_ARRAY_LENGTH>=high){for(;high>low;){var mid=low+high>>>1,computed=array[mid];(retHighest?value>=computed:value>computed)&&null!==computed?low=mid+1:high=mid}return high}return binaryIndexBy(array,value,identity,retHighest)}function binaryIndexBy(array,value,iteratee,retHighest){value=iteratee(value);for(var low=0,high=array?array.length:0,valIsNaN=value!==value,valIsNull=null===value,valIsUndef=value===undefined;high>low;){var mid=nativeFloor((low+high)/2),computed=iteratee(array[mid]),isDef=computed!==undefined,isReflexive=computed===computed;if(valIsNaN)var setLow=isReflexive||retHighest;else setLow=valIsNull?isReflexive&&isDef&&(retHighest||null!=computed):valIsUndef?isReflexive&&(retHighest||isDef):null==computed?!1:retHighest?value>=computed:value>computed;setLow?low=mid+1:high=mid}return nativeMin(high,MAX_ARRAY_INDEX)}function bindCallback(func,thisArg,argCount){if("function"!=typeof func)return identity;if(thisArg===undefined)return func;switch(argCount){case 1:return function(value){return func.call(thisArg,value)};case 3:return function(value,index,collection){return func.call(thisArg,value,index,collection)};case 4:return function(accumulator,value,index,collection){return func.call(thisArg,accumulator,value,index,collection)};case 5:return function(value,other,key,object,source){return func.call(thisArg,value,other,key,object,source)}}return function(){return func.apply(thisArg,arguments)}}function bufferClone(buffer){var result=new ArrayBuffer(buffer.byteLength),view=new Uint8Array(result);return view.set(new Uint8Array(buffer)),result}function composeArgs(args,partials,holders){for(var holdersLength=holders.length,argsIndex=-1,argsLength=nativeMax(args.length-holdersLength,0),leftIndex=-1,leftLength=partials.length,result=Array(leftLength+argsLength);++leftIndex<leftLength;)result[leftIndex]=partials[leftIndex];for(;++argsIndex<holdersLength;)result[holders[argsIndex]]=args[argsIndex];for(;argsLength--;)result[leftIndex++]=args[argsIndex++];return result}function composeArgsRight(args,partials,holders){for(var holdersIndex=-1,holdersLength=holders.length,argsIndex=-1,argsLength=nativeMax(args.length-holdersLength,0),rightIndex=-1,rightLength=partials.length,result=Array(argsLength+rightLength);++argsIndex<argsLength;)result[argsIndex]=args[argsIndex];for(var offset=argsIndex;++rightIndex<rightLength;)result[offset+rightIndex]=partials[rightIndex];for(;++holdersIndex<holdersLength;)result[offset+holders[holdersIndex]]=args[argsIndex++];return result}function createAggregator(setter,initializer){return function(collection,iteratee,thisArg){var result=initializer?initializer():{};if(iteratee=getCallback(iteratee,thisArg,3),isArray(collection))for(var index=-1,length=collection.length;++index<length;){var value=collection[index];setter(result,value,iteratee(value,index,collection),collection)}else baseEach(collection,function(value,key,collection){setter(result,value,iteratee(value,key,collection),collection)});return result}}function createAssigner(assigner){return restParam(function(object,sources){var index=-1,length=null==object?0:sources.length,customizer=length>2?sources[length-2]:undefined,guard=length>2?sources[2]:undefined,thisArg=length>1?sources[length-1]:undefined;for("function"==typeof customizer?(customizer=bindCallback(customizer,thisArg,5),length-=2):(customizer="function"==typeof thisArg?thisArg:undefined,length-=customizer?1:0),guard&&isIterateeCall(sources[0],sources[1],guard)&&(customizer=3>length?undefined:customizer,length=1);++index<length;){var source=sources[index];source&&assigner(object,source,customizer)}return object})}function createBaseEach(eachFunc,fromRight){return function(collection,iteratee){var length=collection?getLength(collection):0;if(!isLength(length))return eachFunc(collection,iteratee);for(var index=fromRight?length:-1,iterable=toObject(collection);(fromRight?index--:++index<length)&&iteratee(iterable[index],index,iterable)!==!1;);return collection}}function createBaseFor(fromRight){return function(object,iteratee,keysFunc){for(var iterable=toObject(object),props=keysFunc(object),length=props.length,index=fromRight?length:-1;fromRight?index--:++index<length;){var key=props[index];if(iteratee(iterable[key],key,iterable)===!1)break}return object}}function createBindWrapper(func,thisArg){function wrapper(){var fn=this&&this!==root&&this instanceof wrapper?Ctor:func;return fn.apply(thisArg,arguments)}var Ctor=createCtorWrapper(func);return wrapper}function createCache(values){return nativeCreate&&Set?new SetCache(values):null}function createCompounder(callback){return function(string){for(var index=-1,array=words(deburr(string)),length=array.length,result="";++index<length;)result=callback(result,array[index],index);return result}}function createCtorWrapper(Ctor){return function(){var args=arguments;switch(args.length){case 0:return new Ctor;case 1:return new Ctor(args[0]);case 2:return new Ctor(args[0],args[1]);case 3:return new Ctor(args[0],args[1],args[2]);case 4:return new Ctor(args[0],args[1],args[2],args[3]);case 5:return new Ctor(args[0],args[1],args[2],args[3],args[4]);case 6:return new Ctor(args[0],args[1],args[2],args[3],args[4],args[5]);case 7:return new Ctor(args[0],args[1],args[2],args[3],args[4],args[5],args[6])}var thisBinding=baseCreate(Ctor.prototype),result=Ctor.apply(thisBinding,args);return isObject(result)?result:thisBinding}}function createCurry(flag){function curryFunc(func,arity,guard){guard&&isIterateeCall(func,arity,guard)&&(arity=undefined);var result=createWrapper(func,flag,undefined,undefined,undefined,undefined,undefined,arity);return result.placeholder=curryFunc.placeholder,result}return curryFunc}function createDefaults(assigner,customizer){return restParam(function(args){var object=args[0];return null==object?object:(args.push(customizer),assigner.apply(undefined,args))})}function createExtremum(comparator,exValue){return function(collection,iteratee,thisArg){if(thisArg&&isIterateeCall(collection,iteratee,thisArg)&&(iteratee=undefined),iteratee=getCallback(iteratee,thisArg,3),1==iteratee.length){collection=isArray(collection)?collection:toIterable(collection);var result=arrayExtremum(collection,iteratee,comparator,exValue);if(!collection.length||result!==exValue)return result}return baseExtremum(collection,iteratee,comparator,exValue)}}function createFind(eachFunc,fromRight){return function(collection,predicate,thisArg){if(predicate=getCallback(predicate,thisArg,3),isArray(collection)){var index=baseFindIndex(collection,predicate,fromRight);return index>-1?collection[index]:undefined}return baseFind(collection,predicate,eachFunc)}}function createFindIndex(fromRight){return function(array,predicate,thisArg){return array&&array.length?(predicate=getCallback(predicate,thisArg,3),baseFindIndex(array,predicate,fromRight)):-1}}function createFindKey(objectFunc){return function(object,predicate,thisArg){return predicate=getCallback(predicate,thisArg,3),baseFind(object,predicate,objectFunc,!0)}}function createFlow(fromRight){return function(){for(var wrapper,length=arguments.length,index=fromRight?length:-1,leftIndex=0,funcs=Array(length);fromRight?index--:++index<length;){var func=funcs[leftIndex++]=arguments[index];if("function"!=typeof func)throw new TypeError(FUNC_ERROR_TEXT);!wrapper&&LodashWrapper.prototype.thru&&"wrapper"==getFuncName(func)&&(wrapper=new LodashWrapper([],!0))}for(index=wrapper?-1:length;++index<length;){func=funcs[index];var funcName=getFuncName(func),data="wrapper"==funcName?getData(func):undefined;wrapper=data&&isLaziable(data[0])&&data[1]==(ARY_FLAG|CURRY_FLAG|PARTIAL_FLAG|REARG_FLAG)&&!data[4].length&&1==data[9]?wrapper[getFuncName(data[0])].apply(wrapper,data[3]):1==func.length&&isLaziable(func)?wrapper[funcName]():wrapper.thru(func)}return function(){var args=arguments,value=args[0];if(wrapper&&1==args.length&&isArray(value)&&value.length>=LARGE_ARRAY_SIZE)return wrapper.plant(value).value();for(var index=0,result=length?funcs[index].apply(this,args):value;++index<length;)result=funcs[index].call(this,result);return result}}}function createForEach(arrayFunc,eachFunc){return function(collection,iteratee,thisArg){return"function"==typeof iteratee&&thisArg===undefined&&isArray(collection)?arrayFunc(collection,iteratee):eachFunc(collection,bindCallback(iteratee,thisArg,3))}}function createForIn(objectFunc){return function(object,iteratee,thisArg){return("function"!=typeof iteratee||thisArg!==undefined)&&(iteratee=bindCallback(iteratee,thisArg,3)),objectFunc(object,iteratee,keysIn)}}function createForOwn(objectFunc){return function(object,iteratee,thisArg){return("function"!=typeof iteratee||thisArg!==undefined)&&(iteratee=bindCallback(iteratee,thisArg,3)),objectFunc(object,iteratee)}}function createObjectMapper(isMapKeys){return function(object,iteratee,thisArg){var result={};return iteratee=getCallback(iteratee,thisArg,3),baseForOwn(object,function(value,key,object){var mapped=iteratee(value,key,object);key=isMapKeys?mapped:key,value=isMapKeys?value:mapped,result[key]=value}),result}}function createPadDir(fromRight){return function(string,length,chars){return string=baseToString(string),(fromRight?string:"")+createPadding(string,length,chars)+(fromRight?"":string)}}function createPartial(flag){var partialFunc=restParam(function(func,partials){var holders=replaceHolders(partials,partialFunc.placeholder);return createWrapper(func,flag,undefined,partials,holders)});return partialFunc}function createReduce(arrayFunc,eachFunc){return function(collection,iteratee,accumulator,thisArg){var initFromArray=arguments.length<3;return"function"==typeof iteratee&&thisArg===undefined&&isArray(collection)?arrayFunc(collection,iteratee,accumulator,initFromArray):baseReduce(collection,getCallback(iteratee,thisArg,4),accumulator,initFromArray,eachFunc)}}function createHybridWrapper(func,bitmask,thisArg,partials,holders,partialsRight,holdersRight,argPos,ary,arity){function wrapper(){for(var length=arguments.length,index=length,args=Array(length);index--;)args[index]=arguments[index];if(partials&&(args=composeArgs(args,partials,holders)),partialsRight&&(args=composeArgsRight(args,partialsRight,holdersRight)),isCurry||isCurryRight){var placeholder=wrapper.placeholder,argsHolders=replaceHolders(args,placeholder);if(length-=argsHolders.length,arity>length){var newArgPos=argPos?arrayCopy(argPos):undefined,newArity=nativeMax(arity-length,0),newsHolders=isCurry?argsHolders:undefined,newHoldersRight=isCurry?undefined:argsHolders,newPartials=isCurry?args:undefined,newPartialsRight=isCurry?undefined:args;bitmask|=isCurry?PARTIAL_FLAG:PARTIAL_RIGHT_FLAG,bitmask&=~(isCurry?PARTIAL_RIGHT_FLAG:PARTIAL_FLAG),isCurryBound||(bitmask&=~(BIND_FLAG|BIND_KEY_FLAG));var newData=[func,bitmask,thisArg,newPartials,newsHolders,newPartialsRight,newHoldersRight,newArgPos,ary,newArity],result=createHybridWrapper.apply(undefined,newData);return isLaziable(func)&&setData(result,newData),result.placeholder=placeholder,result}}var thisBinding=isBind?thisArg:this,fn=isBindKey?thisBinding[func]:func;return argPos&&(args=reorder(args,argPos)),isAry&&ary<args.length&&(args.length=ary),this&&this!==root&&this instanceof wrapper&&(fn=Ctor||createCtorWrapper(func)),fn.apply(thisBinding,args)}var isAry=bitmask&ARY_FLAG,isBind=bitmask&BIND_FLAG,isBindKey=bitmask&BIND_KEY_FLAG,isCurry=bitmask&CURRY_FLAG,isCurryBound=bitmask&CURRY_BOUND_FLAG,isCurryRight=bitmask&CURRY_RIGHT_FLAG,Ctor=isBindKey?undefined:createCtorWrapper(func);return wrapper}function createPadding(string,length,chars){var strLength=string.length;if(length=+length,strLength>=length||!nativeIsFinite(length))return"";var padLength=length-strLength;return chars=null==chars?" ":chars+"",repeat(chars,nativeCeil(padLength/chars.length)).slice(0,padLength)}function createPartialWrapper(func,bitmask,thisArg,partials){function wrapper(){for(var argsIndex=-1,argsLength=arguments.length,leftIndex=-1,leftLength=partials.length,args=Array(leftLength+argsLength);++leftIndex<leftLength;)args[leftIndex]=partials[leftIndex];for(;argsLength--;)args[leftIndex++]=arguments[++argsIndex];var fn=this&&this!==root&&this instanceof wrapper?Ctor:func;return fn.apply(isBind?thisArg:this,args)}var isBind=bitmask&BIND_FLAG,Ctor=createCtorWrapper(func);return wrapper}function createRound(methodName){var func=Math[methodName];return function(number,precision){return precision=precision===undefined?0:+precision||0,precision?(precision=pow(10,precision),func(number*precision)/precision):func(number)}}function createSortedIndex(retHighest){return function(array,value,iteratee,thisArg){var callback=getCallback(iteratee);return null==iteratee&&callback===baseCallback?binaryIndex(array,value,retHighest):binaryIndexBy(array,value,callback(iteratee,thisArg,1),retHighest)}}function createWrapper(func,bitmask,thisArg,partials,holders,argPos,ary,arity){var isBindKey=bitmask&BIND_KEY_FLAG;if(!isBindKey&&"function"!=typeof func)throw new TypeError(FUNC_ERROR_TEXT);var length=partials?partials.length:0;if(length||(bitmask&=~(PARTIAL_FLAG|PARTIAL_RIGHT_FLAG),partials=holders=undefined),length-=holders?holders.length:0,bitmask&PARTIAL_RIGHT_FLAG){var partialsRight=partials,holdersRight=holders;partials=holders=undefined}var data=isBindKey?undefined:getData(func),newData=[func,bitmask,thisArg,partials,holders,partialsRight,holdersRight,argPos,ary,arity];if(data&&(mergeData(newData,data),bitmask=newData[1],arity=newData[9]),newData[9]=null==arity?isBindKey?0:func.length:nativeMax(arity-length,0)||0,bitmask==BIND_FLAG)var result=createBindWrapper(newData[0],newData[2]);else result=bitmask!=PARTIAL_FLAG&&bitmask!=(BIND_FLAG|PARTIAL_FLAG)||newData[4].length?createHybridWrapper.apply(undefined,newData):createPartialWrapper.apply(undefined,newData);var setter=data?baseSetData:setData;return setter(result,newData)}function equalArrays(array,other,equalFunc,customizer,isLoose,stackA,stackB){var index=-1,arrLength=array.length,othLength=other.length;if(arrLength!=othLength&&!(isLoose&&othLength>arrLength))return!1;for(;++index<arrLength;){var arrValue=array[index],othValue=other[index],result=customizer?customizer(isLoose?othValue:arrValue,isLoose?arrValue:othValue,index):undefined;if(result!==undefined){if(result)continue;return!1}if(isLoose){if(!arraySome(other,function(othValue){return arrValue===othValue||equalFunc(arrValue,othValue,customizer,isLoose,stackA,stackB)}))return!1}else if(arrValue!==othValue&&!equalFunc(arrValue,othValue,customizer,isLoose,stackA,stackB))return!1}return!0}function equalByTag(object,other,tag){switch(tag){case boolTag:case dateTag:return+object==+other;case errorTag:return object.name==other.name&&object.message==other.message;case numberTag:return object!=+object?other!=+other:object==+other;case regexpTag:case stringTag:return object==other+""}return!1}function equalObjects(object,other,equalFunc,customizer,isLoose,stackA,stackB){var objProps=keys(object),objLength=objProps.length,othProps=keys(other),othLength=othProps.length;if(objLength!=othLength&&!isLoose)return!1;for(var index=objLength;index--;){var key=objProps[index];if(!(isLoose?key in other:hasOwnProperty.call(other,key)))return!1}for(var skipCtor=isLoose;++index<objLength;){key=objProps[index];var objValue=object[key],othValue=other[key],result=customizer?customizer(isLoose?othValue:objValue,isLoose?objValue:othValue,key):undefined;if(!(result===undefined?equalFunc(objValue,othValue,customizer,isLoose,stackA,stackB):result))return!1;skipCtor||(skipCtor="constructor"==key)}if(!skipCtor){var objCtor=object.constructor,othCtor=other.constructor;if(objCtor!=othCtor&&"constructor"in object&&"constructor"in other&&!("function"==typeof objCtor&&objCtor instanceof objCtor&&"function"==typeof othCtor&&othCtor instanceof othCtor))return!1}return!0}function getCallback(func,thisArg,argCount){var result=lodash.callback||callback;return result=result===callback?baseCallback:result,argCount?result(func,thisArg,argCount):result}function getFuncName(func){for(var result=func.name,array=realNames[result],length=array?array.length:0;length--;){var data=array[length],otherFunc=data.func;if(null==otherFunc||otherFunc==func)return data.name}return result}function getIndexOf(collection,target,fromIndex){var result=lodash.indexOf||indexOf;return result=result===indexOf?baseIndexOf:result,collection?result(collection,target,fromIndex):result}function getMatchData(object){for(var result=pairs(object),length=result.length;length--;)result[length][2]=isStrictComparable(result[length][1]);return result}function getNative(object,key){var value=null==object?undefined:object[key];return isNative(value)?value:undefined}function getView(start,end,transforms){for(var index=-1,length=transforms.length;++index<length;){var data=transforms[index],size=data.size;switch(data.type){case"drop":start+=size;break;case"dropRight":end-=size;break;case"take":end=nativeMin(end,start+size);break;case"takeRight":start=nativeMax(start,end-size)}}return{start:start,end:end}}function initCloneArray(array){var length=array.length,result=new array.constructor(length);return length&&"string"==typeof array[0]&&hasOwnProperty.call(array,"index")&&(result.index=array.index,result.input=array.input),result}function initCloneObject(object){var Ctor=object.constructor;return"function"==typeof Ctor&&Ctor instanceof Ctor||(Ctor=Object),new Ctor}function initCloneByTag(object,tag,isDeep){var Ctor=object.constructor;switch(tag){case arrayBufferTag:return bufferClone(object);case boolTag:case dateTag:return new Ctor(+object);case float32Tag:case float64Tag:case int8Tag:case int16Tag:case int32Tag:case uint8Tag:case uint8ClampedTag:case uint16Tag:case uint32Tag:var buffer=object.buffer;return new Ctor(isDeep?bufferClone(buffer):buffer,object.byteOffset,object.length);case numberTag:case stringTag:return new Ctor(object);case regexpTag:var result=new Ctor(object.source,reFlags.exec(object));result.lastIndex=object.lastIndex}return result}function invokePath(object,path,args){null==object||isKey(path,object)||(path=toPath(path),object=1==path.length?object:baseGet(object,baseSlice(path,0,-1)),path=last(path));var func=null==object?object:object[path];return null==func?undefined:func.apply(object,args)}function isArrayLike(value){return null!=value&&isLength(getLength(value))}function isIndex(value,length){return value="number"==typeof value||reIsUint.test(value)?+value:-1,length=null==length?MAX_SAFE_INTEGER:length,value>-1&&value%1==0&&length>value}function isIterateeCall(value,index,object){if(!isObject(object))return!1;var type=typeof index;if("number"==type?isArrayLike(object)&&isIndex(index,object.length):"string"==type&&index in object){var other=object[index];return value===value?value===other:other!==other}return!1}function isKey(value,object){var type=typeof value;if("string"==type&&reIsPlainProp.test(value)||"number"==type)return!0;if(isArray(value))return!1;var result=!reIsDeepProp.test(value);return result||null!=object&&value in toObject(object)}function isLaziable(func){var funcName=getFuncName(func);if(!(funcName in LazyWrapper.prototype))return!1;var other=lodash[funcName];if(func===other)return!0;var data=getData(other);return!!data&&func===data[0]}function isLength(value){return"number"==typeof value&&value>-1&&value%1==0&&MAX_SAFE_INTEGER>=value}function isStrictComparable(value){return value===value&&!isObject(value)}function mergeData(data,source){var bitmask=data[1],srcBitmask=source[1],newBitmask=bitmask|srcBitmask,isCommon=ARY_FLAG>newBitmask,isCombo=srcBitmask==ARY_FLAG&&bitmask==CURRY_FLAG||srcBitmask==ARY_FLAG&&bitmask==REARG_FLAG&&data[7].length<=source[8]||srcBitmask==(ARY_FLAG|REARG_FLAG)&&bitmask==CURRY_FLAG;if(!isCommon&&!isCombo)return data;srcBitmask&BIND_FLAG&&(data[2]=source[2],newBitmask|=bitmask&BIND_FLAG?0:CURRY_BOUND_FLAG);var value=source[3];if(value){var partials=data[3];data[3]=partials?composeArgs(partials,value,source[4]):arrayCopy(value),data[4]=partials?replaceHolders(data[3],PLACEHOLDER):arrayCopy(source[4])}return value=source[5],value&&(partials=data[5],data[5]=partials?composeArgsRight(partials,value,source[6]):arrayCopy(value),data[6]=partials?replaceHolders(data[5],PLACEHOLDER):arrayCopy(source[6])),value=source[7],value&&(data[7]=arrayCopy(value)),srcBitmask&ARY_FLAG&&(data[8]=null==data[8]?source[8]:nativeMin(data[8],source[8])),null==data[9]&&(data[9]=source[9]),data[0]=source[0],data[1]=newBitmask,data}function mergeDefaults(objectValue,sourceValue){return objectValue===undefined?sourceValue:merge(objectValue,sourceValue,mergeDefaults)}function pickByArray(object,props){object=toObject(object);for(var index=-1,length=props.length,result={};++index<length;){var key=props[index];key in object&&(result[key]=object[key])}return result}function pickByCallback(object,predicate){var result={};
return baseForIn(object,function(value,key,object){predicate(value,key,object)&&(result[key]=value)}),result}function reorder(array,indexes){for(var arrLength=array.length,length=nativeMin(indexes.length,arrLength),oldArray=arrayCopy(array);length--;){var index=indexes[length];array[length]=isIndex(index,arrLength)?oldArray[index]:undefined}return array}function shimKeys(object){for(var props=keysIn(object),propsLength=props.length,length=propsLength&&object.length,allowIndexes=!!length&&isLength(length)&&(isArray(object)||isArguments(object)),index=-1,result=[];++index<propsLength;){var key=props[index];(allowIndexes&&isIndex(key,length)||hasOwnProperty.call(object,key))&&result.push(key)}return result}function toIterable(value){return null==value?[]:isArrayLike(value)?isObject(value)?value:Object(value):values(value)}function toObject(value){return isObject(value)?value:Object(value)}function toPath(value){if(isArray(value))return value;var result=[];return baseToString(value).replace(rePropName,function(match,number,quote,string){result.push(quote?string.replace(reEscapeChar,"$1"):number||match)}),result}function wrapperClone(wrapper){return wrapper instanceof LazyWrapper?wrapper.clone():new LodashWrapper(wrapper.__wrapped__,wrapper.__chain__,arrayCopy(wrapper.__actions__))}function chunk(array,size,guard){size=(guard?isIterateeCall(array,size,guard):null==size)?1:nativeMax(nativeFloor(size)||1,1);for(var index=0,length=array?array.length:0,resIndex=-1,result=Array(nativeCeil(length/size));length>index;)result[++resIndex]=baseSlice(array,index,index+=size);return result}function compact(array){for(var index=-1,length=array?array.length:0,resIndex=-1,result=[];++index<length;){var value=array[index];value&&(result[++resIndex]=value)}return result}function drop(array,n,guard){var length=array?array.length:0;return length?((guard?isIterateeCall(array,n,guard):null==n)&&(n=1),baseSlice(array,0>n?0:n)):[]}function dropRight(array,n,guard){var length=array?array.length:0;return length?((guard?isIterateeCall(array,n,guard):null==n)&&(n=1),n=length-(+n||0),baseSlice(array,0,0>n?0:n)):[]}function dropRightWhile(array,predicate,thisArg){return array&&array.length?baseWhile(array,getCallback(predicate,thisArg,3),!0,!0):[]}function dropWhile(array,predicate,thisArg){return array&&array.length?baseWhile(array,getCallback(predicate,thisArg,3),!0):[]}function fill(array,value,start,end){var length=array?array.length:0;return length?(start&&"number"!=typeof start&&isIterateeCall(array,value,start)&&(start=0,end=length),baseFill(array,value,start,end)):[]}function first(array){return array?array[0]:undefined}function flatten(array,isDeep,guard){var length=array?array.length:0;return guard&&isIterateeCall(array,isDeep,guard)&&(isDeep=!1),length?baseFlatten(array,isDeep):[]}function flattenDeep(array){var length=array?array.length:0;return length?baseFlatten(array,!0):[]}function indexOf(array,value,fromIndex){var length=array?array.length:0;if(!length)return-1;if("number"==typeof fromIndex)fromIndex=0>fromIndex?nativeMax(length+fromIndex,0):fromIndex;else if(fromIndex){var index=binaryIndex(array,value);return length>index&&(value===value?value===array[index]:array[index]!==array[index])?index:-1}return baseIndexOf(array,value,fromIndex||0)}function initial(array){return dropRight(array,1)}function last(array){var length=array?array.length:0;return length?array[length-1]:undefined}function lastIndexOf(array,value,fromIndex){var length=array?array.length:0;if(!length)return-1;var index=length;if("number"==typeof fromIndex)index=(0>fromIndex?nativeMax(length+fromIndex,0):nativeMin(fromIndex||0,length-1))+1;else if(fromIndex){index=binaryIndex(array,value,!0)-1;var other=array[index];return(value===value?value===other:other!==other)?index:-1}if(value!==value)return indexOfNaN(array,index,!0);for(;index--;)if(array[index]===value)return index;return-1}function pull(){var args=arguments,array=args[0];if(!array||!array.length)return array;for(var index=0,indexOf=getIndexOf(),length=args.length;++index<length;)for(var fromIndex=0,value=args[index];(fromIndex=indexOf(array,value,fromIndex))>-1;)splice.call(array,fromIndex,1);return array}function remove(array,predicate,thisArg){var result=[];if(!array||!array.length)return result;var index=-1,indexes=[],length=array.length;for(predicate=getCallback(predicate,thisArg,3);++index<length;){var value=array[index];predicate(value,index,array)&&(result.push(value),indexes.push(index))}return basePullAt(array,indexes),result}function rest(array){return drop(array,1)}function slice(array,start,end){var length=array?array.length:0;return length?(end&&"number"!=typeof end&&isIterateeCall(array,start,end)&&(start=0,end=length),baseSlice(array,start,end)):[]}function take(array,n,guard){var length=array?array.length:0;return length?((guard?isIterateeCall(array,n,guard):null==n)&&(n=1),baseSlice(array,0,0>n?0:n)):[]}function takeRight(array,n,guard){var length=array?array.length:0;return length?((guard?isIterateeCall(array,n,guard):null==n)&&(n=1),n=length-(+n||0),baseSlice(array,0>n?0:n)):[]}function takeRightWhile(array,predicate,thisArg){return array&&array.length?baseWhile(array,getCallback(predicate,thisArg,3),!1,!0):[]}function takeWhile(array,predicate,thisArg){return array&&array.length?baseWhile(array,getCallback(predicate,thisArg,3)):[]}function uniq(array,isSorted,iteratee,thisArg){var length=array?array.length:0;if(!length)return[];null!=isSorted&&"boolean"!=typeof isSorted&&(thisArg=iteratee,iteratee=isIterateeCall(array,isSorted,thisArg)?undefined:isSorted,isSorted=!1);var callback=getCallback();return(null!=iteratee||callback!==baseCallback)&&(iteratee=callback(iteratee,thisArg,3)),isSorted&&getIndexOf()==baseIndexOf?sortedUniq(array,iteratee):baseUniq(array,iteratee)}function unzip(array){if(!array||!array.length)return[];var index=-1,length=0;array=arrayFilter(array,function(group){return isArrayLike(group)?(length=nativeMax(group.length,length),!0):void 0});for(var result=Array(length);++index<length;)result[index]=arrayMap(array,baseProperty(index));return result}function unzipWith(array,iteratee,thisArg){var length=array?array.length:0;if(!length)return[];var result=unzip(array);return null==iteratee?result:(iteratee=bindCallback(iteratee,thisArg,4),arrayMap(result,function(group){return arrayReduce(group,iteratee,undefined,!0)}))}function xor(){for(var index=-1,length=arguments.length;++index<length;){var array=arguments[index];if(isArrayLike(array))var result=result?arrayPush(baseDifference(result,array),baseDifference(array,result)):array}return result?baseUniq(result):[]}function zipObject(props,values){var index=-1,length=props?props.length:0,result={};for(!length||values||isArray(props[0])||(values=[]);++index<length;){var key=props[index];values?result[key]=values[index]:key&&(result[key[0]]=key[1])}return result}function chain(value){var result=lodash(value);return result.__chain__=!0,result}function tap(value,interceptor,thisArg){return interceptor.call(thisArg,value),value}function thru(value,interceptor,thisArg){return interceptor.call(thisArg,value)}function wrapperChain(){return chain(this)}function wrapperCommit(){return new LodashWrapper(this.value(),this.__chain__)}function wrapperPlant(value){for(var result,parent=this;parent instanceof baseLodash;){var clone=wrapperClone(parent);result?previous.__wrapped__=clone:result=clone;var previous=clone;parent=parent.__wrapped__}return previous.__wrapped__=value,result}function wrapperReverse(){var value=this.__wrapped__,interceptor=function(value){return wrapped&&wrapped.__dir__<0?value:value.reverse()};if(value instanceof LazyWrapper){var wrapped=value;return this.__actions__.length&&(wrapped=new LazyWrapper(this)),wrapped=wrapped.reverse(),wrapped.__actions__.push({func:thru,args:[interceptor],thisArg:undefined}),new LodashWrapper(wrapped,this.__chain__)}return this.thru(interceptor)}function wrapperToString(){return this.value()+""}function wrapperValue(){return baseWrapperValue(this.__wrapped__,this.__actions__)}function every(collection,predicate,thisArg){var func=isArray(collection)?arrayEvery:baseEvery;return thisArg&&isIterateeCall(collection,predicate,thisArg)&&(predicate=undefined),("function"!=typeof predicate||thisArg!==undefined)&&(predicate=getCallback(predicate,thisArg,3)),func(collection,predicate)}function filter(collection,predicate,thisArg){var func=isArray(collection)?arrayFilter:baseFilter;return predicate=getCallback(predicate,thisArg,3),func(collection,predicate)}function findWhere(collection,source){return find(collection,baseMatches(source))}function includes(collection,target,fromIndex,guard){var length=collection?getLength(collection):0;return isLength(length)||(collection=values(collection),length=collection.length),fromIndex="number"!=typeof fromIndex||guard&&isIterateeCall(target,fromIndex,guard)?0:0>fromIndex?nativeMax(length+fromIndex,0):fromIndex||0,"string"==typeof collection||!isArray(collection)&&isString(collection)?length>=fromIndex&&collection.indexOf(target,fromIndex)>-1:!!length&&getIndexOf(collection,target,fromIndex)>-1}function map(collection,iteratee,thisArg){var func=isArray(collection)?arrayMap:baseMap;return iteratee=getCallback(iteratee,thisArg,3),func(collection,iteratee)}function pluck(collection,path){return map(collection,property(path))}function reject(collection,predicate,thisArg){var func=isArray(collection)?arrayFilter:baseFilter;return predicate=getCallback(predicate,thisArg,3),func(collection,function(value,index,collection){return!predicate(value,index,collection)})}function sample(collection,n,guard){if(guard?isIterateeCall(collection,n,guard):null==n){collection=toIterable(collection);var length=collection.length;return length>0?collection[baseRandom(0,length-1)]:undefined}var index=-1,result=toArray(collection),length=result.length,lastIndex=length-1;for(n=nativeMin(0>n?0:+n||0,length);++index<n;){var rand=baseRandom(index,lastIndex),value=result[rand];result[rand]=result[index],result[index]=value}return result.length=n,result}function shuffle(collection){return sample(collection,POSITIVE_INFINITY)}function size(collection){var length=collection?getLength(collection):0;return isLength(length)?length:keys(collection).length}function some(collection,predicate,thisArg){var func=isArray(collection)?arraySome:baseSome;return thisArg&&isIterateeCall(collection,predicate,thisArg)&&(predicate=undefined),("function"!=typeof predicate||thisArg!==undefined)&&(predicate=getCallback(predicate,thisArg,3)),func(collection,predicate)}function sortBy(collection,iteratee,thisArg){if(null==collection)return[];thisArg&&isIterateeCall(collection,iteratee,thisArg)&&(iteratee=undefined);var index=-1;iteratee=getCallback(iteratee,thisArg,3);var result=baseMap(collection,function(value,key,collection){return{criteria:iteratee(value,key,collection),index:++index,value:value}});return baseSortBy(result,compareAscending)}function sortByOrder(collection,iteratees,orders,guard){return null==collection?[]:(guard&&isIterateeCall(iteratees,orders,guard)&&(orders=undefined),isArray(iteratees)||(iteratees=null==iteratees?[]:[iteratees]),isArray(orders)||(orders=null==orders?[]:[orders]),baseSortByOrder(collection,iteratees,orders))}function where(collection,source){return filter(collection,baseMatches(source))}function after(n,func){if("function"!=typeof func){if("function"!=typeof n)throw new TypeError(FUNC_ERROR_TEXT);var temp=n;n=func,func=temp}return n=nativeIsFinite(n=+n)?n:0,function(){return--n<1?func.apply(this,arguments):void 0}}function ary(func,n,guard){return guard&&isIterateeCall(func,n,guard)&&(n=undefined),n=func&&null==n?func.length:nativeMax(+n||0,0),createWrapper(func,ARY_FLAG,undefined,undefined,undefined,undefined,n)}function before(n,func){var result;if("function"!=typeof func){if("function"!=typeof n)throw new TypeError(FUNC_ERROR_TEXT);var temp=n;n=func,func=temp}return function(){return--n>0&&(result=func.apply(this,arguments)),1>=n&&(func=undefined),result}}function debounce(func,wait,options){function cancel(){timeoutId&&clearTimeout(timeoutId),maxTimeoutId&&clearTimeout(maxTimeoutId),lastCalled=0,maxTimeoutId=timeoutId=trailingCall=undefined}function complete(isCalled,id){id&&clearTimeout(id),maxTimeoutId=timeoutId=trailingCall=undefined,isCalled&&(lastCalled=now(),result=func.apply(thisArg,args),timeoutId||maxTimeoutId||(args=thisArg=undefined))}function delayed(){var remaining=wait-(now()-stamp);0>=remaining||remaining>wait?complete(trailingCall,maxTimeoutId):timeoutId=setTimeout(delayed,remaining)}function maxDelayed(){complete(trailing,timeoutId)}function debounced(){if(args=arguments,stamp=now(),thisArg=this,trailingCall=trailing&&(timeoutId||!leading),maxWait===!1)var leadingCall=leading&&!timeoutId;else{maxTimeoutId||leading||(lastCalled=stamp);var remaining=maxWait-(stamp-lastCalled),isCalled=0>=remaining||remaining>maxWait;isCalled?(maxTimeoutId&&(maxTimeoutId=clearTimeout(maxTimeoutId)),lastCalled=stamp,result=func.apply(thisArg,args)):maxTimeoutId||(maxTimeoutId=setTimeout(maxDelayed,remaining))}return isCalled&&timeoutId?timeoutId=clearTimeout(timeoutId):timeoutId||wait===maxWait||(timeoutId=setTimeout(delayed,wait)),leadingCall&&(isCalled=!0,result=func.apply(thisArg,args)),!isCalled||timeoutId||maxTimeoutId||(args=thisArg=undefined),result}var args,maxTimeoutId,result,stamp,thisArg,timeoutId,trailingCall,lastCalled=0,maxWait=!1,trailing=!0;if("function"!=typeof func)throw new TypeError(FUNC_ERROR_TEXT);if(wait=0>wait?0:+wait||0,options===!0){var leading=!0;trailing=!1}else isObject(options)&&(leading=!!options.leading,maxWait="maxWait"in options&&nativeMax(+options.maxWait||0,wait),trailing="trailing"in options?!!options.trailing:trailing);return debounced.cancel=cancel,debounced}function memoize(func,resolver){if("function"!=typeof func||resolver&&"function"!=typeof resolver)throw new TypeError(FUNC_ERROR_TEXT);var memoized=function(){var args=arguments,key=resolver?resolver.apply(this,args):args[0],cache=memoized.cache;if(cache.has(key))return cache.get(key);var result=func.apply(this,args);return memoized.cache=cache.set(key,result),result};return memoized.cache=new memoize.Cache,memoized}function negate(predicate){if("function"!=typeof predicate)throw new TypeError(FUNC_ERROR_TEXT);return function(){return!predicate.apply(this,arguments)}}function once(func){return before(2,func)}function restParam(func,start){if("function"!=typeof func)throw new TypeError(FUNC_ERROR_TEXT);return start=nativeMax(start===undefined?func.length-1:+start||0,0),function(){for(var args=arguments,index=-1,length=nativeMax(args.length-start,0),rest=Array(length);++index<length;)rest[index]=args[start+index];switch(start){case 0:return func.call(this,rest);case 1:return func.call(this,args[0],rest);case 2:return func.call(this,args[0],args[1],rest)}var otherArgs=Array(start+1);for(index=-1;++index<start;)otherArgs[index]=args[index];return otherArgs[start]=rest,func.apply(this,otherArgs)}}function spread(func){if("function"!=typeof func)throw new TypeError(FUNC_ERROR_TEXT);return function(array){return func.apply(this,array)}}function throttle(func,wait,options){var leading=!0,trailing=!0;if("function"!=typeof func)throw new TypeError(FUNC_ERROR_TEXT);return options===!1?leading=!1:isObject(options)&&(leading="leading"in options?!!options.leading:leading,trailing="trailing"in options?!!options.trailing:trailing),debounce(func,wait,{leading:leading,maxWait:+wait,trailing:trailing})}function wrap(value,wrapper){return wrapper=null==wrapper?identity:wrapper,createWrapper(wrapper,PARTIAL_FLAG,undefined,[value],[])}function clone(value,isDeep,customizer,thisArg){return isDeep&&"boolean"!=typeof isDeep&&isIterateeCall(value,isDeep,customizer)?isDeep=!1:"function"==typeof isDeep&&(thisArg=customizer,customizer=isDeep,isDeep=!1),"function"==typeof customizer?baseClone(value,isDeep,bindCallback(customizer,thisArg,1)):baseClone(value,isDeep)}function cloneDeep(value,customizer,thisArg){return"function"==typeof customizer?baseClone(value,!0,bindCallback(customizer,thisArg,1)):baseClone(value,!0)}function gt(value,other){return value>other}function gte(value,other){return value>=other}function isArguments(value){return isObjectLike(value)&&isArrayLike(value)&&hasOwnProperty.call(value,"callee")&&!propertyIsEnumerable.call(value,"callee")}function isBoolean(value){return value===!0||value===!1||isObjectLike(value)&&objToString.call(value)==boolTag}function isDate(value){return isObjectLike(value)&&objToString.call(value)==dateTag}function isElement(value){return!!value&&1===value.nodeType&&isObjectLike(value)&&!isPlainObject(value)}function isEmpty(value){return null==value?!0:isArrayLike(value)&&(isArray(value)||isString(value)||isArguments(value)||isObjectLike(value)&&isFunction(value.splice))?!value.length:!keys(value).length}function isEqual(value,other,customizer,thisArg){customizer="function"==typeof customizer?bindCallback(customizer,thisArg,3):undefined;var result=customizer?customizer(value,other):undefined;return result===undefined?baseIsEqual(value,other,customizer):!!result}function isError(value){return isObjectLike(value)&&"string"==typeof value.message&&objToString.call(value)==errorTag}function isFinite(value){return"number"==typeof value&&nativeIsFinite(value)}function isFunction(value){return isObject(value)&&objToString.call(value)==funcTag}function isObject(value){var type=typeof value;return!!value&&("object"==type||"function"==type)}function isMatch(object,source,customizer,thisArg){return customizer="function"==typeof customizer?bindCallback(customizer,thisArg,3):undefined,baseIsMatch(object,getMatchData(source),customizer)}function isNaN(value){return isNumber(value)&&value!=+value}function isNative(value){return null==value?!1:isFunction(value)?reIsNative.test(fnToString.call(value)):isObjectLike(value)&&reIsHostCtor.test(value)}function isNull(value){return null===value}function isNumber(value){return"number"==typeof value||isObjectLike(value)&&objToString.call(value)==numberTag}function isPlainObject(value){var Ctor;if(!isObjectLike(value)||objToString.call(value)!=objectTag||isArguments(value)||!hasOwnProperty.call(value,"constructor")&&(Ctor=value.constructor,"function"==typeof Ctor&&!(Ctor instanceof Ctor)))return!1;var result;return baseForIn(value,function(subValue,key){result=key}),result===undefined||hasOwnProperty.call(value,result)}function isRegExp(value){return isObject(value)&&objToString.call(value)==regexpTag}function isString(value){return"string"==typeof value||isObjectLike(value)&&objToString.call(value)==stringTag}function isTypedArray(value){return isObjectLike(value)&&isLength(value.length)&&!!typedArrayTags[objToString.call(value)]}function isUndefined(value){return value===undefined}function lt(value,other){return other>value}function lte(value,other){return other>=value}function toArray(value){var length=value?getLength(value):0;return isLength(length)?length?arrayCopy(value):[]:values(value)}function toPlainObject(value){return baseCopy(value,keysIn(value))}function create(prototype,properties,guard){var result=baseCreate(prototype);return guard&&isIterateeCall(prototype,properties,guard)&&(properties=undefined),properties?baseAssign(result,properties):result}function functions(object){return baseFunctions(object,keysIn(object))}function get(object,path,defaultValue){var result=null==object?undefined:baseGet(object,toPath(path),path+"");return result===undefined?defaultValue:result}function has(object,path){if(null==object)return!1;var result=hasOwnProperty.call(object,path);if(!result&&!isKey(path)){if(path=toPath(path),object=1==path.length?object:baseGet(object,baseSlice(path,0,-1)),null==object)return!1;path=last(path),result=hasOwnProperty.call(object,path)}return result||isLength(object.length)&&isIndex(path,object.length)&&(isArray(object)||isArguments(object))}function invert(object,multiValue,guard){guard&&isIterateeCall(object,multiValue,guard)&&(multiValue=undefined);for(var index=-1,props=keys(object),length=props.length,result={};++index<length;){var key=props[index],value=object[key];multiValue?hasOwnProperty.call(result,value)?result[value].push(key):result[value]=[key]:result[value]=key}return result}function keysIn(object){if(null==object)return[];isObject(object)||(object=Object(object));var length=object.length;length=length&&isLength(length)&&(isArray(object)||isArguments(object))&&length||0;for(var Ctor=object.constructor,index=-1,isProto="function"==typeof Ctor&&Ctor.prototype===object,result=Array(length),skipIndexes=length>0;++index<length;)result[index]=index+"";for(var key in object)skipIndexes&&isIndex(key,length)||"constructor"==key&&(isProto||!hasOwnProperty.call(object,key))||result.push(key);return result}function pairs(object){object=toObject(object);for(var index=-1,props=keys(object),length=props.length,result=Array(length);++index<length;){var key=props[index];result[index]=[key,object[key]]}return result}function result(object,path,defaultValue){var result=null==object?undefined:object[path];return result===undefined&&(null==object||isKey(path,object)||(path=toPath(path),object=1==path.length?object:baseGet(object,baseSlice(path,0,-1)),result=null==object?undefined:object[last(path)]),result=result===undefined?defaultValue:result),isFunction(result)?result.call(object):result}function set(object,path,value){if(null==object)return object;var pathKey=path+"";path=null!=object[pathKey]||isKey(path,object)?[pathKey]:toPath(path);for(var index=-1,length=path.length,lastIndex=length-1,nested=object;null!=nested&&++index<length;){var key=path[index];isObject(nested)&&(index==lastIndex?nested[key]=value:null==nested[key]&&(nested[key]=isIndex(path[index+1])?[]:{})),nested=nested[key]}return object}function transform(object,iteratee,accumulator,thisArg){var isArr=isArray(object)||isTypedArray(object);if(iteratee=getCallback(iteratee,thisArg,4),null==accumulator)if(isArr||isObject(object)){var Ctor=object.constructor;accumulator=isArr?isArray(object)?new Ctor:[]:baseCreate(isFunction(Ctor)?Ctor.prototype:undefined)}else accumulator={};return(isArr?arrayEach:baseForOwn)(object,function(value,index,object){return iteratee(accumulator,value,index,object)}),accumulator}function values(object){return baseValues(object,keys(object))}function valuesIn(object){return baseValues(object,keysIn(object))}function inRange(value,start,end){return start=+start||0,end===undefined?(end=start,start=0):end=+end||0,value>=nativeMin(start,end)&&value<nativeMax(start,end)}function random(min,max,floating){floating&&isIterateeCall(min,max,floating)&&(max=floating=undefined);var noMin=null==min,noMax=null==max;if(null==floating&&(noMax&&"boolean"==typeof min?(floating=min,min=1):"boolean"==typeof max&&(floating=max,noMax=!0)),noMin&&noMax&&(max=1,noMax=!1),min=+min||0,noMax?(max=min,min=0):max=+max||0,floating||min%1||max%1){var rand=nativeRandom();return nativeMin(min+rand*(max-min+parseFloat("1e-"+((rand+"").length-1))),max)}return baseRandom(min,max)}function capitalize(string){return string=baseToString(string),string&&string.charAt(0).toUpperCase()+string.slice(1)}function deburr(string){return string=baseToString(string),string&&string.replace(reLatin1,deburrLetter).replace(reComboMark,"")}function endsWith(string,target,position){string=baseToString(string),target+="";var length=string.length;return position=position===undefined?length:nativeMin(0>position?0:+position||0,length),position-=target.length,position>=0&&string.indexOf(target,position)==position}function escape(string){return string=baseToString(string),string&&reHasUnescapedHtml.test(string)?string.replace(reUnescapedHtml,escapeHtmlChar):string}function escapeRegExp(string){return string=baseToString(string),string&&reHasRegExpChars.test(string)?string.replace(reRegExpChars,escapeRegExpChar):string||"(?:)"}function pad(string,length,chars){string=baseToString(string),length=+length;var strLength=string.length;if(strLength>=length||!nativeIsFinite(length))return string;var mid=(length-strLength)/2,leftLength=nativeFloor(mid),rightLength=nativeCeil(mid);return chars=createPadding("",rightLength,chars),chars.slice(0,leftLength)+string+chars}function parseInt(string,radix,guard){return(guard?isIterateeCall(string,radix,guard):null==radix)?radix=0:radix&&(radix=+radix),string=trim(string),nativeParseInt(string,radix||(reHasHexPrefix.test(string)?16:10))}function repeat(string,n){var result="";if(string=baseToString(string),n=+n,1>n||!string||!nativeIsFinite(n))return result;do n%2&&(result+=string),n=nativeFloor(n/2),string+=string;while(n);return result}function startsWith(string,target,position){return string=baseToString(string),position=null==position?0:nativeMin(0>position?0:+position||0,string.length),string.lastIndexOf(target,position)==position}function template(string,options,otherOptions){var settings=lodash.templateSettings;otherOptions&&isIterateeCall(string,options,otherOptions)&&(options=otherOptions=undefined),string=baseToString(string),options=assignWith(baseAssign({},otherOptions||options),settings,assignOwnDefaults);var isEscaping,isEvaluating,imports=assignWith(baseAssign({},options.imports),settings.imports,assignOwnDefaults),importsKeys=keys(imports),importsValues=baseValues(imports,importsKeys),index=0,interpolate=options.interpolate||reNoMatch,source="__p += '",reDelimiters=RegExp((options.escape||reNoMatch).source+"|"+interpolate.source+"|"+(interpolate===reInterpolate?reEsTemplate:reNoMatch).source+"|"+(options.evaluate||reNoMatch).source+"|$","g"),sourceURL="//# sourceURL="+("sourceURL"in options?options.sourceURL:"lodash.templateSources["+ ++templateCounter+"]")+"\n";string.replace(reDelimiters,function(match,escapeValue,interpolateValue,esTemplateValue,evaluateValue,offset){return interpolateValue||(interpolateValue=esTemplateValue),source+=string.slice(index,offset).replace(reUnescapedString,escapeStringChar),escapeValue&&(isEscaping=!0,source+="' +\n__e("+escapeValue+") +\n'"),evaluateValue&&(isEvaluating=!0,source+="';\n"+evaluateValue+";\n__p += '"),interpolateValue&&(source+="' +\n((__t = ("+interpolateValue+")) == null ? '' : __t) +\n'"),index=offset+match.length,match}),source+="';\n";var variable=options.variable;variable||(source="with (obj) {\n"+source+"\n}\n"),source=(isEvaluating?source.replace(reEmptyStringLeading,""):source).replace(reEmptyStringMiddle,"$1").replace(reEmptyStringTrailing,"$1;"),source="function("+(variable||"obj")+") {\n"+(variable?"":"obj || (obj = {});\n")+"var __t, __p = ''"+(isEscaping?", __e = _.escape":"")+(isEvaluating?", __j = Array.prototype.join;\nfunction print() { __p += __j.call(arguments, '') }\n":";\n")+source+"return __p\n}";var result=attempt(function(){return Function(importsKeys,sourceURL+"return "+source).apply(undefined,importsValues)});if(result.source=source,isError(result))throw result;return result}function trim(string,chars,guard){var value=string;return(string=baseToString(string))?(guard?isIterateeCall(value,chars,guard):null==chars)?string.slice(trimmedLeftIndex(string),trimmedRightIndex(string)+1):(chars+="",string.slice(charsLeftIndex(string,chars),charsRightIndex(string,chars)+1)):string}function trimLeft(string,chars,guard){var value=string;return string=baseToString(string),string?(guard?isIterateeCall(value,chars,guard):null==chars)?string.slice(trimmedLeftIndex(string)):string.slice(charsLeftIndex(string,chars+"")):string}function trimRight(string,chars,guard){var value=string;return string=baseToString(string),string?(guard?isIterateeCall(value,chars,guard):null==chars)?string.slice(0,trimmedRightIndex(string)+1):string.slice(0,charsRightIndex(string,chars+"")+1):string}function trunc(string,options,guard){guard&&isIterateeCall(string,options,guard)&&(options=undefined);var length=DEFAULT_TRUNC_LENGTH,omission=DEFAULT_TRUNC_OMISSION;if(null!=options)if(isObject(options)){var separator="separator"in options?options.separator:separator;length="length"in options?+options.length||0:length,omission="omission"in options?baseToString(options.omission):omission}else length=+options||0;if(string=baseToString(string),length>=string.length)return string;var end=length-omission.length;if(1>end)return omission;var result=string.slice(0,end);if(null==separator)return result+omission;if(isRegExp(separator)){if(string.slice(end).search(separator)){var match,newEnd,substring=string.slice(0,end);for(separator.global||(separator=RegExp(separator.source,(reFlags.exec(separator)||"")+"g")),separator.lastIndex=0;match=separator.exec(substring);)newEnd=match.index;result=result.slice(0,null==newEnd?end:newEnd)}}else if(string.indexOf(separator,end)!=end){var index=result.lastIndexOf(separator);index>-1&&(result=result.slice(0,index))}return result+omission}function unescape(string){return string=baseToString(string),string&&reHasEscapedHtml.test(string)?string.replace(reEscapedHtml,unescapeHtmlChar):string}function words(string,pattern,guard){return guard&&isIterateeCall(string,pattern,guard)&&(pattern=undefined),string=baseToString(string),string.match(pattern||reWords)||[]}function callback(func,thisArg,guard){return guard&&isIterateeCall(func,thisArg,guard)&&(thisArg=undefined),isObjectLike(func)?matches(func):baseCallback(func,thisArg)}function constant(value){return function(){return value}}function identity(value){return value}function matches(source){return baseMatches(baseClone(source,!0))}function matchesProperty(path,srcValue){return baseMatchesProperty(path,baseClone(srcValue,!0))}function mixin(object,source,options){if(null==options){var isObj=isObject(source),props=isObj?keys(source):undefined,methodNames=props&&props.length?baseFunctions(source,props):undefined;(methodNames?methodNames.length:isObj)||(methodNames=!1,options=source,source=object,object=this)}methodNames||(methodNames=baseFunctions(source,keys(source)));var chain=!0,index=-1,isFunc=isFunction(object),length=methodNames.length;options===!1?chain=!1:isObject(options)&&"chain"in options&&(chain=options.chain);for(;++index<length;){var methodName=methodNames[index],func=source[methodName];object[methodName]=func,isFunc&&(object.prototype[methodName]=function(func){return function(){var chainAll=this.__chain__;if(chain||chainAll){var result=object(this.__wrapped__),actions=result.__actions__=arrayCopy(this.__actions__);return actions.push({func:func,args:arguments,thisArg:object}),result.__chain__=chainAll,result}return func.apply(object,arrayPush([this.value()],arguments))}}(func))}return object}function noConflict(){return root._=oldDash,this}function noop(){}function property(path){return isKey(path)?baseProperty(path):basePropertyDeep(path)}function propertyOf(object){return function(path){return baseGet(object,toPath(path),path+"")}}function range(start,end,step){step&&isIterateeCall(start,end,step)&&(end=step=undefined),start=+start||0,step=null==step?1:+step||0,null==end?(end=start,start=0):end=+end||0;for(var index=-1,length=nativeMax(nativeCeil((end-start)/(step||1)),0),result=Array(length);++index<length;)result[index]=start,start+=step;return result}function times(n,iteratee,thisArg){if(n=nativeFloor(n),1>n||!nativeIsFinite(n))return[];var index=-1,result=Array(nativeMin(n,MAX_ARRAY_LENGTH));for(iteratee=bindCallback(iteratee,thisArg,1);++index<n;)MAX_ARRAY_LENGTH>index?result[index]=iteratee(index):iteratee(index);return result}function uniqueId(prefix){var id=++idCounter;return baseToString(prefix)+id}function add(augend,addend){return(+augend||0)+(+addend||0)}function sum(collection,iteratee,thisArg){return thisArg&&isIterateeCall(collection,iteratee,thisArg)&&(iteratee=undefined),iteratee=getCallback(iteratee,thisArg,3),1==iteratee.length?arraySum(isArray(collection)?collection:toIterable(collection),iteratee):baseSum(collection,iteratee)}context=context?_.defaults(root.Object(),context,_.pick(root,contextProps)):root;var Array=context.Array,Date=context.Date,Error=context.Error,Function=context.Function,Math=context.Math,Number=context.Number,Object=context.Object,RegExp=context.RegExp,String=context.String,TypeError=context.TypeError,arrayProto=Array.prototype,objectProto=Object.prototype,stringProto=String.prototype,fnToString=Function.prototype.toString,hasOwnProperty=objectProto.hasOwnProperty,idCounter=0,objToString=objectProto.toString,oldDash=root._,reIsNative=RegExp("^"+fnToString.call(hasOwnProperty).replace(/[\\^$.*+?()[\]{}|]/g,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$"),ArrayBuffer=context.ArrayBuffer,clearTimeout=context.clearTimeout,parseFloat=context.parseFloat,pow=Math.pow,propertyIsEnumerable=objectProto.propertyIsEnumerable,Set=getNative(context,"Set"),setTimeout=context.setTimeout,splice=arrayProto.splice,Uint8Array=context.Uint8Array,WeakMap=getNative(context,"WeakMap"),nativeCeil=Math.ceil,nativeCreate=getNative(Object,"create"),nativeFloor=Math.floor,nativeIsArray=getNative(Array,"isArray"),nativeIsFinite=context.isFinite,nativeKeys=getNative(Object,"keys"),nativeMax=Math.max,nativeMin=Math.min,nativeNow=getNative(Date,"now"),nativeParseInt=context.parseInt,nativeRandom=Math.random,NEGATIVE_INFINITY=Number.NEGATIVE_INFINITY,POSITIVE_INFINITY=Number.POSITIVE_INFINITY,MAX_ARRAY_LENGTH=4294967295,MAX_ARRAY_INDEX=MAX_ARRAY_LENGTH-1,HALF_MAX_ARRAY_LENGTH=MAX_ARRAY_LENGTH>>>1,MAX_SAFE_INTEGER=9007199254740991,metaMap=WeakMap&&new WeakMap,realNames={};
lodash.support={};lodash.templateSettings={escape:reEscape,evaluate:reEvaluate,interpolate:reInterpolate,variable:"",imports:{_:lodash}};var baseCreate=function(){function object(){}return function(prototype){if(isObject(prototype)){object.prototype=prototype;var result=new object;object.prototype=undefined}return result||{}}}(),baseEach=createBaseEach(baseForOwn),baseEachRight=createBaseEach(baseForOwnRight,!0),baseFor=createBaseFor(),baseForRight=createBaseFor(!0),baseSetData=metaMap?function(func,data){return metaMap.set(func,data),func}:identity,getData=metaMap?function(func){return metaMap.get(func)}:noop,getLength=baseProperty("length"),setData=function(){var count=0,lastCalled=0;return function(key,value){var stamp=now(),remaining=HOT_SPAN-(stamp-lastCalled);if(lastCalled=stamp,remaining>0){if(++count>=HOT_COUNT)return key}else count=0;return baseSetData(key,value)}}(),difference=restParam(function(array,values){return isObjectLike(array)&&isArrayLike(array)?baseDifference(array,baseFlatten(values,!1,!0)):[]}),findIndex=createFindIndex(),findLastIndex=createFindIndex(!0),intersection=restParam(function(arrays){for(var othLength=arrays.length,othIndex=othLength,caches=Array(length),indexOf=getIndexOf(),isCommon=indexOf==baseIndexOf,result=[];othIndex--;){var value=arrays[othIndex]=isArrayLike(value=arrays[othIndex])?value:[];caches[othIndex]=isCommon&&value.length>=120?createCache(othIndex&&value):null}var array=arrays[0],index=-1,length=array?array.length:0,seen=caches[0];outer:for(;++index<length;)if(value=array[index],(seen?cacheIndexOf(seen,value):indexOf(result,value,0))<0){for(var othIndex=othLength;--othIndex;){var cache=caches[othIndex];if((cache?cacheIndexOf(cache,value):indexOf(arrays[othIndex],value,0))<0)continue outer}seen&&seen.push(value),result.push(value)}return result}),pullAt=restParam(function(array,indexes){indexes=baseFlatten(indexes);var result=baseAt(array,indexes);return basePullAt(array,indexes.sort(baseCompareAscending)),result}),sortedIndex=createSortedIndex(),sortedLastIndex=createSortedIndex(!0),union=restParam(function(arrays){return baseUniq(baseFlatten(arrays,!1,!0))}),without=restParam(function(array,values){return isArrayLike(array)?baseDifference(array,values):[]}),zip=restParam(unzip),zipWith=restParam(function(arrays){var length=arrays.length,iteratee=length>2?arrays[length-2]:undefined,thisArg=length>1?arrays[length-1]:undefined;return length>2&&"function"==typeof iteratee?length-=2:(iteratee=length>1&&"function"==typeof thisArg?(--length,thisArg):undefined,thisArg=undefined),arrays.length=length,unzipWith(arrays,iteratee,thisArg)}),wrapperConcat=restParam(function(values){return values=baseFlatten(values),this.thru(function(array){return arrayConcat(isArray(array)?array:[toObject(array)],values)})}),at=restParam(function(collection,props){return baseAt(collection,baseFlatten(props))}),countBy=createAggregator(function(result,value,key){hasOwnProperty.call(result,key)?++result[key]:result[key]=1}),find=createFind(baseEach),findLast=createFind(baseEachRight,!0),forEach=createForEach(arrayEach,baseEach),forEachRight=createForEach(arrayEachRight,baseEachRight),groupBy=createAggregator(function(result,value,key){hasOwnProperty.call(result,key)?result[key].push(value):result[key]=[value]}),indexBy=createAggregator(function(result,value,key){result[key]=value}),invoke=restParam(function(collection,path,args){var index=-1,isFunc="function"==typeof path,isProp=isKey(path),result=isArrayLike(collection)?Array(collection.length):[];return baseEach(collection,function(value){var func=isFunc?path:isProp&&null!=value?value[path]:undefined;result[++index]=func?func.apply(value,args):invokePath(value,path,args)}),result}),partition=createAggregator(function(result,value,key){result[key?0:1].push(value)},function(){return[[],[]]}),reduce=createReduce(arrayReduce,baseEach),reduceRight=createReduce(arrayReduceRight,baseEachRight),sortByAll=restParam(function(collection,iteratees){if(null==collection)return[];var guard=iteratees[2];return guard&&isIterateeCall(iteratees[0],iteratees[1],guard)&&(iteratees.length=1),baseSortByOrder(collection,baseFlatten(iteratees),[])}),now=nativeNow||function(){return(new Date).getTime()},bind=restParam(function(func,thisArg,partials){var bitmask=BIND_FLAG;if(partials.length){var holders=replaceHolders(partials,bind.placeholder);bitmask|=PARTIAL_FLAG}return createWrapper(func,bitmask,thisArg,partials,holders)}),bindAll=restParam(function(object,methodNames){methodNames=methodNames.length?baseFlatten(methodNames):functions(object);for(var index=-1,length=methodNames.length;++index<length;){var key=methodNames[index];object[key]=createWrapper(object[key],BIND_FLAG,object)}return object}),bindKey=restParam(function(object,key,partials){var bitmask=BIND_FLAG|BIND_KEY_FLAG;if(partials.length){var holders=replaceHolders(partials,bindKey.placeholder);bitmask|=PARTIAL_FLAG}return createWrapper(key,bitmask,object,partials,holders)}),curry=createCurry(CURRY_FLAG),curryRight=createCurry(CURRY_RIGHT_FLAG),defer=restParam(function(func,args){return baseDelay(func,1,args)}),delay=restParam(function(func,wait,args){return baseDelay(func,wait,args)}),flow=createFlow(),flowRight=createFlow(!0),modArgs=restParam(function(func,transforms){if(transforms=baseFlatten(transforms),"function"!=typeof func||!arrayEvery(transforms,baseIsFunction))throw new TypeError(FUNC_ERROR_TEXT);var length=transforms.length;return restParam(function(args){for(var index=nativeMin(args.length,length);index--;)args[index]=transforms[index](args[index]);return func.apply(this,args)})}),partial=createPartial(PARTIAL_FLAG),partialRight=createPartial(PARTIAL_RIGHT_FLAG),rearg=restParam(function(func,indexes){return createWrapper(func,REARG_FLAG,undefined,undefined,undefined,baseFlatten(indexes))}),isArray=nativeIsArray||function(value){return isObjectLike(value)&&isLength(value.length)&&objToString.call(value)==arrayTag},merge=createAssigner(baseMerge),assign=createAssigner(function(object,source,customizer){return customizer?assignWith(object,source,customizer):baseAssign(object,source)}),defaults=createDefaults(assign,assignDefaults),defaultsDeep=createDefaults(merge,mergeDefaults),findKey=createFindKey(baseForOwn),findLastKey=createFindKey(baseForOwnRight),forIn=createForIn(baseFor),forInRight=createForIn(baseForRight),forOwn=createForOwn(baseForOwn),forOwnRight=createForOwn(baseForOwnRight),keys=nativeKeys?function(object){var Ctor=null==object?undefined:object.constructor;return"function"==typeof Ctor&&Ctor.prototype===object||"function"!=typeof object&&isArrayLike(object)?shimKeys(object):isObject(object)?nativeKeys(object):[]}:shimKeys,mapKeys=createObjectMapper(!0),mapValues=createObjectMapper(),omit=restParam(function(object,props){if(null==object)return{};if("function"!=typeof props[0]){var props=arrayMap(baseFlatten(props),String);return pickByArray(object,baseDifference(keysIn(object),props))}var predicate=bindCallback(props[0],props[1],3);return pickByCallback(object,function(value,key,object){return!predicate(value,key,object)})}),pick=restParam(function(object,props){return null==object?{}:"function"==typeof props[0]?pickByCallback(object,bindCallback(props[0],props[1],3)):pickByArray(object,baseFlatten(props))}),camelCase=createCompounder(function(result,word,index){return word=word.toLowerCase(),result+(index?word.charAt(0).toUpperCase()+word.slice(1):word)}),kebabCase=createCompounder(function(result,word,index){return result+(index?"-":"")+word.toLowerCase()}),padLeft=createPadDir(),padRight=createPadDir(!0),snakeCase=createCompounder(function(result,word,index){return result+(index?"_":"")+word.toLowerCase()}),startCase=createCompounder(function(result,word,index){return result+(index?" ":"")+(word.charAt(0).toUpperCase()+word.slice(1))}),attempt=restParam(function(func,args){try{return func.apply(undefined,args)}catch(e){return isError(e)?e:new Error(e)}}),method=restParam(function(path,args){return function(object){return invokePath(object,path,args)}}),methodOf=restParam(function(object,args){return function(path){return invokePath(object,path,args)}}),ceil=createRound("ceil"),floor=createRound("floor"),max=createExtremum(gt,NEGATIVE_INFINITY),min=createExtremum(lt,POSITIVE_INFINITY),round=createRound("round");return lodash.prototype=baseLodash.prototype,LodashWrapper.prototype=baseCreate(baseLodash.prototype),LodashWrapper.prototype.constructor=LodashWrapper,LazyWrapper.prototype=baseCreate(baseLodash.prototype),LazyWrapper.prototype.constructor=LazyWrapper,MapCache.prototype.delete=mapDelete,MapCache.prototype.get=mapGet,MapCache.prototype.has=mapHas,MapCache.prototype.set=mapSet,SetCache.prototype.push=cachePush,memoize.Cache=MapCache,lodash.after=after,lodash.ary=ary,lodash.assign=assign,lodash.at=at,lodash.before=before,lodash.bind=bind,lodash.bindAll=bindAll,lodash.bindKey=bindKey,lodash.callback=callback,lodash.chain=chain,lodash.chunk=chunk,lodash.compact=compact,lodash.constant=constant,lodash.countBy=countBy,lodash.create=create,lodash.curry=curry,lodash.curryRight=curryRight,lodash.debounce=debounce,lodash.defaults=defaults,lodash.defaultsDeep=defaultsDeep,lodash.defer=defer,lodash.delay=delay,lodash.difference=difference,lodash.drop=drop,lodash.dropRight=dropRight,lodash.dropRightWhile=dropRightWhile,lodash.dropWhile=dropWhile,lodash.fill=fill,lodash.filter=filter,lodash.flatten=flatten,lodash.flattenDeep=flattenDeep,lodash.flow=flow,lodash.flowRight=flowRight,lodash.forEach=forEach,lodash.forEachRight=forEachRight,lodash.forIn=forIn,lodash.forInRight=forInRight,lodash.forOwn=forOwn,lodash.forOwnRight=forOwnRight,lodash.functions=functions,lodash.groupBy=groupBy,lodash.indexBy=indexBy,lodash.initial=initial,lodash.intersection=intersection,lodash.invert=invert,lodash.invoke=invoke,lodash.keys=keys,lodash.keysIn=keysIn,lodash.map=map,lodash.mapKeys=mapKeys,lodash.mapValues=mapValues,lodash.matches=matches,lodash.matchesProperty=matchesProperty,lodash.memoize=memoize,lodash.merge=merge,lodash.method=method,lodash.methodOf=methodOf,lodash.mixin=mixin,lodash.modArgs=modArgs,lodash.negate=negate,lodash.omit=omit,lodash.once=once,lodash.pairs=pairs,lodash.partial=partial,lodash.partialRight=partialRight,lodash.partition=partition,lodash.pick=pick,lodash.pluck=pluck,lodash.property=property,lodash.propertyOf=propertyOf,lodash.pull=pull,lodash.pullAt=pullAt,lodash.range=range,lodash.rearg=rearg,lodash.reject=reject,lodash.remove=remove,lodash.rest=rest,lodash.restParam=restParam,lodash.set=set,lodash.shuffle=shuffle,lodash.slice=slice,lodash.sortBy=sortBy,lodash.sortByAll=sortByAll,lodash.sortByOrder=sortByOrder,lodash.spread=spread,lodash.take=take,lodash.takeRight=takeRight,lodash.takeRightWhile=takeRightWhile,lodash.takeWhile=takeWhile,lodash.tap=tap,lodash.throttle=throttle,lodash.thru=thru,lodash.times=times,lodash.toArray=toArray,lodash.toPlainObject=toPlainObject,lodash.transform=transform,lodash.union=union,lodash.uniq=uniq,lodash.unzip=unzip,lodash.unzipWith=unzipWith,lodash.values=values,lodash.valuesIn=valuesIn,lodash.where=where,lodash.without=without,lodash.wrap=wrap,lodash.xor=xor,lodash.zip=zip,lodash.zipObject=zipObject,lodash.zipWith=zipWith,lodash.backflow=flowRight,lodash.collect=map,lodash.compose=flowRight,lodash.each=forEach,lodash.eachRight=forEachRight,lodash.extend=assign,lodash.iteratee=callback,lodash.methods=functions,lodash.object=zipObject,lodash.select=filter,lodash.tail=rest,lodash.unique=uniq,mixin(lodash,lodash),lodash.add=add,lodash.attempt=attempt,lodash.camelCase=camelCase,lodash.capitalize=capitalize,lodash.ceil=ceil,lodash.clone=clone,lodash.cloneDeep=cloneDeep,lodash.deburr=deburr,lodash.endsWith=endsWith,lodash.escape=escape,lodash.escapeRegExp=escapeRegExp,lodash.every=every,lodash.find=find,lodash.findIndex=findIndex,lodash.findKey=findKey,lodash.findLast=findLast,lodash.findLastIndex=findLastIndex,lodash.findLastKey=findLastKey,lodash.findWhere=findWhere,lodash.first=first,lodash.floor=floor,lodash.get=get,lodash.gt=gt,lodash.gte=gte,lodash.has=has,lodash.identity=identity,lodash.includes=includes,lodash.indexOf=indexOf,lodash.inRange=inRange,lodash.isArguments=isArguments,lodash.isArray=isArray,lodash.isBoolean=isBoolean,lodash.isDate=isDate,lodash.isElement=isElement,lodash.isEmpty=isEmpty,lodash.isEqual=isEqual,lodash.isError=isError,lodash.isFinite=isFinite,lodash.isFunction=isFunction,lodash.isMatch=isMatch,lodash.isNaN=isNaN,lodash.isNative=isNative,lodash.isNull=isNull,lodash.isNumber=isNumber,lodash.isObject=isObject,lodash.isPlainObject=isPlainObject,lodash.isRegExp=isRegExp,lodash.isString=isString,lodash.isTypedArray=isTypedArray,lodash.isUndefined=isUndefined,lodash.kebabCase=kebabCase,lodash.last=last,lodash.lastIndexOf=lastIndexOf,lodash.lt=lt,lodash.lte=lte,lodash.max=max,lodash.min=min,lodash.noConflict=noConflict,lodash.noop=noop,lodash.now=now,lodash.pad=pad,lodash.padLeft=padLeft,lodash.padRight=padRight,lodash.parseInt=parseInt,lodash.random=random,lodash.reduce=reduce,lodash.reduceRight=reduceRight,lodash.repeat=repeat,lodash.result=result,lodash.round=round,lodash.runInContext=runInContext,lodash.size=size,lodash.snakeCase=snakeCase,lodash.some=some,lodash.sortedIndex=sortedIndex,lodash.sortedLastIndex=sortedLastIndex,lodash.startCase=startCase,lodash.startsWith=startsWith,lodash.sum=sum,lodash.template=template,lodash.trim=trim,lodash.trimLeft=trimLeft,lodash.trimRight=trimRight,lodash.trunc=trunc,lodash.unescape=unescape,lodash.uniqueId=uniqueId,lodash.words=words,lodash.all=every,lodash.any=some,lodash.contains=includes,lodash.eq=isEqual,lodash.detect=find,lodash.foldl=reduce,lodash.foldr=reduceRight,lodash.head=first,lodash.include=includes,lodash.inject=reduce,mixin(lodash,function(){var source={};return baseForOwn(lodash,function(func,methodName){lodash.prototype[methodName]||(source[methodName]=func)}),source}(),!1),lodash.sample=sample,lodash.prototype.sample=function(n){return this.__chain__||null!=n?this.thru(function(value){return sample(value,n)}):sample(this.value())},lodash.VERSION=VERSION,arrayEach(["bind","bindKey","curry","curryRight","partial","partialRight"],function(methodName){lodash[methodName].placeholder=lodash}),arrayEach(["drop","take"],function(methodName,index){LazyWrapper.prototype[methodName]=function(n){var filtered=this.__filtered__;if(filtered&&!index)return new LazyWrapper(this);n=null==n?1:nativeMax(nativeFloor(n)||0,0);var result=this.clone();return filtered?result.__takeCount__=nativeMin(result.__takeCount__,n):result.__views__.push({size:n,type:methodName+(result.__dir__<0?"Right":"")}),result},LazyWrapper.prototype[methodName+"Right"]=function(n){return this.reverse()[methodName](n).reverse()}}),arrayEach(["filter","map","takeWhile"],function(methodName,index){var type=index+1,isFilter=type!=LAZY_MAP_FLAG;LazyWrapper.prototype[methodName]=function(iteratee,thisArg){var result=this.clone();return result.__iteratees__.push({iteratee:getCallback(iteratee,thisArg,1),type:type}),result.__filtered__=result.__filtered__||isFilter,result}}),arrayEach(["first","last"],function(methodName,index){var takeName="take"+(index?"Right":"");LazyWrapper.prototype[methodName]=function(){return this[takeName](1).value()[0]}}),arrayEach(["initial","rest"],function(methodName,index){var dropName="drop"+(index?"":"Right");LazyWrapper.prototype[methodName]=function(){return this.__filtered__?new LazyWrapper(this):this[dropName](1)}}),arrayEach(["pluck","where"],function(methodName,index){var operationName=index?"filter":"map",createCallback=index?baseMatches:property;LazyWrapper.prototype[methodName]=function(value){return this[operationName](createCallback(value))}}),LazyWrapper.prototype.compact=function(){return this.filter(identity)},LazyWrapper.prototype.reject=function(predicate,thisArg){return predicate=getCallback(predicate,thisArg,1),this.filter(function(value){return!predicate(value)})},LazyWrapper.prototype.slice=function(start,end){start=null==start?0:+start||0;var result=this;return result.__filtered__&&(start>0||0>end)?new LazyWrapper(result):(0>start?result=result.takeRight(-start):start&&(result=result.drop(start)),end!==undefined&&(end=+end||0,result=0>end?result.dropRight(-end):result.take(end-start)),result)},LazyWrapper.prototype.takeRightWhile=function(predicate,thisArg){return this.reverse().takeWhile(predicate,thisArg).reverse()},LazyWrapper.prototype.toArray=function(){return this.take(POSITIVE_INFINITY)},baseForOwn(LazyWrapper.prototype,function(func,methodName){var checkIteratee=/^(?:filter|map|reject)|While$/.test(methodName),retUnwrapped=/^(?:first|last)$/.test(methodName),lodashFunc=lodash[retUnwrapped?"take"+("last"==methodName?"Right":""):methodName];lodashFunc&&(lodash.prototype[methodName]=function(){var args=retUnwrapped?[1]:arguments,chainAll=this.__chain__,value=this.__wrapped__,isHybrid=!!this.__actions__.length,isLazy=value instanceof LazyWrapper,iteratee=args[0],useLazy=isLazy||isArray(value);useLazy&&checkIteratee&&"function"==typeof iteratee&&1!=iteratee.length&&(isLazy=useLazy=!1);var interceptor=function(value){return retUnwrapped&&chainAll?lodashFunc(value,1)[0]:lodashFunc.apply(undefined,arrayPush([value],args))},action={func:thru,args:[interceptor],thisArg:undefined},onlyLazy=isLazy&&!isHybrid;if(retUnwrapped&&!chainAll)return onlyLazy?(value=value.clone(),value.__actions__.push(action),func.call(value)):lodashFunc.call(undefined,this.value())[0];if(!retUnwrapped&&useLazy){value=onlyLazy?value:new LazyWrapper(this);var result=func.apply(value,args);return result.__actions__.push(action),new LodashWrapper(result,chainAll)}return this.thru(interceptor)})}),arrayEach(["join","pop","push","replace","shift","sort","splice","split","unshift"],function(methodName){var func=(/^(?:replace|split)$/.test(methodName)?stringProto:arrayProto)[methodName],chainName=/^(?:push|sort|unshift)$/.test(methodName)?"tap":"thru",retUnwrapped=/^(?:join|pop|replace|shift)$/.test(methodName);lodash.prototype[methodName]=function(){var args=arguments;return retUnwrapped&&!this.__chain__?func.apply(this.value(),args):this[chainName](function(value){return func.apply(value,args)})}}),baseForOwn(LazyWrapper.prototype,function(func,methodName){var lodashFunc=lodash[methodName];if(lodashFunc){var key=lodashFunc.name,names=realNames[key]||(realNames[key]=[]);names.push({name:methodName,func:lodashFunc})}}),realNames[createHybridWrapper(undefined,BIND_KEY_FLAG).name]=[{name:"wrapper",func:undefined}],LazyWrapper.prototype.clone=lazyClone,LazyWrapper.prototype.reverse=lazyReverse,LazyWrapper.prototype.value=lazyValue,lodash.prototype.chain=wrapperChain,lodash.prototype.commit=wrapperCommit,lodash.prototype.concat=wrapperConcat,lodash.prototype.plant=wrapperPlant,lodash.prototype.reverse=wrapperReverse,lodash.prototype.toString=wrapperToString,lodash.prototype.run=lodash.prototype.toJSON=lodash.prototype.valueOf=lodash.prototype.value=wrapperValue,lodash.prototype.collect=lodash.prototype.map,lodash.prototype.head=lodash.prototype.first,lodash.prototype.select=lodash.prototype.filter,lodash.prototype.tail=lodash.prototype.rest,lodash}var undefined,VERSION="3.10.1",BIND_FLAG=1,BIND_KEY_FLAG=2,CURRY_BOUND_FLAG=4,CURRY_FLAG=8,CURRY_RIGHT_FLAG=16,PARTIAL_FLAG=32,PARTIAL_RIGHT_FLAG=64,ARY_FLAG=128,REARG_FLAG=256,DEFAULT_TRUNC_LENGTH=30,DEFAULT_TRUNC_OMISSION="...",HOT_COUNT=150,HOT_SPAN=16,LARGE_ARRAY_SIZE=200,LAZY_FILTER_FLAG=1,LAZY_MAP_FLAG=2,FUNC_ERROR_TEXT="Expected a function",PLACEHOLDER="__lodash_placeholder__",argsTag="[object Arguments]",arrayTag="[object Array]",boolTag="[object Boolean]",dateTag="[object Date]",errorTag="[object Error]",funcTag="[object Function]",mapTag="[object Map]",numberTag="[object Number]",objectTag="[object Object]",regexpTag="[object RegExp]",setTag="[object Set]",stringTag="[object String]",weakMapTag="[object WeakMap]",arrayBufferTag="[object ArrayBuffer]",float32Tag="[object Float32Array]",float64Tag="[object Float64Array]",int8Tag="[object Int8Array]",int16Tag="[object Int16Array]",int32Tag="[object Int32Array]",uint8Tag="[object Uint8Array]",uint8ClampedTag="[object Uint8ClampedArray]",uint16Tag="[object Uint16Array]",uint32Tag="[object Uint32Array]",reEmptyStringLeading=/\b__p \+= '';/g,reEmptyStringMiddle=/\b(__p \+=) '' \+/g,reEmptyStringTrailing=/(__e\(.*?\)|\b__t\)) \+\n'';/g,reEscapedHtml=/&(?:amp|lt|gt|quot|#39|#96);/g,reUnescapedHtml=/[&<>"'`]/g,reHasEscapedHtml=RegExp(reEscapedHtml.source),reHasUnescapedHtml=RegExp(reUnescapedHtml.source),reEscape=/<%-([\s\S]+?)%>/g,reEvaluate=/<%([\s\S]+?)%>/g,reInterpolate=/<%=([\s\S]+?)%>/g,reIsDeepProp=/\.|\[(?:[^[\]]*|(["'])(?:(?!\1)[^\n\\]|\\.)*?\1)\]/,reIsPlainProp=/^\w*$/,rePropName=/[^.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\n\\]|\\.)*?)\2)\]/g,reRegExpChars=/^[:!,]|[\\^$.*+?()[\]{}|\/]|(^[0-9a-fA-Fnrtuvx])|([\n\r\u2028\u2029])/g,reHasRegExpChars=RegExp(reRegExpChars.source),reComboMark=/[\u0300-\u036f\ufe20-\ufe23]/g,reEscapeChar=/\\(\\)?/g,reEsTemplate=/\$\{([^\\}]*(?:\\.[^\\}]*)*)\}/g,reFlags=/\w*$/,reHasHexPrefix=/^0[xX]/,reIsHostCtor=/^\[object .+?Constructor\]$/,reIsUint=/^\d+$/,reLatin1=/[\xc0-\xd6\xd8-\xde\xdf-\xf6\xf8-\xff]/g,reNoMatch=/($^)/,reUnescapedString=/['\n\r\u2028\u2029\\]/g,reWords=function(){var upper="[A-Z\\xc0-\\xd6\\xd8-\\xde]",lower="[a-z\\xdf-\\xf6\\xf8-\\xff]+";return RegExp(upper+"+(?="+upper+lower+")|"+upper+"?"+lower+"|"+upper+"+|[0-9]+","g")}(),contextProps=["Array","ArrayBuffer","Date","Error","Float32Array","Float64Array","Function","Int8Array","Int16Array","Int32Array","Math","Number","Object","RegExp","Set","String","_","clearTimeout","isFinite","parseFloat","parseInt","setTimeout","TypeError","Uint8Array","Uint8ClampedArray","Uint16Array","Uint32Array","WeakMap"],templateCounter=-1,typedArrayTags={};typedArrayTags[float32Tag]=typedArrayTags[float64Tag]=typedArrayTags[int8Tag]=typedArrayTags[int16Tag]=typedArrayTags[int32Tag]=typedArrayTags[uint8Tag]=typedArrayTags[uint8ClampedTag]=typedArrayTags[uint16Tag]=typedArrayTags[uint32Tag]=!0,typedArrayTags[argsTag]=typedArrayTags[arrayTag]=typedArrayTags[arrayBufferTag]=typedArrayTags[boolTag]=typedArrayTags[dateTag]=typedArrayTags[errorTag]=typedArrayTags[funcTag]=typedArrayTags[mapTag]=typedArrayTags[numberTag]=typedArrayTags[objectTag]=typedArrayTags[regexpTag]=typedArrayTags[setTag]=typedArrayTags[stringTag]=typedArrayTags[weakMapTag]=!1;var cloneableTags={};cloneableTags[argsTag]=cloneableTags[arrayTag]=cloneableTags[arrayBufferTag]=cloneableTags[boolTag]=cloneableTags[dateTag]=cloneableTags[float32Tag]=cloneableTags[float64Tag]=cloneableTags[int8Tag]=cloneableTags[int16Tag]=cloneableTags[int32Tag]=cloneableTags[numberTag]=cloneableTags[objectTag]=cloneableTags[regexpTag]=cloneableTags[stringTag]=cloneableTags[uint8Tag]=cloneableTags[uint8ClampedTag]=cloneableTags[uint16Tag]=cloneableTags[uint32Tag]=!0,cloneableTags[errorTag]=cloneableTags[funcTag]=cloneableTags[mapTag]=cloneableTags[setTag]=cloneableTags[weakMapTag]=!1;var deburredLetters={"À":"A","Á":"A","Â":"A","Ã":"A","Ä":"A","Å":"A","à":"a","á":"a","â":"a","ã":"a","ä":"a","å":"a","Ç":"C","ç":"c","Ð":"D","ð":"d","È":"E","É":"E","Ê":"E","Ë":"E","è":"e","é":"e","ê":"e","ë":"e","Ì":"I","Í":"I","Î":"I","Ï":"I","ì":"i","í":"i","î":"i","ï":"i","Ñ":"N","ñ":"n","Ò":"O","Ó":"O","Ô":"O","Õ":"O","Ö":"O","Ø":"O","ò":"o","ó":"o","ô":"o","õ":"o","ö":"o","ø":"o","Ù":"U","Ú":"U","Û":"U","Ü":"U","ù":"u","ú":"u","û":"u","ü":"u","Ý":"Y","ý":"y","ÿ":"y","Æ":"Ae","æ":"ae","Þ":"Th","þ":"th","ß":"ss"},htmlEscapes={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;","`":"&#96;"},htmlUnescapes={"&amp;":"&","&lt;":"<","&gt;":">","&quot;":'"',"&#39;":"'","&#96;":"`"},objectTypes={function:!0,object:!0},regexpEscapes={0:"x30",1:"x31",2:"x32",3:"x33",4:"x34",5:"x35",6:"x36",7:"x37",8:"x38",9:"x39",A:"x41",B:"x42",C:"x43",D:"x44",E:"x45",F:"x46",a:"x61",b:"x62",c:"x63",d:"x64",e:"x65",f:"x66",n:"x6e",r:"x72",t:"x74",u:"x75",v:"x76",x:"x78"},stringEscapes={"\\":"\\","'":"'","\n":"n","\r":"r","\u2028":"u2028","\u2029":"u2029"},freeExports=objectTypes[typeof exports]&&exports&&!exports.nodeType&&exports,freeModule=objectTypes[typeof module]&&module&&!module.nodeType&&module,freeGlobal=freeExports&&freeModule&&"object"==typeof global&&global&&global.Object&&global,freeSelf=objectTypes[typeof self]&&self&&self.Object&&self,freeWindow=objectTypes[typeof window]&&window&&window.Object&&window,moduleExports=freeModule&&freeModule.exports===freeExports&&freeExports,root=freeGlobal||freeWindow!==(this&&this.window)&&freeWindow||freeSelf||this,_=runInContext();"function"==typeof define&&"object"==typeof define.amd&&define.amd?(root._=_,define(function(){return _})):freeExports&&freeModule?moduleExports?(freeModule.exports=_)._=_:freeExports._=_:root._=_}).call(this)}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{}],26:[function(require,module,exports){"use strict";function toObject(val){if(null===val||void 0===val)throw new TypeError("Object.assign cannot be called with null or undefined");return Object(val)}var hasOwnProperty=Object.prototype.hasOwnProperty,propIsEnumerable=Object.prototype.propertyIsEnumerable;module.exports=Object.assign||function(target,source){for(var from,symbols,to=toObject(target),s=1;s<arguments.length;s++){from=Object(arguments[s]);for(var key in from)hasOwnProperty.call(from,key)&&(to[key]=from[key]);if(Object.getOwnPropertySymbols){symbols=Object.getOwnPropertySymbols(from);for(var i=0;i<symbols.length;i++)propIsEnumerable.call(from,symbols[i])&&(to[symbols[i]]=from[symbols[i]])}}return to}},{}],27:[function(require,module,exports){(function(process){function normalizeArray(parts,allowAboveRoot){for(var up=0,i=parts.length-1;i>=0;i--){var last=parts[i];"."===last?parts.splice(i,1):".."===last?(parts.splice(i,1),up++):up&&(parts.splice(i,1),up--)}if(allowAboveRoot)for(;up--;up)parts.unshift("..");return parts}function filter(xs,f){if(xs.filter)return xs.filter(f);for(var res=[],i=0;i<xs.length;i++)f(xs[i],i,xs)&&res.push(xs[i]);return res}var splitPathRe=/^(\/?|)([\s\S]*?)((?:\.{1,2}|[^\/]+?|)(\.[^.\/]*|))(?:[\/]*)$/,splitPath=function(filename){return splitPathRe.exec(filename).slice(1)};exports.resolve=function(){for(var resolvedPath="",resolvedAbsolute=!1,i=arguments.length-1;i>=-1&&!resolvedAbsolute;i--){var path=i>=0?arguments[i]:process.cwd();if("string"!=typeof path)throw new TypeError("Arguments to path.resolve must be strings");path&&(resolvedPath=path+"/"+resolvedPath,resolvedAbsolute="/"===path.charAt(0))}return resolvedPath=normalizeArray(filter(resolvedPath.split("/"),function(p){return!!p}),!resolvedAbsolute).join("/"),(resolvedAbsolute?"/":"")+resolvedPath||"."},exports.normalize=function(path){var isAbsolute=exports.isAbsolute(path),trailingSlash="/"===substr(path,-1);return path=normalizeArray(filter(path.split("/"),function(p){return!!p}),!isAbsolute).join("/"),path||isAbsolute||(path="."),path&&trailingSlash&&(path+="/"),(isAbsolute?"/":"")+path},exports.isAbsolute=function(path){return"/"===path.charAt(0)},exports.join=function(){var paths=Array.prototype.slice.call(arguments,0);return exports.normalize(filter(paths,function(p,index){if("string"!=typeof p)throw new TypeError("Arguments to path.join must be strings");return p}).join("/"))},exports.relative=function(from,to){function trim(arr){for(var start=0;start<arr.length&&""===arr[start];start++);for(var end=arr.length-1;end>=0&&""===arr[end];end--);return start>end?[]:arr.slice(start,end-start+1)}from=exports.resolve(from).substr(1),to=exports.resolve(to).substr(1);for(var fromParts=trim(from.split("/")),toParts=trim(to.split("/")),length=Math.min(fromParts.length,toParts.length),samePartsLength=length,i=0;length>i;i++)if(fromParts[i]!==toParts[i]){samePartsLength=i;break}for(var outputParts=[],i=samePartsLength;i<fromParts.length;i++)outputParts.push("..");return outputParts=outputParts.concat(toParts.slice(samePartsLength)),outputParts.join("/")},exports.sep="/",exports.delimiter=":",exports.dirname=function(path){var result=splitPath(path),root=result[0],dir=result[1];return root||dir?(dir&&(dir=dir.substr(0,dir.length-1)),root+dir):"."},exports.basename=function(path,ext){var f=splitPath(path)[2];return ext&&f.substr(-1*ext.length)===ext&&(f=f.substr(0,f.length-ext.length)),f},exports.extname=function(path){return splitPath(path)[3]};var substr="b"==="ab".substr(-1)?function(str,start,len){return str.substr(start,len)}:function(str,start,len){return 0>start&&(start=str.length+start),str.substr(start,len)}}).call(this,require("_process"))},{_process:140}],28:[function(require,module,exports){module.exports={_args:[["pixi.js@^3.0.8","/Users/etienne-dldc/Workspace/gob-sound-2"]],_from:"pixi.js@>=3.0.8 <4.0.0",_id:"pixi.js@3.0.8",_inCache:!0,_installable:!0,_location:"/pixi.js",_nodeVersion:"0.12.4",_npmUser:{email:"englercj@live.com",name:"englercj"},_npmVersion:"2.7.1",_phantomChildren:{},_requested:{name:"pixi.js",raw:"pixi.js@^3.0.8",rawSpec:"^3.0.8",scope:null,spec:">=3.0.8 <4.0.0",type:"range"},_requiredBy:["/"],_resolved:"https://registry.npmjs.org/pixi.js/-/pixi.js-3.0.8.tgz",_shasum:"259dbe9739957587f160417dce7df9e1c5e47521",_shrinkwrap:null,_spec:"pixi.js@^3.0.8",_where:"/Users/etienne-dldc/Workspace/gob-sound-2",author:{name:"Mat Groves"},browserify:{transform:["brfs"]},bugs:{url:"https://github.com/pixijs/pixi.js/issues"},contributors:[{name:"Chad Engler",email:"chad@pantherdev.com"},{name:"Richard Davey",email:"rdavey@gmail.com"}],dependencies:{async:"^1.4.2",brfs:"^1.4.1",earcut:"^2.0.2",eventemitter3:"^1.1.1","gulp-header":"^1.7.1","object-assign":"^4.0.1","resource-loader":"^1.6.2"},description:"Pixi.js is a fast lightweight 2D library that works across all devices.",devDependencies:{browserify:"^11.1.0",chai:"^3.2.0",del:"^2.0.2",gulp:"^3.9.0","gulp-cached":"^1.1.0","gulp-concat":"^2.6.0","gulp-debug":"^2.1.0","gulp-jshint":"^1.11.2","gulp-mirror":"^0.4.0","gulp-plumber":"^1.0.1","gulp-rename":"^1.2.2","gulp-sourcemaps":"^1.5.2","gulp-uglify":"^1.4.1","gulp-util":"^3.0.6","jaguarjs-jsdoc":"git+https://github.com/davidshimjs/jaguarjs-jsdoc.git",jsdoc:"^3.3.2","jshint-summary":"^0.4.0",minimist:"^1.2.0",mocha:"^2.3.2","require-dir":"^0.3.0","run-sequence":"^1.1.2",testem:"^0.9.4","vinyl-buffer":"^1.0.0","vinyl-source-stream":"^1.1.0",watchify:"^3.4.0"},directories:{},dist:{shasum:"259dbe9739957587f160417dce7df9e1c5e47521",tarball:"http://registry.npmjs.org/pixi.js/-/pixi.js-3.0.8.tgz"},files:["CONTRIBUTING.md","LICENSE","README.md","bin/","package.json","src/"],gitHead:"5d385885324e97369fd29b686e9e90eb4cefd14a",homepage:"http://goodboydigital.com/",license:"MIT",main:"./src/index.js",maintainers:[{name:"englercj",email:"englercj@live.com"}],name:"pixi.js",optionalDependencies:{},readme:"ERROR: No README data found!",repository:{type:"git",url:"git+https://github.com/pixijs/pixi.js.git"},scripts:{build:"gulp",docs:"jsdoc -c ./gulp/util/jsdoc.conf.json -R README.md",start:"gulp && gulp watch",test:"gulp && testem ci"},version:"3.0.8"}},{}],29:[function(require,module,exports){var CONST={VERSION:require("../../package.json").version,PI_2:2*Math.PI,RAD_TO_DEG:180/Math.PI,DEG_TO_RAD:Math.PI/180,TARGET_FPMS:.06,RENDERER_TYPE:{UNKNOWN:0,WEBGL:1,CANVAS:2},BLEND_MODES:{NORMAL:0,ADD:1,MULTIPLY:2,SCREEN:3,OVERLAY:4,DARKEN:5,LIGHTEN:6,COLOR_DODGE:7,COLOR_BURN:8,HARD_LIGHT:9,SOFT_LIGHT:10,DIFFERENCE:11,EXCLUSION:12,HUE:13,SATURATION:14,COLOR:15,LUMINOSITY:16},DRAW_MODES:{POINTS:0,LINES:1,LINE_LOOP:2,LINE_STRIP:3,TRIANGLES:4,TRIANGLE_STRIP:5,TRIANGLE_FAN:6},SCALE_MODES:{DEFAULT:0,LINEAR:0,NEAREST:1},RETINA_PREFIX:/@(.+)x/,RESOLUTION:1,FILTER_RESOLUTION:1,DEFAULT_RENDER_OPTIONS:{view:null,resolution:1,antialias:!1,forceFXAA:!1,autoResize:!1,transparent:!1,backgroundColor:0,clearBeforeRender:!0,preserveDrawingBuffer:!1,roundPixels:!1},SHAPES:{POLY:0,RECT:1,CIRC:2,ELIP:3,RREC:4},SPRITE_BATCH_SIZE:2e3};module.exports=CONST},{"../../package.json":28}],30:[function(require,module,exports){
function Container(){DisplayObject.call(this),this.children=[]}var math=require("../math"),DisplayObject=require("./DisplayObject"),RenderTexture=require("../textures/RenderTexture"),_tempMatrix=new math.Matrix;Container.prototype=Object.create(DisplayObject.prototype),Container.prototype.constructor=Container,module.exports=Container,Object.defineProperties(Container.prototype,{width:{get:function(){return this.scale.x*this.getLocalBounds().width},set:function(value){var width=this.getLocalBounds().width;0!==width?this.scale.x=value/width:this.scale.x=1,this._width=value}},height:{get:function(){return this.scale.y*this.getLocalBounds().height},set:function(value){var height=this.getLocalBounds().height;0!==height?this.scale.y=value/height:this.scale.y=1,this._height=value}}}),Container.prototype.onChildrenChange=function(){},Container.prototype.addChild=function(child){return this.addChildAt(child,this.children.length)},Container.prototype.addChildAt=function(child,index){if(child===this)return child;if(index>=0&&index<=this.children.length)return child.parent&&child.parent.removeChild(child),child.parent=this,this.children.splice(index,0,child),this.onChildrenChange(index),child.emit("added",this),child;throw new Error(child+"addChildAt: The index "+index+" supplied is out of bounds "+this.children.length)},Container.prototype.swapChildren=function(child,child2){if(child!==child2){var index1=this.getChildIndex(child),index2=this.getChildIndex(child2);if(0>index1||0>index2)throw new Error("swapChildren: Both the supplied DisplayObjects must be children of the caller.");this.children[index1]=child2,this.children[index2]=child,this.onChildrenChange(index2>index1?index1:index2)}},Container.prototype.getChildIndex=function(child){var index=this.children.indexOf(child);if(-1===index)throw new Error("The supplied DisplayObject must be a child of the caller");return index},Container.prototype.setChildIndex=function(child,index){if(0>index||index>=this.children.length)throw new Error("The supplied index is out of bounds");var currentIndex=this.getChildIndex(child);this.children.splice(currentIndex,1),this.children.splice(index,0,child),this.onChildrenChange(index)},Container.prototype.getChildAt=function(index){if(0>index||index>=this.children.length)throw new Error("getChildAt: Supplied index "+index+" does not exist in the child list, or the supplied DisplayObject is not a child of the caller");return this.children[index]},Container.prototype.removeChild=function(child){var index=this.children.indexOf(child);if(-1!==index)return this.removeChildAt(index)},Container.prototype.removeChildAt=function(index){var child=this.getChildAt(index);return child.parent=null,this.children.splice(index,1),this.onChildrenChange(index),child.emit("removed",this),child},Container.prototype.removeChildren=function(beginIndex,endIndex){var removed,i,begin=beginIndex||0,end="number"==typeof endIndex?endIndex:this.children.length,range=end-begin;if(range>0&&end>=range){for(removed=this.children.splice(begin,range),i=0;i<removed.length;++i)removed[i].parent=null;for(this.onChildrenChange(beginIndex),i=0;i<removed.length;++i)removed[i].emit("removed",this);return removed}if(0===range&&0===this.children.length)return[];throw new RangeError("removeChildren: numeric values are outside the acceptable range.")},Container.prototype.generateTexture=function(renderer,resolution,scaleMode){var bounds=this.getLocalBounds(),renderTexture=new RenderTexture(renderer,0|bounds.width,0|bounds.height,scaleMode,resolution);return _tempMatrix.tx=-bounds.x,_tempMatrix.ty=-bounds.y,renderTexture.render(this,_tempMatrix),renderTexture},Container.prototype.updateTransform=function(){if(this.visible){this.displayObjectUpdateTransform();for(var i=0,j=this.children.length;j>i;++i)this.children[i].updateTransform()}},Container.prototype.containerUpdateTransform=Container.prototype.updateTransform,Container.prototype.getBounds=function(){if(!this._currentBounds){if(0===this.children.length)return math.Rectangle.EMPTY;for(var childBounds,childMaxX,childMaxY,minX=1/0,minY=1/0,maxX=-(1/0),maxY=-(1/0),childVisible=!1,i=0,j=this.children.length;j>i;++i){var child=this.children[i];child.visible&&(childVisible=!0,childBounds=this.children[i].getBounds(),minX=minX<childBounds.x?minX:childBounds.x,minY=minY<childBounds.y?minY:childBounds.y,childMaxX=childBounds.width+childBounds.x,childMaxY=childBounds.height+childBounds.y,maxX=maxX>childMaxX?maxX:childMaxX,maxY=maxY>childMaxY?maxY:childMaxY)}if(!childVisible)return math.Rectangle.EMPTY;var bounds=this._bounds;bounds.x=minX,bounds.y=minY,bounds.width=maxX-minX,bounds.height=maxY-minY,this._currentBounds=bounds}return this._currentBounds},Container.prototype.containerGetBounds=Container.prototype.getBounds,Container.prototype.getLocalBounds=function(){var matrixCache=this.worldTransform;this.worldTransform=math.Matrix.IDENTITY;for(var i=0,j=this.children.length;j>i;++i)this.children[i].updateTransform();return this.worldTransform=matrixCache,this._currentBounds=null,this.getBounds(math.Matrix.IDENTITY)},Container.prototype.renderWebGL=function(renderer){if(this.visible&&!(this.worldAlpha<=0)&&this.renderable){var i,j;if(this._mask||this._filters){for(renderer.currentRenderer.flush(),this._filters&&this._filters.length&&renderer.filterManager.pushFilter(this,this._filters),this._mask&&renderer.maskManager.pushMask(this,this._mask),renderer.currentRenderer.start(),this._renderWebGL(renderer),i=0,j=this.children.length;j>i;i++)this.children[i].renderWebGL(renderer);renderer.currentRenderer.flush(),this._mask&&renderer.maskManager.popMask(this,this._mask),this._filters&&renderer.filterManager.popFilter(),renderer.currentRenderer.start()}else for(this._renderWebGL(renderer),i=0,j=this.children.length;j>i;++i)this.children[i].renderWebGL(renderer)}},Container.prototype._renderWebGL=function(renderer){},Container.prototype._renderCanvas=function(renderer){},Container.prototype.renderCanvas=function(renderer){if(this.visible&&!(this.alpha<=0)&&this.renderable){this._mask&&renderer.maskManager.pushMask(this._mask,renderer),this._renderCanvas(renderer);for(var i=0,j=this.children.length;j>i;++i)this.children[i].renderCanvas(renderer);this._mask&&renderer.maskManager.popMask(renderer)}},Container.prototype.destroy=function(destroyChildren){if(DisplayObject.prototype.destroy.call(this),destroyChildren)for(var i=0,j=this.children.length;j>i;++i)this.children[i].destroy(destroyChildren);this.removeChildren(),this.children=null}},{"../math":39,"../textures/RenderTexture":77,"./DisplayObject":31}],31:[function(require,module,exports){function DisplayObject(){EventEmitter.call(this),this.position=new math.Point,this.scale=new math.Point(1,1),this.pivot=new math.Point(0,0),this.rotation=0,this.alpha=1,this.visible=!0,this.renderable=!0,this.parent=null,this.worldAlpha=1,this.worldTransform=new math.Matrix,this.filterArea=null,this._sr=0,this._cr=1,this._bounds=new math.Rectangle(0,0,1,1),this._currentBounds=null,this._mask=null}var math=require("../math"),RenderTexture=require("../textures/RenderTexture"),EventEmitter=require("eventemitter3"),CONST=require("../const"),_tempMatrix=new math.Matrix,_tempDisplayObjectParent={worldTransform:new math.Matrix,worldAlpha:1,children:[]};DisplayObject.prototype=Object.create(EventEmitter.prototype),DisplayObject.prototype.constructor=DisplayObject,module.exports=DisplayObject,Object.defineProperties(DisplayObject.prototype,{x:{get:function(){return this.position.x},set:function(value){this.position.x=value}},y:{get:function(){return this.position.y},set:function(value){this.position.y=value}},worldVisible:{get:function(){var item=this;do{if(!item.visible)return!1;item=item.parent}while(item);return!0}},mask:{get:function(){return this._mask},set:function(value){this._mask&&(this._mask.renderable=!0),this._mask=value,this._mask&&(this._mask.renderable=!1)}},filters:{get:function(){return this._filters&&this._filters.slice()},set:function(value){this._filters=value&&value.slice()}}}),DisplayObject.prototype.updateTransform=function(){var a,b,c,d,tx,ty,pt=this.parent.worldTransform,wt=this.worldTransform;this.rotation%CONST.PI_2?(this.rotation!==this.rotationCache&&(this.rotationCache=this.rotation,this._sr=Math.sin(this.rotation),this._cr=Math.cos(this.rotation)),a=this._cr*this.scale.x,b=this._sr*this.scale.x,c=-this._sr*this.scale.y,d=this._cr*this.scale.y,tx=this.position.x,ty=this.position.y,(this.pivot.x||this.pivot.y)&&(tx-=this.pivot.x*a+this.pivot.y*c,ty-=this.pivot.x*b+this.pivot.y*d),wt.a=a*pt.a+b*pt.c,wt.b=a*pt.b+b*pt.d,wt.c=c*pt.a+d*pt.c,wt.d=c*pt.b+d*pt.d,wt.tx=tx*pt.a+ty*pt.c+pt.tx,wt.ty=tx*pt.b+ty*pt.d+pt.ty):(a=this.scale.x,d=this.scale.y,tx=this.position.x-this.pivot.x*a,ty=this.position.y-this.pivot.y*d,wt.a=a*pt.a,wt.b=a*pt.b,wt.c=d*pt.c,wt.d=d*pt.d,wt.tx=tx*pt.a+ty*pt.c+pt.tx,wt.ty=tx*pt.b+ty*pt.d+pt.ty),this.worldAlpha=this.alpha*this.parent.worldAlpha,this._currentBounds=null},DisplayObject.prototype.displayObjectUpdateTransform=DisplayObject.prototype.updateTransform,DisplayObject.prototype.getBounds=function(matrix){return math.Rectangle.EMPTY},DisplayObject.prototype.getLocalBounds=function(){return this.getBounds(math.Matrix.IDENTITY)},DisplayObject.prototype.toGlobal=function(position){return this.parent?this.displayObjectUpdateTransform():(this.parent=_tempDisplayObjectParent,this.displayObjectUpdateTransform(),this.parent=null),this.worldTransform.apply(position)},DisplayObject.prototype.toLocal=function(position,from){return from&&(position=from.toGlobal(position)),this.parent?this.displayObjectUpdateTransform():(this.parent=_tempDisplayObjectParent,this.displayObjectUpdateTransform(),this.parent=null),this.worldTransform.applyInverse(position)},DisplayObject.prototype.renderWebGL=function(renderer){},DisplayObject.prototype.renderCanvas=function(renderer){},DisplayObject.prototype.generateTexture=function(renderer,scaleMode,resolution){var bounds=this.getLocalBounds(),renderTexture=new RenderTexture(renderer,0|bounds.width,0|bounds.height,scaleMode,resolution);return _tempMatrix.tx=-bounds.x,_tempMatrix.ty=-bounds.y,renderTexture.render(this,_tempMatrix),renderTexture},DisplayObject.prototype.setParent=function(container){if(!container||!container.addChild)throw new Error("setParent: Argument must be a Container");return container.addChild(this),container},DisplayObject.prototype.destroy=function(){this.position=null,this.scale=null,this.pivot=null,this.parent=null,this._bounds=null,this._currentBounds=null,this._mask=null,this.worldTransform=null,this.filterArea=null}},{"../const":29,"../math":39,"../textures/RenderTexture":77,eventemitter3:22}],32:[function(require,module,exports){function Graphics(){Container.call(this),this.fillAlpha=1,this.lineWidth=0,this.lineColor=0,this.graphicsData=[],this.tint=16777215,this._prevTint=16777215,this.blendMode=CONST.BLEND_MODES.NORMAL,this.currentPath=null,this._webGL={},this.isMask=!1,this.boundsPadding=0,this._localBounds=new math.Rectangle(0,0,1,1),this.dirty=!0,this.glDirty=!1,this.boundsDirty=!0,this.cachedSpriteDirty=!1}var Container=require("../display/Container"),Texture=require("../textures/Texture"),CanvasBuffer=require("../renderers/canvas/utils/CanvasBuffer"),CanvasGraphics=require("../renderers/canvas/utils/CanvasGraphics"),GraphicsData=require("./GraphicsData"),math=require("../math"),CONST=require("../const"),tempPoint=new math.Point;Graphics.prototype=Object.create(Container.prototype),Graphics.prototype.constructor=Graphics,module.exports=Graphics,Graphics.prototype.clone=function(){var clone=new Graphics;clone.renderable=this.renderable,clone.fillAlpha=this.fillAlpha,clone.lineWidth=this.lineWidth,clone.lineColor=this.lineColor,clone.tint=this.tint,clone.blendMode=this.blendMode,clone.isMask=this.isMask,clone.boundsPadding=this.boundsPadding,clone.dirty=!0,clone.glDirty=!0,clone.cachedSpriteDirty=this.cachedSpriteDirty;for(var i=0;i<this.graphicsData.length;++i)clone.graphicsData.push(this.graphicsData[i].clone());return clone.currentPath=clone.graphicsData[clone.graphicsData.length-1],clone.updateLocalBounds(),clone},Graphics.prototype.lineStyle=function(lineWidth,color,alpha){if(this.lineWidth=lineWidth||0,this.lineColor=color||0,this.lineAlpha=void 0===alpha?1:alpha,this.currentPath)if(this.currentPath.shape.points.length){var shape=new math.Polygon(this.currentPath.shape.points.slice(-2));shape.closed=!1,this.drawShape(shape)}else this.currentPath.lineWidth=this.lineWidth,this.currentPath.lineColor=this.lineColor,this.currentPath.lineAlpha=this.lineAlpha;return this},Graphics.prototype.moveTo=function(x,y){var shape=new math.Polygon([x,y]);return shape.closed=!1,this.drawShape(shape),this},Graphics.prototype.lineTo=function(x,y){return this.currentPath.shape.points.push(x,y),this.dirty=!0,this},Graphics.prototype.quadraticCurveTo=function(cpX,cpY,toX,toY){this.currentPath?0===this.currentPath.shape.points.length&&(this.currentPath.shape.points=[0,0]):this.moveTo(0,0);var xa,ya,n=20,points=this.currentPath.shape.points;0===points.length&&this.moveTo(0,0);for(var fromX=points[points.length-2],fromY=points[points.length-1],j=0,i=1;n>=i;++i)j=i/n,xa=fromX+(cpX-fromX)*j,ya=fromY+(cpY-fromY)*j,points.push(xa+(cpX+(toX-cpX)*j-xa)*j,ya+(cpY+(toY-cpY)*j-ya)*j);return this.dirty=this.boundsDirty=!0,this},Graphics.prototype.bezierCurveTo=function(cpX,cpY,cpX2,cpY2,toX,toY){this.currentPath?0===this.currentPath.shape.points.length&&(this.currentPath.shape.points=[0,0]):this.moveTo(0,0);for(var dt,dt2,dt3,t2,t3,n=20,points=this.currentPath.shape.points,fromX=points[points.length-2],fromY=points[points.length-1],j=0,i=1;n>=i;++i)j=i/n,dt=1-j,dt2=dt*dt,dt3=dt2*dt,t2=j*j,t3=t2*j,points.push(dt3*fromX+3*dt2*j*cpX+3*dt*t2*cpX2+t3*toX,dt3*fromY+3*dt2*j*cpY+3*dt*t2*cpY2+t3*toY);return this.dirty=this.boundsDirty=!0,this},Graphics.prototype.arcTo=function(x1,y1,x2,y2,radius){this.currentPath?0===this.currentPath.shape.points.length&&this.currentPath.shape.points.push(x1,y1):this.moveTo(x1,y1);var points=this.currentPath.shape.points,fromX=points[points.length-2],fromY=points[points.length-1],a1=fromY-y1,b1=fromX-x1,a2=y2-y1,b2=x2-x1,mm=Math.abs(a1*b2-b1*a2);if(1e-8>mm||0===radius)(points[points.length-2]!==x1||points[points.length-1]!==y1)&&points.push(x1,y1);else{var dd=a1*a1+b1*b1,cc=a2*a2+b2*b2,tt=a1*a2+b1*b2,k1=radius*Math.sqrt(dd)/mm,k2=radius*Math.sqrt(cc)/mm,j1=k1*tt/dd,j2=k2*tt/cc,cx=k1*b2+k2*b1,cy=k1*a2+k2*a1,px=b1*(k2+j1),py=a1*(k2+j1),qx=b2*(k1+j2),qy=a2*(k1+j2),startAngle=Math.atan2(py-cy,px-cx),endAngle=Math.atan2(qy-cy,qx-cx);this.arc(cx+x1,cy+y1,radius,startAngle,endAngle,b1*a2>b2*a1)}return this.dirty=this.boundsDirty=!0,this},Graphics.prototype.arc=function(cx,cy,radius,startAngle,endAngle,anticlockwise){if(anticlockwise=anticlockwise||!1,startAngle===endAngle)return this;!anticlockwise&&startAngle>=endAngle?endAngle+=2*Math.PI:anticlockwise&&endAngle>=startAngle&&(startAngle+=2*Math.PI);var sweep=anticlockwise?-1*(startAngle-endAngle):endAngle-startAngle,segs=40*Math.ceil(Math.abs(sweep)/(2*Math.PI));if(0===sweep)return this;var startX=cx+Math.cos(startAngle)*radius,startY=cy+Math.sin(startAngle)*radius;this.currentPath?this.currentPath.shape.points.push(startX,startY):this.moveTo(startX,startY);for(var points=this.currentPath.shape.points,theta=sweep/(2*segs),theta2=2*theta,cTheta=Math.cos(theta),sTheta=Math.sin(theta),segMinus=segs-1,remainder=segMinus%1/segMinus,i=0;segMinus>=i;i++){var real=i+remainder*i,angle=theta+startAngle+theta2*real,c=Math.cos(angle),s=-Math.sin(angle);points.push((cTheta*c+sTheta*s)*radius+cx,(cTheta*-s+sTheta*c)*radius+cy)}return this.dirty=this.boundsDirty=!0,this},Graphics.prototype.beginFill=function(color,alpha){return this.filling=!0,this.fillColor=color||0,this.fillAlpha=void 0===alpha?1:alpha,this.currentPath&&this.currentPath.shape.points.length<=2&&(this.currentPath.fill=this.filling,this.currentPath.fillColor=this.fillColor,this.currentPath.fillAlpha=this.fillAlpha),this},Graphics.prototype.endFill=function(){return this.filling=!1,this.fillColor=null,this.fillAlpha=1,this},Graphics.prototype.drawRect=function(x,y,width,height){return this.drawShape(new math.Rectangle(x,y,width,height)),this},Graphics.prototype.drawRoundedRect=function(x,y,width,height,radius){return this.drawShape(new math.RoundedRectangle(x,y,width,height,radius)),this},Graphics.prototype.drawCircle=function(x,y,radius){return this.drawShape(new math.Circle(x,y,radius)),this},Graphics.prototype.drawEllipse=function(x,y,width,height){return this.drawShape(new math.Ellipse(x,y,width,height)),this},Graphics.prototype.drawPolygon=function(path){var points=path,closed=!0;if(points instanceof math.Polygon&&(closed=points.closed,points=points.points),!Array.isArray(points)){points=new Array(arguments.length);for(var i=0;i<points.length;++i)points[i]=arguments[i]}var shape=new math.Polygon(points);return shape.closed=closed,this.drawShape(shape),this},Graphics.prototype.clear=function(){return this.lineWidth=0,this.filling=!1,this.dirty=!0,this.clearDirty=!0,this.graphicsData=[],this},Graphics.prototype.generateTexture=function(renderer,resolution,scaleMode){resolution=resolution||1;var bounds=this.getLocalBounds(),canvasBuffer=new CanvasBuffer(bounds.width*resolution,bounds.height*resolution),texture=Texture.fromCanvas(canvasBuffer.canvas,scaleMode);return texture.baseTexture.resolution=resolution,canvasBuffer.context.scale(resolution,resolution),canvasBuffer.context.translate(-bounds.x,-bounds.y),CanvasGraphics.renderGraphics(this,canvasBuffer.context),texture},Graphics.prototype._renderWebGL=function(renderer){this.glDirty&&(this.dirty=!0,this.glDirty=!1),renderer.setObjectRenderer(renderer.plugins.graphics),renderer.plugins.graphics.render(this)},Graphics.prototype._renderCanvas=function(renderer){if(this.isMask!==!0){this._prevTint!==this.tint&&(this.dirty=!0);var context=renderer.context,transform=this.worldTransform,compositeOperation=renderer.blendModes[this.blendMode];compositeOperation!==context.globalCompositeOperation&&(context.globalCompositeOperation=compositeOperation);var resolution=renderer.resolution;context.setTransform(transform.a*resolution,transform.b*resolution,transform.c*resolution,transform.d*resolution,transform.tx*resolution,transform.ty*resolution),CanvasGraphics.renderGraphics(this,context)}},Graphics.prototype.getBounds=function(matrix){if(!this._currentBounds){if(!this.renderable)return math.Rectangle.EMPTY;this.boundsDirty&&(this.updateLocalBounds(),this.glDirty=!0,this.cachedSpriteDirty=!0,this.boundsDirty=!1);var bounds=this._localBounds,w0=bounds.x,w1=bounds.width+bounds.x,h0=bounds.y,h1=bounds.height+bounds.y,worldTransform=matrix||this.worldTransform,a=worldTransform.a,b=worldTransform.b,c=worldTransform.c,d=worldTransform.d,tx=worldTransform.tx,ty=worldTransform.ty,x1=a*w1+c*h1+tx,y1=d*h1+b*w1+ty,x2=a*w0+c*h1+tx,y2=d*h1+b*w0+ty,x3=a*w0+c*h0+tx,y3=d*h0+b*w0+ty,x4=a*w1+c*h0+tx,y4=d*h0+b*w1+ty,maxX=x1,maxY=y1,minX=x1,minY=y1;minX=minX>x2?x2:minX,minX=minX>x3?x3:minX,minX=minX>x4?x4:minX,minY=minY>y2?y2:minY,minY=minY>y3?y3:minY,minY=minY>y4?y4:minY,maxX=x2>maxX?x2:maxX,maxX=x3>maxX?x3:maxX,maxX=x4>maxX?x4:maxX,maxY=y2>maxY?y2:maxY,maxY=y3>maxY?y3:maxY,maxY=y4>maxY?y4:maxY,this._bounds.x=minX,this._bounds.width=maxX-minX,this._bounds.y=minY,this._bounds.height=maxY-minY,this._currentBounds=this._bounds}return this._currentBounds},Graphics.prototype.containsPoint=function(point){this.worldTransform.applyInverse(point,tempPoint);for(var graphicsData=this.graphicsData,i=0;i<graphicsData.length;i++){var data=graphicsData[i];if(data.fill&&data.shape&&data.shape.contains(tempPoint.x,tempPoint.y))return!0}return!1},Graphics.prototype.updateLocalBounds=function(){var minX=1/0,maxX=-(1/0),minY=1/0,maxY=-(1/0);if(this.graphicsData.length)for(var shape,points,x,y,w,h,i=0;i<this.graphicsData.length;i++){var data=this.graphicsData[i],type=data.type,lineWidth=data.lineWidth;if(shape=data.shape,type===CONST.SHAPES.RECT||type===CONST.SHAPES.RREC)x=shape.x-lineWidth/2,y=shape.y-lineWidth/2,w=shape.width+lineWidth,h=shape.height+lineWidth,minX=minX>x?x:minX,maxX=x+w>maxX?x+w:maxX,minY=minY>y?y:minY,maxY=y+h>maxY?y+h:maxY;else if(type===CONST.SHAPES.CIRC)x=shape.x,y=shape.y,w=shape.radius+lineWidth/2,h=shape.radius+lineWidth/2,minX=minX>x-w?x-w:minX,maxX=x+w>maxX?x+w:maxX,minY=minY>y-h?y-h:minY,maxY=y+h>maxY?y+h:maxY;else if(type===CONST.SHAPES.ELIP)x=shape.x,y=shape.y,w=shape.width+lineWidth/2,h=shape.height+lineWidth/2,minX=minX>x-w?x-w:minX,maxX=x+w>maxX?x+w:maxX,minY=minY>y-h?y-h:minY,maxY=y+h>maxY?y+h:maxY;else{points=shape.points;for(var j=0;j<points.length;j+=2)x=points[j],y=points[j+1],minX=minX>x-lineWidth?x-lineWidth:minX,maxX=x+lineWidth>maxX?x+lineWidth:maxX,minY=minY>y-lineWidth?y-lineWidth:minY,maxY=y+lineWidth>maxY?y+lineWidth:maxY}}else minX=0,maxX=0,minY=0,maxY=0;var padding=this.boundsPadding;this._localBounds.x=minX-padding,this._localBounds.width=maxX-minX+2*padding,this._localBounds.y=minY-padding,this._localBounds.height=maxY-minY+2*padding},Graphics.prototype.drawShape=function(shape){this.currentPath&&this.currentPath.shape.points.length<=2&&this.graphicsData.pop(),this.currentPath=null;var data=new GraphicsData(this.lineWidth,this.lineColor,this.lineAlpha,this.fillColor,this.fillAlpha,this.filling,shape);return this.graphicsData.push(data),data.type===CONST.SHAPES.POLY&&(data.shape.closed=data.shape.closed||this.filling,this.currentPath=data),this.dirty=this.boundsDirty=!0,data},Graphics.prototype.destroy=function(){Container.prototype.destroy.apply(this,arguments);for(var i=0;i<this.graphicsData.length;++i)this.graphicsData[i].destroy();for(var id in this._webgl)for(var j=0;j<this._webgl[id].data.length;++j)this._webgl[id].data[j].destroy();this.graphicsData=null,this.currentPath=null,this._webgl=null,this._localBounds=null}},{"../const":29,"../display/Container":30,"../math":39,"../renderers/canvas/utils/CanvasBuffer":51,"../renderers/canvas/utils/CanvasGraphics":52,"../textures/Texture":78,"./GraphicsData":33}],33:[function(require,module,exports){function GraphicsData(lineWidth,lineColor,lineAlpha,fillColor,fillAlpha,fill,shape){this.lineWidth=lineWidth,this.lineColor=lineColor,this.lineAlpha=lineAlpha,this._lineTint=lineColor,this.fillColor=fillColor,this.fillAlpha=fillAlpha,this._fillTint=fillColor,this.fill=fill,this.shape=shape,this.type=shape.type}GraphicsData.prototype.constructor=GraphicsData,module.exports=GraphicsData,GraphicsData.prototype.clone=function(){return new GraphicsData(this.lineWidth,this.lineColor,this.lineAlpha,this.fillColor,this.fillAlpha,this.fill,this.shape)},GraphicsData.prototype.destroy=function(){this.shape=null}},{}],34:[function(require,module,exports){function GraphicsRenderer(renderer){ObjectRenderer.call(this,renderer),this.graphicsDataPool=[],this.primitiveShader=null,this.complexPrimitiveShader=null,this.maximumSimplePolySize=200}var utils=require("../../utils"),math=require("../../math"),CONST=require("../../const"),ObjectRenderer=require("../../renderers/webgl/utils/ObjectRenderer"),WebGLRenderer=require("../../renderers/webgl/WebGLRenderer"),WebGLGraphicsData=require("./WebGLGraphicsData"),earcut=require("earcut");GraphicsRenderer.prototype=Object.create(ObjectRenderer.prototype),GraphicsRenderer.prototype.constructor=GraphicsRenderer,module.exports=GraphicsRenderer,WebGLRenderer.registerPlugin("graphics",GraphicsRenderer),GraphicsRenderer.prototype.onContextChange=function(){},GraphicsRenderer.prototype.destroy=function(){ObjectRenderer.prototype.destroy.call(this);for(var i=0;i<this.graphicsDataPool.length;++i)this.graphicsDataPool[i].destroy();this.graphicsDataPool=null},GraphicsRenderer.prototype.render=function(graphics){var webGLData,renderer=this.renderer,gl=renderer.gl,shader=renderer.shaderManager.plugins.primitiveShader;graphics.dirty&&this.updateGraphics(graphics);var webGL=graphics._webGL[gl.id];renderer.blendModeManager.setBlendMode(graphics.blendMode);for(var i=0,n=webGL.data.length;n>i;i++)webGLData=webGL.data[i],1===webGL.data[i].mode?(renderer.stencilManager.pushStencil(graphics,webGLData),gl.uniform1f(renderer.shaderManager.complexPrimitiveShader.uniforms.alpha._location,graphics.worldAlpha*webGLData.alpha),gl.drawElements(gl.TRIANGLE_FAN,4,gl.UNSIGNED_SHORT,2*(webGLData.indices.length-4)),renderer.stencilManager.popStencil(graphics,webGLData)):(shader=renderer.shaderManager.primitiveShader,renderer.shaderManager.setShader(shader),gl.uniformMatrix3fv(shader.uniforms.translationMatrix._location,!1,graphics.worldTransform.toArray(!0)),gl.uniformMatrix3fv(shader.uniforms.projectionMatrix._location,!1,renderer.currentRenderTarget.projectionMatrix.toArray(!0)),gl.uniform3fv(shader.uniforms.tint._location,utils.hex2rgb(graphics.tint)),gl.uniform1f(shader.uniforms.alpha._location,graphics.worldAlpha),gl.bindBuffer(gl.ARRAY_BUFFER,webGLData.buffer),gl.vertexAttribPointer(shader.attributes.aVertexPosition,2,gl.FLOAT,!1,24,0),gl.vertexAttribPointer(shader.attributes.aColor,4,gl.FLOAT,!1,24,8),gl.bindBuffer(gl.ELEMENT_ARRAY_BUFFER,webGLData.indexBuffer),gl.drawElements(gl.TRIANGLE_STRIP,webGLData.indices.length,gl.UNSIGNED_SHORT,0)),renderer.drawCount++},GraphicsRenderer.prototype.updateGraphics=function(graphics){var gl=this.renderer.gl,webGL=graphics._webGL[gl.id];webGL||(webGL=graphics._webGL[gl.id]={lastIndex:0,data:[],gl:gl}),graphics.dirty=!1;var i;if(graphics.clearDirty){for(graphics.clearDirty=!1,i=0;i<webGL.data.length;i++){var graphicsData=webGL.data[i];graphicsData.reset(),this.graphicsDataPool.push(graphicsData)}webGL.data=[],webGL.lastIndex=0}var webGLData;for(i=webGL.lastIndex;i<graphics.graphicsData.length;i++){var data=graphics.graphicsData[i];if(data.type===CONST.SHAPES.POLY){if(data.points=data.shape.points.slice(),data.shape.closed&&(data.points[0]!==data.points[data.points.length-2]||data.points[1]!==data.points[data.points.length-1])&&data.points.push(data.points[0],data.points[1]),data.fill&&data.points.length>=6)if(data.points.length<2*this.maximumSimplePolySize){webGLData=this.switchMode(webGL,0);var canDrawUsingSimple=this.buildPoly(data,webGLData);canDrawUsingSimple||(webGLData=this.switchMode(webGL,1),this.buildComplexPoly(data,webGLData))}else webGLData=this.switchMode(webGL,1),this.buildComplexPoly(data,webGLData);data.lineWidth>0&&(webGLData=this.switchMode(webGL,0),this.buildLine(data,webGLData))}else webGLData=this.switchMode(webGL,0),data.type===CONST.SHAPES.RECT?this.buildRectangle(data,webGLData):data.type===CONST.SHAPES.CIRC||data.type===CONST.SHAPES.ELIP?this.buildCircle(data,webGLData):data.type===CONST.SHAPES.RREC&&this.buildRoundedRectangle(data,webGLData);webGL.lastIndex++}for(i=0;i<webGL.data.length;i++)webGLData=webGL.data[i],webGLData.dirty&&webGLData.upload()},GraphicsRenderer.prototype.switchMode=function(webGL,type){var webGLData;return webGL.data.length?(webGLData=webGL.data[webGL.data.length-1],(webGLData.points.length>32e4||webGLData.mode!==type||1===type)&&(webGLData=this.graphicsDataPool.pop()||new WebGLGraphicsData(webGL.gl),webGLData.mode=type,webGL.data.push(webGLData))):(webGLData=this.graphicsDataPool.pop()||new WebGLGraphicsData(webGL.gl),webGLData.mode=type,webGL.data.push(webGLData)),webGLData.dirty=!0,webGLData},GraphicsRenderer.prototype.buildRectangle=function(graphicsData,webGLData){var rectData=graphicsData.shape,x=rectData.x,y=rectData.y,width=rectData.width,height=rectData.height;if(graphicsData.fill){var color=utils.hex2rgb(graphicsData.fillColor),alpha=graphicsData.fillAlpha,r=color[0]*alpha,g=color[1]*alpha,b=color[2]*alpha,verts=webGLData.points,indices=webGLData.indices,vertPos=verts.length/6;verts.push(x,y),verts.push(r,g,b,alpha),verts.push(x+width,y),verts.push(r,g,b,alpha),verts.push(x,y+height),verts.push(r,g,b,alpha),verts.push(x+width,y+height),verts.push(r,g,b,alpha),indices.push(vertPos,vertPos,vertPos+1,vertPos+2,vertPos+3,vertPos+3)}if(graphicsData.lineWidth){var tempPoints=graphicsData.points;graphicsData.points=[x,y,x+width,y,x+width,y+height,x,y+height,x,y],this.buildLine(graphicsData,webGLData),graphicsData.points=tempPoints}},GraphicsRenderer.prototype.buildRoundedRectangle=function(graphicsData,webGLData){var rrectData=graphicsData.shape,x=rrectData.x,y=rrectData.y,width=rrectData.width,height=rrectData.height,radius=rrectData.radius,recPoints=[];if(recPoints.push(x,y+radius),this.quadraticBezierCurve(x,y+height-radius,x,y+height,x+radius,y+height,recPoints),this.quadraticBezierCurve(x+width-radius,y+height,x+width,y+height,x+width,y+height-radius,recPoints),this.quadraticBezierCurve(x+width,y+radius,x+width,y,x+width-radius,y,recPoints),this.quadraticBezierCurve(x+radius,y,x,y,x,y+radius+1e-10,recPoints),graphicsData.fill){var color=utils.hex2rgb(graphicsData.fillColor),alpha=graphicsData.fillAlpha,r=color[0]*alpha,g=color[1]*alpha,b=color[2]*alpha,verts=webGLData.points,indices=webGLData.indices,vecPos=verts.length/6,triangles=earcut(recPoints,null,2),i=0;for(i=0;i<triangles.length;i+=3)indices.push(triangles[i]+vecPos),indices.push(triangles[i]+vecPos),indices.push(triangles[i+1]+vecPos),indices.push(triangles[i+2]+vecPos),indices.push(triangles[i+2]+vecPos);for(i=0;i<recPoints.length;i++)verts.push(recPoints[i],recPoints[++i],r,g,b,alpha)}if(graphicsData.lineWidth){var tempPoints=graphicsData.points;graphicsData.points=recPoints,this.buildLine(graphicsData,webGLData),graphicsData.points=tempPoints}},GraphicsRenderer.prototype.quadraticBezierCurve=function(fromX,fromY,cpX,cpY,toX,toY,out){function getPt(n1,n2,perc){var diff=n2-n1;return n1+diff*perc}for(var xa,ya,xb,yb,x,y,n=20,points=out||[],j=0,i=0;n>=i;i++)j=i/n,xa=getPt(fromX,cpX,j),ya=getPt(fromY,cpY,j),xb=getPt(cpX,toX,j),yb=getPt(cpY,toY,j),x=getPt(xa,xb,j),y=getPt(ya,yb,j),points.push(x,y);return points},GraphicsRenderer.prototype.buildCircle=function(graphicsData,webGLData){var width,height,circleData=graphicsData.shape,x=circleData.x,y=circleData.y;graphicsData.type===CONST.SHAPES.CIRC?(width=circleData.radius,height=circleData.radius):(width=circleData.width,height=circleData.height);var totalSegs=Math.floor(30*Math.sqrt(circleData.radius))||Math.floor(15*Math.sqrt(circleData.width+circleData.height)),seg=2*Math.PI/totalSegs,i=0;if(graphicsData.fill){var color=utils.hex2rgb(graphicsData.fillColor),alpha=graphicsData.fillAlpha,r=color[0]*alpha,g=color[1]*alpha,b=color[2]*alpha,verts=webGLData.points,indices=webGLData.indices,vecPos=verts.length/6;for(indices.push(vecPos),i=0;totalSegs+1>i;i++)verts.push(x,y,r,g,b,alpha),verts.push(x+Math.sin(seg*i)*width,y+Math.cos(seg*i)*height,r,g,b,alpha),indices.push(vecPos++,vecPos++);indices.push(vecPos-1)}if(graphicsData.lineWidth){var tempPoints=graphicsData.points;for(graphicsData.points=[],i=0;totalSegs+1>i;i++)graphicsData.points.push(x+Math.sin(seg*i)*width,y+Math.cos(seg*i)*height);this.buildLine(graphicsData,webGLData),graphicsData.points=tempPoints}},GraphicsRenderer.prototype.buildLine=function(graphicsData,webGLData){var i=0,points=graphicsData.points;if(0!==points.length){var firstPoint=new math.Point(points[0],points[1]),lastPoint=new math.Point(points[points.length-2],points[points.length-1]);if(firstPoint.x===lastPoint.x&&firstPoint.y===lastPoint.y){points=points.slice(),points.pop(),points.pop(),lastPoint=new math.Point(points[points.length-2],points[points.length-1]);var midPointX=lastPoint.x+.5*(firstPoint.x-lastPoint.x),midPointY=lastPoint.y+.5*(firstPoint.y-lastPoint.y);points.unshift(midPointX,midPointY),points.push(midPointX,midPointY)}var px,py,p1x,p1y,p2x,p2y,p3x,p3y,perpx,perpy,perp2x,perp2y,perp3x,perp3y,a1,b1,c1,a2,b2,c2,denom,pdist,dist,verts=webGLData.points,indices=webGLData.indices,length=points.length/2,indexCount=points.length,indexStart=verts.length/6,width=graphicsData.lineWidth/2,color=utils.hex2rgb(graphicsData.lineColor),alpha=graphicsData.lineAlpha,r=color[0]*alpha,g=color[1]*alpha,b=color[2]*alpha;for(p1x=points[0],p1y=points[1],p2x=points[2],p2y=points[3],perpx=-(p1y-p2y),
perpy=p1x-p2x,dist=Math.sqrt(perpx*perpx+perpy*perpy),perpx/=dist,perpy/=dist,perpx*=width,perpy*=width,verts.push(p1x-perpx,p1y-perpy,r,g,b,alpha),verts.push(p1x+perpx,p1y+perpy,r,g,b,alpha),i=1;length-1>i;i++)p1x=points[2*(i-1)],p1y=points[2*(i-1)+1],p2x=points[2*i],p2y=points[2*i+1],p3x=points[2*(i+1)],p3y=points[2*(i+1)+1],perpx=-(p1y-p2y),perpy=p1x-p2x,dist=Math.sqrt(perpx*perpx+perpy*perpy),perpx/=dist,perpy/=dist,perpx*=width,perpy*=width,perp2x=-(p2y-p3y),perp2y=p2x-p3x,dist=Math.sqrt(perp2x*perp2x+perp2y*perp2y),perp2x/=dist,perp2y/=dist,perp2x*=width,perp2y*=width,a1=-perpy+p1y-(-perpy+p2y),b1=-perpx+p2x-(-perpx+p1x),c1=(-perpx+p1x)*(-perpy+p2y)-(-perpx+p2x)*(-perpy+p1y),a2=-perp2y+p3y-(-perp2y+p2y),b2=-perp2x+p2x-(-perp2x+p3x),c2=(-perp2x+p3x)*(-perp2y+p2y)-(-perp2x+p2x)*(-perp2y+p3y),denom=a1*b2-a2*b1,Math.abs(denom)<.1?(denom+=10.1,verts.push(p2x-perpx,p2y-perpy,r,g,b,alpha),verts.push(p2x+perpx,p2y+perpy,r,g,b,alpha)):(px=(b1*c2-b2*c1)/denom,py=(a2*c1-a1*c2)/denom,pdist=(px-p2x)*(px-p2x)+(py-p2y)+(py-p2y),pdist>19600?(perp3x=perpx-perp2x,perp3y=perpy-perp2y,dist=Math.sqrt(perp3x*perp3x+perp3y*perp3y),perp3x/=dist,perp3y/=dist,perp3x*=width,perp3y*=width,verts.push(p2x-perp3x,p2y-perp3y),verts.push(r,g,b,alpha),verts.push(p2x+perp3x,p2y+perp3y),verts.push(r,g,b,alpha),verts.push(p2x-perp3x,p2y-perp3y),verts.push(r,g,b,alpha),indexCount++):(verts.push(px,py),verts.push(r,g,b,alpha),verts.push(p2x-(px-p2x),p2y-(py-p2y)),verts.push(r,g,b,alpha)));for(p1x=points[2*(length-2)],p1y=points[2*(length-2)+1],p2x=points[2*(length-1)],p2y=points[2*(length-1)+1],perpx=-(p1y-p2y),perpy=p1x-p2x,dist=Math.sqrt(perpx*perpx+perpy*perpy),perpx/=dist,perpy/=dist,perpx*=width,perpy*=width,verts.push(p2x-perpx,p2y-perpy),verts.push(r,g,b,alpha),verts.push(p2x+perpx,p2y+perpy),verts.push(r,g,b,alpha),indices.push(indexStart),i=0;indexCount>i;i++)indices.push(indexStart++);indices.push(indexStart-1)}},GraphicsRenderer.prototype.buildComplexPoly=function(graphicsData,webGLData){var points=graphicsData.points.slice();if(!(points.length<6)){var indices=webGLData.indices;webGLData.points=points,webGLData.alpha=graphicsData.fillAlpha,webGLData.color=utils.hex2rgb(graphicsData.fillColor);for(var x,y,minX=1/0,maxX=-(1/0),minY=1/0,maxY=-(1/0),i=0;i<points.length;i+=2)x=points[i],y=points[i+1],minX=minX>x?x:minX,maxX=x>maxX?x:maxX,minY=minY>y?y:minY,maxY=y>maxY?y:maxY;points.push(minX,minY,maxX,minY,maxX,maxY,minX,maxY);var length=points.length/2;for(i=0;length>i;i++)indices.push(i)}},GraphicsRenderer.prototype.buildPoly=function(graphicsData,webGLData){var points=graphicsData.points;if(!(points.length<6)){var verts=webGLData.points,indices=webGLData.indices,length=points.length/2,color=utils.hex2rgb(graphicsData.fillColor),alpha=graphicsData.fillAlpha,r=color[0]*alpha,g=color[1]*alpha,b=color[2]*alpha,triangles=earcut(points,null,2);if(!triangles)return!1;var vertPos=verts.length/6,i=0;for(i=0;i<triangles.length;i+=3)indices.push(triangles[i]+vertPos),indices.push(triangles[i]+vertPos),indices.push(triangles[i+1]+vertPos),indices.push(triangles[i+2]+vertPos),indices.push(triangles[i+2]+vertPos);for(i=0;length>i;i++)verts.push(points[2*i],points[2*i+1],r,g,b,alpha);return!0}}},{"../../const":29,"../../math":39,"../../renderers/webgl/WebGLRenderer":55,"../../renderers/webgl/utils/ObjectRenderer":69,"../../utils":83,"./WebGLGraphicsData":35,earcut:21}],35:[function(require,module,exports){function WebGLGraphicsData(gl){this.gl=gl,this.color=[0,0,0],this.points=[],this.indices=[],this.buffer=gl.createBuffer(),this.indexBuffer=gl.createBuffer(),this.mode=1,this.alpha=1,this.dirty=!0,this.glPoints=null,this.glIndices=null}WebGLGraphicsData.prototype.constructor=WebGLGraphicsData,module.exports=WebGLGraphicsData,WebGLGraphicsData.prototype.reset=function(){this.points.length=0,this.indices.length=0},WebGLGraphicsData.prototype.upload=function(){var gl=this.gl;this.glPoints=new Float32Array(this.points),gl.bindBuffer(gl.ARRAY_BUFFER,this.buffer),gl.bufferData(gl.ARRAY_BUFFER,this.glPoints,gl.STATIC_DRAW),this.glIndices=new Uint16Array(this.indices),gl.bindBuffer(gl.ELEMENT_ARRAY_BUFFER,this.indexBuffer),gl.bufferData(gl.ELEMENT_ARRAY_BUFFER,this.glIndices,gl.STATIC_DRAW),this.dirty=!1},WebGLGraphicsData.prototype.destroy=function(){this.color=null,this.points=null,this.indices=null,this.gl.deleteBuffer(this.buffer),this.gl.deleteBuffer(this.indexBuffer),this.gl=null,this.buffer=null,this.indexBuffer=null,this.glPoints=null,this.glIndices=null}},{}],36:[function(require,module,exports){var core=module.exports=Object.assign(require("./const"),require("./math"),{utils:require("./utils"),ticker:require("./ticker"),DisplayObject:require("./display/DisplayObject"),Container:require("./display/Container"),Sprite:require("./sprites/Sprite"),ParticleContainer:require("./particles/ParticleContainer"),SpriteRenderer:require("./sprites/webgl/SpriteRenderer"),ParticleRenderer:require("./particles/webgl/ParticleRenderer"),Text:require("./text/Text"),Graphics:require("./graphics/Graphics"),GraphicsData:require("./graphics/GraphicsData"),GraphicsRenderer:require("./graphics/webgl/GraphicsRenderer"),Texture:require("./textures/Texture"),BaseTexture:require("./textures/BaseTexture"),RenderTexture:require("./textures/RenderTexture"),VideoBaseTexture:require("./textures/VideoBaseTexture"),TextureUvs:require("./textures/TextureUvs"),CanvasRenderer:require("./renderers/canvas/CanvasRenderer"),CanvasGraphics:require("./renderers/canvas/utils/CanvasGraphics"),CanvasBuffer:require("./renderers/canvas/utils/CanvasBuffer"),WebGLRenderer:require("./renderers/webgl/WebGLRenderer"),ShaderManager:require("./renderers/webgl/managers/ShaderManager"),Shader:require("./renderers/webgl/shaders/Shader"),ObjectRenderer:require("./renderers/webgl/utils/ObjectRenderer"),RenderTarget:require("./renderers/webgl/utils/RenderTarget"),AbstractFilter:require("./renderers/webgl/filters/AbstractFilter"),FXAAFilter:require("./renderers/webgl/filters/FXAAFilter"),SpriteMaskFilter:require("./renderers/webgl/filters/SpriteMaskFilter"),autoDetectRenderer:function(width,height,options,noWebGL){return width=width||800,height=height||600,!noWebGL&&core.utils.isWebGLSupported()?new core.WebGLRenderer(width,height,options):new core.CanvasRenderer(width,height,options)}})},{"./const":29,"./display/Container":30,"./display/DisplayObject":31,"./graphics/Graphics":32,"./graphics/GraphicsData":33,"./graphics/webgl/GraphicsRenderer":34,"./math":39,"./particles/ParticleContainer":45,"./particles/webgl/ParticleRenderer":47,"./renderers/canvas/CanvasRenderer":50,"./renderers/canvas/utils/CanvasBuffer":51,"./renderers/canvas/utils/CanvasGraphics":52,"./renderers/webgl/WebGLRenderer":55,"./renderers/webgl/filters/AbstractFilter":56,"./renderers/webgl/filters/FXAAFilter":57,"./renderers/webgl/filters/SpriteMaskFilter":58,"./renderers/webgl/managers/ShaderManager":62,"./renderers/webgl/shaders/Shader":67,"./renderers/webgl/utils/ObjectRenderer":69,"./renderers/webgl/utils/RenderTarget":71,"./sprites/Sprite":73,"./sprites/webgl/SpriteRenderer":74,"./text/Text":75,"./textures/BaseTexture":76,"./textures/RenderTexture":77,"./textures/Texture":78,"./textures/TextureUvs":79,"./textures/VideoBaseTexture":80,"./ticker":82,"./utils":83}],37:[function(require,module,exports){function Matrix(){this.a=1,this.b=0,this.c=0,this.d=1,this.tx=0,this.ty=0}var Point=require("./Point");Matrix.prototype.constructor=Matrix,module.exports=Matrix,Matrix.prototype.fromArray=function(array){this.a=array[0],this.b=array[1],this.c=array[3],this.d=array[4],this.tx=array[2],this.ty=array[5]},Matrix.prototype.toArray=function(transpose,out){this.array||(this.array=new Float32Array(9));var array=out||this.array;return transpose?(array[0]=this.a,array[1]=this.b,array[2]=0,array[3]=this.c,array[4]=this.d,array[5]=0,array[6]=this.tx,array[7]=this.ty,array[8]=1):(array[0]=this.a,array[1]=this.c,array[2]=this.tx,array[3]=this.b,array[4]=this.d,array[5]=this.ty,array[6]=0,array[7]=0,array[8]=1),array},Matrix.prototype.apply=function(pos,newPos){newPos=newPos||new Point;var x=pos.x,y=pos.y;return newPos.x=this.a*x+this.c*y+this.tx,newPos.y=this.b*x+this.d*y+this.ty,newPos},Matrix.prototype.applyInverse=function(pos,newPos){newPos=newPos||new Point;var id=1/(this.a*this.d+this.c*-this.b),x=pos.x,y=pos.y;return newPos.x=this.d*id*x+-this.c*id*y+(this.ty*this.c-this.tx*this.d)*id,newPos.y=this.a*id*y+-this.b*id*x+(-this.ty*this.a+this.tx*this.b)*id,newPos},Matrix.prototype.translate=function(x,y){return this.tx+=x,this.ty+=y,this},Matrix.prototype.scale=function(x,y){return this.a*=x,this.d*=y,this.c*=x,this.b*=y,this.tx*=x,this.ty*=y,this},Matrix.prototype.rotate=function(angle){var cos=Math.cos(angle),sin=Math.sin(angle),a1=this.a,c1=this.c,tx1=this.tx;return this.a=a1*cos-this.b*sin,this.b=a1*sin+this.b*cos,this.c=c1*cos-this.d*sin,this.d=c1*sin+this.d*cos,this.tx=tx1*cos-this.ty*sin,this.ty=tx1*sin+this.ty*cos,this},Matrix.prototype.append=function(matrix){var a1=this.a,b1=this.b,c1=this.c,d1=this.d;return this.a=matrix.a*a1+matrix.b*c1,this.b=matrix.a*b1+matrix.b*d1,this.c=matrix.c*a1+matrix.d*c1,this.d=matrix.c*b1+matrix.d*d1,this.tx=matrix.tx*a1+matrix.ty*c1+this.tx,this.ty=matrix.tx*b1+matrix.ty*d1+this.ty,this},Matrix.prototype.prepend=function(matrix){var tx1=this.tx;if(1!==matrix.a||0!==matrix.b||0!==matrix.c||1!==matrix.d){var a1=this.a,c1=this.c;this.a=a1*matrix.a+this.b*matrix.c,this.b=a1*matrix.b+this.b*matrix.d,this.c=c1*matrix.a+this.d*matrix.c,this.d=c1*matrix.b+this.d*matrix.d}return this.tx=tx1*matrix.a+this.ty*matrix.c+matrix.tx,this.ty=tx1*matrix.b+this.ty*matrix.d+matrix.ty,this},Matrix.prototype.invert=function(){var a1=this.a,b1=this.b,c1=this.c,d1=this.d,tx1=this.tx,n=a1*d1-b1*c1;return this.a=d1/n,this.b=-b1/n,this.c=-c1/n,this.d=a1/n,this.tx=(c1*this.ty-d1*tx1)/n,this.ty=-(a1*this.ty-b1*tx1)/n,this},Matrix.prototype.identity=function(){return this.a=1,this.b=0,this.c=0,this.d=1,this.tx=0,this.ty=0,this},Matrix.prototype.clone=function(){var matrix=new Matrix;return matrix.a=this.a,matrix.b=this.b,matrix.c=this.c,matrix.d=this.d,matrix.tx=this.tx,matrix.ty=this.ty,matrix},Matrix.prototype.copy=function(matrix){return matrix.a=this.a,matrix.b=this.b,matrix.c=this.c,matrix.d=this.d,matrix.tx=this.tx,matrix.ty=this.ty,matrix},Matrix.IDENTITY=new Matrix,Matrix.TEMP_MATRIX=new Matrix},{"./Point":38}],38:[function(require,module,exports){function Point(x,y){this.x=x||0,this.y=y||0}Point.prototype.constructor=Point,module.exports=Point,Point.prototype.clone=function(){return new Point(this.x,this.y)},Point.prototype.copy=function(p){this.set(p.x,p.y)},Point.prototype.equals=function(p){return p.x===this.x&&p.y===this.y},Point.prototype.set=function(x,y){this.x=x||0,this.y=y||(0!==y?this.x:0)}},{}],39:[function(require,module,exports){module.exports={Point:require("./Point"),Matrix:require("./Matrix"),Circle:require("./shapes/Circle"),Ellipse:require("./shapes/Ellipse"),Polygon:require("./shapes/Polygon"),Rectangle:require("./shapes/Rectangle"),RoundedRectangle:require("./shapes/RoundedRectangle")}},{"./Matrix":37,"./Point":38,"./shapes/Circle":40,"./shapes/Ellipse":41,"./shapes/Polygon":42,"./shapes/Rectangle":43,"./shapes/RoundedRectangle":44}],40:[function(require,module,exports){function Circle(x,y,radius){this.x=x||0,this.y=y||0,this.radius=radius||0,this.type=CONST.SHAPES.CIRC}var Rectangle=require("./Rectangle"),CONST=require("../../const");Circle.prototype.constructor=Circle,module.exports=Circle,Circle.prototype.clone=function(){return new Circle(this.x,this.y,this.radius)},Circle.prototype.contains=function(x,y){if(this.radius<=0)return!1;var dx=this.x-x,dy=this.y-y,r2=this.radius*this.radius;return dx*=dx,dy*=dy,r2>=dx+dy},Circle.prototype.getBounds=function(){return new Rectangle(this.x-this.radius,this.y-this.radius,2*this.radius,2*this.radius)}},{"../../const":29,"./Rectangle":43}],41:[function(require,module,exports){function Ellipse(x,y,width,height){this.x=x||0,this.y=y||0,this.width=width||0,this.height=height||0,this.type=CONST.SHAPES.ELIP}var Rectangle=require("./Rectangle"),CONST=require("../../const");Ellipse.prototype.constructor=Ellipse,module.exports=Ellipse,Ellipse.prototype.clone=function(){return new Ellipse(this.x,this.y,this.width,this.height)},Ellipse.prototype.contains=function(x,y){if(this.width<=0||this.height<=0)return!1;var normx=(x-this.x)/this.width,normy=(y-this.y)/this.height;return normx*=normx,normy*=normy,1>=normx+normy},Ellipse.prototype.getBounds=function(){return new Rectangle(this.x-this.width,this.y-this.height,this.width,this.height)}},{"../../const":29,"./Rectangle":43}],42:[function(require,module,exports){function Polygon(points_){var points=points_;if(!Array.isArray(points)){points=new Array(arguments.length);for(var a=0;a<points.length;++a)points[a]=arguments[a]}if(points[0]instanceof Point){for(var p=[],i=0,il=points.length;il>i;i++)p.push(points[i].x,points[i].y);points=p}this.closed=!0,this.points=points,this.type=CONST.SHAPES.POLY}var Point=require("../Point"),CONST=require("../../const");Polygon.prototype.constructor=Polygon,module.exports=Polygon,Polygon.prototype.clone=function(){return new Polygon(this.points.slice())},Polygon.prototype.contains=function(x,y){for(var inside=!1,length=this.points.length/2,i=0,j=length-1;length>i;j=i++){var xi=this.points[2*i],yi=this.points[2*i+1],xj=this.points[2*j],yj=this.points[2*j+1],intersect=yi>y!=yj>y&&(xj-xi)*(y-yi)/(yj-yi)+xi>x;intersect&&(inside=!inside)}return inside}},{"../../const":29,"../Point":38}],43:[function(require,module,exports){function Rectangle(x,y,width,height){this.x=x||0,this.y=y||0,this.width=width||0,this.height=height||0,this.type=CONST.SHAPES.RECT}var CONST=require("../../const");Rectangle.prototype.constructor=Rectangle,module.exports=Rectangle,Rectangle.EMPTY=new Rectangle(0,0,0,0),Rectangle.prototype.clone=function(){return new Rectangle(this.x,this.y,this.width,this.height)},Rectangle.prototype.contains=function(x,y){return this.width<=0||this.height<=0?!1:x>=this.x&&x<this.x+this.width&&y>=this.y&&y<this.y+this.height?!0:!1}},{"../../const":29}],44:[function(require,module,exports){function RoundedRectangle(x,y,width,height,radius){this.x=x||0,this.y=y||0,this.width=width||0,this.height=height||0,this.radius=radius||20,this.type=CONST.SHAPES.RREC}var CONST=require("../../const");RoundedRectangle.prototype.constructor=RoundedRectangle,module.exports=RoundedRectangle,RoundedRectangle.prototype.clone=function(){return new RoundedRectangle(this.x,this.y,this.width,this.height,this.radius)},RoundedRectangle.prototype.contains=function(x,y){return this.width<=0||this.height<=0?!1:x>=this.x&&x<=this.x+this.width&&y>=this.y&&y<=this.y+this.height?!0:!1}},{"../../const":29}],45:[function(require,module,exports){function ParticleContainer(maxSize,properties,batchSize){Container.call(this),batchSize=batchSize||15e3,maxSize=maxSize||15e3;var maxBatchSize=16384;batchSize>maxBatchSize&&(batchSize=maxBatchSize),batchSize>maxSize&&(batchSize=maxSize),this._properties=[!1,!0,!1,!1,!1],this._maxSize=maxSize,this._batchSize=batchSize,this._buffers=null,this._bufferToUpdate=0,this.interactiveChildren=!1,this.blendMode=CONST.BLEND_MODES.NORMAL,this.roundPixels=!0,this.setProperties(properties)}var Container=require("../display/Container"),CONST=require("../const");ParticleContainer.prototype=Object.create(Container.prototype),ParticleContainer.prototype.constructor=ParticleContainer,module.exports=ParticleContainer,ParticleContainer.prototype.setProperties=function(properties){properties&&(this._properties[0]="scale"in properties?!!properties.scale:this._properties[0],this._properties[1]="position"in properties?!!properties.position:this._properties[1],this._properties[2]="rotation"in properties?!!properties.rotation:this._properties[2],this._properties[3]="uvs"in properties?!!properties.uvs:this._properties[3],this._properties[4]="alpha"in properties?!!properties.alpha:this._properties[4])},ParticleContainer.prototype.updateTransform=function(){this.displayObjectUpdateTransform()},ParticleContainer.prototype.renderWebGL=function(renderer){this.visible&&!(this.worldAlpha<=0)&&this.children.length&&this.renderable&&(renderer.setObjectRenderer(renderer.plugins.particle),renderer.plugins.particle.render(this))},ParticleContainer.prototype.onChildrenChange=function(smallestChildIndex){var bufferIndex=Math.floor(smallestChildIndex/this._batchSize);bufferIndex<this._bufferToUpdate&&(this._bufferToUpdate=bufferIndex)},ParticleContainer.prototype.renderCanvas=function(renderer){if(this.visible&&!(this.worldAlpha<=0)&&this.children.length&&this.renderable){var context=renderer.context,transform=this.worldTransform,isRotated=!0,positionX=0,positionY=0,finalWidth=0,finalHeight=0;context.globalAlpha=this.worldAlpha,this.displayObjectUpdateTransform();for(var i=0;i<this.children.length;++i){var child=this.children[i];if(child.visible){var frame=child.texture.frame;if(context.globalAlpha=this.worldAlpha*child.alpha,child.rotation%(2*Math.PI)===0)isRotated&&(context.setTransform(transform.a,transform.b,transform.c,transform.d,transform.tx,transform.ty),isRotated=!1),positionX=child.anchor.x*(-frame.width*child.scale.x)+child.position.x+.5,positionY=child.anchor.y*(-frame.height*child.scale.y)+child.position.y+.5,finalWidth=frame.width*child.scale.x,finalHeight=frame.height*child.scale.y;else{isRotated||(isRotated=!0),child.displayObjectUpdateTransform();var childTransform=child.worldTransform;renderer.roundPixels?context.setTransform(childTransform.a,childTransform.b,childTransform.c,childTransform.d,0|childTransform.tx,0|childTransform.ty):context.setTransform(childTransform.a,childTransform.b,childTransform.c,childTransform.d,childTransform.tx,childTransform.ty),positionX=child.anchor.x*-frame.width+.5,positionY=child.anchor.y*-frame.height+.5,finalWidth=frame.width,finalHeight=frame.height}context.drawImage(child.texture.baseTexture.source,frame.x,frame.y,frame.width,frame.height,positionX,positionY,finalWidth,finalHeight)}}}},ParticleContainer.prototype.destroy=function(){if(Container.prototype.destroy.apply(this,arguments),this._buffers)for(var i=0;i<this._buffers.length;++i)this._buffers[i].destroy();this._properties=null,this._buffers=null}},{"../const":29,"../display/Container":30}],46:[function(require,module,exports){function ParticleBuffer(gl,properties,dynamicPropertyFlags,size){this.gl=gl,this.vertSize=2,this.vertByteSize=4*this.vertSize,this.size=size,this.dynamicProperties=[],this.staticProperties=[];for(var i=0;i<properties.length;i++){var property=properties[i];dynamicPropertyFlags[i]?this.dynamicProperties.push(property):this.staticProperties.push(property)}this.staticStride=0,this.staticBuffer=null,this.staticData=null,this.dynamicStride=0,this.dynamicBuffer=null,this.dynamicData=null,this.initBuffers()}ParticleBuffer.prototype.constructor=ParticleBuffer,module.exports=ParticleBuffer,ParticleBuffer.prototype.initBuffers=function(){var i,property,gl=this.gl,dynamicOffset=0;for(this.dynamicStride=0,i=0;i<this.dynamicProperties.length;i++)property=this.dynamicProperties[i],property.offset=dynamicOffset,dynamicOffset+=property.size,this.dynamicStride+=property.size;this.dynamicData=new Float32Array(this.size*this.dynamicStride*4),this.dynamicBuffer=gl.createBuffer(),gl.bindBuffer(gl.ARRAY_BUFFER,this.dynamicBuffer),gl.bufferData(gl.ARRAY_BUFFER,this.dynamicData,gl.DYNAMIC_DRAW);var staticOffset=0;for(this.staticStride=0,i=0;i<this.staticProperties.length;i++)property=this.staticProperties[i],property.offset=staticOffset,staticOffset+=property.size,this.staticStride+=property.size;this.staticData=new Float32Array(this.size*this.staticStride*4),this.staticBuffer=gl.createBuffer(),gl.bindBuffer(gl.ARRAY_BUFFER,this.staticBuffer),gl.bufferData(gl.ARRAY_BUFFER,this.staticData,gl.DYNAMIC_DRAW)},ParticleBuffer.prototype.uploadDynamic=function(children,startIndex,amount){for(var gl=this.gl,i=0;i<this.dynamicProperties.length;i++){var property=this.dynamicProperties[i];property.uploadFunction(children,startIndex,amount,this.dynamicData,this.dynamicStride,property.offset)}gl.bindBuffer(gl.ARRAY_BUFFER,this.dynamicBuffer),gl.bufferSubData(gl.ARRAY_BUFFER,0,this.dynamicData)},ParticleBuffer.prototype.uploadStatic=function(children,startIndex,amount){for(var gl=this.gl,i=0;i<this.staticProperties.length;i++){var property=this.staticProperties[i];property.uploadFunction(children,startIndex,amount,this.staticData,this.staticStride,property.offset)}gl.bindBuffer(gl.ARRAY_BUFFER,this.staticBuffer),gl.bufferSubData(gl.ARRAY_BUFFER,0,this.staticData)},ParticleBuffer.prototype.bind=function(){var i,property,gl=this.gl;for(gl.bindBuffer(gl.ARRAY_BUFFER,this.dynamicBuffer),i=0;i<this.dynamicProperties.length;i++)property=this.dynamicProperties[i],gl.vertexAttribPointer(property.attribute,property.size,gl.FLOAT,!1,4*this.dynamicStride,4*property.offset);for(gl.bindBuffer(gl.ARRAY_BUFFER,this.staticBuffer),i=0;i<this.staticProperties.length;i++)property=this.staticProperties[i],gl.vertexAttribPointer(property.attribute,property.size,gl.FLOAT,!1,4*this.staticStride,4*property.offset)},ParticleBuffer.prototype.destroy=function(){this.dynamicProperties=null,this.dynamicData=null,this.gl.deleteBuffer(this.dynamicBuffer),this.staticProperties=null,this.staticData=null,this.gl.deleteBuffer(this.staticBuffer)}},{}],47:[function(require,module,exports){function ParticleRenderer(renderer){ObjectRenderer.call(this,renderer);var numIndices=98304;this.indices=new Uint16Array(numIndices);for(var i=0,j=0;numIndices>i;i+=6,j+=4)this.indices[i+0]=j+0,this.indices[i+1]=j+1,this.indices[i+2]=j+2,this.indices[i+3]=j+0,this.indices[i+4]=j+2,this.indices[i+5]=j+3;this.shader=null,this.indexBuffer=null,this.properties=null,this.tempMatrix=new math.Matrix}var ObjectRenderer=require("../../renderers/webgl/utils/ObjectRenderer"),WebGLRenderer=require("../../renderers/webgl/WebGLRenderer"),ParticleShader=require("./ParticleShader"),ParticleBuffer=require("./ParticleBuffer"),math=require("../../math");ParticleRenderer.prototype=Object.create(ObjectRenderer.prototype),ParticleRenderer.prototype.constructor=ParticleRenderer,module.exports=ParticleRenderer,WebGLRenderer.registerPlugin("particle",ParticleRenderer),ParticleRenderer.prototype.onContextChange=function(){var gl=this.renderer.gl;this.shader=new ParticleShader(this.renderer.shaderManager),this.indexBuffer=gl.createBuffer(),gl.bindBuffer(gl.ELEMENT_ARRAY_BUFFER,this.indexBuffer),gl.bufferData(gl.ELEMENT_ARRAY_BUFFER,this.indices,gl.STATIC_DRAW),this.properties=[{attribute:this.shader.attributes.aVertexPosition,size:2,uploadFunction:this.uploadVertices,offset:0},{attribute:this.shader.attributes.aPositionCoord,size:2,uploadFunction:this.uploadPosition,offset:0},{attribute:this.shader.attributes.aRotation,size:1,uploadFunction:this.uploadRotation,offset:0},{attribute:this.shader.attributes.aTextureCoord,size:2,uploadFunction:this.uploadUvs,offset:0},{attribute:this.shader.attributes.aColor,size:1,uploadFunction:this.uploadAlpha,offset:0}]},ParticleRenderer.prototype.start=function(){var gl=this.renderer.gl;gl.activeTexture(gl.TEXTURE0),gl.bindBuffer(gl.ELEMENT_ARRAY_BUFFER,this.indexBuffer);var shader=this.shader;this.renderer.shaderManager.setShader(shader)},ParticleRenderer.prototype.render=function(container){var children=container.children,totalChildren=children.length,maxSize=container._maxSize,batchSize=container._batchSize;if(0!==totalChildren){totalChildren>maxSize&&(totalChildren=maxSize),container._buffers||(container._buffers=this.generateBuffers(container)),this.renderer.blendModeManager.setBlendMode(container.blendMode);var gl=this.renderer.gl,m=container.worldTransform.copy(this.tempMatrix);m.prepend(this.renderer.currentRenderTarget.projectionMatrix),gl.uniformMatrix3fv(this.shader.uniforms.projectionMatrix._location,!1,m.toArray(!0)),gl.uniform1f(this.shader.uniforms.uAlpha._location,container.worldAlpha);var baseTexture=children[0]._texture.baseTexture;if(baseTexture._glTextures[gl.id])gl.bindTexture(gl.TEXTURE_2D,baseTexture._glTextures[gl.id]);else{if(!this.renderer.updateTexture(baseTexture))return;container._properties[0]&&container._properties[3]||(container._bufferToUpdate=0)}for(var i=0,j=0;totalChildren>i;i+=batchSize,j+=1){var amount=totalChildren-i;amount>batchSize&&(amount=batchSize);var buffer=container._buffers[j];buffer.uploadDynamic(children,i,amount),container._bufferToUpdate===j&&(buffer.uploadStatic(children,i,amount),container._bufferToUpdate=j+1),buffer.bind(this.shader),gl.drawElements(gl.TRIANGLES,6*amount,gl.UNSIGNED_SHORT,0),this.renderer.drawCount++}}},ParticleRenderer.prototype.generateBuffers=function(container){var i,gl=this.renderer.gl,buffers=[],size=container._maxSize,batchSize=container._batchSize,dynamicPropertyFlags=container._properties;for(i=0;size>i;i+=batchSize)buffers.push(new ParticleBuffer(gl,this.properties,dynamicPropertyFlags,batchSize));return buffers},ParticleRenderer.prototype.uploadVertices=function(children,startIndex,amount,array,stride,offset){for(var sprite,texture,trim,sx,sy,w0,w1,h0,h1,i=0;amount>i;i++)sprite=children[startIndex+i],texture=sprite._texture,sx=sprite.scale.x,sy=sprite.scale.y,texture.trim?(trim=texture.trim,w1=trim.x-sprite.anchor.x*trim.width,w0=w1+texture.crop.width,h1=trim.y-sprite.anchor.y*trim.height,h0=h1+texture.crop.height):(w0=texture._frame.width*(1-sprite.anchor.x),w1=texture._frame.width*-sprite.anchor.x,h0=texture._frame.height*(1-sprite.anchor.y),h1=texture._frame.height*-sprite.anchor.y),array[offset]=w1*sx,array[offset+1]=h1*sy,array[offset+stride]=w0*sx,array[offset+stride+1]=h1*sy,array[offset+2*stride]=w0*sx,array[offset+2*stride+1]=h0*sy,array[offset+3*stride]=w1*sx,array[offset+3*stride+1]=h0*sy,offset+=4*stride},ParticleRenderer.prototype.uploadPosition=function(children,startIndex,amount,array,stride,offset){for(var i=0;amount>i;i++){var spritePosition=children[startIndex+i].position;array[offset]=spritePosition.x,array[offset+1]=spritePosition.y,array[offset+stride]=spritePosition.x,array[offset+stride+1]=spritePosition.y,array[offset+2*stride]=spritePosition.x,array[offset+2*stride+1]=spritePosition.y,array[offset+3*stride]=spritePosition.x,array[offset+3*stride+1]=spritePosition.y,offset+=4*stride}},ParticleRenderer.prototype.uploadRotation=function(children,startIndex,amount,array,stride,offset){for(var i=0;amount>i;i++){var spriteRotation=children[startIndex+i].rotation;array[offset]=spriteRotation,array[offset+stride]=spriteRotation,array[offset+2*stride]=spriteRotation,array[offset+3*stride]=spriteRotation,offset+=4*stride}},ParticleRenderer.prototype.uploadUvs=function(children,startIndex,amount,array,stride,offset){for(var i=0;amount>i;i++){var textureUvs=children[startIndex+i]._texture._uvs;textureUvs?(array[offset]=textureUvs.x0,array[offset+1]=textureUvs.y0,array[offset+stride]=textureUvs.x1,array[offset+stride+1]=textureUvs.y1,array[offset+2*stride]=textureUvs.x2,array[offset+2*stride+1]=textureUvs.y2,array[offset+3*stride]=textureUvs.x3,array[offset+3*stride+1]=textureUvs.y3,offset+=4*stride):(array[offset]=0,array[offset+1]=0,array[offset+stride]=0,array[offset+stride+1]=0,array[offset+2*stride]=0,array[offset+2*stride+1]=0,array[offset+3*stride]=0,array[offset+3*stride+1]=0,offset+=4*stride)}},ParticleRenderer.prototype.uploadAlpha=function(children,startIndex,amount,array,stride,offset){for(var i=0;amount>i;i++){var spriteAlpha=children[startIndex+i].alpha;array[offset]=spriteAlpha,array[offset+stride]=spriteAlpha,array[offset+2*stride]=spriteAlpha,array[offset+3*stride]=spriteAlpha,offset+=4*stride}},ParticleRenderer.prototype.destroy=function(){this.renderer.gl&&this.renderer.gl.deleteBuffer(this.indexBuffer),ObjectRenderer.prototype.destroy.apply(this,arguments),this.shader.destroy(),this.indices=null,this.tempMatrix=null}},{"../../math":39,"../../renderers/webgl/WebGLRenderer":55,"../../renderers/webgl/utils/ObjectRenderer":69,"./ParticleBuffer":46,"./ParticleShader":48}],48:[function(require,module,exports){function ParticleShader(shaderManager){TextureShader.call(this,shaderManager,["attribute vec2 aVertexPosition;","attribute vec2 aTextureCoord;","attribute float aColor;","attribute vec2 aPositionCoord;","attribute vec2 aScale;","attribute float aRotation;","uniform mat3 projectionMatrix;","varying vec2 vTextureCoord;","varying float vColor;","void main(void){","   vec2 v = aVertexPosition;","   v.x = (aVertexPosition.x) * cos(aRotation) - (aVertexPosition.y) * sin(aRotation);","   v.y = (aVertexPosition.x) * sin(aRotation) + (aVertexPosition.y) * cos(aRotation);","   v = v + aPositionCoord;","   gl_Position = vec4((projectionMatrix * vec3(v, 1.0)).xy, 0.0, 1.0);","   vTextureCoord = aTextureCoord;","   vColor = aColor;","}"].join("\n"),["precision lowp float;","varying vec2 vTextureCoord;","varying float vColor;","uniform sampler2D uSampler;","uniform float uAlpha;","void main(void){","  vec4 color = texture2D(uSampler, vTextureCoord) * vColor * uAlpha;","  if (color.a == 0.0) discard;","  gl_FragColor = color;","}"].join("\n"),{uAlpha:{type:"1f",value:1}},{aPositionCoord:0,aRotation:0})}var TextureShader=require("../../renderers/webgl/shaders/TextureShader");ParticleShader.prototype=Object.create(TextureShader.prototype),ParticleShader.prototype.constructor=ParticleShader,module.exports=ParticleShader},{"../../renderers/webgl/shaders/TextureShader":68}],49:[function(require,module,exports){function SystemRenderer(system,width,height,options){if(EventEmitter.call(this),utils.sayHello(system),options)for(var i in CONST.DEFAULT_RENDER_OPTIONS)"undefined"==typeof options[i]&&(options[i]=CONST.DEFAULT_RENDER_OPTIONS[i]);else options=CONST.DEFAULT_RENDER_OPTIONS;this.type=CONST.RENDERER_TYPE.UNKNOWN,this.width=width||800,this.height=height||600,this.view=options.view||document.createElement("canvas"),this.resolution=options.resolution,this.transparent=options.transparent,this.autoResize=options.autoResize||!1,this.blendModes=null,this.preserveDrawingBuffer=options.preserveDrawingBuffer,this.clearBeforeRender=options.clearBeforeRender,this.roundPixels=options.roundPixels,this._backgroundColor=0,this._backgroundColorRgb=[0,0,0],this._backgroundColorString="#000000",this.backgroundColor=options.backgroundColor||this._backgroundColor,this._tempDisplayObjectParent={worldTransform:new math.Matrix,worldAlpha:1,children:[]},this._lastObjectRendered=this._tempDisplayObjectParent}var utils=require("../utils"),math=require("../math"),CONST=require("../const"),EventEmitter=require("eventemitter3");SystemRenderer.prototype=Object.create(EventEmitter.prototype),SystemRenderer.prototype.constructor=SystemRenderer,module.exports=SystemRenderer,Object.defineProperties(SystemRenderer.prototype,{backgroundColor:{get:function(){return this._backgroundColor},set:function(val){this._backgroundColor=val,this._backgroundColorString=utils.hex2string(val),utils.hex2rgb(val,this._backgroundColorRgb)}}}),SystemRenderer.prototype.resize=function(width,height){this.width=width*this.resolution,this.height=height*this.resolution,this.view.width=this.width,this.view.height=this.height,this.autoResize&&(this.view.style.width=this.width/this.resolution+"px",this.view.style.height=this.height/this.resolution+"px")},SystemRenderer.prototype.destroy=function(removeView){removeView&&this.view.parentNode&&this.view.parentNode.removeChild(this.view),this.type=CONST.RENDERER_TYPE.UNKNOWN,this.width=0,this.height=0,this.view=null,this.resolution=0,this.transparent=!1,this.autoResize=!1,this.blendModes=null,this.preserveDrawingBuffer=!1,this.clearBeforeRender=!1,this.roundPixels=!1,this._backgroundColor=0,this._backgroundColorRgb=null,this._backgroundColorString=null}},{"../const":29,"../math":39,"../utils":83,eventemitter3:22}],50:[function(require,module,exports){function CanvasRenderer(width,height,options){options=options||{},SystemRenderer.call(this,"Canvas",width,height,options),this.type=CONST.RENDERER_TYPE.CANVAS,
this.context=this.view.getContext("2d",{alpha:this.transparent}),this.refresh=!0,this.maskManager=new CanvasMaskManager,this.smoothProperty="imageSmoothingEnabled",this.context.imageSmoothingEnabled||(this.context.webkitImageSmoothingEnabled?this.smoothProperty="webkitImageSmoothingEnabled":this.context.mozImageSmoothingEnabled?this.smoothProperty="mozImageSmoothingEnabled":this.context.oImageSmoothingEnabled?this.smoothProperty="oImageSmoothingEnabled":this.context.msImageSmoothingEnabled&&(this.smoothProperty="msImageSmoothingEnabled")),this.initPlugins(),this._mapBlendModes(),this._tempDisplayObjectParent={worldTransform:new math.Matrix,worldAlpha:1},this.resize(width,height)}var SystemRenderer=require("../SystemRenderer"),CanvasMaskManager=require("./utils/CanvasMaskManager"),utils=require("../../utils"),math=require("../../math"),CONST=require("../../const");CanvasRenderer.prototype=Object.create(SystemRenderer.prototype),CanvasRenderer.prototype.constructor=CanvasRenderer,module.exports=CanvasRenderer,utils.pluginTarget.mixin(CanvasRenderer),CanvasRenderer.prototype.render=function(object){var cacheParent=object.parent;this._lastObjectRendered=object,object.parent=this._tempDisplayObjectParent,object.updateTransform(),object.parent=cacheParent,this.context.setTransform(1,0,0,1,0,0),this.context.globalAlpha=1,this.context.globalCompositeOperation=this.blendModes[CONST.BLEND_MODES.NORMAL],navigator.isCocoonJS&&this.view.screencanvas&&(this.context.fillStyle="black",this.context.clear()),this.clearBeforeRender&&(this.transparent?this.context.clearRect(0,0,this.width,this.height):(this.context.fillStyle=this._backgroundColorString,this.context.fillRect(0,0,this.width,this.height))),this.renderDisplayObject(object,this.context)},CanvasRenderer.prototype.destroy=function(removeView){this.destroyPlugins(),SystemRenderer.prototype.destroy.call(this,removeView),this.context=null,this.refresh=!0,this.maskManager.destroy(),this.maskManager=null,this.smoothProperty=null},CanvasRenderer.prototype.renderDisplayObject=function(displayObject,context){var tempContext=this.context;this.context=context,displayObject.renderCanvas(this),this.context=tempContext},CanvasRenderer.prototype.resize=function(w,h){SystemRenderer.prototype.resize.call(this,w,h),this.smoothProperty&&(this.context[this.smoothProperty]=CONST.SCALE_MODES.DEFAULT===CONST.SCALE_MODES.LINEAR)},CanvasRenderer.prototype._mapBlendModes=function(){this.blendModes||(this.blendModes={},utils.canUseNewCanvasBlendModes()?(this.blendModes[CONST.BLEND_MODES.NORMAL]="source-over",this.blendModes[CONST.BLEND_MODES.ADD]="lighter",this.blendModes[CONST.BLEND_MODES.MULTIPLY]="multiply",this.blendModes[CONST.BLEND_MODES.SCREEN]="screen",this.blendModes[CONST.BLEND_MODES.OVERLAY]="overlay",this.blendModes[CONST.BLEND_MODES.DARKEN]="darken",this.blendModes[CONST.BLEND_MODES.LIGHTEN]="lighten",this.blendModes[CONST.BLEND_MODES.COLOR_DODGE]="color-dodge",this.blendModes[CONST.BLEND_MODES.COLOR_BURN]="color-burn",this.blendModes[CONST.BLEND_MODES.HARD_LIGHT]="hard-light",this.blendModes[CONST.BLEND_MODES.SOFT_LIGHT]="soft-light",this.blendModes[CONST.BLEND_MODES.DIFFERENCE]="difference",this.blendModes[CONST.BLEND_MODES.EXCLUSION]="exclusion",this.blendModes[CONST.BLEND_MODES.HUE]="hue",this.blendModes[CONST.BLEND_MODES.SATURATION]="saturate",this.blendModes[CONST.BLEND_MODES.COLOR]="color",this.blendModes[CONST.BLEND_MODES.LUMINOSITY]="luminosity"):(this.blendModes[CONST.BLEND_MODES.NORMAL]="source-over",this.blendModes[CONST.BLEND_MODES.ADD]="lighter",this.blendModes[CONST.BLEND_MODES.MULTIPLY]="source-over",this.blendModes[CONST.BLEND_MODES.SCREEN]="source-over",this.blendModes[CONST.BLEND_MODES.OVERLAY]="source-over",this.blendModes[CONST.BLEND_MODES.DARKEN]="source-over",this.blendModes[CONST.BLEND_MODES.LIGHTEN]="source-over",this.blendModes[CONST.BLEND_MODES.COLOR_DODGE]="source-over",this.blendModes[CONST.BLEND_MODES.COLOR_BURN]="source-over",this.blendModes[CONST.BLEND_MODES.HARD_LIGHT]="source-over",this.blendModes[CONST.BLEND_MODES.SOFT_LIGHT]="source-over",this.blendModes[CONST.BLEND_MODES.DIFFERENCE]="source-over",this.blendModes[CONST.BLEND_MODES.EXCLUSION]="source-over",this.blendModes[CONST.BLEND_MODES.HUE]="source-over",this.blendModes[CONST.BLEND_MODES.SATURATION]="source-over",this.blendModes[CONST.BLEND_MODES.COLOR]="source-over",this.blendModes[CONST.BLEND_MODES.LUMINOSITY]="source-over"))}},{"../../const":29,"../../math":39,"../../utils":83,"../SystemRenderer":49,"./utils/CanvasMaskManager":53}],51:[function(require,module,exports){function CanvasBuffer(width,height){this.canvas=document.createElement("canvas"),this.context=this.canvas.getContext("2d"),this.canvas.width=width,this.canvas.height=height}CanvasBuffer.prototype.constructor=CanvasBuffer,module.exports=CanvasBuffer,Object.defineProperties(CanvasBuffer.prototype,{width:{get:function(){return this.canvas.width},set:function(val){this.canvas.width=val}},height:{get:function(){return this.canvas.height},set:function(val){this.canvas.height=val}}}),CanvasBuffer.prototype.clear=function(){this.context.setTransform(1,0,0,1,0,0),this.context.clearRect(0,0,this.canvas.width,this.canvas.height)},CanvasBuffer.prototype.resize=function(width,height){this.canvas.width=width,this.canvas.height=height},CanvasBuffer.prototype.destroy=function(){this.context=null,this.canvas=null}},{}],52:[function(require,module,exports){var CONST=require("../../../const"),CanvasGraphics={};module.exports=CanvasGraphics,CanvasGraphics.renderGraphics=function(graphics,context){var worldAlpha=graphics.worldAlpha;graphics.dirty&&(this.updateGraphicsTint(graphics),graphics.dirty=!1);for(var i=0;i<graphics.graphicsData.length;i++){var data=graphics.graphicsData[i],shape=data.shape,fillColor=data._fillTint,lineColor=data._lineTint;if(context.lineWidth=data.lineWidth,data.type===CONST.SHAPES.POLY){context.beginPath();var points=shape.points;context.moveTo(points[0],points[1]);for(var j=1;j<points.length/2;j++)context.lineTo(points[2*j],points[2*j+1]);shape.closed&&context.lineTo(points[0],points[1]),points[0]===points[points.length-2]&&points[1]===points[points.length-1]&&context.closePath(),data.fill&&(context.globalAlpha=data.fillAlpha*worldAlpha,context.fillStyle="#"+("00000"+(0|fillColor).toString(16)).substr(-6),context.fill()),data.lineWidth&&(context.globalAlpha=data.lineAlpha*worldAlpha,context.strokeStyle="#"+("00000"+(0|lineColor).toString(16)).substr(-6),context.stroke())}else if(data.type===CONST.SHAPES.RECT)(data.fillColor||0===data.fillColor)&&(context.globalAlpha=data.fillAlpha*worldAlpha,context.fillStyle="#"+("00000"+(0|fillColor).toString(16)).substr(-6),context.fillRect(shape.x,shape.y,shape.width,shape.height)),data.lineWidth&&(context.globalAlpha=data.lineAlpha*worldAlpha,context.strokeStyle="#"+("00000"+(0|lineColor).toString(16)).substr(-6),context.strokeRect(shape.x,shape.y,shape.width,shape.height));else if(data.type===CONST.SHAPES.CIRC)context.beginPath(),context.arc(shape.x,shape.y,shape.radius,0,2*Math.PI),context.closePath(),data.fill&&(context.globalAlpha=data.fillAlpha*worldAlpha,context.fillStyle="#"+("00000"+(0|fillColor).toString(16)).substr(-6),context.fill()),data.lineWidth&&(context.globalAlpha=data.lineAlpha*worldAlpha,context.strokeStyle="#"+("00000"+(0|lineColor).toString(16)).substr(-6),context.stroke());else if(data.type===CONST.SHAPES.ELIP){var w=2*shape.width,h=2*shape.height,x=shape.x-w/2,y=shape.y-h/2;context.beginPath();var kappa=.5522848,ox=w/2*kappa,oy=h/2*kappa,xe=x+w,ye=y+h,xm=x+w/2,ym=y+h/2;context.moveTo(x,ym),context.bezierCurveTo(x,ym-oy,xm-ox,y,xm,y),context.bezierCurveTo(xm+ox,y,xe,ym-oy,xe,ym),context.bezierCurveTo(xe,ym+oy,xm+ox,ye,xm,ye),context.bezierCurveTo(xm-ox,ye,x,ym+oy,x,ym),context.closePath(),data.fill&&(context.globalAlpha=data.fillAlpha*worldAlpha,context.fillStyle="#"+("00000"+(0|fillColor).toString(16)).substr(-6),context.fill()),data.lineWidth&&(context.globalAlpha=data.lineAlpha*worldAlpha,context.strokeStyle="#"+("00000"+(0|lineColor).toString(16)).substr(-6),context.stroke())}else if(data.type===CONST.SHAPES.RREC){var rx=shape.x,ry=shape.y,width=shape.width,height=shape.height,radius=shape.radius,maxRadius=Math.min(width,height)/2|0;radius=radius>maxRadius?maxRadius:radius,context.beginPath(),context.moveTo(rx,ry+radius),context.lineTo(rx,ry+height-radius),context.quadraticCurveTo(rx,ry+height,rx+radius,ry+height),context.lineTo(rx+width-radius,ry+height),context.quadraticCurveTo(rx+width,ry+height,rx+width,ry+height-radius),context.lineTo(rx+width,ry+radius),context.quadraticCurveTo(rx+width,ry,rx+width-radius,ry),context.lineTo(rx+radius,ry),context.quadraticCurveTo(rx,ry,rx,ry+radius),context.closePath(),(data.fillColor||0===data.fillColor)&&(context.globalAlpha=data.fillAlpha*worldAlpha,context.fillStyle="#"+("00000"+(0|fillColor).toString(16)).substr(-6),context.fill()),data.lineWidth&&(context.globalAlpha=data.lineAlpha*worldAlpha,context.strokeStyle="#"+("00000"+(0|lineColor).toString(16)).substr(-6),context.stroke())}}},CanvasGraphics.renderGraphicsMask=function(graphics,context){var len=graphics.graphicsData.length;if(0!==len){context.beginPath();for(var i=0;len>i;i++){var data=graphics.graphicsData[i],shape=data.shape;if(data.type===CONST.SHAPES.POLY){var points=shape.points;context.moveTo(points[0],points[1]);for(var j=1;j<points.length/2;j++)context.lineTo(points[2*j],points[2*j+1]);points[0]===points[points.length-2]&&points[1]===points[points.length-1]&&context.closePath()}else if(data.type===CONST.SHAPES.RECT)context.rect(shape.x,shape.y,shape.width,shape.height),context.closePath();else if(data.type===CONST.SHAPES.CIRC)context.arc(shape.x,shape.y,shape.radius,0,2*Math.PI),context.closePath();else if(data.type===CONST.SHAPES.ELIP){var w=2*shape.width,h=2*shape.height,x=shape.x-w/2,y=shape.y-h/2,kappa=.5522848,ox=w/2*kappa,oy=h/2*kappa,xe=x+w,ye=y+h,xm=x+w/2,ym=y+h/2;context.moveTo(x,ym),context.bezierCurveTo(x,ym-oy,xm-ox,y,xm,y),context.bezierCurveTo(xm+ox,y,xe,ym-oy,xe,ym),context.bezierCurveTo(xe,ym+oy,xm+ox,ye,xm,ye),context.bezierCurveTo(xm-ox,ye,x,ym+oy,x,ym),context.closePath()}else if(data.type===CONST.SHAPES.RREC){var rx=shape.x,ry=shape.y,width=shape.width,height=shape.height,radius=shape.radius,maxRadius=Math.min(width,height)/2|0;radius=radius>maxRadius?maxRadius:radius,context.moveTo(rx,ry+radius),context.lineTo(rx,ry+height-radius),context.quadraticCurveTo(rx,ry+height,rx+radius,ry+height),context.lineTo(rx+width-radius,ry+height),context.quadraticCurveTo(rx+width,ry+height,rx+width,ry+height-radius),context.lineTo(rx+width,ry+radius),context.quadraticCurveTo(rx+width,ry,rx+width-radius,ry),context.lineTo(rx+radius,ry),context.quadraticCurveTo(rx,ry,rx,ry+radius),context.closePath()}}}},CanvasGraphics.updateGraphicsTint=function(graphics){if(16777215!==graphics.tint||graphics._prevTint!==graphics.tint){graphics._prevTint=graphics.tint;for(var tintR=(graphics.tint>>16&255)/255,tintG=(graphics.tint>>8&255)/255,tintB=(255&graphics.tint)/255,i=0;i<graphics.graphicsData.length;i++){var data=graphics.graphicsData[i],fillColor=0|data.fillColor,lineColor=0|data.lineColor;data._fillTint=((fillColor>>16&255)/255*tintR*255<<16)+((fillColor>>8&255)/255*tintG*255<<8)+(255&fillColor)/255*tintB*255,data._lineTint=((lineColor>>16&255)/255*tintR*255<<16)+((lineColor>>8&255)/255*tintG*255<<8)+(255&lineColor)/255*tintB*255}}}},{"../../../const":29}],53:[function(require,module,exports){function CanvasMaskManager(){}var CanvasGraphics=require("./CanvasGraphics");CanvasMaskManager.prototype.constructor=CanvasMaskManager,module.exports=CanvasMaskManager,CanvasMaskManager.prototype.pushMask=function(maskData,renderer){renderer.context.save();var cacheAlpha=maskData.alpha,transform=maskData.worldTransform,resolution=renderer.resolution;renderer.context.setTransform(transform.a*resolution,transform.b*resolution,transform.c*resolution,transform.d*resolution,transform.tx*resolution,transform.ty*resolution),maskData.texture||(CanvasGraphics.renderGraphicsMask(maskData,renderer.context),renderer.context.clip()),maskData.worldAlpha=cacheAlpha},CanvasMaskManager.prototype.popMask=function(renderer){renderer.context.restore()},CanvasMaskManager.prototype.destroy=function(){}},{"./CanvasGraphics":52}],54:[function(require,module,exports){var utils=require("../../../utils"),CanvasTinter={};module.exports=CanvasTinter,CanvasTinter.getTintedTexture=function(sprite,color){var texture=sprite.texture;color=CanvasTinter.roundColor(color);var stringColor="#"+("00000"+(0|color).toString(16)).substr(-6);if(texture.tintCache=texture.tintCache||{},texture.tintCache[stringColor])return texture.tintCache[stringColor];var canvas=CanvasTinter.canvas||document.createElement("canvas");if(CanvasTinter.tintMethod(texture,color,canvas),CanvasTinter.convertTintToImage){var tintImage=new Image;tintImage.src=canvas.toDataURL(),texture.tintCache[stringColor]=tintImage}else texture.tintCache[stringColor]=canvas,CanvasTinter.canvas=null;return canvas},CanvasTinter.tintWithMultiply=function(texture,color,canvas){var context=canvas.getContext("2d"),resolution=texture.baseTexture.resolution,crop=texture.crop.clone();crop.x*=resolution,crop.y*=resolution,crop.width*=resolution,crop.height*=resolution,canvas.width=crop.width,canvas.height=crop.height,context.fillStyle="#"+("00000"+(0|color).toString(16)).substr(-6),context.fillRect(0,0,crop.width,crop.height),context.globalCompositeOperation="multiply",context.drawImage(texture.baseTexture.source,crop.x,crop.y,crop.width,crop.height,0,0,crop.width,crop.height),context.globalCompositeOperation="destination-atop",context.drawImage(texture.baseTexture.source,crop.x,crop.y,crop.width,crop.height,0,0,crop.width,crop.height)},CanvasTinter.tintWithOverlay=function(texture,color,canvas){var context=canvas.getContext("2d"),resolution=texture.baseTexture.resolution,crop=texture.crop.clone();crop.x*=resolution,crop.y*=resolution,crop.width*=resolution,crop.height*=resolution,canvas.width=crop.width,canvas.height=crop.height,context.globalCompositeOperation="copy",context.fillStyle="#"+("00000"+(0|color).toString(16)).substr(-6),context.fillRect(0,0,crop.width,crop.height),context.globalCompositeOperation="destination-atop",context.drawImage(texture.baseTexture.source,crop.x,crop.y,crop.width,crop.height,0,0,crop.width,crop.height)},CanvasTinter.tintWithPerPixel=function(texture,color,canvas){var context=canvas.getContext("2d"),resolution=texture.baseTexture.resolution,crop=texture.crop.clone();crop.x*=resolution,crop.y*=resolution,crop.width*=resolution,crop.height*=resolution,canvas.width=crop.width,canvas.height=crop.height,context.globalCompositeOperation="copy",context.drawImage(texture.baseTexture.source,crop.x,crop.y,crop.width,crop.height,0,0,crop.width,crop.height);for(var rgbValues=utils.hex2rgb(color),r=rgbValues[0],g=rgbValues[1],b=rgbValues[2],pixelData=context.getImageData(0,0,crop.width,crop.height),pixels=pixelData.data,i=0;i<pixels.length;i+=4)pixels[i+0]*=r,pixels[i+1]*=g,pixels[i+2]*=b;context.putImageData(pixelData,0,0)},CanvasTinter.roundColor=function(color){var step=CanvasTinter.cacheStepsPerColorChannel,rgbValues=utils.hex2rgb(color);return rgbValues[0]=Math.min(255,rgbValues[0]/step*step),rgbValues[1]=Math.min(255,rgbValues[1]/step*step),rgbValues[2]=Math.min(255,rgbValues[2]/step*step),utils.rgb2hex(rgbValues)},CanvasTinter.cacheStepsPerColorChannel=8,CanvasTinter.convertTintToImage=!1,CanvasTinter.canUseMultiply=utils.canUseNewCanvasBlendModes(),CanvasTinter.tintMethod=CanvasTinter.canUseMultiply?CanvasTinter.tintWithMultiply:CanvasTinter.tintWithPerPixel},{"../../../utils":83}],55:[function(require,module,exports){function WebGLRenderer(width,height,options){options=options||{},SystemRenderer.call(this,"WebGL",width,height,options),this.type=CONST.RENDERER_TYPE.WEBGL,this.handleContextLost=this.handleContextLost.bind(this),this.handleContextRestored=this.handleContextRestored.bind(this),this.view.addEventListener("webglcontextlost",this.handleContextLost,!1),this.view.addEventListener("webglcontextrestored",this.handleContextRestored,!1),this._useFXAA=!!options.forceFXAA&&options.antialias,this._FXAAFilter=null,this._contextOptions={alpha:this.transparent,antialias:options.antialias,premultipliedAlpha:this.transparent&&"notMultiplied"!==this.transparent,stencil:!0,preserveDrawingBuffer:options.preserveDrawingBuffer},this.drawCount=0,this.shaderManager=new ShaderManager(this),this.maskManager=new MaskManager(this),this.stencilManager=new StencilManager(this),this.filterManager=new FilterManager(this),this.blendModeManager=new BlendModeManager(this),this.currentRenderTarget=null,this.currentRenderer=new ObjectRenderer(this),this.initPlugins(),this._createContext(),this._initContext(),this._mapGlModes(),this._renderTargetStack=[]}var SystemRenderer=require("../SystemRenderer"),ShaderManager=require("./managers/ShaderManager"),MaskManager=require("./managers/MaskManager"),StencilManager=require("./managers/StencilManager"),FilterManager=require("./managers/FilterManager"),BlendModeManager=require("./managers/BlendModeManager"),RenderTarget=require("./utils/RenderTarget"),ObjectRenderer=require("./utils/ObjectRenderer"),FXAAFilter=require("./filters/FXAAFilter"),utils=require("../../utils"),CONST=require("../../const");WebGLRenderer.prototype=Object.create(SystemRenderer.prototype),WebGLRenderer.prototype.constructor=WebGLRenderer,module.exports=WebGLRenderer,utils.pluginTarget.mixin(WebGLRenderer),WebGLRenderer.glContextId=0,WebGLRenderer.prototype._createContext=function(){var gl=this.view.getContext("webgl",this._contextOptions)||this.view.getContext("experimental-webgl",this._contextOptions);if(this.gl=gl,!gl)throw new Error("This browser does not support webGL. Try using the canvas renderer");this.glContextId=WebGLRenderer.glContextId++,gl.id=this.glContextId,gl.renderer=this},WebGLRenderer.prototype._initContext=function(){var gl=this.gl;gl.disable(gl.DEPTH_TEST),gl.disable(gl.CULL_FACE),gl.enable(gl.BLEND),this.renderTarget=new RenderTarget(gl,this.width,this.height,null,this.resolution,!0),this.setRenderTarget(this.renderTarget),this.emit("context",gl),this.resize(this.width,this.height),this._useFXAA||(this._useFXAA=this._contextOptions.antialias&&!gl.getContextAttributes().antialias),this._useFXAA&&(window.console.warn("FXAA antialiasing being used instead of native antialiasing"),this._FXAAFilter=[new FXAAFilter])},WebGLRenderer.prototype.render=function(object){if(!this.gl.isContextLost()){this.drawCount=0,this._lastObjectRendered=object,this._useFXAA&&(this._FXAAFilter[0].uniforms.resolution.value.x=this.width,this._FXAAFilter[0].uniforms.resolution.value.y=this.height,object.filterArea=this.renderTarget.size,object.filters=this._FXAAFilter);var cacheParent=object.parent;object.parent=this._tempDisplayObjectParent,object.updateTransform(),object.parent=cacheParent;var gl=this.gl;this.setRenderTarget(this.renderTarget),this.clearBeforeRender&&(this.transparent?gl.clearColor(0,0,0,0):gl.clearColor(this._backgroundColorRgb[0],this._backgroundColorRgb[1],this._backgroundColorRgb[2],1),gl.clear(gl.COLOR_BUFFER_BIT)),this.renderDisplayObject(object,this.renderTarget)}},WebGLRenderer.prototype.renderDisplayObject=function(displayObject,renderTarget,clear){this.setRenderTarget(renderTarget),clear&&renderTarget.clear(),this.filterManager.setFilterStack(renderTarget.filterStack),displayObject.renderWebGL(this),this.currentRenderer.flush()},WebGLRenderer.prototype.setObjectRenderer=function(objectRenderer){this.currentRenderer!==objectRenderer&&(this.currentRenderer.stop(),this.currentRenderer=objectRenderer,this.currentRenderer.start())},WebGLRenderer.prototype.setRenderTarget=function(renderTarget){this.currentRenderTarget!==renderTarget&&(this.currentRenderTarget=renderTarget,this.currentRenderTarget.activate(),this.stencilManager.setMaskStack(renderTarget.stencilMaskStack))},WebGLRenderer.prototype.resize=function(width,height){SystemRenderer.prototype.resize.call(this,width,height),this.filterManager.resize(width,height),this.renderTarget.resize(width,height),this.currentRenderTarget===this.renderTarget&&(this.renderTarget.activate(),this.gl.viewport(0,0,this.width,this.height))},WebGLRenderer.prototype.updateTexture=function(texture){if(texture=texture.baseTexture||texture,texture.hasLoaded){var gl=this.gl;return texture._glTextures[gl.id]||(texture._glTextures[gl.id]=gl.createTexture(),texture.on("update",this.updateTexture,this),texture.on("dispose",this.destroyTexture,this)),gl.bindTexture(gl.TEXTURE_2D,texture._glTextures[gl.id]),gl.pixelStorei(gl.UNPACK_PREMULTIPLY_ALPHA_WEBGL,texture.premultipliedAlpha),gl.texImage2D(gl.TEXTURE_2D,0,gl.RGBA,gl.RGBA,gl.UNSIGNED_BYTE,texture.source),gl.texParameteri(gl.TEXTURE_2D,gl.TEXTURE_MAG_FILTER,texture.scaleMode===CONST.SCALE_MODES.LINEAR?gl.LINEAR:gl.NEAREST),texture.mipmap&&texture.isPowerOfTwo?(gl.texParameteri(gl.TEXTURE_2D,gl.TEXTURE_MIN_FILTER,texture.scaleMode===CONST.SCALE_MODES.LINEAR?gl.LINEAR_MIPMAP_LINEAR:gl.NEAREST_MIPMAP_NEAREST),gl.generateMipmap(gl.TEXTURE_2D)):gl.texParameteri(gl.TEXTURE_2D,gl.TEXTURE_MIN_FILTER,texture.scaleMode===CONST.SCALE_MODES.LINEAR?gl.LINEAR:gl.NEAREST),texture.isPowerOfTwo?(gl.texParameteri(gl.TEXTURE_2D,gl.TEXTURE_WRAP_S,gl.REPEAT),gl.texParameteri(gl.TEXTURE_2D,gl.TEXTURE_WRAP_T,gl.REPEAT)):(gl.texParameteri(gl.TEXTURE_2D,gl.TEXTURE_WRAP_S,gl.CLAMP_TO_EDGE),gl.texParameteri(gl.TEXTURE_2D,gl.TEXTURE_WRAP_T,gl.CLAMP_TO_EDGE)),texture._glTextures[gl.id]}},WebGLRenderer.prototype.destroyTexture=function(texture){texture=texture.baseTexture||texture,texture.hasLoaded&&texture._glTextures[this.gl.id]&&this.gl.deleteTexture(texture._glTextures[this.gl.id])},WebGLRenderer.prototype.handleContextLost=function(event){event.preventDefault()},WebGLRenderer.prototype.handleContextRestored=function(){this._initContext();for(var key in utils.BaseTextureCache)utils.BaseTextureCache[key]._glTextures.length=0},WebGLRenderer.prototype.destroy=function(removeView){this.destroyPlugins(),this.view.removeEventListener("webglcontextlost",this.handleContextLost),this.view.removeEventListener("webglcontextrestored",this.handleContextRestored);for(var key in utils.BaseTextureCache){var texture=utils.BaseTextureCache[key];texture.off("update",this.updateTexture,this),texture.off("dispose",this.destroyTexture,this)}SystemRenderer.prototype.destroy.call(this,removeView),this.uid=0,this.shaderManager.destroy(),this.maskManager.destroy(),this.stencilManager.destroy(),this.filterManager.destroy(),this.blendModeManager.destroy(),this.shaderManager=null,this.maskManager=null,this.filterManager=null,this.blendModeManager=null,this.currentRenderer=null,this.handleContextLost=null,this.handleContextRestored=null,this._contextOptions=null,this.drawCount=0,this.gl.useProgram(null),this.gl=null},WebGLRenderer.prototype._mapGlModes=function(){var gl=this.gl;this.blendModes||(this.blendModes={},this.blendModes[CONST.BLEND_MODES.NORMAL]=[gl.ONE,gl.ONE_MINUS_SRC_ALPHA],this.blendModes[CONST.BLEND_MODES.ADD]=[gl.SRC_ALPHA,gl.DST_ALPHA],this.blendModes[CONST.BLEND_MODES.MULTIPLY]=[gl.DST_COLOR,gl.ONE_MINUS_SRC_ALPHA],this.blendModes[CONST.BLEND_MODES.SCREEN]=[gl.SRC_ALPHA,gl.ONE],this.blendModes[CONST.BLEND_MODES.OVERLAY]=[gl.ONE,gl.ONE_MINUS_SRC_ALPHA],this.blendModes[CONST.BLEND_MODES.DARKEN]=[gl.ONE,gl.ONE_MINUS_SRC_ALPHA],this.blendModes[CONST.BLEND_MODES.LIGHTEN]=[gl.ONE,gl.ONE_MINUS_SRC_ALPHA],this.blendModes[CONST.BLEND_MODES.COLOR_DODGE]=[gl.ONE,gl.ONE_MINUS_SRC_ALPHA],this.blendModes[CONST.BLEND_MODES.COLOR_BURN]=[gl.ONE,gl.ONE_MINUS_SRC_ALPHA],this.blendModes[CONST.BLEND_MODES.HARD_LIGHT]=[gl.ONE,gl.ONE_MINUS_SRC_ALPHA],this.blendModes[CONST.BLEND_MODES.SOFT_LIGHT]=[gl.ONE,gl.ONE_MINUS_SRC_ALPHA],this.blendModes[CONST.BLEND_MODES.DIFFERENCE]=[gl.ONE,gl.ONE_MINUS_SRC_ALPHA],this.blendModes[CONST.BLEND_MODES.EXCLUSION]=[gl.ONE,gl.ONE_MINUS_SRC_ALPHA],this.blendModes[CONST.BLEND_MODES.HUE]=[gl.ONE,gl.ONE_MINUS_SRC_ALPHA],this.blendModes[CONST.BLEND_MODES.SATURATION]=[gl.ONE,gl.ONE_MINUS_SRC_ALPHA],this.blendModes[CONST.BLEND_MODES.COLOR]=[gl.ONE,gl.ONE_MINUS_SRC_ALPHA],this.blendModes[CONST.BLEND_MODES.LUMINOSITY]=[gl.ONE,gl.ONE_MINUS_SRC_ALPHA]),this.drawModes||(this.drawModes={},this.drawModes[CONST.DRAW_MODES.POINTS]=gl.POINTS,this.drawModes[CONST.DRAW_MODES.LINES]=gl.LINES,this.drawModes[CONST.DRAW_MODES.LINE_LOOP]=gl.LINE_LOOP,this.drawModes[CONST.DRAW_MODES.LINE_STRIP]=gl.LINE_STRIP,this.drawModes[CONST.DRAW_MODES.TRIANGLES]=gl.TRIANGLES,this.drawModes[CONST.DRAW_MODES.TRIANGLE_STRIP]=gl.TRIANGLE_STRIP,this.drawModes[CONST.DRAW_MODES.TRIANGLE_FAN]=gl.TRIANGLE_FAN)}},{"../../const":29,"../../utils":83,"../SystemRenderer":49,"./filters/FXAAFilter":57,"./managers/BlendModeManager":59,"./managers/FilterManager":60,"./managers/MaskManager":61,"./managers/ShaderManager":62,"./managers/StencilManager":63,"./utils/ObjectRenderer":69,"./utils/RenderTarget":71}],56:[function(require,module,exports){function AbstractFilter(vertexSrc,fragmentSrc,uniforms){this.shaders=[],this.padding=0,this.uniforms=uniforms||{},this.vertexSrc=vertexSrc||DefaultShader.defaultVertexSrc,this.fragmentSrc=fragmentSrc||DefaultShader.defaultFragmentSrc}var DefaultShader=require("../shaders/TextureShader");AbstractFilter.prototype.constructor=AbstractFilter,module.exports=AbstractFilter,AbstractFilter.prototype.getShader=function(renderer){var gl=renderer.gl,shader=this.shaders[gl.id];return shader||(shader=new DefaultShader(renderer.shaderManager,this.vertexSrc,this.fragmentSrc,this.uniforms,this.attributes),this.shaders[gl.id]=shader),shader},AbstractFilter.prototype.applyFilter=function(renderer,input,output,clear){var shader=this.getShader(renderer);renderer.filterManager.applyFilter(shader,input,output,clear)},AbstractFilter.prototype.syncUniform=function(uniform){for(var i=0,j=this.shaders.length;j>i;++i)this.shaders[i].syncUniform(uniform)}},{"../shaders/TextureShader":68}],57:[function(require,module,exports){function FXAAFilter(){AbstractFilter.call(this,"\nprecision mediump float;\n\nattribute vec2 aVertexPosition;\nattribute vec2 aTextureCoord;\nattribute vec4 aColor;\n\nuniform mat3 projectionMatrix;\nuniform vec2 resolution;\n\nvarying vec2 vTextureCoord;\nvarying vec4 vColor;\n\nvarying vec2 vResolution;\n\n//texcoords computed in vertex step\n//to avoid dependent texture reads\nvarying vec2 v_rgbNW;\nvarying vec2 v_rgbNE;\nvarying vec2 v_rgbSW;\nvarying vec2 v_rgbSE;\nvarying vec2 v_rgbM;\n\n\nvoid texcoords(vec2 fragCoord, vec2 resolution,\n            out vec2 v_rgbNW, out vec2 v_rgbNE,\n            out vec2 v_rgbSW, out vec2 v_rgbSE,\n            out vec2 v_rgbM) {\n    vec2 inverseVP = 1.0 / resolution.xy;\n    v_rgbNW = (fragCoord + vec2(-1.0, -1.0)) * inverseVP;\n    v_rgbNE = (fragCoord + vec2(1.0, -1.0)) * inverseVP;\n    v_rgbSW = (fragCoord + vec2(-1.0, 1.0)) * inverseVP;\n    v_rgbSE = (fragCoord + vec2(1.0, 1.0)) * inverseVP;\n    v_rgbM = vec2(fragCoord * inverseVP);\n}\n\nvoid main(void){\n   gl_Position = vec4((projectionMatrix * vec3(aVertexPosition, 1.0)).xy, 0.0, 1.0);\n   vTextureCoord = aTextureCoord;\n   vColor = vec4(aColor.rgb * aColor.a, aColor.a);\n   vResolution = resolution;\n\n   //compute the texture coords and send them to varyings\n   texcoords(aTextureCoord * resolution, resolution, v_rgbNW, v_rgbNE, v_rgbSW, v_rgbSE, v_rgbM);\n}\n",'precision lowp float;\n\n\n/**\nBasic FXAA implementation based on the code on geeks3d.com with the\nmodification that the texture2DLod stuff was removed since it\'s\nunsupported by WebGL.\n\n--\n\nFrom:\nhttps://github.com/mitsuhiko/webgl-meincraft\n\nCopyright (c) 2011 by Armin Ronacher.\n\nSome rights reserved.\n\nRedistribution and use in source and binary forms, with or without\nmodification, are permitted provided that the following conditions are\nmet:\n\n    * Redistributions of source code must retain the above copyright\n      notice, this list of conditions and the following disclaimer.\n\n    * Redistributions in binary form must reproduce the above\n      copyright notice, this list of conditions and the following\n      disclaimer in the documentation and/or other materials provided\n      with the distribution.\n\n    * The names of the contributors may not be used to endorse or\n      promote products derived from this software without specific\n      prior written permission.\n\nTHIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS\n"AS IS" AND ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT\nLIMITED TO, THE IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR\nA PARTICULAR PURPOSE ARE DISCLAIMED. IN NO EVENT SHALL THE COPYRIGHT\nOWNER OR CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL,\nSPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT\nLIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES; LOSS OF USE,\nDATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY\nTHEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT\n(INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE\nOF THIS SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.\n*/\n\n#ifndef FXAA_REDUCE_MIN\n    #define FXAA_REDUCE_MIN   (1.0/ 128.0)\n#endif\n#ifndef FXAA_REDUCE_MUL\n    #define FXAA_REDUCE_MUL   (1.0 / 8.0)\n#endif\n#ifndef FXAA_SPAN_MAX\n    #define FXAA_SPAN_MAX     8.0\n#endif\n\n//optimized version for mobile, where dependent\n//texture reads can be a bottleneck\nvec4 fxaa(sampler2D tex, vec2 fragCoord, vec2 resolution,\n            vec2 v_rgbNW, vec2 v_rgbNE,\n            vec2 v_rgbSW, vec2 v_rgbSE,\n            vec2 v_rgbM) {\n    vec4 color;\n    mediump vec2 inverseVP = vec2(1.0 / resolution.x, 1.0 / resolution.y);\n    vec3 rgbNW = texture2D(tex, v_rgbNW).xyz;\n    vec3 rgbNE = texture2D(tex, v_rgbNE).xyz;\n    vec3 rgbSW = texture2D(tex, v_rgbSW).xyz;\n    vec3 rgbSE = texture2D(tex, v_rgbSE).xyz;\n    vec4 texColor = texture2D(tex, v_rgbM);\n    vec3 rgbM  = texColor.xyz;\n    vec3 luma = vec3(0.299, 0.587, 0.114);\n    float lumaNW = dot(rgbNW, luma);\n    float lumaNE = dot(rgbNE, luma);\n    float lumaSW = dot(rgbSW, luma);\n    float lumaSE = dot(rgbSE, luma);\n    float lumaM  = dot(rgbM,  luma);\n    float lumaMin = min(lumaM, min(min(lumaNW, lumaNE), min(lumaSW, lumaSE)));\n    float lumaMax = max(lumaM, max(max(lumaNW, lumaNE), max(lumaSW, lumaSE)));\n\n    mediump vec2 dir;\n    dir.x = -((lumaNW + lumaNE) - (lumaSW + lumaSE));\n    dir.y =  ((lumaNW + lumaSW) - (lumaNE + lumaSE));\n\n    float dirReduce = max((lumaNW + lumaNE + lumaSW + lumaSE) *\n                          (0.25 * FXAA_REDUCE_MUL), FXAA_REDUCE_MIN);\n\n    float rcpDirMin = 1.0 / (min(abs(dir.x), abs(dir.y)) + dirReduce);\n    dir = min(vec2(FXAA_SPAN_MAX, FXAA_SPAN_MAX),\n              max(vec2(-FXAA_SPAN_MAX, -FXAA_SPAN_MAX),\n              dir * rcpDirMin)) * inverseVP;\n\n    vec3 rgbA = 0.5 * (\n        texture2D(tex, fragCoord * inverseVP + dir * (1.0 / 3.0 - 0.5)).xyz +\n        texture2D(tex, fragCoord * inverseVP + dir * (2.0 / 3.0 - 0.5)).xyz);\n    vec3 rgbB = rgbA * 0.5 + 0.25 * (\n        texture2D(tex, fragCoord * inverseVP + dir * -0.5).xyz +\n        texture2D(tex, fragCoord * inverseVP + dir * 0.5).xyz);\n\n    float lumaB = dot(rgbB, luma);\n    if ((lumaB < lumaMin) || (lumaB > lumaMax))\n        color = vec4(rgbA, texColor.a);\n    else\n        color = vec4(rgbB, texColor.a);\n    return color;\n}\n\n\nvarying vec2 vTextureCoord;\nvarying vec4 vColor;\nvarying vec2 vResolution;\n\n//texcoords computed in vertex step\n//to avoid dependent texture reads\nvarying vec2 v_rgbNW;\nvarying vec2 v_rgbNE;\nvarying vec2 v_rgbSW;\nvarying vec2 v_rgbSE;\nvarying vec2 v_rgbM;\n\nuniform sampler2D uSampler;\n\n\nvoid main(void){\n\n    gl_FragColor = fxaa(uSampler, vTextureCoord * vResolution, vResolution, v_rgbNW, v_rgbNE, v_rgbSW, v_rgbSE, v_rgbM);\n\n}\n',{resolution:{type:"v2",value:{x:1,y:1}}})}var AbstractFilter=require("./AbstractFilter");
FXAAFilter.prototype=Object.create(AbstractFilter.prototype),FXAAFilter.prototype.constructor=FXAAFilter,module.exports=FXAAFilter,FXAAFilter.prototype.applyFilter=function(renderer,input,output){var filterManager=renderer.filterManager,shader=this.getShader(renderer);filterManager.applyFilter(shader,input,output)}},{"./AbstractFilter":56}],58:[function(require,module,exports){function SpriteMaskFilter(sprite){var maskMatrix=new math.Matrix;AbstractFilter.call(this,"attribute vec2 aVertexPosition;\nattribute vec2 aTextureCoord;\nattribute vec4 aColor;\n\nuniform mat3 projectionMatrix;\nuniform mat3 otherMatrix;\n\nvarying vec2 vMaskCoord;\nvarying vec2 vTextureCoord;\nvarying vec4 vColor;\n\nvoid main(void)\n{\n    gl_Position = vec4((projectionMatrix * vec3(aVertexPosition, 1.0)).xy, 0.0, 1.0);\n    vTextureCoord = aTextureCoord;\n    vMaskCoord = ( otherMatrix * vec3( aTextureCoord, 1.0)  ).xy;\n    vColor = vec4(aColor.rgb * aColor.a, aColor.a);\n}\n","precision lowp float;\n\nvarying vec2 vMaskCoord;\nvarying vec2 vTextureCoord;\nvarying vec4 vColor;\n\nuniform sampler2D uSampler;\nuniform float alpha;\nuniform sampler2D mask;\n\nvoid main(void)\n{\n    // check clip! this will stop the mask bleeding out from the edges\n    vec2 text = abs( vMaskCoord - 0.5 );\n    text = step(0.5, text);\n    float clip = 1.0 - max(text.y, text.x);\n    vec4 original = texture2D(uSampler, vTextureCoord);\n    vec4 masky = texture2D(mask, vMaskCoord);\n    original *= (masky.r * masky.a * alpha * clip);\n    gl_FragColor = original;\n}\n",{mask:{type:"sampler2D",value:sprite._texture},alpha:{type:"f",value:1},otherMatrix:{type:"mat3",value:maskMatrix.toArray(!0)}}),this.maskSprite=sprite,this.maskMatrix=maskMatrix}var AbstractFilter=require("./AbstractFilter"),math=require("../../../math");SpriteMaskFilter.prototype=Object.create(AbstractFilter.prototype),SpriteMaskFilter.prototype.constructor=SpriteMaskFilter,module.exports=SpriteMaskFilter,SpriteMaskFilter.prototype.applyFilter=function(renderer,input,output){var filterManager=renderer.filterManager;this.uniforms.mask.value=this.maskSprite._texture,filterManager.calculateMappedMatrix(input.frame,this.maskSprite,this.maskMatrix),this.uniforms.otherMatrix.value=this.maskMatrix.toArray(!0),this.uniforms.alpha.value=this.maskSprite.worldAlpha;var shader=this.getShader(renderer);filterManager.applyFilter(shader,input,output)},Object.defineProperties(SpriteMaskFilter.prototype,{map:{get:function(){return this.uniforms.mask.value},set:function(value){this.uniforms.mask.value=value}},offset:{get:function(){return this.uniforms.offset.value},set:function(value){this.uniforms.offset.value=value}}})},{"../../../math":39,"./AbstractFilter":56}],59:[function(require,module,exports){function BlendModeManager(renderer){WebGLManager.call(this,renderer),this.currentBlendMode=99999}var WebGLManager=require("./WebGLManager");BlendModeManager.prototype=Object.create(WebGLManager.prototype),BlendModeManager.prototype.constructor=BlendModeManager,module.exports=BlendModeManager,BlendModeManager.prototype.setBlendMode=function(blendMode){if(this.currentBlendMode===blendMode)return!1;this.currentBlendMode=blendMode;var mode=this.renderer.blendModes[this.currentBlendMode];return this.renderer.gl.blendFunc(mode[0],mode[1]),!0}},{"./WebGLManager":64}],60:[function(require,module,exports){function FilterManager(renderer){WebGLManager.call(this,renderer),this.filterStack=[],this.filterStack.push({renderTarget:renderer.currentRenderTarget,filter:[],bounds:null}),this.texturePool=[],this.textureSize=new math.Rectangle(0,0,renderer.width,renderer.height),this.currentFrame=null}var WebGLManager=require("./WebGLManager"),RenderTarget=require("../utils/RenderTarget"),CONST=require("../../../const"),Quad=require("../utils/Quad"),math=require("../../../math");FilterManager.prototype=Object.create(WebGLManager.prototype),FilterManager.prototype.constructor=FilterManager,module.exports=FilterManager,FilterManager.prototype.onContextChange=function(){this.texturePool.length=0;var gl=this.renderer.gl;this.quad=new Quad(gl)},FilterManager.prototype.setFilterStack=function(filterStack){this.filterStack=filterStack},FilterManager.prototype.pushFilter=function(target,filters){var bounds=target.filterArea?target.filterArea.clone():target.getBounds();bounds.x=0|bounds.x,bounds.y=0|bounds.y,bounds.width=0|bounds.width,bounds.height=0|bounds.height;var padding=0|filters[0].padding;if(bounds.x-=padding,bounds.y-=padding,bounds.width+=2*padding,bounds.height+=2*padding,this.renderer.currentRenderTarget.transform){var transform=this.renderer.currentRenderTarget.transform;bounds.x+=transform.tx,bounds.y+=transform.ty,this.capFilterArea(bounds),bounds.x-=transform.tx,bounds.y-=transform.ty}else this.capFilterArea(bounds);if(bounds.width>0&&bounds.height>0){this.currentFrame=bounds;var texture=this.getRenderTarget();this.renderer.setRenderTarget(texture),texture.clear(),this.filterStack.push({renderTarget:texture,filter:filters})}else this.filterStack.push({renderTarget:null,filter:filters})},FilterManager.prototype.popFilter=function(){var filterData=this.filterStack.pop(),previousFilterData=this.filterStack[this.filterStack.length-1],input=filterData.renderTarget;if(filterData.renderTarget){var output=previousFilterData.renderTarget,gl=this.renderer.gl;this.currentFrame=input.frame,this.quad.map(this.textureSize,input.frame),gl.bindBuffer(gl.ARRAY_BUFFER,this.quad.vertexBuffer),gl.bindBuffer(gl.ELEMENT_ARRAY_BUFFER,this.quad.indexBuffer);var filters=filterData.filter;if(gl.vertexAttribPointer(this.renderer.shaderManager.defaultShader.attributes.aVertexPosition,2,gl.FLOAT,!1,0,0),gl.vertexAttribPointer(this.renderer.shaderManager.defaultShader.attributes.aTextureCoord,2,gl.FLOAT,!1,0,32),gl.vertexAttribPointer(this.renderer.shaderManager.defaultShader.attributes.aColor,4,gl.FLOAT,!1,0,64),this.renderer.blendModeManager.setBlendMode(CONST.BLEND_MODES.NORMAL),1===filters.length)filters[0].uniforms.dimensions&&(filters[0].uniforms.dimensions.value[0]=this.renderer.width,filters[0].uniforms.dimensions.value[1]=this.renderer.height,filters[0].uniforms.dimensions.value[2]=this.quad.vertices[0],filters[0].uniforms.dimensions.value[3]=this.quad.vertices[5]),filters[0].applyFilter(this.renderer,input,output),this.returnRenderTarget(input);else{for(var flipTexture=input,flopTexture=this.getRenderTarget(!0),i=0;i<filters.length-1;i++){var filter=filters[i];filter.uniforms.dimensions&&(filter.uniforms.dimensions.value[0]=this.renderer.width,filter.uniforms.dimensions.value[1]=this.renderer.height,filter.uniforms.dimensions.value[2]=this.quad.vertices[0],filter.uniforms.dimensions.value[3]=this.quad.vertices[5]),filter.applyFilter(this.renderer,flipTexture,flopTexture);var temp=flipTexture;flipTexture=flopTexture,flopTexture=temp}filters[filters.length-1].applyFilter(this.renderer,flipTexture,output),this.returnRenderTarget(flipTexture),this.returnRenderTarget(flopTexture)}return filterData.filter}},FilterManager.prototype.getRenderTarget=function(clear){var renderTarget=this.texturePool.pop()||new RenderTarget(this.renderer.gl,this.textureSize.width,this.textureSize.height,CONST.SCALE_MODES.LINEAR,this.renderer.resolution*CONST.FILTER_RESOLUTION);return renderTarget.frame=this.currentFrame,clear&&renderTarget.clear(!0),renderTarget},FilterManager.prototype.returnRenderTarget=function(renderTarget){this.texturePool.push(renderTarget)},FilterManager.prototype.applyFilter=function(shader,inputTarget,outputTarget,clear){var gl=this.renderer.gl;this.renderer.setRenderTarget(outputTarget),clear&&outputTarget.clear(),this.renderer.shaderManager.setShader(shader),shader.uniforms.projectionMatrix.value=this.renderer.currentRenderTarget.projectionMatrix.toArray(!0),shader.syncUniforms(),gl.activeTexture(gl.TEXTURE0),gl.bindTexture(gl.TEXTURE_2D,inputTarget.texture),gl.drawElements(gl.TRIANGLES,6,gl.UNSIGNED_SHORT,0),this.renderer.drawCount++},FilterManager.prototype.calculateMappedMatrix=function(filterArea,sprite,outputMatrix){var worldTransform=sprite.worldTransform.copy(math.Matrix.TEMP_MATRIX),texture=sprite._texture.baseTexture,mappedMatrix=outputMatrix.identity(),ratio=this.textureSize.height/this.textureSize.width;mappedMatrix.translate(filterArea.x/this.textureSize.width,filterArea.y/this.textureSize.height),mappedMatrix.scale(1,ratio);var translateScaleX=this.textureSize.width/texture.width,translateScaleY=this.textureSize.height/texture.height;return worldTransform.tx/=texture.width*translateScaleX,worldTransform.ty/=texture.width*translateScaleX,worldTransform.invert(),mappedMatrix.prepend(worldTransform),mappedMatrix.scale(1,1/ratio),mappedMatrix.scale(translateScaleX,translateScaleY),mappedMatrix.translate(sprite.anchor.x,sprite.anchor.y),mappedMatrix},FilterManager.prototype.capFilterArea=function(filterArea){filterArea.x<0&&(filterArea.width+=filterArea.x,filterArea.x=0),filterArea.y<0&&(filterArea.height+=filterArea.y,filterArea.y=0),filterArea.x+filterArea.width>this.textureSize.width&&(filterArea.width=this.textureSize.width-filterArea.x),filterArea.y+filterArea.height>this.textureSize.height&&(filterArea.height=this.textureSize.height-filterArea.y)},FilterManager.prototype.resize=function(width,height){this.textureSize.width=width,this.textureSize.height=height;for(var i=0;i<this.texturePool.length;i++)this.texturePool[i].resize(width,height)},FilterManager.prototype.destroy=function(){this.quad.destroy(),WebGLManager.prototype.destroy.call(this),this.filterStack=null,this.offsetY=0;for(var i=0;i<this.texturePool.length;i++)this.texturePool[i].destroy();this.texturePool=null}},{"../../../const":29,"../../../math":39,"../utils/Quad":70,"../utils/RenderTarget":71,"./WebGLManager":64}],61:[function(require,module,exports){function MaskManager(renderer){WebGLManager.call(this,renderer),this.stencilStack=[],this.reverse=!0,this.count=0,this.alphaMaskPool=[]}var WebGLManager=require("./WebGLManager"),AlphaMaskFilter=require("../filters/SpriteMaskFilter");MaskManager.prototype=Object.create(WebGLManager.prototype),MaskManager.prototype.constructor=MaskManager,module.exports=MaskManager,MaskManager.prototype.pushMask=function(target,maskData){maskData.texture?this.pushSpriteMask(target,maskData):this.pushStencilMask(target,maskData)},MaskManager.prototype.popMask=function(target,maskData){maskData.texture?this.popSpriteMask(target,maskData):this.popStencilMask(target,maskData)},MaskManager.prototype.pushSpriteMask=function(target,maskData){var alphaMaskFilter=this.alphaMaskPool.pop();alphaMaskFilter||(alphaMaskFilter=[new AlphaMaskFilter(maskData)]),alphaMaskFilter[0].maskSprite=maskData,this.renderer.filterManager.pushFilter(target,alphaMaskFilter)},MaskManager.prototype.popSpriteMask=function(){var filters=this.renderer.filterManager.popFilter();this.alphaMaskPool.push(filters)},MaskManager.prototype.pushStencilMask=function(target,maskData){this.renderer.stencilManager.pushMask(maskData)},MaskManager.prototype.popStencilMask=function(target,maskData){this.renderer.stencilManager.popMask(maskData)}},{"../filters/SpriteMaskFilter":58,"./WebGLManager":64}],62:[function(require,module,exports){function ShaderManager(renderer){WebGLManager.call(this,renderer),this.maxAttibs=10,this.attribState=[],this.tempAttribState=[];for(var i=0;i<this.maxAttibs;i++)this.attribState[i]=!1;this.stack=[],this._currentId=-1,this.currentShader=null}var WebGLManager=require("./WebGLManager"),TextureShader=require("../shaders/TextureShader"),ComplexPrimitiveShader=require("../shaders/ComplexPrimitiveShader"),PrimitiveShader=require("../shaders/PrimitiveShader"),utils=require("../../../utils");ShaderManager.prototype=Object.create(WebGLManager.prototype),ShaderManager.prototype.constructor=ShaderManager,utils.pluginTarget.mixin(ShaderManager),module.exports=ShaderManager,ShaderManager.prototype.onContextChange=function(){this.initPlugins();var gl=this.renderer.gl;this.maxAttibs=gl.getParameter(gl.MAX_VERTEX_ATTRIBS),this.attribState=[];for(var i=0;i<this.maxAttibs;i++)this.attribState[i]=!1;this.defaultShader=new TextureShader(this),this.primitiveShader=new PrimitiveShader(this),this.complexPrimitiveShader=new ComplexPrimitiveShader(this)},ShaderManager.prototype.setAttribs=function(attribs){var i;for(i=0;i<this.tempAttribState.length;i++)this.tempAttribState[i]=!1;for(var a in attribs)this.tempAttribState[attribs[a]]=!0;var gl=this.renderer.gl;for(i=0;i<this.attribState.length;i++)this.attribState[i]!==this.tempAttribState[i]&&(this.attribState[i]=this.tempAttribState[i],this.attribState[i]?gl.enableVertexAttribArray(i):gl.disableVertexAttribArray(i))},ShaderManager.prototype.setShader=function(shader){return this._currentId===shader.uid?!1:(this._currentId=shader.uid,this.currentShader=shader,this.renderer.gl.useProgram(shader.program),this.setAttribs(shader.attributes),!0)},ShaderManager.prototype.destroy=function(){this.primitiveShader.destroy(),this.complexPrimitiveShader.destroy(),WebGLManager.prototype.destroy.call(this),this.destroyPlugins(),this.attribState=null,this.tempAttribState=null}},{"../../../utils":83,"../shaders/ComplexPrimitiveShader":65,"../shaders/PrimitiveShader":66,"../shaders/TextureShader":68,"./WebGLManager":64}],63:[function(require,module,exports){function WebGLMaskManager(renderer){WebGLManager.call(this,renderer),this.stencilMaskStack=null}var WebGLManager=require("./WebGLManager"),utils=require("../../../utils");WebGLMaskManager.prototype=Object.create(WebGLManager.prototype),WebGLMaskManager.prototype.constructor=WebGLMaskManager,module.exports=WebGLMaskManager,WebGLMaskManager.prototype.setMaskStack=function(stencilMaskStack){this.stencilMaskStack=stencilMaskStack;var gl=this.renderer.gl;0===stencilMaskStack.stencilStack.length?gl.disable(gl.STENCIL_TEST):gl.enable(gl.STENCIL_TEST)},WebGLMaskManager.prototype.pushStencil=function(graphics,webGLData){this.renderer.currentRenderTarget.attachStencilBuffer();var gl=this.renderer.gl,sms=this.stencilMaskStack;this.bindGraphics(graphics,webGLData),0===sms.stencilStack.length&&(gl.enable(gl.STENCIL_TEST),gl.clear(gl.STENCIL_BUFFER_BIT),sms.reverse=!0,sms.count=0),sms.stencilStack.push(webGLData);var level=sms.count;gl.colorMask(!1,!1,!1,!1),gl.stencilFunc(gl.ALWAYS,0,255),gl.stencilOp(gl.KEEP,gl.KEEP,gl.INVERT),1===webGLData.mode?(gl.drawElements(gl.TRIANGLE_FAN,webGLData.indices.length-4,gl.UNSIGNED_SHORT,0),sms.reverse?(gl.stencilFunc(gl.EQUAL,255-level,255),gl.stencilOp(gl.KEEP,gl.KEEP,gl.DECR)):(gl.stencilFunc(gl.EQUAL,level,255),gl.stencilOp(gl.KEEP,gl.KEEP,gl.INCR)),gl.drawElements(gl.TRIANGLE_FAN,4,gl.UNSIGNED_SHORT,2*(webGLData.indices.length-4)),sms.reverse?gl.stencilFunc(gl.EQUAL,255-(level+1),255):gl.stencilFunc(gl.EQUAL,level+1,255),sms.reverse=!sms.reverse):(sms.reverse?(gl.stencilFunc(gl.EQUAL,level,255),gl.stencilOp(gl.KEEP,gl.KEEP,gl.INCR)):(gl.stencilFunc(gl.EQUAL,255-level,255),gl.stencilOp(gl.KEEP,gl.KEEP,gl.DECR)),gl.drawElements(gl.TRIANGLE_STRIP,webGLData.indices.length,gl.UNSIGNED_SHORT,0),sms.reverse?gl.stencilFunc(gl.EQUAL,level+1,255):gl.stencilFunc(gl.EQUAL,255-(level+1),255)),gl.colorMask(!0,!0,!0,!0),gl.stencilOp(gl.KEEP,gl.KEEP,gl.KEEP),sms.count++},WebGLMaskManager.prototype.bindGraphics=function(graphics,webGLData){var shader,gl=this.renderer.gl;1===webGLData.mode?(shader=this.renderer.shaderManager.complexPrimitiveShader,this.renderer.shaderManager.setShader(shader),gl.uniformMatrix3fv(shader.uniforms.translationMatrix._location,!1,graphics.worldTransform.toArray(!0)),gl.uniformMatrix3fv(shader.uniforms.projectionMatrix._location,!1,this.renderer.currentRenderTarget.projectionMatrix.toArray(!0)),gl.uniform3fv(shader.uniforms.tint._location,utils.hex2rgb(graphics.tint)),gl.uniform3fv(shader.uniforms.color._location,webGLData.color),gl.uniform1f(shader.uniforms.alpha._location,graphics.worldAlpha),gl.bindBuffer(gl.ARRAY_BUFFER,webGLData.buffer),gl.vertexAttribPointer(shader.attributes.aVertexPosition,2,gl.FLOAT,!1,8,0),gl.bindBuffer(gl.ELEMENT_ARRAY_BUFFER,webGLData.indexBuffer)):(shader=this.renderer.shaderManager.primitiveShader,this.renderer.shaderManager.setShader(shader),gl.uniformMatrix3fv(shader.uniforms.translationMatrix._location,!1,graphics.worldTransform.toArray(!0)),gl.uniformMatrix3fv(shader.uniforms.projectionMatrix._location,!1,this.renderer.currentRenderTarget.projectionMatrix.toArray(!0)),gl.uniform3fv(shader.uniforms.tint._location,utils.hex2rgb(graphics.tint)),gl.uniform1f(shader.uniforms.alpha._location,graphics.worldAlpha),gl.bindBuffer(gl.ARRAY_BUFFER,webGLData.buffer),gl.vertexAttribPointer(shader.attributes.aVertexPosition,2,gl.FLOAT,!1,24,0),gl.vertexAttribPointer(shader.attributes.aColor,4,gl.FLOAT,!1,24,8),gl.bindBuffer(gl.ELEMENT_ARRAY_BUFFER,webGLData.indexBuffer))},WebGLMaskManager.prototype.popStencil=function(graphics,webGLData){var gl=this.renderer.gl,sms=this.stencilMaskStack;if(sms.stencilStack.pop(),sms.count--,0===sms.stencilStack.length)gl.disable(gl.STENCIL_TEST);else{var level=sms.count;this.bindGraphics(graphics,webGLData),gl.colorMask(!1,!1,!1,!1),1===webGLData.mode?(sms.reverse=!sms.reverse,sms.reverse?(gl.stencilFunc(gl.EQUAL,255-(level+1),255),gl.stencilOp(gl.KEEP,gl.KEEP,gl.INCR)):(gl.stencilFunc(gl.EQUAL,level+1,255),gl.stencilOp(gl.KEEP,gl.KEEP,gl.DECR)),gl.drawElements(gl.TRIANGLE_FAN,4,gl.UNSIGNED_SHORT,2*(webGLData.indices.length-4)),gl.stencilFunc(gl.ALWAYS,0,255),gl.stencilOp(gl.KEEP,gl.KEEP,gl.INVERT),gl.drawElements(gl.TRIANGLE_FAN,webGLData.indices.length-4,gl.UNSIGNED_SHORT,0),this.renderer.drawCount+=2,sms.reverse?gl.stencilFunc(gl.EQUAL,level,255):gl.stencilFunc(gl.EQUAL,255-level,255)):(sms.reverse?(gl.stencilFunc(gl.EQUAL,level+1,255),gl.stencilOp(gl.KEEP,gl.KEEP,gl.DECR)):(gl.stencilFunc(gl.EQUAL,255-(level+1),255),gl.stencilOp(gl.KEEP,gl.KEEP,gl.INCR)),gl.drawElements(gl.TRIANGLE_STRIP,webGLData.indices.length,gl.UNSIGNED_SHORT,0),this.renderer.drawCount++,sms.reverse?gl.stencilFunc(gl.EQUAL,level,255):gl.stencilFunc(gl.EQUAL,255-level,255)),gl.colorMask(!0,!0,!0,!0),gl.stencilOp(gl.KEEP,gl.KEEP,gl.KEEP)}},WebGLMaskManager.prototype.destroy=function(){WebGLManager.prototype.destroy.call(this),this.stencilMaskStack.stencilStack=null},WebGLMaskManager.prototype.pushMask=function(maskData){this.renderer.setObjectRenderer(this.renderer.plugins.graphics),maskData.dirty&&this.renderer.plugins.graphics.updateGraphics(maskData,this.renderer.gl),maskData._webGL[this.renderer.gl.id].data.length&&this.pushStencil(maskData,maskData._webGL[this.renderer.gl.id].data[0])},WebGLMaskManager.prototype.popMask=function(maskData){this.renderer.setObjectRenderer(this.renderer.plugins.graphics),this.popStencil(maskData,maskData._webGL[this.renderer.gl.id].data[0])}},{"../../../utils":83,"./WebGLManager":64}],64:[function(require,module,exports){function WebGLManager(renderer){this.renderer=renderer,this.renderer.on("context",this.onContextChange,this)}WebGLManager.prototype.constructor=WebGLManager,module.exports=WebGLManager,WebGLManager.prototype.onContextChange=function(){},WebGLManager.prototype.destroy=function(){this.renderer.off("context",this.onContextChange,this),this.renderer=null}},{}],65:[function(require,module,exports){function ComplexPrimitiveShader(shaderManager){Shader.call(this,shaderManager,["attribute vec2 aVertexPosition;","uniform mat3 translationMatrix;","uniform mat3 projectionMatrix;","uniform vec3 tint;","uniform float alpha;","uniform vec3 color;","varying vec4 vColor;","void main(void){","   gl_Position = vec4((projectionMatrix * translationMatrix * vec3(aVertexPosition, 1.0)).xy, 0.0, 1.0);","   vColor = vec4(color * alpha * tint, alpha);","}"].join("\n"),["precision mediump float;","varying vec4 vColor;","void main(void){","   gl_FragColor = vColor;","}"].join("\n"),{tint:{type:"3f",value:[0,0,0]},alpha:{type:"1f",value:0},color:{type:"3f",value:[0,0,0]},translationMatrix:{type:"mat3",value:new Float32Array(9)},projectionMatrix:{type:"mat3",value:new Float32Array(9)}},{aVertexPosition:0})}var Shader=require("./Shader");ComplexPrimitiveShader.prototype=Object.create(Shader.prototype),ComplexPrimitiveShader.prototype.constructor=ComplexPrimitiveShader,module.exports=ComplexPrimitiveShader},{"./Shader":67}],66:[function(require,module,exports){function PrimitiveShader(shaderManager){Shader.call(this,shaderManager,["attribute vec2 aVertexPosition;","attribute vec4 aColor;","uniform mat3 translationMatrix;","uniform mat3 projectionMatrix;","uniform float alpha;","uniform float flipY;","uniform vec3 tint;","varying vec4 vColor;","void main(void){","   gl_Position = vec4((projectionMatrix * translationMatrix * vec3(aVertexPosition, 1.0)).xy, 0.0, 1.0);","   vColor = aColor * vec4(tint * alpha, alpha);","}"].join("\n"),["precision mediump float;","varying vec4 vColor;","void main(void){","   gl_FragColor = vColor;","}"].join("\n"),{tint:{type:"3f",value:[0,0,0]},alpha:{type:"1f",value:0},translationMatrix:{type:"mat3",value:new Float32Array(9)},projectionMatrix:{type:"mat3",value:new Float32Array(9)}},{aVertexPosition:0,aColor:0})}var Shader=require("./Shader");PrimitiveShader.prototype=Object.create(Shader.prototype),PrimitiveShader.prototype.constructor=PrimitiveShader,module.exports=PrimitiveShader},{"./Shader":67}],67:[function(require,module,exports){function Shader(shaderManager,vertexSrc,fragmentSrc,uniforms,attributes){if(!vertexSrc||!fragmentSrc)throw new Error("Pixi.js Error. Shader requires vertexSrc and fragmentSrc");this.uid=utils.uid(),this.gl=shaderManager.renderer.gl,this.shaderManager=shaderManager,this.program=null,this.uniforms=uniforms||{},this.attributes=attributes||{},this.textureCount=1,this.vertexSrc=vertexSrc,this.fragmentSrc=fragmentSrc,this.init()}var utils=require("../../../utils");Shader.prototype.constructor=Shader,module.exports=Shader,Shader.prototype.init=function(){this.compile(),this.gl.useProgram(this.program),this.cacheUniformLocations(Object.keys(this.uniforms)),this.cacheAttributeLocations(Object.keys(this.attributes))},Shader.prototype.cacheUniformLocations=function(keys){for(var i=0;i<keys.length;++i)this.uniforms[keys[i]]._location=this.gl.getUniformLocation(this.program,keys[i])},Shader.prototype.cacheAttributeLocations=function(keys){for(var i=0;i<keys.length;++i)this.attributes[keys[i]]=this.gl.getAttribLocation(this.program,keys[i])},Shader.prototype.compile=function(){var gl=this.gl,glVertShader=this._glCompile(gl.VERTEX_SHADER,this.vertexSrc),glFragShader=this._glCompile(gl.FRAGMENT_SHADER,this.fragmentSrc),program=gl.createProgram();return gl.attachShader(program,glVertShader),gl.attachShader(program,glFragShader),gl.linkProgram(program),gl.getProgramParameter(program,gl.LINK_STATUS)||(console.error("Pixi.js Error: Could not initialize shader."),console.error("gl.VALIDATE_STATUS",gl.getProgramParameter(program,gl.VALIDATE_STATUS)),console.error("gl.getError()",gl.getError()),""!==gl.getProgramInfoLog(program)&&console.warn("Pixi.js Warning: gl.getProgramInfoLog()",gl.getProgramInfoLog(program)),gl.deleteProgram(program),program=null),gl.deleteShader(glVertShader),gl.deleteShader(glFragShader),this.program=program},Shader.prototype.syncUniform=function(uniform){var i,il,location=uniform._location,value=uniform.value,gl=this.gl;switch(uniform.type){case"b":case"bool":case"boolean":gl.uniform1i(location,value?1:0);break;case"i":case"1i":gl.uniform1i(location,value);break;case"f":case"1f":gl.uniform1f(location,value);break;case"2f":gl.uniform2f(location,value[0],value[1]);break;case"3f":gl.uniform3f(location,value[0],value[1],value[2]);break;case"4f":gl.uniform4f(location,value[0],value[1],value[2],value[3]);break;case"v2":gl.uniform2f(location,value.x,value.y);break;case"v3":gl.uniform3f(location,value.x,value.y,value.z);break;case"v4":gl.uniform4f(location,value.x,value.y,value.z,value.w);break;case"1iv":gl.uniform1iv(location,value);break;case"2iv":gl.uniform2iv(location,value);break;case"3iv":gl.uniform3iv(location,value);break;case"4iv":gl.uniform4iv(location,value);break;case"1fv":gl.uniform1fv(location,value);break;case"2fv":gl.uniform2fv(location,value);break;case"3fv":gl.uniform3fv(location,value);break;case"4fv":gl.uniform4fv(location,value);break;case"m2":case"mat2":case"Matrix2fv":gl.uniformMatrix2fv(location,uniform.transpose,value);break;case"m3":case"mat3":case"Matrix3fv":gl.uniformMatrix3fv(location,uniform.transpose,value);break;case"m4":case"mat4":case"Matrix4fv":gl.uniformMatrix4fv(location,uniform.transpose,value);break;case"c":"number"==typeof value&&(value=utils.hex2rgb(value)),gl.uniform3f(location,value[0],value[1],value[2]);break;case"iv1":gl.uniform1iv(location,value);break;case"iv":gl.uniform3iv(location,value);break;case"fv1":gl.uniform1fv(location,value);break;case"fv":gl.uniform3fv(location,value);break;case"v2v":for(uniform._array||(uniform._array=new Float32Array(2*value.length)),i=0,il=value.length;il>i;++i)uniform._array[2*i]=value[i].x,uniform._array[2*i+1]=value[i].y;gl.uniform2fv(location,uniform._array);break;case"v3v":for(uniform._array||(uniform._array=new Float32Array(3*value.length)),i=0,il=value.length;il>i;++i)uniform._array[3*i]=value[i].x,uniform._array[3*i+1]=value[i].y,uniform._array[3*i+2]=value[i].z;gl.uniform3fv(location,uniform._array);break;case"v4v":for(uniform._array||(uniform._array=new Float32Array(4*value.length)),i=0,il=value.length;il>i;++i)uniform._array[4*i]=value[i].x,uniform._array[4*i+1]=value[i].y,uniform._array[4*i+2]=value[i].z,uniform._array[4*i+3]=value[i].w;gl.uniform4fv(location,uniform._array);break;case"t":case"sampler2D":if(!uniform.value||!uniform.value.baseTexture.hasLoaded)break;gl.activeTexture(gl["TEXTURE"+this.textureCount]);var texture=uniform.value.baseTexture._glTextures[gl.id];texture||(this.initSampler2D(uniform),texture=uniform.value.baseTexture._glTextures[gl.id]),gl.bindTexture(gl.TEXTURE_2D,texture),gl.uniform1i(uniform._location,this.textureCount),this.textureCount++;break;default:console.warn("Pixi.js Shader Warning: Unknown uniform type: "+uniform.type)}},Shader.prototype.syncUniforms=function(){this.textureCount=1;for(var key in this.uniforms)this.syncUniform(this.uniforms[key])},Shader.prototype.initSampler2D=function(uniform){var gl=this.gl,texture=uniform.value.baseTexture;if(texture.hasLoaded)if(uniform.textureData){var data=uniform.textureData;texture._glTextures[gl.id]=gl.createTexture(),gl.bindTexture(gl.TEXTURE_2D,texture._glTextures[gl.id]),gl.pixelStorei(gl.UNPACK_PREMULTIPLY_ALPHA_WEBGL,texture.premultipliedAlpha),gl.texImage2D(gl.TEXTURE_2D,0,data.luminance?gl.LUMINANCE:gl.RGBA,gl.RGBA,gl.UNSIGNED_BYTE,texture.source),gl.texParameteri(gl.TEXTURE_2D,gl.TEXTURE_MAG_FILTER,data.magFilter?data.magFilter:gl.LINEAR),gl.texParameteri(gl.TEXTURE_2D,gl.TEXTURE_MIN_FILTER,data.wrapS?data.wrapS:gl.CLAMP_TO_EDGE),gl.texParameteri(gl.TEXTURE_2D,gl.TEXTURE_WRAP_T,data.wrapS?data.wrapS:gl.CLAMP_TO_EDGE),gl.texParameteri(gl.TEXTURE_2D,gl.TEXTURE_WRAP_S,data.wrapT?data.wrapT:gl.CLAMP_TO_EDGE)}else this.shaderManager.renderer.updateTexture(texture)},Shader.prototype.destroy=function(){this.gl.deleteProgram(this.program),this.gl=null,this.uniforms=null,this.attributes=null,this.vertexSrc=null,this.fragmentSrc=null},Shader.prototype._glCompile=function(type,src){var shader=this.gl.createShader(type);return this.gl.shaderSource(shader,src),this.gl.compileShader(shader),this.gl.getShaderParameter(shader,this.gl.COMPILE_STATUS)?shader:(console.log(this.gl.getShaderInfoLog(shader)),null)}},{"../../../utils":83}],68:[function(require,module,exports){function TextureShader(shaderManager,vertexSrc,fragmentSrc,customUniforms,customAttributes){var uniforms={uSampler:{type:"sampler2D",value:0},projectionMatrix:{type:"mat3",value:new Float32Array([1,0,0,0,1,0,0,0,1])}};if(customUniforms)for(var u in customUniforms)uniforms[u]=customUniforms[u];var attributes={aVertexPosition:0,aTextureCoord:0,aColor:0};if(customAttributes)for(var a in customAttributes)attributes[a]=customAttributes[a];vertexSrc=vertexSrc||TextureShader.defaultVertexSrc,fragmentSrc=fragmentSrc||TextureShader.defaultFragmentSrc,Shader.call(this,shaderManager,vertexSrc,fragmentSrc,uniforms,attributes)}var Shader=require("./Shader");TextureShader.prototype=Object.create(Shader.prototype),TextureShader.prototype.constructor=TextureShader,module.exports=TextureShader,TextureShader.defaultVertexSrc=["precision lowp float;","attribute vec2 aVertexPosition;","attribute vec2 aTextureCoord;","attribute vec4 aColor;","uniform mat3 projectionMatrix;","varying vec2 vTextureCoord;","varying vec4 vColor;","void main(void){","   gl_Position = vec4((projectionMatrix * vec3(aVertexPosition, 1.0)).xy, 0.0, 1.0);","   vTextureCoord = aTextureCoord;","   vColor = vec4(aColor.rgb * aColor.a, aColor.a);","}"].join("\n"),TextureShader.defaultFragmentSrc=["precision lowp float;","varying vec2 vTextureCoord;","varying vec4 vColor;","uniform sampler2D uSampler;","void main(void){","   gl_FragColor = texture2D(uSampler, vTextureCoord) * vColor ;","}"].join("\n")},{"./Shader":67}],69:[function(require,module,exports){function ObjectRenderer(renderer){WebGLManager.call(this,renderer)}var WebGLManager=require("../managers/WebGLManager");ObjectRenderer.prototype=Object.create(WebGLManager.prototype),ObjectRenderer.prototype.constructor=ObjectRenderer,module.exports=ObjectRenderer,ObjectRenderer.prototype.start=function(){},ObjectRenderer.prototype.stop=function(){this.flush()},ObjectRenderer.prototype.flush=function(){},ObjectRenderer.prototype.render=function(object){}},{"../managers/WebGLManager":64}],70:[function(require,module,exports){function Quad(gl){this.gl=gl,this.vertices=new Float32Array([0,0,200,0,200,200,0,200]),this.uvs=new Float32Array([0,0,1,0,1,1,0,1]),this.colors=new Float32Array([1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1]),this.indices=new Uint16Array([0,1,2,0,3,2]),this.vertexBuffer=gl.createBuffer(),this.indexBuffer=gl.createBuffer(),gl.bindBuffer(gl.ARRAY_BUFFER,this.vertexBuffer),gl.bufferData(gl.ARRAY_BUFFER,128,gl.DYNAMIC_DRAW),gl.bindBuffer(gl.ELEMENT_ARRAY_BUFFER,this.indexBuffer),gl.bufferData(gl.ELEMENT_ARRAY_BUFFER,this.indices,gl.STATIC_DRAW),this.upload()}Quad.prototype.constructor=Quad,Quad.prototype.map=function(rect,rect2){var x=0,y=0;this.uvs[0]=x,this.uvs[1]=y,this.uvs[2]=x+rect2.width/rect.width,this.uvs[3]=y,this.uvs[4]=x+rect2.width/rect.width,this.uvs[5]=y+rect2.height/rect.height,this.uvs[6]=x,this.uvs[7]=y+rect2.height/rect.height,x=rect2.x,y=rect2.y,this.vertices[0]=x,this.vertices[1]=y,this.vertices[2]=x+rect2.width,this.vertices[3]=y,this.vertices[4]=x+rect2.width,this.vertices[5]=y+rect2.height,this.vertices[6]=x,this.vertices[7]=y+rect2.height,this.upload()},Quad.prototype.upload=function(){var gl=this.gl;gl.bindBuffer(gl.ARRAY_BUFFER,this.vertexBuffer),gl.bufferSubData(gl.ARRAY_BUFFER,0,this.vertices),gl.bufferSubData(gl.ARRAY_BUFFER,32,this.uvs),gl.bufferSubData(gl.ARRAY_BUFFER,64,this.colors)},Quad.prototype.destroy=function(){var gl=this.gl;gl.deleteBuffer(this.vertexBuffer),gl.deleteBuffer(this.indexBuffer)},module.exports=Quad},{}],71:[function(require,module,exports){var math=require("../../../math"),utils=require("../../../utils"),CONST=require("../../../const"),StencilMaskStack=require("./StencilMaskStack"),RenderTarget=function(gl,width,height,scaleMode,resolution,root){if(this.gl=gl,this.frameBuffer=null,this.texture=null,this.size=new math.Rectangle(0,0,1,1),this.resolution=resolution||CONST.RESOLUTION,this.projectionMatrix=new math.Matrix,this.transform=null,this.frame=null,this.stencilBuffer=null,this.stencilMaskStack=new StencilMaskStack,this.filterStack=[{renderTarget:this,filter:[],bounds:this.size}],this.scaleMode=scaleMode||CONST.SCALE_MODES.DEFAULT,this.root=root,!this.root){this.frameBuffer=gl.createFramebuffer(),this.texture=gl.createTexture(),gl.bindTexture(gl.TEXTURE_2D,this.texture),gl.texParameteri(gl.TEXTURE_2D,gl.TEXTURE_MAG_FILTER,scaleMode===CONST.SCALE_MODES.LINEAR?gl.LINEAR:gl.NEAREST),gl.texParameteri(gl.TEXTURE_2D,gl.TEXTURE_MIN_FILTER,scaleMode===CONST.SCALE_MODES.LINEAR?gl.LINEAR:gl.NEAREST);
var isPowerOfTwo=utils.isPowerOfTwo(width,height);isPowerOfTwo?(gl.texParameteri(gl.TEXTURE_2D,gl.TEXTURE_WRAP_S,gl.REPEAT),gl.texParameteri(gl.TEXTURE_2D,gl.TEXTURE_WRAP_T,gl.REPEAT)):(gl.texParameteri(gl.TEXTURE_2D,gl.TEXTURE_WRAP_S,gl.CLAMP_TO_EDGE),gl.texParameteri(gl.TEXTURE_2D,gl.TEXTURE_WRAP_T,gl.CLAMP_TO_EDGE)),gl.bindFramebuffer(gl.FRAMEBUFFER,this.frameBuffer),gl.framebufferTexture2D(gl.FRAMEBUFFER,gl.COLOR_ATTACHMENT0,gl.TEXTURE_2D,this.texture,0)}this.resize(width,height)};RenderTarget.prototype.constructor=RenderTarget,module.exports=RenderTarget,RenderTarget.prototype.clear=function(bind){var gl=this.gl;bind&&gl.bindFramebuffer(gl.FRAMEBUFFER,this.frameBuffer),gl.clearColor(0,0,0,0),gl.clear(gl.COLOR_BUFFER_BIT)},RenderTarget.prototype.attachStencilBuffer=function(){if(!this.stencilBuffer&&!this.root){var gl=this.gl;this.stencilBuffer=gl.createRenderbuffer(),gl.bindRenderbuffer(gl.RENDERBUFFER,this.stencilBuffer),gl.framebufferRenderbuffer(gl.FRAMEBUFFER,gl.DEPTH_STENCIL_ATTACHMENT,gl.RENDERBUFFER,this.stencilBuffer),gl.renderbufferStorage(gl.RENDERBUFFER,gl.DEPTH_STENCIL,this.size.width*this.resolution,this.size.height*this.resolution)}},RenderTarget.prototype.activate=function(){var gl=this.gl;gl.bindFramebuffer(gl.FRAMEBUFFER,this.frameBuffer);var projectionFrame=this.frame||this.size;this.calculateProjection(projectionFrame),this.transform&&this.projectionMatrix.append(this.transform),gl.viewport(0,0,projectionFrame.width*this.resolution,projectionFrame.height*this.resolution)},RenderTarget.prototype.calculateProjection=function(projectionFrame){var pm=this.projectionMatrix;pm.identity(),this.root?(pm.a=1/projectionFrame.width*2,pm.d=-1/projectionFrame.height*2,pm.tx=-1-projectionFrame.x*pm.a,pm.ty=1-projectionFrame.y*pm.d):(pm.a=1/projectionFrame.width*2,pm.d=1/projectionFrame.height*2,pm.tx=-1-projectionFrame.x*pm.a,pm.ty=-1-projectionFrame.y*pm.d)},RenderTarget.prototype.resize=function(width,height){if(width=0|width,height=0|height,this.size.width!==width||this.size.height!==height){if(this.size.width=width,this.size.height=height,!this.root){var gl=this.gl;gl.bindTexture(gl.TEXTURE_2D,this.texture),gl.texImage2D(gl.TEXTURE_2D,0,gl.RGBA,width*this.resolution,height*this.resolution,0,gl.RGBA,gl.UNSIGNED_BYTE,null),this.stencilBuffer&&(gl.bindRenderbuffer(gl.RENDERBUFFER,this.stencilBuffer),gl.renderbufferStorage(gl.RENDERBUFFER,gl.DEPTH_STENCIL,width*this.resolution,height*this.resolution))}var projectionFrame=this.frame||this.size;this.calculateProjection(projectionFrame)}},RenderTarget.prototype.destroy=function(){var gl=this.gl;gl.deleteRenderbuffer(this.stencilBuffer),gl.deleteFramebuffer(this.frameBuffer),gl.deleteTexture(this.texture),this.frameBuffer=null,this.texture=null}},{"../../../const":29,"../../../math":39,"../../../utils":83,"./StencilMaskStack":72}],72:[function(require,module,exports){function StencilMaskStack(){this.stencilStack=[],this.reverse=!0,this.count=0}StencilMaskStack.prototype.constructor=StencilMaskStack,module.exports=StencilMaskStack},{}],73:[function(require,module,exports){function Sprite(texture){Container.call(this),this.anchor=new math.Point,this._texture=null,this._width=0,this._height=0,this.tint=16777215,this.blendMode=CONST.BLEND_MODES.NORMAL,this.shader=null,this.cachedTint=16777215,this.texture=texture||Texture.EMPTY}var math=require("../math"),Texture=require("../textures/Texture"),Container=require("../display/Container"),CanvasTinter=require("../renderers/canvas/utils/CanvasTinter"),utils=require("../utils"),CONST=require("../const"),tempPoint=new math.Point;Sprite.prototype=Object.create(Container.prototype),Sprite.prototype.constructor=Sprite,module.exports=Sprite,Object.defineProperties(Sprite.prototype,{width:{get:function(){return Math.abs(this.scale.x)*this.texture._frame.width},set:function(value){this.scale.x=utils.sign(this.scale.x)*value/this.texture._frame.width,this._width=value}},height:{get:function(){return Math.abs(this.scale.y)*this.texture._frame.height},set:function(value){this.scale.y=utils.sign(this.scale.y)*value/this.texture._frame.height,this._height=value}},texture:{get:function(){return this._texture},set:function(value){this._texture!==value&&(this._texture=value,this.cachedTint=16777215,value&&(value.baseTexture.hasLoaded?this._onTextureUpdate():value.once("update",this._onTextureUpdate,this)))}}}),Sprite.prototype._onTextureUpdate=function(){this._width&&(this.scale.x=utils.sign(this.scale.x)*this._width/this.texture.frame.width),this._height&&(this.scale.y=utils.sign(this.scale.y)*this._height/this.texture.frame.height)},Sprite.prototype._renderWebGL=function(renderer){renderer.setObjectRenderer(renderer.plugins.sprite),renderer.plugins.sprite.render(this)},Sprite.prototype.getBounds=function(matrix){if(!this._currentBounds){var minX,maxX,minY,maxY,width=this._texture._frame.width,height=this._texture._frame.height,w0=width*(1-this.anchor.x),w1=width*-this.anchor.x,h0=height*(1-this.anchor.y),h1=height*-this.anchor.y,worldTransform=matrix||this.worldTransform,a=worldTransform.a,b=worldTransform.b,c=worldTransform.c,d=worldTransform.d,tx=worldTransform.tx,ty=worldTransform.ty;if(0===b&&0===c)0>a&&(a*=-1),0>d&&(d*=-1),minX=a*w1+tx,maxX=a*w0+tx,minY=d*h1+ty,maxY=d*h0+ty;else{var x1=a*w1+c*h1+tx,y1=d*h1+b*w1+ty,x2=a*w0+c*h1+tx,y2=d*h1+b*w0+ty,x3=a*w0+c*h0+tx,y3=d*h0+b*w0+ty,x4=a*w1+c*h0+tx,y4=d*h0+b*w1+ty;minX=x1,minX=minX>x2?x2:minX,minX=minX>x3?x3:minX,minX=minX>x4?x4:minX,minY=y1,minY=minY>y2?y2:minY,minY=minY>y3?y3:minY,minY=minY>y4?y4:minY,maxX=x1,maxX=x2>maxX?x2:maxX,maxX=x3>maxX?x3:maxX,maxX=x4>maxX?x4:maxX,maxY=y1,maxY=y2>maxY?y2:maxY,maxY=y3>maxY?y3:maxY,maxY=y4>maxY?y4:maxY}if(this.children.length){var childBounds=this.containerGetBounds();w0=childBounds.x,w1=childBounds.x+childBounds.width,h0=childBounds.y,h1=childBounds.y+childBounds.height,minX=w0>minX?minX:w0,minY=h0>minY?minY:h0,maxX=maxX>w1?maxX:w1,maxY=maxY>h1?maxY:h1}var bounds=this._bounds;bounds.x=minX,bounds.width=maxX-minX,bounds.y=minY,bounds.height=maxY-minY,this._currentBounds=bounds}return this._currentBounds},Sprite.prototype.getLocalBounds=function(){return this._bounds.x=-this._texture._frame.width*this.anchor.x,this._bounds.y=-this._texture._frame.height*this.anchor.y,this._bounds.width=this._texture._frame.width,this._bounds.height=this._texture._frame.height,this._bounds},Sprite.prototype.containsPoint=function(point){this.worldTransform.applyInverse(point,tempPoint);var y1,width=this._texture._frame.width,height=this._texture._frame.height,x1=-width*this.anchor.x;return tempPoint.x>x1&&tempPoint.x<x1+width&&(y1=-height*this.anchor.y,tempPoint.y>y1&&tempPoint.y<y1+height)?!0:!1},Sprite.prototype._renderCanvas=function(renderer){if(!(this.texture.crop.width<=0||this.texture.crop.height<=0)){var compositeOperation=renderer.blendModes[this.blendMode];if(compositeOperation!==renderer.context.globalCompositeOperation&&(renderer.context.globalCompositeOperation=compositeOperation),this.texture.valid){var dx,dy,width,height,texture=this._texture,wt=this.worldTransform;renderer.context.globalAlpha=this.worldAlpha;var smoothingEnabled=texture.baseTexture.scaleMode===CONST.SCALE_MODES.LINEAR;if(renderer.smoothProperty&&renderer.context[renderer.smoothProperty]!==smoothingEnabled&&(renderer.context[renderer.smoothProperty]=smoothingEnabled),texture.rotate){var a=wt.a,b=wt.b;wt.a=-wt.c,wt.b=-wt.d,wt.c=a,wt.d=b,width=texture.crop.height,height=texture.crop.width,dx=texture.trim?texture.trim.y-this.anchor.y*texture.trim.height:this.anchor.y*-texture._frame.height,dy=texture.trim?texture.trim.x-this.anchor.x*texture.trim.width:this.anchor.x*-texture._frame.width}else width=texture.crop.width,height=texture.crop.height,dx=texture.trim?texture.trim.x-this.anchor.x*texture.trim.width:this.anchor.x*-texture._frame.width,dy=texture.trim?texture.trim.y-this.anchor.y*texture.trim.height:this.anchor.y*-texture._frame.height;renderer.roundPixels?(renderer.context.setTransform(wt.a,wt.b,wt.c,wt.d,wt.tx*renderer.resolution|0,wt.ty*renderer.resolution|0),dx=0|dx,dy=0|dy):renderer.context.setTransform(wt.a,wt.b,wt.c,wt.d,wt.tx*renderer.resolution,wt.ty*renderer.resolution);var resolution=texture.baseTexture.resolution;16777215!==this.tint?(this.cachedTint!==this.tint&&(this.cachedTint=this.tint,this.tintedTexture=CanvasTinter.getTintedTexture(this,this.tint)),renderer.context.drawImage(this.tintedTexture,0,0,width*resolution,height*resolution,dx*renderer.resolution,dy*renderer.resolution,width*renderer.resolution,height*renderer.resolution)):renderer.context.drawImage(texture.baseTexture.source,texture.crop.x*resolution,texture.crop.y*resolution,width*resolution,height*resolution,dx*renderer.resolution,dy*renderer.resolution,width*renderer.resolution,height*renderer.resolution)}}},Sprite.prototype.destroy=function(destroyTexture,destroyBaseTexture){Container.prototype.destroy.call(this),this.anchor=null,destroyTexture&&this._texture.destroy(destroyBaseTexture),this._texture=null,this.shader=null},Sprite.fromFrame=function(frameId){var texture=utils.TextureCache[frameId];if(!texture)throw new Error('The frameId "'+frameId+'" does not exist in the texture cache');return new Sprite(texture)},Sprite.fromImage=function(imageId,crossorigin,scaleMode){return new Sprite(Texture.fromImage(imageId,crossorigin,scaleMode))}},{"../const":29,"../display/Container":30,"../math":39,"../renderers/canvas/utils/CanvasTinter":54,"../textures/Texture":78,"../utils":83}],74:[function(require,module,exports){function SpriteRenderer(renderer){ObjectRenderer.call(this,renderer),this.vertSize=5,this.vertByteSize=4*this.vertSize,this.size=CONST.SPRITE_BATCH_SIZE;var numVerts=4*this.size*this.vertByteSize,numIndices=6*this.size;this.vertices=new ArrayBuffer(numVerts),this.positions=new Float32Array(this.vertices),this.colors=new Uint32Array(this.vertices),this.indices=new Uint16Array(numIndices);for(var i=0,j=0;numIndices>i;i+=6,j+=4)this.indices[i+0]=j+0,this.indices[i+1]=j+1,this.indices[i+2]=j+2,this.indices[i+3]=j+0,this.indices[i+4]=j+2,this.indices[i+5]=j+3;this.currentBatchSize=0,this.sprites=[],this.shader=null}var ObjectRenderer=require("../../renderers/webgl/utils/ObjectRenderer"),WebGLRenderer=require("../../renderers/webgl/WebGLRenderer"),CONST=require("../../const");SpriteRenderer.prototype=Object.create(ObjectRenderer.prototype),SpriteRenderer.prototype.constructor=SpriteRenderer,module.exports=SpriteRenderer,WebGLRenderer.registerPlugin("sprite",SpriteRenderer),SpriteRenderer.prototype.onContextChange=function(){var gl=this.renderer.gl;this.shader=this.renderer.shaderManager.defaultShader,this.vertexBuffer=gl.createBuffer(),this.indexBuffer=gl.createBuffer(),gl.bindBuffer(gl.ELEMENT_ARRAY_BUFFER,this.indexBuffer),gl.bufferData(gl.ELEMENT_ARRAY_BUFFER,this.indices,gl.STATIC_DRAW),gl.bindBuffer(gl.ARRAY_BUFFER,this.vertexBuffer),gl.bufferData(gl.ARRAY_BUFFER,this.vertices,gl.DYNAMIC_DRAW),this.currentBlendMode=99999},SpriteRenderer.prototype.render=function(sprite){var texture=sprite._texture;this.currentBatchSize>=this.size&&this.flush();var uvs=texture._uvs;if(uvs){var w0,w1,h0,h1,aX=sprite.anchor.x,aY=sprite.anchor.y;if(texture.trim&&void 0===sprite.tileScale){var trim=texture.trim;w1=trim.x-aX*trim.width,w0=w1+texture.crop.width,h1=trim.y-aY*trim.height,h0=h1+texture.crop.height}else w0=texture._frame.width*(1-aX),w1=texture._frame.width*-aX,h0=texture._frame.height*(1-aY),h1=texture._frame.height*-aY;var index=this.currentBatchSize*this.vertByteSize,worldTransform=sprite.worldTransform,a=worldTransform.a,b=worldTransform.b,c=worldTransform.c,d=worldTransform.d,tx=worldTransform.tx,ty=worldTransform.ty,colors=this.colors,positions=this.positions;this.renderer.roundPixels?(positions[index]=a*w1+c*h1+tx|0,positions[index+1]=d*h1+b*w1+ty|0,positions[index+5]=a*w0+c*h1+tx|0,positions[index+6]=d*h1+b*w0+ty|0,positions[index+10]=a*w0+c*h0+tx|0,positions[index+11]=d*h0+b*w0+ty|0,positions[index+15]=a*w1+c*h0+tx|0,positions[index+16]=d*h0+b*w1+ty|0):(positions[index]=a*w1+c*h1+tx,positions[index+1]=d*h1+b*w1+ty,positions[index+5]=a*w0+c*h1+tx,positions[index+6]=d*h1+b*w0+ty,positions[index+10]=a*w0+c*h0+tx,positions[index+11]=d*h0+b*w0+ty,positions[index+15]=a*w1+c*h0+tx,positions[index+16]=d*h0+b*w1+ty),positions[index+2]=uvs.x0,positions[index+3]=uvs.y0,positions[index+7]=uvs.x1,positions[index+8]=uvs.y1,positions[index+12]=uvs.x2,positions[index+13]=uvs.y2,positions[index+17]=uvs.x3,positions[index+18]=uvs.y3;var tint=sprite.tint;colors[index+4]=colors[index+9]=colors[index+14]=colors[index+19]=(tint>>16)+(65280&tint)+((255&tint)<<16)+(255*sprite.worldAlpha<<24),this.sprites[this.currentBatchSize++]=sprite}},SpriteRenderer.prototype.flush=function(){if(0!==this.currentBatchSize){var shader,gl=this.renderer.gl;if(this.currentBatchSize>.5*this.size)gl.bufferSubData(gl.ARRAY_BUFFER,0,this.vertices);else{var view=this.positions.subarray(0,this.currentBatchSize*this.vertByteSize);gl.bufferSubData(gl.ARRAY_BUFFER,0,view)}for(var nextTexture,nextBlendMode,nextShader,sprite,batchSize=0,start=0,currentBaseTexture=null,currentBlendMode=this.renderer.blendModeManager.currentBlendMode,currentShader=null,blendSwap=!1,shaderSwap=!1,i=0,j=this.currentBatchSize;j>i;i++)sprite=this.sprites[i],nextTexture=sprite._texture.baseTexture,nextBlendMode=sprite.blendMode,nextShader=sprite.shader||this.shader,blendSwap=currentBlendMode!==nextBlendMode,shaderSwap=currentShader!==nextShader,(currentBaseTexture!==nextTexture||blendSwap||shaderSwap)&&(this.renderBatch(currentBaseTexture,batchSize,start),start=i,batchSize=0,currentBaseTexture=nextTexture,blendSwap&&(currentBlendMode=nextBlendMode,this.renderer.blendModeManager.setBlendMode(currentBlendMode)),shaderSwap&&(currentShader=nextShader,shader=currentShader.shaders?currentShader.shaders[gl.id]:currentShader,shader||(shader=currentShader.getShader(this.renderer)),this.renderer.shaderManager.setShader(shader),shader.uniforms.projectionMatrix.value=this.renderer.currentRenderTarget.projectionMatrix.toArray(!0),shader.syncUniforms(),gl.activeTexture(gl.TEXTURE0))),batchSize++;this.renderBatch(currentBaseTexture,batchSize,start),this.currentBatchSize=0}},SpriteRenderer.prototype.renderBatch=function(texture,size,startIndex){if(0!==size){var gl=this.renderer.gl;texture._glTextures[gl.id]?gl.bindTexture(gl.TEXTURE_2D,texture._glTextures[gl.id]):this.renderer.updateTexture(texture),gl.drawElements(gl.TRIANGLES,6*size,gl.UNSIGNED_SHORT,6*startIndex*2),this.renderer.drawCount++}},SpriteRenderer.prototype.start=function(){var gl=this.renderer.gl;gl.bindBuffer(gl.ARRAY_BUFFER,this.vertexBuffer),gl.bindBuffer(gl.ELEMENT_ARRAY_BUFFER,this.indexBuffer);var stride=this.vertByteSize;gl.vertexAttribPointer(this.shader.attributes.aVertexPosition,2,gl.FLOAT,!1,stride,0),gl.vertexAttribPointer(this.shader.attributes.aTextureCoord,2,gl.FLOAT,!1,stride,8),gl.vertexAttribPointer(this.shader.attributes.aColor,4,gl.UNSIGNED_BYTE,!0,stride,16)},SpriteRenderer.prototype.destroy=function(){this.renderer.gl.deleteBuffer(this.vertexBuffer),this.renderer.gl.deleteBuffer(this.indexBuffer),ObjectRenderer.prototype.destroy.call(this),this.shader.destroy(),this.renderer=null,this.vertices=null,this.positions=null,this.colors=null,this.indices=null,this.vertexBuffer=null,this.indexBuffer=null,this.sprites=null,this.shader=null}},{"../../const":29,"../../renderers/webgl/WebGLRenderer":55,"../../renderers/webgl/utils/ObjectRenderer":69}],75:[function(require,module,exports){function Text(text,style,resolution){this.canvas=document.createElement("canvas"),this.context=this.canvas.getContext("2d"),this.resolution=resolution||CONST.RESOLUTION,this._text=null,this._style=null;var texture=Texture.fromCanvas(this.canvas);texture.trim=new math.Rectangle,Sprite.call(this,texture),this.text=text,this.style=style}var Sprite=require("../sprites/Sprite"),Texture=require("../textures/Texture"),math=require("../math"),utils=require("../utils"),CONST=require("../const");Text.prototype=Object.create(Sprite.prototype),Text.prototype.constructor=Text,module.exports=Text,Text.fontPropertiesCache={},Text.fontPropertiesCanvas=document.createElement("canvas"),Text.fontPropertiesContext=Text.fontPropertiesCanvas.getContext("2d"),Object.defineProperties(Text.prototype,{width:{get:function(){return this.dirty&&this.updateText(),this.scale.x*this._texture._frame.width},set:function(value){this.scale.x=value/this._texture._frame.width,this._width=value}},height:{get:function(){return this.dirty&&this.updateText(),this.scale.y*this._texture._frame.height},set:function(value){this.scale.y=value/this._texture._frame.height,this._height=value}},style:{get:function(){return this._style},set:function(style){style=style||{},"number"==typeof style.fill&&(style.fill=utils.hex2string(style.fill)),"number"==typeof style.stroke&&(style.stroke=utils.hex2string(style.stroke)),"number"==typeof style.dropShadowColor&&(style.dropShadowColor=utils.hex2string(style.dropShadowColor)),style.font=style.font||"bold 20pt Arial",style.fill=style.fill||"black",style.align=style.align||"left",style.stroke=style.stroke||"black",style.strokeThickness=style.strokeThickness||0,style.wordWrap=style.wordWrap||!1,style.wordWrapWidth=style.wordWrapWidth||100,style.dropShadow=style.dropShadow||!1,style.dropShadowColor=style.dropShadowColor||"#000000",style.dropShadowAngle=style.dropShadowAngle||Math.PI/6,style.dropShadowDistance=style.dropShadowDistance||5,style.padding=style.padding||0,style.textBaseline=style.textBaseline||"alphabetic",style.lineJoin=style.lineJoin||"miter",style.miterLimit=style.miterLimit||10,this._style=style,this.dirty=!0}},text:{get:function(){return this._text},set:function(text){text=text.toString()||" ",this._text!==text&&(this._text=text,this.dirty=!0)}}}),Text.prototype.updateText=function(){var style=this._style;this.context.font=style.font;for(var outputText=style.wordWrap?this.wordWrap(this._text):this._text,lines=outputText.split(/(?:\r\n|\r|\n)/),lineWidths=new Array(lines.length),maxLineWidth=0,fontProperties=this.determineFontProperties(style.font),i=0;i<lines.length;i++){var lineWidth=this.context.measureText(lines[i]).width;lineWidths[i]=lineWidth,maxLineWidth=Math.max(maxLineWidth,lineWidth)}var width=maxLineWidth+style.strokeThickness;style.dropShadow&&(width+=style.dropShadowDistance),this.canvas.width=(width+this.context.lineWidth)*this.resolution;var lineHeight=this.style.lineHeight||fontProperties.fontSize+style.strokeThickness,height=lineHeight*lines.length;style.dropShadow&&(height+=style.dropShadowDistance),this.canvas.height=(height+2*this._style.padding)*this.resolution,this.context.scale(this.resolution,this.resolution),navigator.isCocoonJS&&this.context.clearRect(0,0,this.canvas.width,this.canvas.height),this.context.font=style.font,this.context.strokeStyle=style.stroke,this.context.lineWidth=style.strokeThickness,this.context.textBaseline=style.textBaseline,this.context.lineJoin=style.lineJoin,this.context.miterLimit=style.miterLimit;var linePositionX,linePositionY;if(style.dropShadow){this.context.fillStyle=style.dropShadowColor;var xShadowOffset=Math.cos(style.dropShadowAngle)*style.dropShadowDistance,yShadowOffset=Math.sin(style.dropShadowAngle)*style.dropShadowDistance;for(i=0;i<lines.length;i++)linePositionX=style.strokeThickness/2,linePositionY=style.strokeThickness/2+i*lineHeight+fontProperties.ascent,"right"===style.align?linePositionX+=maxLineWidth-lineWidths[i]:"center"===style.align&&(linePositionX+=(maxLineWidth-lineWidths[i])/2),style.fill&&this.context.fillText(lines[i],linePositionX+xShadowOffset,linePositionY+yShadowOffset+this._style.padding)}for(this.context.fillStyle=style.fill,i=0;i<lines.length;i++)linePositionX=style.strokeThickness/2,linePositionY=style.strokeThickness/2+i*lineHeight+fontProperties.ascent,"right"===style.align?linePositionX+=maxLineWidth-lineWidths[i]:"center"===style.align&&(linePositionX+=(maxLineWidth-lineWidths[i])/2),style.stroke&&style.strokeThickness&&this.context.strokeText(lines[i],linePositionX,linePositionY+this._style.padding),style.fill&&this.context.fillText(lines[i],linePositionX,linePositionY+this._style.padding);this.updateTexture()},Text.prototype.updateTexture=function(){var texture=this._texture;texture.baseTexture.hasLoaded=!0,texture.baseTexture.resolution=this.resolution,texture.baseTexture.width=this.canvas.width/this.resolution,texture.baseTexture.height=this.canvas.height/this.resolution,texture.crop.width=texture._frame.width=this.canvas.width/this.resolution,texture.crop.height=texture._frame.height=this.canvas.height/this.resolution,texture.trim.x=0,texture.trim.y=-this._style.padding,texture.trim.width=texture._frame.width,texture.trim.height=texture._frame.height-2*this._style.padding,this._width=this.canvas.width/this.resolution,this._height=this.canvas.height/this.resolution,texture.baseTexture.emit("update",texture.baseTexture),this.dirty=!1},Text.prototype.renderWebGL=function(renderer){this.dirty&&this.updateText(),Sprite.prototype.renderWebGL.call(this,renderer)},Text.prototype._renderCanvas=function(renderer){this.dirty&&this.updateText(),Sprite.prototype._renderCanvas.call(this,renderer)},Text.prototype.determineFontProperties=function(fontStyle){var properties=Text.fontPropertiesCache[fontStyle];if(!properties){properties={};var canvas=Text.fontPropertiesCanvas,context=Text.fontPropertiesContext;context.font=fontStyle;var width=Math.ceil(context.measureText("|MÉq").width),baseline=Math.ceil(context.measureText("M").width),height=2*baseline;baseline=1.4*baseline|0,canvas.width=width,canvas.height=height,context.fillStyle="#f00",context.fillRect(0,0,width,height),context.font=fontStyle,context.textBaseline="alphabetic",context.fillStyle="#000",context.fillText("|MÉq",0,baseline);var i,j,imagedata=context.getImageData(0,0,width,height).data,pixels=imagedata.length,line=4*width,idx=0,stop=!1;for(i=0;baseline>i;i++){for(j=0;line>j;j+=4)if(255!==imagedata[idx+j]){stop=!0;break}if(stop)break;idx+=line}for(properties.ascent=baseline-i,idx=pixels-line,stop=!1,i=height;i>baseline;i--){for(j=0;line>j;j+=4)if(255!==imagedata[idx+j]){stop=!0;break}if(stop)break;idx-=line}properties.descent=i-baseline,properties.fontSize=properties.ascent+properties.descent,Text.fontPropertiesCache[fontStyle]=properties}return properties},Text.prototype.wordWrap=function(text){for(var result="",lines=text.split("\n"),wordWrapWidth=this._style.wordWrapWidth,i=0;i<lines.length;i++){for(var spaceLeft=wordWrapWidth,words=lines[i].split(" "),j=0;j<words.length;j++){var wordWidth=this.context.measureText(words[j]).width,wordWidthWithSpace=wordWidth+this.context.measureText(" ").width;0===j||wordWidthWithSpace>spaceLeft?(j>0&&(result+="\n"),result+=words[j],spaceLeft=wordWrapWidth-wordWidth):(spaceLeft-=wordWidthWithSpace,result+=" "+words[j])}i<lines.length-1&&(result+="\n")}return result},Text.prototype.getBounds=function(matrix){return this.dirty&&this.updateText(),Sprite.prototype.getBounds.call(this,matrix)},Text.prototype.destroy=function(destroyBaseTexture){this.context=null,this.canvas=null,this._style=null,this._texture.destroy(void 0===destroyBaseTexture?!0:destroyBaseTexture)}},{"../const":29,"../math":39,"../sprites/Sprite":73,"../textures/Texture":78,"../utils":83}],76:[function(require,module,exports){function BaseTexture(source,scaleMode,resolution){EventEmitter.call(this),this.uid=utils.uid(),this.resolution=resolution||1,this.width=100,this.height=100,this.realWidth=100,this.realHeight=100,this.scaleMode=scaleMode||CONST.SCALE_MODES.DEFAULT,this.hasLoaded=!1,this.isLoading=!1,this.source=null,this.premultipliedAlpha=!0,this.imageUrl=null,this.isPowerOfTwo=!1,this.mipmap=!1,this._glTextures=[],source&&this.loadSource(source)}var utils=require("../utils"),CONST=require("../const"),EventEmitter=require("eventemitter3");BaseTexture.prototype=Object.create(EventEmitter.prototype),BaseTexture.prototype.constructor=BaseTexture,module.exports=BaseTexture,BaseTexture.prototype.update=function(){this.realWidth=this.source.naturalWidth||this.source.width,this.realHeight=this.source.naturalHeight||this.source.height,this.width=this.realWidth/this.resolution,this.height=this.realHeight/this.resolution,this.isPowerOfTwo=utils.isPowerOfTwo(this.realWidth,this.realHeight),this.emit("update",this)},BaseTexture.prototype.loadSource=function(source){var wasLoading=this.isLoading;if(this.hasLoaded=!1,this.isLoading=!1,wasLoading&&this.source&&(this.source.onload=null,this.source.onerror=null),this.source=source,(this.source.complete||this.source.getContext)&&this.source.width&&this.source.height)this._sourceLoaded();else if(!source.getContext){this.isLoading=!0;var scope=this;source.onload=function(){source.onload=null,source.onerror=null,scope.isLoading&&(scope.isLoading=!1,scope._sourceLoaded(),scope.emit("loaded",scope))},source.onerror=function(){source.onload=null,source.onerror=null,scope.isLoading&&(scope.isLoading=!1,scope.emit("error",scope))},source.complete&&source.src&&(this.isLoading=!1,source.onload=null,source.onerror=null,source.width&&source.height?(this._sourceLoaded(),wasLoading&&this.emit("loaded",this)):wasLoading&&this.emit("error",this))}},BaseTexture.prototype._sourceLoaded=function(){this.hasLoaded=!0,this.update()},BaseTexture.prototype.destroy=function(){this.imageUrl?(delete utils.BaseTextureCache[this.imageUrl],delete utils.TextureCache[this.imageUrl],this.imageUrl=null,navigator.isCocoonJS||(this.source.src="")):this.source&&this.source._pixiId&&delete utils.BaseTextureCache[this.source._pixiId],this.source=null,this.dispose()},BaseTexture.prototype.dispose=function(){this.emit("dispose",this),this._glTextures.length=0},BaseTexture.prototype.updateSourceImage=function(newSrc){this.source.src=newSrc,this.loadSource(this.source)},BaseTexture.fromImage=function(imageUrl,crossorigin,scaleMode){var baseTexture=utils.BaseTextureCache[imageUrl];if(void 0===crossorigin&&0!==imageUrl.indexOf("data:")&&(crossorigin=!0),!baseTexture){var image=new Image;crossorigin&&(image.crossOrigin=""),baseTexture=new BaseTexture(image,scaleMode),baseTexture.imageUrl=imageUrl,image.src=imageUrl,utils.BaseTextureCache[imageUrl]=baseTexture,baseTexture.resolution=utils.getResolutionOfUrl(imageUrl)}return baseTexture},BaseTexture.fromCanvas=function(canvas,scaleMode){canvas._pixiId||(canvas._pixiId="canvas_"+utils.uid());var baseTexture=utils.BaseTextureCache[canvas._pixiId];return baseTexture||(baseTexture=new BaseTexture(canvas,scaleMode),utils.BaseTextureCache[canvas._pixiId]=baseTexture),baseTexture}},{"../const":29,"../utils":83,eventemitter3:22}],77:[function(require,module,exports){function RenderTexture(renderer,width,height,scaleMode,resolution){if(!renderer)throw new Error("Unable to create RenderTexture, you must pass a renderer into the constructor.");width=width||100,height=height||100,resolution=resolution||CONST.RESOLUTION;var baseTexture=new BaseTexture;if(baseTexture.width=width,baseTexture.height=height,baseTexture.resolution=resolution,baseTexture.scaleMode=scaleMode||CONST.SCALE_MODES.DEFAULT,baseTexture.hasLoaded=!0,Texture.call(this,baseTexture,new math.Rectangle(0,0,width,height)),this.width=width,this.height=height,this.resolution=resolution,this.render=null,this.renderer=renderer,this.renderer.type===CONST.RENDERER_TYPE.WEBGL){var gl=this.renderer.gl;this.textureBuffer=new RenderTarget(gl,this.width,this.height,baseTexture.scaleMode,this.resolution),this.baseTexture._glTextures[gl.id]=this.textureBuffer.texture,this.filterManager=new FilterManager(this.renderer),this.filterManager.onContextChange(),this.filterManager.resize(width,height),this.render=this.renderWebGL,this.renderer.currentRenderer.start(),this.renderer.currentRenderTarget.activate()}else this.render=this.renderCanvas,this.textureBuffer=new CanvasBuffer(this.width*this.resolution,this.height*this.resolution),this.baseTexture.source=this.textureBuffer.canvas;this.valid=!0,this._updateUvs()}var BaseTexture=require("./BaseTexture"),Texture=require("./Texture"),RenderTarget=require("../renderers/webgl/utils/RenderTarget"),FilterManager=require("../renderers/webgl/managers/FilterManager"),CanvasBuffer=require("../renderers/canvas/utils/CanvasBuffer"),math=require("../math"),CONST=require("../const"),tempMatrix=new math.Matrix;RenderTexture.prototype=Object.create(Texture.prototype),RenderTexture.prototype.constructor=RenderTexture,module.exports=RenderTexture,RenderTexture.prototype.resize=function(width,height,updateBase){(width!==this.width||height!==this.height)&&(this.valid=width>0&&height>0,this.width=this._frame.width=this.crop.width=width,this.height=this._frame.height=this.crop.height=height,updateBase&&(this.baseTexture.width=this.width,this.baseTexture.height=this.height),this.valid&&(this.textureBuffer.resize(this.width,this.height),this.filterManager&&this.filterManager.resize(this.width,this.height)))},RenderTexture.prototype.clear=function(){this.valid&&(this.renderer.type===CONST.RENDERER_TYPE.WEBGL&&this.renderer.gl.bindFramebuffer(this.renderer.gl.FRAMEBUFFER,this.textureBuffer.frameBuffer),this.textureBuffer.clear())},RenderTexture.prototype.renderWebGL=function(displayObject,matrix,clear,updateTransform){if(this.valid){if(updateTransform=void 0!==updateTransform?updateTransform:!0,this.textureBuffer.transform=matrix,this.textureBuffer.activate(),displayObject.worldAlpha=1,updateTransform){displayObject.worldTransform.identity(),displayObject.currentBounds=null;var i,j,children=displayObject.children;for(i=0,j=children.length;j>i;++i)children[i].updateTransform()}var temp=this.renderer.filterManager;this.renderer.filterManager=this.filterManager,this.renderer.renderDisplayObject(displayObject,this.textureBuffer,clear),this.renderer.filterManager=temp}},RenderTexture.prototype.renderCanvas=function(displayObject,matrix,clear,updateTransform){if(this.valid){updateTransform=!!updateTransform;var wt=tempMatrix;wt.identity(),matrix&&wt.append(matrix),displayObject.worldTransform=wt;var cachedWt=displayObject.worldTransform;displayObject.worldAlpha=1;var i,j,children=displayObject.children;for(i=0,j=children.length;j>i;++i)children[i].updateTransform();clear&&this.textureBuffer.clear();var context=this.textureBuffer.context,realResolution=this.renderer.resolution;this.renderer.resolution=this.resolution,this.renderer.renderDisplayObject(displayObject,context),this.renderer.resolution=realResolution,displayObject.worldTransform=cachedWt}},RenderTexture.prototype.destroy=function(){Texture.prototype.destroy.call(this,!0),this.textureBuffer.destroy(),this.filterManager&&this.filterManager.destroy(),this.renderer=null},RenderTexture.prototype.getImage=function(){var image=new Image;return image.src=this.getBase64(),image},RenderTexture.prototype.getBase64=function(){return this.getCanvas().toDataURL()},RenderTexture.prototype.getCanvas=function(){if(this.renderer.type===CONST.RENDERER_TYPE.WEBGL){var gl=this.renderer.gl,width=this.textureBuffer.size.width,height=this.textureBuffer.size.height,webGLPixels=new Uint8Array(4*width*height);gl.bindFramebuffer(gl.FRAMEBUFFER,this.textureBuffer.frameBuffer),gl.readPixels(0,0,width,height,gl.RGBA,gl.UNSIGNED_BYTE,webGLPixels),gl.bindFramebuffer(gl.FRAMEBUFFER,null);var tempCanvas=new CanvasBuffer(width,height),canvasData=tempCanvas.context.getImageData(0,0,width,height);return canvasData.data.set(webGLPixels),tempCanvas.context.putImageData(canvasData,0,0),tempCanvas.canvas}return this.textureBuffer.canvas},RenderTexture.prototype.getPixels=function(){var width,height;if(this.renderer.type===CONST.RENDERER_TYPE.WEBGL){var gl=this.renderer.gl;width=this.textureBuffer.size.width,height=this.textureBuffer.size.height;var webGLPixels=new Uint8Array(4*width*height);return gl.bindFramebuffer(gl.FRAMEBUFFER,this.textureBuffer.frameBuffer),gl.readPixels(0,0,width,height,gl.RGBA,gl.UNSIGNED_BYTE,webGLPixels),gl.bindFramebuffer(gl.FRAMEBUFFER,null),webGLPixels}return width=this.textureBuffer.canvas.width,height=this.textureBuffer.canvas.height,
this.textureBuffer.canvas.getContext("2d").getImageData(0,0,width,height).data},RenderTexture.prototype.getPixel=function(x,y){if(this.renderer.type===CONST.RENDERER_TYPE.WEBGL){var gl=this.renderer.gl,webGLPixels=new Uint8Array(4);return gl.bindFramebuffer(gl.FRAMEBUFFER,this.textureBuffer.frameBuffer),gl.readPixels(x,y,1,1,gl.RGBA,gl.UNSIGNED_BYTE,webGLPixels),gl.bindFramebuffer(gl.FRAMEBUFFER,null),webGLPixels}return this.textureBuffer.canvas.getContext("2d").getImageData(x,y,1,1).data}},{"../const":29,"../math":39,"../renderers/canvas/utils/CanvasBuffer":51,"../renderers/webgl/managers/FilterManager":60,"../renderers/webgl/utils/RenderTarget":71,"./BaseTexture":76,"./Texture":78}],78:[function(require,module,exports){function Texture(baseTexture,frame,crop,trim,rotate){EventEmitter.call(this),this.noFrame=!1,frame||(this.noFrame=!0,frame=new math.Rectangle(0,0,1,1)),baseTexture instanceof Texture&&(baseTexture=baseTexture.baseTexture),this.baseTexture=baseTexture,this._frame=frame,this.trim=trim,this.valid=!1,this.requiresUpdate=!1,this._uvs=null,this.width=0,this.height=0,this.crop=crop||frame,this.rotate=!!rotate,baseTexture.hasLoaded?(this.noFrame&&(frame=new math.Rectangle(0,0,baseTexture.width,baseTexture.height),baseTexture.on("update",this.onBaseTextureUpdated,this)),this.frame=frame):baseTexture.once("loaded",this.onBaseTextureLoaded,this)}var BaseTexture=require("./BaseTexture"),VideoBaseTexture=require("./VideoBaseTexture"),TextureUvs=require("./TextureUvs"),EventEmitter=require("eventemitter3"),math=require("../math"),utils=require("../utils");Texture.prototype=Object.create(EventEmitter.prototype),Texture.prototype.constructor=Texture,module.exports=Texture,Object.defineProperties(Texture.prototype,{frame:{get:function(){return this._frame},set:function(frame){if(this._frame=frame,this.noFrame=!1,this.width=frame.width,this.height=frame.height,!this.trim&&!this.rotate&&(frame.x+frame.width>this.baseTexture.width||frame.y+frame.height>this.baseTexture.height))throw new Error("Texture Error: frame does not fit inside the base Texture dimensions "+this);this.valid=frame&&frame.width&&frame.height&&this.baseTexture.hasLoaded,this.trim?(this.width=this.trim.width,this.height=this.trim.height,this._frame.width=this.trim.width,this._frame.height=this.trim.height):this.crop=frame,this.valid&&this._updateUvs()}}}),Texture.prototype.update=function(){this.baseTexture.update()},Texture.prototype.onBaseTextureLoaded=function(baseTexture){this.noFrame?this.frame=new math.Rectangle(0,0,baseTexture.width,baseTexture.height):this.frame=this._frame,this.emit("update",this)},Texture.prototype.onBaseTextureUpdated=function(baseTexture){this._frame.width=baseTexture.width,this._frame.height=baseTexture.height,this.emit("update",this)},Texture.prototype.destroy=function(destroyBase){this.baseTexture&&(destroyBase&&this.baseTexture.destroy(),this.baseTexture.off("update",this.onBaseTextureUpdated,this),this.baseTexture.off("loaded",this.onBaseTextureLoaded,this),this.baseTexture=null),this._frame=null,this._uvs=null,this.trim=null,this.crop=null,this.valid=!1,this.off("dispose",this.dispose,this),this.off("update",this.update,this)},Texture.prototype.clone=function(){return new Texture(this.baseTexture,this.frame,this.crop,this.trim,this.rotate)},Texture.prototype._updateUvs=function(){this._uvs||(this._uvs=new TextureUvs),this._uvs.set(this.crop,this.baseTexture,this.rotate)},Texture.fromImage=function(imageUrl,crossorigin,scaleMode){var texture=utils.TextureCache[imageUrl];return texture||(texture=new Texture(BaseTexture.fromImage(imageUrl,crossorigin,scaleMode)),utils.TextureCache[imageUrl]=texture),texture},Texture.fromFrame=function(frameId){var texture=utils.TextureCache[frameId];if(!texture)throw new Error('The frameId "'+frameId+'" does not exist in the texture cache');return texture},Texture.fromCanvas=function(canvas,scaleMode){return new Texture(BaseTexture.fromCanvas(canvas,scaleMode))},Texture.fromVideo=function(video,scaleMode){return"string"==typeof video?Texture.fromVideoUrl(video,scaleMode):new Texture(VideoBaseTexture.fromVideo(video,scaleMode))},Texture.fromVideoUrl=function(videoUrl,scaleMode){return new Texture(VideoBaseTexture.fromUrl(videoUrl,scaleMode))},Texture.addTextureToCache=function(texture,id){utils.TextureCache[id]=texture},Texture.removeTextureFromCache=function(id){var texture=utils.TextureCache[id];return delete utils.TextureCache[id],delete utils.BaseTextureCache[id],texture},Texture.EMPTY=new Texture(new BaseTexture)},{"../math":39,"../utils":83,"./BaseTexture":76,"./TextureUvs":79,"./VideoBaseTexture":80,eventemitter3:22}],79:[function(require,module,exports){function TextureUvs(){this.x0=0,this.y0=0,this.x1=1,this.y1=0,this.x2=1,this.y2=1,this.x3=0,this.y3=1}module.exports=TextureUvs,TextureUvs.prototype.set=function(frame,baseFrame,rotate){var tw=baseFrame.width,th=baseFrame.height;rotate?(this.x0=(frame.x+frame.height)/tw,this.y0=frame.y/th,this.x1=(frame.x+frame.height)/tw,this.y1=(frame.y+frame.width)/th,this.x2=frame.x/tw,this.y2=(frame.y+frame.width)/th,this.x3=frame.x/tw,this.y3=frame.y/th):(this.x0=frame.x/tw,this.y0=frame.y/th,this.x1=(frame.x+frame.width)/tw,this.y1=frame.y/th,this.x2=(frame.x+frame.width)/tw,this.y2=(frame.y+frame.height)/th,this.x3=frame.x/tw,this.y3=(frame.y+frame.height)/th)}},{}],80:[function(require,module,exports){function VideoBaseTexture(source,scaleMode){if(!source)throw new Error("No video source element specified.");(source.readyState===source.HAVE_ENOUGH_DATA||source.readyState===source.HAVE_FUTURE_DATA)&&source.width&&source.height&&(source.complete=!0),BaseTexture.call(this,source,scaleMode),this.autoUpdate=!1,this._onUpdate=this._onUpdate.bind(this),this._onCanPlay=this._onCanPlay.bind(this),source.complete||(source.addEventListener("canplay",this._onCanPlay),source.addEventListener("canplaythrough",this._onCanPlay),source.addEventListener("play",this._onPlayStart.bind(this)),source.addEventListener("pause",this._onPlayStop.bind(this))),this.__loaded=!1}function createSource(path,type){type||(type="video/"+path.substr(path.lastIndexOf(".")+1));var source=document.createElement("source");return source.src=path,source.type=type,source}var BaseTexture=require("./BaseTexture"),utils=require("../utils");VideoBaseTexture.prototype=Object.create(BaseTexture.prototype),VideoBaseTexture.prototype.constructor=VideoBaseTexture,module.exports=VideoBaseTexture,VideoBaseTexture.prototype._onUpdate=function(){this.autoUpdate&&(window.requestAnimationFrame(this._onUpdate),this.update())},VideoBaseTexture.prototype._onPlayStart=function(){this.autoUpdate||(window.requestAnimationFrame(this._onUpdate),this.autoUpdate=!0)},VideoBaseTexture.prototype._onPlayStop=function(){this.autoUpdate=!1},VideoBaseTexture.prototype._onCanPlay=function(){this.hasLoaded=!0,this.source&&(this.source.removeEventListener("canplay",this._onCanPlay),this.source.removeEventListener("canplaythrough",this._onCanPlay),this.width=this.source.videoWidth,this.height=this.source.videoHeight,this.source.play(),this.__loaded||(this.__loaded=!0,this.emit("loaded",this)))},VideoBaseTexture.prototype.destroy=function(){this.source&&this.source._pixiId&&(delete utils.BaseTextureCache[this.source._pixiId],delete this.source._pixiId),BaseTexture.prototype.destroy.call(this)},VideoBaseTexture.fromVideo=function(video,scaleMode){video._pixiId||(video._pixiId="video_"+utils.uid());var baseTexture=utils.BaseTextureCache[video._pixiId];return baseTexture||(baseTexture=new VideoBaseTexture(video,scaleMode),utils.BaseTextureCache[video._pixiId]=baseTexture),baseTexture},VideoBaseTexture.fromUrl=function(videoSrc,scaleMode){var video=document.createElement("video");if(Array.isArray(videoSrc))for(var i=0;i<videoSrc.length;++i)video.appendChild(createSource(videoSrc[i].src||videoSrc[i],videoSrc[i].mime));else video.appendChild(createSource(videoSrc.src||videoSrc,videoSrc.mime));return video.load(),video.play(),VideoBaseTexture.fromVideo(video,scaleMode)},VideoBaseTexture.fromUrls=VideoBaseTexture.fromUrl},{"../utils":83,"./BaseTexture":76}],81:[function(require,module,exports){function Ticker(){var _this=this;this._tick=function(time){_this._requestId=null,_this.started&&(_this.update(time),_this.started&&null===_this._requestId&&_this._emitter.listeners(TICK,!0)&&(_this._requestId=requestAnimationFrame(_this._tick)))},this._emitter=new EventEmitter,this._requestId=null,this._maxElapsedMS=100,this.autoStart=!1,this.deltaTime=1,this.elapsedMS=1/CONST.TARGET_FPMS,this.lastTime=0,this.speed=1,this.started=!1}var CONST=require("../const"),EventEmitter=require("eventemitter3"),TICK="tick";Object.defineProperties(Ticker.prototype,{FPS:{get:function(){return 1e3/this.elapsedMS}},minFPS:{get:function(){return 1e3/this._maxElapsedMS},set:function(fps){var minFPMS=Math.min(Math.max(0,fps)/1e3,CONST.TARGET_FPMS);this._maxElapsedMS=1/minFPMS}}}),Ticker.prototype._requestIfNeeded=function(){null===this._requestId&&this._emitter.listeners(TICK,!0)&&(this.lastTime=performance.now(),this._requestId=requestAnimationFrame(this._tick))},Ticker.prototype._cancelIfNeeded=function(){null!==this._requestId&&(cancelAnimationFrame(this._requestId),this._requestId=null)},Ticker.prototype._startIfPossible=function(){this.started?this._requestIfNeeded():this.autoStart&&this.start()},Ticker.prototype.add=function(fn,context){return this._emitter.on(TICK,fn,context),this._startIfPossible(),this},Ticker.prototype.addOnce=function(fn,context){return this._emitter.once(TICK,fn,context),this._startIfPossible(),this},Ticker.prototype.remove=function(fn,context){return this._emitter.off(TICK,fn,context),this._emitter.listeners(TICK,!0)||this._cancelIfNeeded(),this},Ticker.prototype.start=function(){this.started||(this.started=!0,this._requestIfNeeded())},Ticker.prototype.stop=function(){this.started&&(this.started=!1,this._cancelIfNeeded())},Ticker.prototype.update=function(currentTime){var elapsedMS;currentTime=currentTime||performance.now(),elapsedMS=this.elapsedMS=currentTime-this.lastTime,elapsedMS>this._maxElapsedMS&&(elapsedMS=this._maxElapsedMS),this.deltaTime=elapsedMS*CONST.TARGET_FPMS*this.speed,this._emitter.emit(TICK,this.deltaTime),this.lastTime=currentTime},module.exports=Ticker},{"../const":29,eventemitter3:22}],82:[function(require,module,exports){var Ticker=require("./Ticker"),shared=new Ticker;shared.autoStart=!0,module.exports={shared:shared,Ticker:Ticker}},{"./Ticker":81}],83:[function(require,module,exports){var CONST=require("../const"),utils=module.exports={_uid:0,_saidHello:!1,EventEmitter:require("eventemitter3"),pluginTarget:require("./pluginTarget"),async:require("async"),uid:function(){return++utils._uid},hex2rgb:function(hex,out){return out=out||[],out[0]=(hex>>16&255)/255,out[1]=(hex>>8&255)/255,out[2]=(255&hex)/255,out},hex2string:function(hex){return hex=hex.toString(16),hex="000000".substr(0,6-hex.length)+hex,"#"+hex},rgb2hex:function(rgb){return(255*rgb[0]<<16)+(255*rgb[1]<<8)+255*rgb[2]},canUseNewCanvasBlendModes:function(){if("undefined"==typeof document)return!1;var pngHead="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAQAAAABAQMAAADD8p2OAAAAA1BMVEX/",pngEnd="AAAACklEQVQI12NgAAAAAgAB4iG8MwAAAABJRU5ErkJggg==",magenta=new Image;magenta.src=pngHead+"AP804Oa6"+pngEnd;var yellow=new Image;yellow.src=pngHead+"/wCKxvRF"+pngEnd;var canvas=document.createElement("canvas");canvas.width=6,canvas.height=1;var context=canvas.getContext("2d");context.globalCompositeOperation="multiply",context.drawImage(magenta,0,0),context.drawImage(yellow,2,0);var data=context.getImageData(2,0,1,1).data;return 255===data[0]&&0===data[1]&&0===data[2]},getNextPowerOfTwo:function(number){if(number>0&&0===(number&number-1))return number;for(var result=1;number>result;)result<<=1;return result},isPowerOfTwo:function(width,height){return width>0&&0===(width&width-1)&&height>0&&0===(height&height-1)},getResolutionOfUrl:function(url){var resolution=CONST.RETINA_PREFIX.exec(url);return resolution?parseFloat(resolution[1]):1},sayHello:function(type){if(!utils._saidHello){if(navigator.userAgent.toLowerCase().indexOf("chrome")>-1){var args=["\n %c %c %c Pixi.js "+CONST.VERSION+" - ✰ "+type+" ✰  %c  %c  http://www.pixijs.com/  %c %c ♥%c♥%c♥ \n\n","background: #ff66a5; padding:5px 0;","background: #ff66a5; padding:5px 0;","color: #ff66a5; background: #030307; padding:5px 0;","background: #ff66a5; padding:5px 0;","background: #ffc3dc; padding:5px 0;","background: #ff66a5; padding:5px 0;","color: #ff2424; background: #fff; padding:5px 0;","color: #ff2424; background: #fff; padding:5px 0;","color: #ff2424; background: #fff; padding:5px 0;"];window.console.log.apply(console,args)}else window.console&&window.console.log("Pixi.js "+CONST.VERSION+" - "+type+" - http://www.pixijs.com/");utils._saidHello=!0}},isWebGLSupported:function(){var contextOptions={stencil:!0};try{if(!window.WebGLRenderingContext)return!1;var canvas=document.createElement("canvas"),gl=canvas.getContext("webgl",contextOptions)||canvas.getContext("experimental-webgl",contextOptions);return!(!gl||!gl.getContextAttributes().stencil)}catch(e){return!1}},sign:function(n){return n?0>n?-1:1:0},TextureCache:{},BaseTextureCache:{}}},{"../const":29,"./pluginTarget":84,async:9,eventemitter3:22}],84:[function(require,module,exports){function pluginTarget(obj){obj.__plugins={},obj.registerPlugin=function(pluginName,ctor){obj.__plugins[pluginName]=ctor},obj.prototype.initPlugins=function(){this.plugins=this.plugins||{};for(var o in obj.__plugins)this.plugins[o]=new obj.__plugins[o](this)},obj.prototype.destroyPlugins=function(){for(var o in this.plugins)this.plugins[o].destroy(),this.plugins[o]=null;this.plugins=null}}module.exports={mixin:function(obj){pluginTarget(obj)}}},{}],85:[function(require,module,exports){var core=require("./core"),mesh=require("./mesh"),extras=require("./extras"),filters=require("./filters");core.SpriteBatch=function(){throw new ReferenceError("SpriteBatch does not exist any more, please use the new ParticleContainer instead.")},core.AssetLoader=function(){throw new ReferenceError("The loader system was overhauled in pixi v3, please see the new PIXI.loaders.Loader class.")},Object.defineProperties(core,{Stage:{get:function(){return console.warn("You do not need to use a PIXI Stage any more, you can simply render any container."),core.Container}},DisplayObjectContainer:{get:function(){return console.warn("DisplayObjectContainer has been shortened to Container, please use Container from now on."),core.Container}},Strip:{get:function(){return console.warn("The Strip class has been renamed to Mesh and moved to mesh.Mesh, please use mesh.Mesh from now on."),mesh.Mesh}},Rope:{get:function(){return console.warn("The Rope class has been moved to mesh.Rope, please use mesh.Rope from now on."),mesh.Rope}},MovieClip:{get:function(){return console.warn("The MovieClip class has been moved to extras.MovieClip, please use extras.MovieClip from now on."),extras.MovieClip}},TilingSprite:{get:function(){return console.warn("The TilingSprite class has been moved to extras.TilingSprite, please use extras.TilingSprite from now on."),extras.TilingSprite}},BitmapText:{get:function(){return console.warn("The BitmapText class has been moved to extras.BitmapText, please use extras.BitmapText from now on."),extras.BitmapText}},blendModes:{get:function(){return console.warn("The blendModes has been moved to BLEND_MODES, please use BLEND_MODES from now on."),core.BLEND_MODES}},scaleModes:{get:function(){return console.warn("The scaleModes has been moved to SCALE_MODES, please use SCALE_MODES from now on."),core.SCALE_MODES}},BaseTextureCache:{get:function(){return console.warn("The BaseTextureCache class has been moved to utils.BaseTextureCache, please use utils.BaseTextureCache from now on."),core.utils.BaseTextureCache}},TextureCache:{get:function(){return console.warn("The TextureCache class has been moved to utils.TextureCache, please use utils.TextureCache from now on."),core.utils.TextureCache}},math:{get:function(){return console.warn("The math namespace is deprecated, please access members already accessible on PIXI."),core}}}),core.Sprite.prototype.setTexture=function(texture){this.texture=texture,console.warn("setTexture is now deprecated, please use the texture property, e.g : sprite.texture = texture;")},extras.BitmapText.prototype.setText=function(text){this.text=text,console.warn("setText is now deprecated, please use the text property, e.g : myBitmapText.text = 'my text';")},core.Text.prototype.setText=function(text){this.text=text,console.warn("setText is now deprecated, please use the text property, e.g : myText.text = 'my text';")},core.Text.prototype.setStyle=function(style){this.style=style,console.warn("setStyle is now deprecated, please use the style property, e.g : myText.style = style;")},core.Texture.prototype.setFrame=function(frame){this.frame=frame,console.warn("setFrame is now deprecated, please use the frame property, e.g : myTexture.frame = frame;")},Object.defineProperties(filters,{AbstractFilter:{get:function(){return console.warn("filters.AbstractFilter is an undocumented alias, please use AbstractFilter from now on."),core.AbstractFilter}},FXAAFilter:{get:function(){return console.warn("filters.FXAAFilter is an undocumented alias, please use FXAAFilter from now on."),core.FXAAFilter}},SpriteMaskFilter:{get:function(){return console.warn("filters.SpriteMaskFilter is an undocumented alias, please use SpriteMaskFilter from now on."),core.SpriteMaskFilter}}}),core.utils.uuid=function(){return console.warn("utils.uuid() is deprecated, please use utils.uid() from now on."),core.utils.uid()}},{"./core":36,"./extras":92,"./filters":109,"./mesh":133}],86:[function(require,module,exports){function BitmapText(text,style){core.Container.call(this),style=style||{},this.textWidth=0,this.textHeight=0,this._glyphs=[],this._font={tint:void 0!==style.tint?style.tint:16777215,align:style.align||"left",name:null,size:0},this.font=style.font,this._text=text,this.maxWidth=0,this.maxLineHeight=0,this.dirty=!1,this.updateText()}var core=require("../core");BitmapText.prototype=Object.create(core.Container.prototype),BitmapText.prototype.constructor=BitmapText,module.exports=BitmapText,Object.defineProperties(BitmapText.prototype,{tint:{get:function(){return this._font.tint},set:function(value){this._font.tint="number"==typeof value&&value>=0?value:16777215,this.dirty=!0}},align:{get:function(){return this._font.align},set:function(value){this._font.align=value||"left",this.dirty=!0}},font:{get:function(){return this._font},set:function(value){value&&("string"==typeof value?(value=value.split(" "),this._font.name=1===value.length?value[0]:value.slice(1).join(" "),this._font.size=value.length>=2?parseInt(value[0],10):BitmapText.fonts[this._font.name].size):(this._font.name=value.name,this._font.size="number"==typeof value.size?value.size:parseInt(value.size,10)),this.dirty=!0)}},text:{get:function(){return this._text},set:function(value){value=value.toString()||" ",this._text!==value&&(this._text=value,this.dirty=!0)}}}),BitmapText.prototype.updateText=function(){for(var data=BitmapText.fonts[this._font.name],pos=new core.Point,prevCharCode=null,chars=[],lastLineWidth=0,maxLineWidth=0,lineWidths=[],line=0,scale=this._font.size/data.size,lastSpace=-1,maxLineHeight=0,i=0;i<this.text.length;i++){var charCode=this.text.charCodeAt(i);if(lastSpace=/(\s)/.test(this.text.charAt(i))?i:lastSpace,/(?:\r\n|\r|\n)/.test(this.text.charAt(i)))lineWidths.push(lastLineWidth),maxLineWidth=Math.max(maxLineWidth,lastLineWidth),line++,pos.x=0,pos.y+=data.lineHeight,prevCharCode=null;else if(-1!==lastSpace&&this.maxWidth>0&&pos.x*scale>this.maxWidth)chars.splice(lastSpace,i-lastSpace),i=lastSpace,lastSpace=-1,lineWidths.push(lastLineWidth),maxLineWidth=Math.max(maxLineWidth,lastLineWidth),line++,pos.x=0,pos.y+=data.lineHeight,prevCharCode=null;else{var charData=data.chars[charCode];charData&&(prevCharCode&&charData.kerning[prevCharCode]&&(pos.x+=charData.kerning[prevCharCode]),chars.push({texture:charData.texture,line:line,charCode:charCode,position:new core.Point(pos.x+charData.xOffset,pos.y+charData.yOffset)}),lastLineWidth=pos.x+(charData.texture.width+charData.xOffset),pos.x+=charData.xAdvance,maxLineHeight=Math.max(maxLineHeight,charData.yOffset+charData.texture.height),prevCharCode=charCode)}}lineWidths.push(lastLineWidth),maxLineWidth=Math.max(maxLineWidth,lastLineWidth);var lineAlignOffsets=[];for(i=0;line>=i;i++){var alignOffset=0;"right"===this._font.align?alignOffset=maxLineWidth-lineWidths[i]:"center"===this._font.align&&(alignOffset=(maxLineWidth-lineWidths[i])/2),lineAlignOffsets.push(alignOffset)}var lenChars=chars.length,tint=this.tint;for(i=0;lenChars>i;i++){var c=this._glyphs[i];c?c.texture=chars[i].texture:(c=new core.Sprite(chars[i].texture),this._glyphs.push(c)),c.position.x=(chars[i].position.x+lineAlignOffsets[chars[i].line])*scale,c.position.y=chars[i].position.y*scale,c.scale.x=c.scale.y=scale,c.tint=tint,c.parent||this.addChild(c)}for(i=lenChars;i<this._glyphs.length;++i)this.removeChild(this._glyphs[i]);this.textWidth=maxLineWidth*scale,this.textHeight=(pos.y+data.lineHeight)*scale,this.maxLineHeight=maxLineHeight*scale},BitmapText.prototype.updateTransform=function(){this.validate(),this.containerUpdateTransform()},BitmapText.prototype.getLocalBounds=function(){return this.validate(),core.Container.prototype.getLocalBounds.call(this)},BitmapText.prototype.validate=function(){this.dirty&&(this.updateText(),this.dirty=!1)},BitmapText.fonts={}},{"../core":36}],87:[function(require,module,exports){function MovieClip(textures){core.Sprite.call(this,textures[0]instanceof core.Texture?textures[0]:textures[0].texture),this._textures=null,this._durations=null,this.textures=textures,this.animationSpeed=1,this.loop=!0,this.onComplete=null,this._currentTime=0,this.playing=!1}var core=require("../core");MovieClip.prototype=Object.create(core.Sprite.prototype),MovieClip.prototype.constructor=MovieClip,module.exports=MovieClip,Object.defineProperties(MovieClip.prototype,{totalFrames:{get:function(){return this._textures.length}},textures:{get:function(){return this._textures},set:function(value){if(value[0]instanceof core.Texture)this._textures=value,this._durations=null;else{this._textures=[],this._durations=[];for(var i=0;i<value.length;i++)this._textures.push(value[i].texture),this._durations.push(value[i].time)}}},currentFrame:{get:function(){var currentFrame=Math.floor(this._currentTime)%this._textures.length;return 0>currentFrame&&(currentFrame+=this._textures.length),currentFrame}}}),MovieClip.prototype.stop=function(){this.playing&&(this.playing=!1,core.ticker.shared.remove(this.update,this))},MovieClip.prototype.play=function(){this.playing||(this.playing=!0,core.ticker.shared.add(this.update,this))},MovieClip.prototype.gotoAndStop=function(frameNumber){this.stop(),this._currentTime=frameNumber,this._texture=this._textures[this.currentFrame]},MovieClip.prototype.gotoAndPlay=function(frameNumber){this._currentTime=frameNumber,this.play()},MovieClip.prototype.update=function(deltaTime){var elapsed=this.animationSpeed*deltaTime;if(null!==this._durations){var lag=this._currentTime%1*this._durations[this.currentFrame];for(lag+=elapsed/60*1e3;0>lag;)this._currentTime--,lag+=this._durations[this.currentFrame];var sign=Math.sign(this.animationSpeed*deltaTime);for(this._currentTime=Math.floor(this._currentTime);lag>=this._durations[this.currentFrame];)lag-=this._durations[this.currentFrame]*sign,this._currentTime+=sign;this._currentTime+=lag/this._durations[this.currentFrame]}else this._currentTime+=elapsed;this._currentTime<0&&!this.loop?(this.gotoAndStop(0),this.onComplete&&this.onComplete()):this._currentTime>=this._textures.length&&!this.loop?(this.gotoAndStop(this._textures.length-1),this.onComplete&&this.onComplete()):this._texture=this._textures[this.currentFrame]},MovieClip.prototype.destroy=function(){this.stop(),core.Sprite.prototype.destroy.call(this)},MovieClip.fromFrames=function(frames){for(var textures=[],i=0;i<frames.length;++i)textures.push(new core.Texture.fromFrame(frames[i]));return new MovieClip(textures)},MovieClip.fromImages=function(images){for(var textures=[],i=0;i<images.length;++i)textures.push(new core.Texture.fromImage(images[i]));return new MovieClip(textures)}},{"../core":36}],88:[function(require,module,exports){function TilingSprite(texture,width,height){core.Sprite.call(this,texture),this.tileScale=new core.Point(1,1),this.tilePosition=new core.Point(0,0),this._width=width||100,this._height=height||100,this._uvs=new core.TextureUvs,this._canvasPattern=null,this.shader=new core.AbstractFilter(["precision lowp float;","attribute vec2 aVertexPosition;","attribute vec2 aTextureCoord;","attribute vec4 aColor;","uniform mat3 projectionMatrix;","uniform vec4 uFrame;","uniform vec4 uTransform;","varying vec2 vTextureCoord;","varying vec4 vColor;","void main(void){","   gl_Position = vec4((projectionMatrix * vec3(aVertexPosition, 1.0)).xy, 0.0, 1.0);","   vec2 coord = aTextureCoord;","   coord -= uTransform.xy;","   coord /= uTransform.zw;","   vTextureCoord = coord;","   vColor = vec4(aColor.rgb * aColor.a, aColor.a);","}"].join("\n"),["precision lowp float;","varying vec2 vTextureCoord;","varying vec4 vColor;","uniform sampler2D uSampler;","uniform vec4 uFrame;","uniform vec2 uPixelSize;","void main(void){","   vec2 coord = mod(vTextureCoord, uFrame.zw);","   coord = clamp(coord, uPixelSize, uFrame.zw - uPixelSize);","   coord += uFrame.xy;","   gl_FragColor =  texture2D(uSampler, coord) * vColor ;","}"].join("\n"),{uFrame:{type:"4fv",value:[0,0,1,1]},uTransform:{type:"4fv",value:[0,0,1,1]},uPixelSize:{type:"2fv",value:[1,1]}})}var core=require("../core"),tempPoint=new core.Point,CanvasTinter=require("../core/renderers/canvas/utils/CanvasTinter");TilingSprite.prototype=Object.create(core.Sprite.prototype),TilingSprite.prototype.constructor=TilingSprite,module.exports=TilingSprite,Object.defineProperties(TilingSprite.prototype,{width:{get:function(){return this._width},set:function(value){this._width=value}},height:{get:function(){return this._height},set:function(value){this._height=value}}}),TilingSprite.prototype._onTextureUpdate=function(){},TilingSprite.prototype._renderWebGL=function(renderer){var texture=this._texture;if(texture&&texture._uvs){var tempUvs=texture._uvs,tempWidth=texture._frame.width,tempHeight=texture._frame.height,tw=texture.baseTexture.width,th=texture.baseTexture.height;texture._uvs=this._uvs,texture._frame.width=this.width,texture._frame.height=this.height,this.shader.uniforms.uPixelSize.value[0]=1/tw,this.shader.uniforms.uPixelSize.value[1]=1/th,this.shader.uniforms.uFrame.value[0]=tempUvs.x0,this.shader.uniforms.uFrame.value[1]=tempUvs.y0,this.shader.uniforms.uFrame.value[2]=tempUvs.x1-tempUvs.x0,this.shader.uniforms.uFrame.value[3]=tempUvs.y2-tempUvs.y0,this.shader.uniforms.uTransform.value[0]=this.tilePosition.x%(tempWidth*this.tileScale.x)/this._width,this.shader.uniforms.uTransform.value[1]=this.tilePosition.y%(tempHeight*this.tileScale.y)/this._height,this.shader.uniforms.uTransform.value[2]=tw/this._width*this.tileScale.x,this.shader.uniforms.uTransform.value[3]=th/this._height*this.tileScale.y,renderer.setObjectRenderer(renderer.plugins.sprite),renderer.plugins.sprite.render(this),texture._uvs=tempUvs,texture._frame.width=tempWidth,texture._frame.height=tempHeight}},TilingSprite.prototype._renderCanvas=function(renderer){var texture=this._texture;if(texture.baseTexture.hasLoaded){var context=renderer.context,transform=this.worldTransform,resolution=renderer.resolution,baseTexture=texture.baseTexture,modX=this.tilePosition.x/this.tileScale.x%texture._frame.width,modY=this.tilePosition.y/this.tileScale.y%texture._frame.height;if(!this._canvasPattern){var tempCanvas=new core.CanvasBuffer(texture._frame.width,texture._frame.height);16777215!==this.tint?(this.cachedTint!==this.tint&&(this.cachedTint=this.tint,this.tintedTexture=CanvasTinter.getTintedTexture(this,this.tint)),tempCanvas.context.drawImage(this.tintedTexture,0,0)):tempCanvas.context.drawImage(baseTexture.source,-texture._frame.x,-texture._frame.y),this._canvasPattern=tempCanvas.context.createPattern(tempCanvas.canvas,"repeat")}context.globalAlpha=this.worldAlpha,context.setTransform(transform.a*resolution,transform.b*resolution,transform.c*resolution,transform.d*resolution,transform.tx*resolution,transform.ty*resolution),context.scale(this.tileScale.x,this.tileScale.y),context.translate(modX+this.anchor.x*-this._width,modY+this.anchor.y*-this._height);var compositeOperation=renderer.blendModes[this.blendMode];compositeOperation!==renderer.context.globalCompositeOperation&&(context.globalCompositeOperation=compositeOperation),context.fillStyle=this._canvasPattern,context.fillRect(-modX,-modY,this._width/this.tileScale.x,this._height/this.tileScale.y)}},TilingSprite.prototype.getBounds=function(){var minX,maxX,minY,maxY,width=this._width,height=this._height,w0=width*(1-this.anchor.x),w1=width*-this.anchor.x,h0=height*(1-this.anchor.y),h1=height*-this.anchor.y,worldTransform=this.worldTransform,a=worldTransform.a,b=worldTransform.b,c=worldTransform.c,d=worldTransform.d,tx=worldTransform.tx,ty=worldTransform.ty,x1=a*w1+c*h1+tx,y1=d*h1+b*w1+ty,x2=a*w0+c*h1+tx,y2=d*h1+b*w0+ty,x3=a*w0+c*h0+tx,y3=d*h0+b*w0+ty,x4=a*w1+c*h0+tx,y4=d*h0+b*w1+ty;minX=x1,minX=minX>x2?x2:minX,minX=minX>x3?x3:minX,minX=minX>x4?x4:minX,minY=y1,minY=minY>y2?y2:minY,minY=minY>y3?y3:minY,minY=minY>y4?y4:minY,maxX=x1,maxX=x2>maxX?x2:maxX,maxX=x3>maxX?x3:maxX,maxX=x4>maxX?x4:maxX,maxY=y1,maxY=y2>maxY?y2:maxY,maxY=y3>maxY?y3:maxY,maxY=y4>maxY?y4:maxY;var bounds=this._bounds;return bounds.x=minX,bounds.width=maxX-minX,bounds.y=minY,bounds.height=maxY-minY,this._currentBounds=bounds,bounds},TilingSprite.prototype.containsPoint=function(point){this.worldTransform.applyInverse(point,tempPoint);var y1,width=this._width,height=this._height,x1=-width*this.anchor.x;return tempPoint.x>x1&&tempPoint.x<x1+width&&(y1=-height*this.anchor.y,tempPoint.y>y1&&tempPoint.y<y1+height)?!0:!1},TilingSprite.prototype.destroy=function(){core.Sprite.prototype.destroy.call(this),this.tileScale=null,this._tileScaleOffset=null,this.tilePosition=null,this._uvs=null},TilingSprite.fromFrame=function(frameId,width,height){var texture=core.utils.TextureCache[frameId];if(!texture)throw new Error('The frameId "'+frameId+'" does not exist in the texture cache '+this);return new TilingSprite(texture,width,height)},TilingSprite.fromImage=function(imageId,width,height,crossorigin,scaleMode){return new TilingSprite(core.Texture.fromImage(imageId,crossorigin,scaleMode),width,height)}},{"../core":36,"../core/renderers/canvas/utils/CanvasTinter":54}],89:[function(require,module,exports){var core=require("../core"),DisplayObject=core.DisplayObject,_tempMatrix=new core.Matrix;DisplayObject.prototype._cacheAsBitmap=!1,DisplayObject.prototype._originalRenderWebGL=null,DisplayObject.prototype._originalRenderCanvas=null,DisplayObject.prototype._originalUpdateTransform=null,DisplayObject.prototype._originalHitTest=null,DisplayObject.prototype._originalDestroy=null,DisplayObject.prototype._cachedSprite=null,Object.defineProperties(DisplayObject.prototype,{cacheAsBitmap:{get:function(){return this._cacheAsBitmap},set:function(value){this._cacheAsBitmap!==value&&(this._cacheAsBitmap=value,value?(this._originalRenderWebGL=this.renderWebGL,this._originalRenderCanvas=this.renderCanvas,this._originalUpdateTransform=this.updateTransform,this._originalGetBounds=this.getBounds,this._originalDestroy=this.destroy,this._originalContainsPoint=this.containsPoint,this.renderWebGL=this._renderCachedWebGL,this.renderCanvas=this._renderCachedCanvas,this.destroy=this._cacheAsBitmapDestroy):(this._cachedSprite&&this._destroyCachedDisplayObject(),this.renderWebGL=this._originalRenderWebGL,this.renderCanvas=this._originalRenderCanvas,this.getBounds=this._originalGetBounds,
this.destroy=this._originalDestroy,this.updateTransform=this._originalUpdateTransform,this.containsPoint=this._originalContainsPoint))}}}),DisplayObject.prototype._renderCachedWebGL=function(renderer){!this.visible||this.worldAlpha<=0||!this.renderable||(this._initCachedDisplayObject(renderer),this._cachedSprite.worldAlpha=this.worldAlpha,renderer.setObjectRenderer(renderer.plugins.sprite),renderer.plugins.sprite.render(this._cachedSprite))},DisplayObject.prototype._initCachedDisplayObject=function(renderer){if(!this._cachedSprite){renderer.currentRenderer.flush();var bounds=this.getLocalBounds().clone();if(this._filters){var padding=this._filters[0].padding;bounds.x-=padding,bounds.y-=padding,bounds.width+=2*padding,bounds.height+=2*padding}var cachedRenderTarget=renderer.currentRenderTarget,stack=renderer.filterManager.filterStack,renderTexture=new core.RenderTexture(renderer,0|bounds.width,0|bounds.height),m=_tempMatrix;m.tx=-bounds.x,m.ty=-bounds.y,this.renderWebGL=this._originalRenderWebGL,renderTexture.render(this,m,!0,!0),renderer.setRenderTarget(cachedRenderTarget),renderer.filterManager.filterStack=stack,this.renderWebGL=this._renderCachedWebGL,this.updateTransform=this.displayObjectUpdateTransform,this.getBounds=this._getCachedBounds,this._cachedSprite=new core.Sprite(renderTexture),this._cachedSprite.worldTransform=this.worldTransform,this._cachedSprite.anchor.x=-(bounds.x/bounds.width),this._cachedSprite.anchor.y=-(bounds.y/bounds.height),this.updateTransform(),this.containsPoint=this._cachedSprite.containsPoint.bind(this._cachedSprite)}},DisplayObject.prototype._renderCachedCanvas=function(renderer){!this.visible||this.worldAlpha<=0||!this.renderable||(this._initCachedDisplayObjectCanvas(renderer),this._cachedSprite.worldAlpha=this.worldAlpha,this._cachedSprite.renderCanvas(renderer))},DisplayObject.prototype._initCachedDisplayObjectCanvas=function(renderer){if(!this._cachedSprite){var bounds=this.getLocalBounds(),cachedRenderTarget=renderer.context,renderTexture=new core.RenderTexture(renderer,0|bounds.width,0|bounds.height),m=_tempMatrix;m.tx=-bounds.x,m.ty=-bounds.y,this.renderCanvas=this._originalRenderCanvas,renderTexture.render(this,m,!0),renderer.context=cachedRenderTarget,this.renderCanvas=this._renderCachedCanvas,this.updateTransform=this.displayObjectUpdateTransform,this.getBounds=this._getCachedBounds,this._cachedSprite=new core.Sprite(renderTexture),this._cachedSprite.worldTransform=this.worldTransform,this._cachedSprite.anchor.x=-(bounds.x/bounds.width),this._cachedSprite.anchor.y=-(bounds.y/bounds.height),this.updateTransform(),this.containsPoint=this._cachedSprite.containsPoint.bind(this._cachedSprite)}},DisplayObject.prototype._getCachedBounds=function(){return this._cachedSprite._currentBounds=null,this._cachedSprite.getBounds()},DisplayObject.prototype._destroyCachedDisplayObject=function(){this._cachedSprite._texture.destroy(),this._cachedSprite=null},DisplayObject.prototype._cacheAsBitmapDestroy=function(){this.cacheAsBitmap=!1,this._originalDestroy()}},{"../core":36}],90:[function(require,module,exports){var core=require("../core");core.DisplayObject.prototype.name=null,core.Container.prototype.getChildByName=function(name){for(var i=0;i<this.children.length;i++)if(this.children[i].name===name)return this.children[i];return null}},{"../core":36}],91:[function(require,module,exports){var core=require("../core");core.DisplayObject.prototype.getGlobalPosition=function(point){return point=point||new core.Point,this.parent?(this.displayObjectUpdateTransform(),point.x=this.worldTransform.tx,point.y=this.worldTransform.ty):(point.x=this.position.x,point.y=this.position.y),point}},{"../core":36}],92:[function(require,module,exports){require("./cacheAsBitmap"),require("./getChildByName"),require("./getGlobalPosition"),module.exports={MovieClip:require("./MovieClip"),TilingSprite:require("./TilingSprite"),BitmapText:require("./BitmapText")}},{"./BitmapText":86,"./MovieClip":87,"./TilingSprite":88,"./cacheAsBitmap":89,"./getChildByName":90,"./getGlobalPosition":91}],93:[function(require,module,exports){function AsciiFilter(){core.AbstractFilter.call(this,null,"precision mediump float;\n\nuniform vec4 dimensions;\nuniform float pixelSize;\nuniform sampler2D uSampler;\n\nfloat character(float n, vec2 p)\n{\n    p = floor(p*vec2(4.0, -4.0) + 2.5);\n    if (clamp(p.x, 0.0, 4.0) == p.x && clamp(p.y, 0.0, 4.0) == p.y)\n    {\n        if (int(mod(n/exp2(p.x + 5.0*p.y), 2.0)) == 1) return 1.0;\n    }\n    return 0.0;\n}\n\nvoid main()\n{\n    vec2 uv = gl_FragCoord.xy;\n\n    vec3 col = texture2D(uSampler, floor( uv / pixelSize ) * pixelSize / dimensions.xy).rgb;\n\n    float gray = (col.r + col.g + col.b) / 3.0;\n\n    float n =  65536.0;             // .\n    if (gray > 0.2) n = 65600.0;    // :\n    if (gray > 0.3) n = 332772.0;   // *\n    if (gray > 0.4) n = 15255086.0; // o\n    if (gray > 0.5) n = 23385164.0; // &\n    if (gray > 0.6) n = 15252014.0; // 8\n    if (gray > 0.7) n = 13199452.0; // @\n    if (gray > 0.8) n = 11512810.0; // #\n\n    vec2 p = mod( uv / ( pixelSize * 0.5 ), 2.0) - vec2(1.0);\n    col = col * character(n, p);\n\n    gl_FragColor = vec4(col, 1.0);\n}\n",{dimensions:{type:"4fv",value:new Float32Array([0,0,0,0])},pixelSize:{type:"1f",value:8}})}var core=require("../../core");AsciiFilter.prototype=Object.create(core.AbstractFilter.prototype),AsciiFilter.prototype.constructor=AsciiFilter,module.exports=AsciiFilter,Object.defineProperties(AsciiFilter.prototype,{size:{get:function(){return this.uniforms.pixelSize.value},set:function(value){this.uniforms.pixelSize.value=value}}})},{"../../core":36}],94:[function(require,module,exports){function BloomFilter(){core.AbstractFilter.call(this),this.blurXFilter=new BlurXFilter,this.blurYFilter=new BlurYFilter,this.defaultFilter=new core.AbstractFilter}var core=require("../../core"),BlurXFilter=require("../blur/BlurXFilter"),BlurYFilter=require("../blur/BlurYFilter");BloomFilter.prototype=Object.create(core.AbstractFilter.prototype),BloomFilter.prototype.constructor=BloomFilter,module.exports=BloomFilter,BloomFilter.prototype.applyFilter=function(renderer,input,output){var renderTarget=renderer.filterManager.getRenderTarget(!0);this.defaultFilter.applyFilter(renderer,input,output),this.blurXFilter.applyFilter(renderer,input,renderTarget),renderer.blendModeManager.setBlendMode(core.BLEND_MODES.SCREEN),this.blurYFilter.applyFilter(renderer,renderTarget,output),renderer.blendModeManager.setBlendMode(core.BLEND_MODES.NORMAL),renderer.filterManager.returnRenderTarget(renderTarget)},Object.defineProperties(BloomFilter.prototype,{blur:{get:function(){return this.blurXFilter.blur},set:function(value){this.blurXFilter.blur=this.blurYFilter.blur=value}},blurX:{get:function(){return this.blurXFilter.blur},set:function(value){this.blurXFilter.blur=value}},blurY:{get:function(){return this.blurYFilter.blur},set:function(value){this.blurYFilter.blur=value}}})},{"../../core":36,"../blur/BlurXFilter":97,"../blur/BlurYFilter":98}],95:[function(require,module,exports){function BlurDirFilter(dirX,dirY){core.AbstractFilter.call(this,"attribute vec2 aVertexPosition;\nattribute vec2 aTextureCoord;\nattribute vec4 aColor;\n\nuniform float strength;\nuniform float dirX;\nuniform float dirY;\nuniform mat3 projectionMatrix;\n\nvarying vec2 vTextureCoord;\nvarying vec4 vColor;\nvarying vec2 vBlurTexCoords[3];\n\nvoid main(void)\n{\n    gl_Position = vec4((projectionMatrix * vec3((aVertexPosition), 1.0)).xy, 0.0, 1.0);\n    vTextureCoord = aTextureCoord;\n\n    vBlurTexCoords[0] = aTextureCoord + vec2( (0.004 * strength) * dirX, (0.004 * strength) * dirY );\n    vBlurTexCoords[1] = aTextureCoord + vec2( (0.008 * strength) * dirX, (0.008 * strength) * dirY );\n    vBlurTexCoords[2] = aTextureCoord + vec2( (0.012 * strength) * dirX, (0.012 * strength) * dirY );\n\n    vColor = vec4(aColor.rgb * aColor.a, aColor.a);\n}\n","precision lowp float;\n\nvarying vec2 vTextureCoord;\nvarying vec2 vBlurTexCoords[3];\nvarying vec4 vColor;\n\nuniform sampler2D uSampler;\n\nvoid main(void)\n{\n    gl_FragColor = vec4(0.0);\n\n    gl_FragColor += texture2D(uSampler, vTextureCoord     ) * 0.3989422804014327;\n    gl_FragColor += texture2D(uSampler, vBlurTexCoords[ 0]) * 0.2419707245191454;\n    gl_FragColor += texture2D(uSampler, vBlurTexCoords[ 1]) * 0.05399096651318985;\n    gl_FragColor += texture2D(uSampler, vBlurTexCoords[ 2]) * 0.004431848411938341;\n}\n",{strength:{type:"1f",value:1},dirX:{type:"1f",value:dirX||0},dirY:{type:"1f",value:dirY||0}}),this.defaultFilter=new core.AbstractFilter,this.passes=1,this.dirX=dirX||0,this.dirY=dirY||0,this.strength=4}var core=require("../../core");BlurDirFilter.prototype=Object.create(core.AbstractFilter.prototype),BlurDirFilter.prototype.constructor=BlurDirFilter,module.exports=BlurDirFilter,BlurDirFilter.prototype.applyFilter=function(renderer,input,output,clear){var shader=this.getShader(renderer);if(this.uniforms.strength.value=this.strength/4/this.passes*(input.frame.width/input.size.width),1===this.passes)renderer.filterManager.applyFilter(shader,input,output,clear);else{var renderTarget=renderer.filterManager.getRenderTarget(!0);renderer.filterManager.applyFilter(shader,input,renderTarget,clear);for(var i=0;i<this.passes-2;i++)renderer.filterManager.applyFilter(shader,renderTarget,renderTarget,clear);renderer.filterManager.applyFilter(shader,renderTarget,output,clear),renderer.filterManager.returnRenderTarget(renderTarget)}},Object.defineProperties(BlurDirFilter.prototype,{blur:{get:function(){return this.strength},set:function(value){this.padding=.5*value,this.strength=value}},dirX:{get:function(){return this.dirX},set:function(value){this.uniforms.dirX.value=value}},dirY:{get:function(){return this.dirY},set:function(value){this.uniforms.dirY.value=value}}})},{"../../core":36}],96:[function(require,module,exports){function BlurFilter(){core.AbstractFilter.call(this),this.blurXFilter=new BlurXFilter,this.blurYFilter=new BlurYFilter}var core=require("../../core"),BlurXFilter=require("./BlurXFilter"),BlurYFilter=require("./BlurYFilter");BlurFilter.prototype=Object.create(core.AbstractFilter.prototype),BlurFilter.prototype.constructor=BlurFilter,module.exports=BlurFilter,BlurFilter.prototype.applyFilter=function(renderer,input,output){var renderTarget=renderer.filterManager.getRenderTarget(!0);this.blurXFilter.applyFilter(renderer,input,renderTarget),this.blurYFilter.applyFilter(renderer,renderTarget,output),renderer.filterManager.returnRenderTarget(renderTarget)},Object.defineProperties(BlurFilter.prototype,{blur:{get:function(){return this.blurXFilter.blur},set:function(value){this.padding=.5*Math.abs(value),this.blurXFilter.blur=this.blurYFilter.blur=value}},passes:{get:function(){return this.blurXFilter.passes},set:function(value){this.blurXFilter.passes=this.blurYFilter.passes=value}},blurX:{get:function(){return this.blurXFilter.blur},set:function(value){this.blurXFilter.blur=value}},blurY:{get:function(){return this.blurYFilter.blur},set:function(value){this.blurYFilter.blur=value}}})},{"../../core":36,"./BlurXFilter":97,"./BlurYFilter":98}],97:[function(require,module,exports){function BlurXFilter(){core.AbstractFilter.call(this,"attribute vec2 aVertexPosition;\nattribute vec2 aTextureCoord;\nattribute vec4 aColor;\n\nuniform float strength;\nuniform mat3 projectionMatrix;\n\nvarying vec2 vTextureCoord;\nvarying vec4 vColor;\nvarying vec2 vBlurTexCoords[6];\n\nvoid main(void)\n{\n    gl_Position = vec4((projectionMatrix * vec3((aVertexPosition), 1.0)).xy, 0.0, 1.0);\n    vTextureCoord = aTextureCoord;\n\n    vBlurTexCoords[ 0] = aTextureCoord + vec2(-0.012 * strength, 0.0);\n    vBlurTexCoords[ 1] = aTextureCoord + vec2(-0.008 * strength, 0.0);\n    vBlurTexCoords[ 2] = aTextureCoord + vec2(-0.004 * strength, 0.0);\n    vBlurTexCoords[ 3] = aTextureCoord + vec2( 0.004 * strength, 0.0);\n    vBlurTexCoords[ 4] = aTextureCoord + vec2( 0.008 * strength, 0.0);\n    vBlurTexCoords[ 5] = aTextureCoord + vec2( 0.012 * strength, 0.0);\n\n    vColor = vec4(aColor.rgb * aColor.a, aColor.a);\n}\n","precision lowp float;\n\nvarying vec2 vTextureCoord;\nvarying vec2 vBlurTexCoords[6];\nvarying vec4 vColor;\n\nuniform sampler2D uSampler;\n\nvoid main(void)\n{\n    gl_FragColor = vec4(0.0);\n\n    gl_FragColor += texture2D(uSampler, vBlurTexCoords[ 0])*0.004431848411938341;\n    gl_FragColor += texture2D(uSampler, vBlurTexCoords[ 1])*0.05399096651318985;\n    gl_FragColor += texture2D(uSampler, vBlurTexCoords[ 2])*0.2419707245191454;\n    gl_FragColor += texture2D(uSampler, vTextureCoord     )*0.3989422804014327;\n    gl_FragColor += texture2D(uSampler, vBlurTexCoords[ 3])*0.2419707245191454;\n    gl_FragColor += texture2D(uSampler, vBlurTexCoords[ 4])*0.05399096651318985;\n    gl_FragColor += texture2D(uSampler, vBlurTexCoords[ 5])*0.004431848411938341;\n}\n",{strength:{type:"1f",value:1}}),this.passes=1,this.strength=4}var core=require("../../core");BlurXFilter.prototype=Object.create(core.AbstractFilter.prototype),BlurXFilter.prototype.constructor=BlurXFilter,module.exports=BlurXFilter,BlurXFilter.prototype.applyFilter=function(renderer,input,output,clear){var shader=this.getShader(renderer);if(this.uniforms.strength.value=this.strength/4/this.passes*(input.frame.width/input.size.width),1===this.passes)renderer.filterManager.applyFilter(shader,input,output,clear);else{for(var renderTarget=renderer.filterManager.getRenderTarget(!0),flip=input,flop=renderTarget,i=0;i<this.passes-1;i++){renderer.filterManager.applyFilter(shader,flip,flop,!0);var temp=flop;flop=flip,flip=temp}renderer.filterManager.applyFilter(shader,flip,output,clear),renderer.filterManager.returnRenderTarget(renderTarget)}},Object.defineProperties(BlurXFilter.prototype,{blur:{get:function(){return this.strength},set:function(value){this.padding=.5*Math.abs(value),this.strength=value}}})},{"../../core":36}],98:[function(require,module,exports){function BlurYFilter(){core.AbstractFilter.call(this,"attribute vec2 aVertexPosition;\nattribute vec2 aTextureCoord;\nattribute vec4 aColor;\n\nuniform float strength;\nuniform mat3 projectionMatrix;\n\nvarying vec2 vTextureCoord;\nvarying vec4 vColor;\nvarying vec2 vBlurTexCoords[6];\n\nvoid main(void)\n{\n    gl_Position = vec4((projectionMatrix * vec3((aVertexPosition), 1.0)).xy, 0.0, 1.0);\n    vTextureCoord = aTextureCoord;\n\n    vBlurTexCoords[ 0] = aTextureCoord + vec2(0.0, -0.012 * strength);\n    vBlurTexCoords[ 1] = aTextureCoord + vec2(0.0, -0.008 * strength);\n    vBlurTexCoords[ 2] = aTextureCoord + vec2(0.0, -0.004 * strength);\n    vBlurTexCoords[ 3] = aTextureCoord + vec2(0.0,  0.004 * strength);\n    vBlurTexCoords[ 4] = aTextureCoord + vec2(0.0,  0.008 * strength);\n    vBlurTexCoords[ 5] = aTextureCoord + vec2(0.0,  0.012 * strength);\n\n   vColor = vec4(aColor.rgb * aColor.a, aColor.a);\n}\n","precision lowp float;\n\nvarying vec2 vTextureCoord;\nvarying vec2 vBlurTexCoords[6];\nvarying vec4 vColor;\n\nuniform sampler2D uSampler;\n\nvoid main(void)\n{\n    gl_FragColor = vec4(0.0);\n\n    gl_FragColor += texture2D(uSampler, vBlurTexCoords[ 0])*0.004431848411938341;\n    gl_FragColor += texture2D(uSampler, vBlurTexCoords[ 1])*0.05399096651318985;\n    gl_FragColor += texture2D(uSampler, vBlurTexCoords[ 2])*0.2419707245191454;\n    gl_FragColor += texture2D(uSampler, vTextureCoord     )*0.3989422804014327;\n    gl_FragColor += texture2D(uSampler, vBlurTexCoords[ 3])*0.2419707245191454;\n    gl_FragColor += texture2D(uSampler, vBlurTexCoords[ 4])*0.05399096651318985;\n    gl_FragColor += texture2D(uSampler, vBlurTexCoords[ 5])*0.004431848411938341;\n}\n",{strength:{type:"1f",value:1}}),this.passes=1,this.strength=4}var core=require("../../core");BlurYFilter.prototype=Object.create(core.AbstractFilter.prototype),BlurYFilter.prototype.constructor=BlurYFilter,module.exports=BlurYFilter,BlurYFilter.prototype.applyFilter=function(renderer,input,output,clear){var shader=this.getShader(renderer);if(this.uniforms.strength.value=Math.abs(this.strength)/4/this.passes*(input.frame.height/input.size.height),1===this.passes)renderer.filterManager.applyFilter(shader,input,output,clear);else{for(var renderTarget=renderer.filterManager.getRenderTarget(!0),flip=input,flop=renderTarget,i=0;i<this.passes-1;i++){renderer.filterManager.applyFilter(shader,flip,flop,!0);var temp=flop;flop=flip,flip=temp}renderer.filterManager.applyFilter(shader,flip,output,clear),renderer.filterManager.returnRenderTarget(renderTarget)}},Object.defineProperties(BlurYFilter.prototype,{blur:{get:function(){return this.strength},set:function(value){this.padding=.5*Math.abs(value),this.strength=value}}})},{"../../core":36}],99:[function(require,module,exports){function SmartBlurFilter(){core.AbstractFilter.call(this,null,"precision mediump float;\n\nvarying vec2 vTextureCoord;\n\nuniform sampler2D uSampler;\nuniform vec2 delta;\n\nfloat random(vec3 scale, float seed)\n{\n    return fract(sin(dot(gl_FragCoord.xyz + seed, scale)) * 43758.5453 + seed);\n}\n\nvoid main(void)\n{\n    vec4 color = vec4(0.0);\n    float total = 0.0;\n\n    float offset = random(vec3(12.9898, 78.233, 151.7182), 0.0);\n\n    for (float t = -30.0; t <= 30.0; t++)\n    {\n        float percent = (t + offset - 0.5) / 30.0;\n        float weight = 1.0 - abs(percent);\n        vec4 sample = texture2D(uSampler, vTextureCoord + delta * percent);\n        sample.rgb *= sample.a;\n        color += sample * weight;\n        total += weight;\n    }\n\n    gl_FragColor = color / total;\n    gl_FragColor.rgb /= gl_FragColor.a + 0.00001;\n}\n",{delta:{type:"v2",value:{x:.1,y:0}}})}var core=require("../../core");SmartBlurFilter.prototype=Object.create(core.AbstractFilter.prototype),SmartBlurFilter.prototype.constructor=SmartBlurFilter,module.exports=SmartBlurFilter},{"../../core":36}],100:[function(require,module,exports){function ColorMatrixFilter(){core.AbstractFilter.call(this,null,"precision mediump float;\n\nvarying vec2 vTextureCoord;\nuniform sampler2D uSampler;\nuniform float m[25];\n\nvoid main(void)\n{\n\n    vec4 c = texture2D(uSampler, vTextureCoord);\n\n    gl_FragColor.r = (m[0] * c.r);\n        gl_FragColor.r += (m[1] * c.g);\n        gl_FragColor.r += (m[2] * c.b);\n        gl_FragColor.r += (m[3] * c.a);\n        gl_FragColor.r += m[4];\n\n    gl_FragColor.g = (m[5] * c.r);\n        gl_FragColor.g += (m[6] * c.g);\n        gl_FragColor.g += (m[7] * c.b);\n        gl_FragColor.g += (m[8] * c.a);\n        gl_FragColor.g += m[9];\n\n     gl_FragColor.b = (m[10] * c.r);\n        gl_FragColor.b += (m[11] * c.g);\n        gl_FragColor.b += (m[12] * c.b);\n        gl_FragColor.b += (m[13] * c.a);\n        gl_FragColor.b += m[14];\n\n     gl_FragColor.a = (m[15] * c.r);\n        gl_FragColor.a += (m[16] * c.g);\n        gl_FragColor.a += (m[17] * c.b);\n        gl_FragColor.a += (m[18] * c.a);\n        gl_FragColor.a += m[19];\n\n}\n",{m:{type:"1fv",value:[1,0,0,0,0,0,1,0,0,0,0,0,1,0,0,0,0,0,1,0]}})}var core=require("../../core");ColorMatrixFilter.prototype=Object.create(core.AbstractFilter.prototype),ColorMatrixFilter.prototype.constructor=ColorMatrixFilter,module.exports=ColorMatrixFilter,ColorMatrixFilter.prototype._loadMatrix=function(matrix,multiply){multiply=!!multiply;var newMatrix=matrix;multiply&&(this._multiply(newMatrix,this.uniforms.m.value,matrix),newMatrix=this._colorMatrix(newMatrix)),this.uniforms.m.value=newMatrix},ColorMatrixFilter.prototype._multiply=function(out,a,b){return out[0]=a[0]*b[0]+a[1]*b[5]+a[2]*b[10]+a[3]*b[15],out[1]=a[0]*b[1]+a[1]*b[6]+a[2]*b[11]+a[3]*b[16],out[2]=a[0]*b[2]+a[1]*b[7]+a[2]*b[12]+a[3]*b[17],out[3]=a[0]*b[3]+a[1]*b[8]+a[2]*b[13]+a[3]*b[18],out[4]=a[0]*b[4]+a[1]*b[9]+a[2]*b[14]+a[3]*b[19],out[5]=a[5]*b[0]+a[6]*b[5]+a[7]*b[10]+a[8]*b[15],out[6]=a[5]*b[1]+a[6]*b[6]+a[7]*b[11]+a[8]*b[16],out[7]=a[5]*b[2]+a[6]*b[7]+a[7]*b[12]+a[8]*b[17],out[8]=a[5]*b[3]+a[6]*b[8]+a[7]*b[13]+a[8]*b[18],out[9]=a[5]*b[4]+a[6]*b[9]+a[7]*b[14]+a[8]*b[19],out[10]=a[10]*b[0]+a[11]*b[5]+a[12]*b[10]+a[13]*b[15],out[11]=a[10]*b[1]+a[11]*b[6]+a[12]*b[11]+a[13]*b[16],out[12]=a[10]*b[2]+a[11]*b[7]+a[12]*b[12]+a[13]*b[17],out[13]=a[10]*b[3]+a[11]*b[8]+a[12]*b[13]+a[13]*b[18],out[14]=a[10]*b[4]+a[11]*b[9]+a[12]*b[14]+a[13]*b[19],out[15]=a[15]*b[0]+a[16]*b[5]+a[17]*b[10]+a[18]*b[15],out[16]=a[15]*b[1]+a[16]*b[6]+a[17]*b[11]+a[18]*b[16],out[17]=a[15]*b[2]+a[16]*b[7]+a[17]*b[12]+a[18]*b[17],out[18]=a[15]*b[3]+a[16]*b[8]+a[17]*b[13]+a[18]*b[18],out[19]=a[15]*b[4]+a[16]*b[9]+a[17]*b[14]+a[18]*b[19],out},ColorMatrixFilter.prototype._colorMatrix=function(matrix){var m=new Float32Array(matrix);return m[4]/=255,m[9]/=255,m[14]/=255,m[19]/=255,m},ColorMatrixFilter.prototype.brightness=function(b,multiply){var matrix=[b,0,0,0,0,0,b,0,0,0,0,0,b,0,0,0,0,0,1,0];this._loadMatrix(matrix,multiply)},ColorMatrixFilter.prototype.greyscale=function(scale,multiply){var matrix=[scale,scale,scale,0,0,scale,scale,scale,0,0,scale,scale,scale,0,0,0,0,0,1,0];this._loadMatrix(matrix,multiply)},ColorMatrixFilter.prototype.grayscale=ColorMatrixFilter.prototype.greyscale,ColorMatrixFilter.prototype.blackAndWhite=function(multiply){var matrix=[.3,.6,.1,0,0,.3,.6,.1,0,0,.3,.6,.1,0,0,0,0,0,1,0];this._loadMatrix(matrix,multiply)},ColorMatrixFilter.prototype.hue=function(rotation,multiply){rotation=(rotation||0)/180*Math.PI;var cos=Math.cos(rotation),sin=Math.sin(rotation),lumR=.213,lumG=.715,lumB=.072,matrix=[lumR+cos*(1-lumR)+sin*-lumR,lumG+cos*-lumG+sin*-lumG,lumB+cos*-lumB+sin*(1-lumB),0,0,lumR+cos*-lumR+.143*sin,lumG+cos*(1-lumG)+.14*sin,lumB+cos*-lumB+sin*-.283,0,0,lumR+cos*-lumR+sin*-(1-lumR),lumG+cos*-lumG+sin*lumG,lumB+cos*(1-lumB)+sin*lumB,0,0,0,0,0,1,0];this._loadMatrix(matrix,multiply)},ColorMatrixFilter.prototype.contrast=function(amount,multiply){var v=(amount||0)+1,o=-128*(v-1),matrix=[v,0,0,0,o,0,v,0,0,o,0,0,v,0,o,0,0,0,1,0];this._loadMatrix(matrix,multiply)},ColorMatrixFilter.prototype.saturate=function(amount,multiply){var x=2*(amount||0)/3+1,y=(x-1)*-.5,matrix=[x,y,y,0,0,y,x,y,0,0,y,y,x,0,0,0,0,0,1,0];this._loadMatrix(matrix,multiply)},ColorMatrixFilter.prototype.desaturate=function(multiply){this.saturate(-1)},ColorMatrixFilter.prototype.negative=function(multiply){var matrix=[0,1,1,0,0,1,0,1,0,0,1,1,0,0,0,0,0,0,1,0];this._loadMatrix(matrix,multiply)},ColorMatrixFilter.prototype.sepia=function(multiply){var matrix=[.393,.7689999,.18899999,0,0,.349,.6859999,.16799999,0,0,.272,.5339999,.13099999,0,0,0,0,0,1,0];this._loadMatrix(matrix,multiply)},ColorMatrixFilter.prototype.technicolor=function(multiply){var matrix=[1.9125277891456083,-.8545344976951645,-.09155508482755585,0,11.793603434377337,-.3087833385928097,1.7658908555458428,-.10601743074722245,0,-70.35205161461398,-.231103377548616,-.7501899197440212,1.847597816108189,0,30.950940869491138,0,0,0,1,0];this._loadMatrix(matrix,multiply)},ColorMatrixFilter.prototype.polaroid=function(multiply){var matrix=[1.438,-.062,-.062,0,0,-.122,1.378,-.122,0,0,-.016,-.016,1.483,0,0,0,0,0,1,0];this._loadMatrix(matrix,multiply)},ColorMatrixFilter.prototype.toBGR=function(multiply){var matrix=[0,0,1,0,0,0,1,0,0,0,1,0,0,0,0,0,0,0,1,0];this._loadMatrix(matrix,multiply)},ColorMatrixFilter.prototype.kodachrome=function(multiply){var matrix=[1.1285582396593525,-.3967382283601348,-.03992559172921793,0,63.72958762196502,-.16404339962244616,1.0835251566291304,-.05498805115633132,0,24.732407896706203,-.16786010706155763,-.5603416277695248,1.6014850761964943,0,35.62982807460946,0,0,0,1,0];this._loadMatrix(matrix,multiply)},ColorMatrixFilter.prototype.browni=function(multiply){var matrix=[.5997023498159715,.34553243048391263,-.2708298674538042,0,47.43192855600873,-.037703249837783157,.8609577587992641,.15059552388459913,0,-36.96841498319127,.24113635128153335,-.07441037908422492,.44972182064877153,0,-7.562075277591283,0,0,0,1,0];this._loadMatrix(matrix,multiply)},ColorMatrixFilter.prototype.vintage=function(multiply){var matrix=[.6279345635605994,.3202183420819367,-.03965408211312453,0,9.651285835294123,.02578397704808868,.6441188644374771,.03259127616149294,0,7.462829176470591,.0466055556782719,-.0851232987247891,.5241648018700465,0,5.159190588235296,0,0,0,1,0];this._loadMatrix(matrix,multiply)},ColorMatrixFilter.prototype.colorTone=function(desaturation,toned,lightColor,darkColor,multiply){desaturation=desaturation||.2,toned=toned||.15,lightColor=lightColor||16770432,darkColor=darkColor||3375104;var lR=(lightColor>>16&255)/255,lG=(lightColor>>8&255)/255,lB=(255&lightColor)/255,dR=(darkColor>>16&255)/255,dG=(darkColor>>8&255)/255,dB=(255&darkColor)/255,matrix=[.3,.59,.11,0,0,lR,lG,lB,desaturation,0,dR,dG,dB,toned,0,lR-dR,lG-dG,lB-dB,0,0];this._loadMatrix(matrix,multiply)},ColorMatrixFilter.prototype.night=function(intensity,multiply){intensity=intensity||.1;var matrix=[-2*intensity,-intensity,0,0,0,-intensity,0,intensity,0,0,0,intensity,2*intensity,0,0,0,0,0,1,0];this._loadMatrix(matrix,multiply)},ColorMatrixFilter.prototype.predator=function(amount,multiply){var matrix=[11.224130630493164*amount,-4.794486999511719*amount,-2.8746118545532227*amount,0*amount,.40342438220977783*amount,-3.6330697536468506*amount,9.193157196044922*amount,-2.951810836791992*amount,0*amount,-1.316135048866272*amount,-3.2184197902679443*amount,-4.2375030517578125*amount,7.476448059082031*amount,0*amount,.8044459223747253*amount,0,0,0,1,0];this._loadMatrix(matrix,multiply)},ColorMatrixFilter.prototype.lsd=function(multiply){var matrix=[2,-.4,.5,0,0,-.5,2,-.4,0,0,-.4,-.5,3,0,0,0,0,0,1,0];this._loadMatrix(matrix,multiply)},ColorMatrixFilter.prototype.reset=function(){var matrix=[1,0,0,0,0,0,1,0,0,0,0,0,1,0,0,0,0,0,1,0];this._loadMatrix(matrix,!1)},Object.defineProperties(ColorMatrixFilter.prototype,{matrix:{get:function(){return this.uniforms.m.value},set:function(value){this.uniforms.m.value=value}}})},{"../../core":36}],101:[function(require,module,exports){function ColorStepFilter(){core.AbstractFilter.call(this,null,"precision mediump float;\n\nvarying vec2 vTextureCoord;\n\nuniform sampler2D uSampler;\nuniform float step;\n\nvoid main(void)\n{\n    vec4 color = texture2D(uSampler, vTextureCoord);\n\n    color = floor(color * step) / step;\n\n    gl_FragColor = color;\n}\n",{step:{type:"1f",value:5}})}var core=require("../../core");ColorStepFilter.prototype=Object.create(core.AbstractFilter.prototype),ColorStepFilter.prototype.constructor=ColorStepFilter,module.exports=ColorStepFilter,Object.defineProperties(ColorStepFilter.prototype,{step:{get:function(){return this.uniforms.step.value},set:function(value){this.uniforms.step.value=value}}})},{"../../core":36}],102:[function(require,module,exports){function ConvolutionFilter(matrix,width,height){core.AbstractFilter.call(this,null,"precision mediump float;\n\nvarying mediump vec2 vTextureCoord;\n\nuniform sampler2D uSampler;\nuniform vec2 texelSize;\nuniform float matrix[9];\n\nvoid main(void)\n{\n   vec4 c11 = texture2D(uSampler, vTextureCoord - texelSize); // top left\n   vec4 c12 = texture2D(uSampler, vec2(vTextureCoord.x, vTextureCoord.y - texelSize.y)); // top center\n   vec4 c13 = texture2D(uSampler, vec2(vTextureCoord.x + texelSize.x, vTextureCoord.y - texelSize.y)); // top right\n\n   vec4 c21 = texture2D(uSampler, vec2(vTextureCoord.x - texelSize.x, vTextureCoord.y)); // mid left\n   vec4 c22 = texture2D(uSampler, vTextureCoord); // mid center\n   vec4 c23 = texture2D(uSampler, vec2(vTextureCoord.x + texelSize.x, vTextureCoord.y)); // mid right\n\n   vec4 c31 = texture2D(uSampler, vec2(vTextureCoord.x - texelSize.x, vTextureCoord.y + texelSize.y)); // bottom left\n   vec4 c32 = texture2D(uSampler, vec2(vTextureCoord.x, vTextureCoord.y + texelSize.y)); // bottom center\n   vec4 c33 = texture2D(uSampler, vTextureCoord + texelSize); // bottom right\n\n   gl_FragColor =\n       c11 * matrix[0] + c12 * matrix[1] + c13 * matrix[2] +\n       c21 * matrix[3] + c22 * matrix[4] + c23 * matrix[5] +\n       c31 * matrix[6] + c32 * matrix[7] + c33 * matrix[8];\n\n   gl_FragColor.a = c22.a;\n}\n",{matrix:{type:"1fv",value:new Float32Array(matrix)},texelSize:{type:"v2",value:{x:1/width,y:1/height}}})}var core=require("../../core");ConvolutionFilter.prototype=Object.create(core.AbstractFilter.prototype),ConvolutionFilter.prototype.constructor=ConvolutionFilter,module.exports=ConvolutionFilter,Object.defineProperties(ConvolutionFilter.prototype,{matrix:{get:function(){return this.uniforms.matrix.value},set:function(value){this.uniforms.matrix.value=new Float32Array(value)}},width:{get:function(){return 1/this.uniforms.texelSize.value.x},set:function(value){this.uniforms.texelSize.value.x=1/value}},height:{get:function(){return 1/this.uniforms.texelSize.value.y},set:function(value){this.uniforms.texelSize.value.y=1/value}}})},{"../../core":36}],103:[function(require,module,exports){function CrossHatchFilter(){core.AbstractFilter.call(this,null,"precision mediump float;\n\nvarying vec2 vTextureCoord;\n\nuniform sampler2D uSampler;\n\nvoid main(void)\n{\n    float lum = length(texture2D(uSampler, vTextureCoord.xy).rgb);\n\n    gl_FragColor = vec4(1.0, 1.0, 1.0, 1.0);\n\n    if (lum < 1.00)\n    {\n        if (mod(gl_FragCoord.x + gl_FragCoord.y, 10.0) == 0.0)\n        {\n            gl_FragColor = vec4(0.0, 0.0, 0.0, 1.0);\n        }\n    }\n\n    if (lum < 0.75)\n    {\n        if (mod(gl_FragCoord.x - gl_FragCoord.y, 10.0) == 0.0)\n        {\n            gl_FragColor = vec4(0.0, 0.0, 0.0, 1.0);\n        }\n    }\n\n    if (lum < 0.50)\n    {\n        if (mod(gl_FragCoord.x + gl_FragCoord.y - 5.0, 10.0) == 0.0)\n        {\n            gl_FragColor = vec4(0.0, 0.0, 0.0, 1.0);\n        }\n    }\n\n    if (lum < 0.3)\n    {\n        if (mod(gl_FragCoord.x - gl_FragCoord.y - 5.0, 10.0) == 0.0)\n        {\n            gl_FragColor = vec4(0.0, 0.0, 0.0, 1.0);\n        }\n    }\n}\n")}var core=require("../../core");CrossHatchFilter.prototype=Object.create(core.AbstractFilter.prototype),CrossHatchFilter.prototype.constructor=CrossHatchFilter,module.exports=CrossHatchFilter},{"../../core":36}],104:[function(require,module,exports){function DisplacementFilter(sprite,scale){var maskMatrix=new core.Matrix;sprite.renderable=!1,core.AbstractFilter.call(this,"attribute vec2 aVertexPosition;\nattribute vec2 aTextureCoord;\nattribute vec4 aColor;\n\nuniform mat3 projectionMatrix;\nuniform mat3 otherMatrix;\n\nvarying vec2 vMapCoord;\nvarying vec2 vTextureCoord;\nvarying vec4 vColor;\n\nvoid main(void)\n{\n   gl_Position = vec4((projectionMatrix * vec3(aVertexPosition, 1.0)).xy, 0.0, 1.0);\n   vTextureCoord = aTextureCoord;\n   vMapCoord = ( otherMatrix * vec3( aTextureCoord, 1.0)  ).xy;\n   vColor = vec4(aColor.rgb * aColor.a, aColor.a);\n}\n","precision mediump float;\n\nvarying vec2 vMapCoord;\nvarying vec2 vTextureCoord;\nvarying vec4 vColor;\n\nuniform vec2 scale;\n\nuniform sampler2D uSampler;\nuniform sampler2D mapSampler;\n\nvoid main(void)\n{\n   vec4 map =  texture2D(mapSampler, vMapCoord);\n\n   map -= 0.5;\n   map.xy *= scale;\n\n   gl_FragColor = texture2D(uSampler, vec2(vTextureCoord.x + map.x, vTextureCoord.y + map.y));\n}\n",{mapSampler:{type:"sampler2D",value:sprite.texture},otherMatrix:{type:"mat3",value:maskMatrix.toArray(!0)},scale:{type:"v2",value:{x:1,y:1}}}),this.maskSprite=sprite,this.maskMatrix=maskMatrix,(null===scale||void 0===scale)&&(scale=20),this.scale=new core.Point(scale,scale)}var core=require("../../core");DisplacementFilter.prototype=Object.create(core.AbstractFilter.prototype),DisplacementFilter.prototype.constructor=DisplacementFilter,module.exports=DisplacementFilter,DisplacementFilter.prototype.applyFilter=function(renderer,input,output){var filterManager=renderer.filterManager;filterManager.calculateMappedMatrix(input.frame,this.maskSprite,this.maskMatrix),this.uniforms.otherMatrix.value=this.maskMatrix.toArray(!0),this.uniforms.scale.value.x=this.scale.x*(1/input.frame.width),this.uniforms.scale.value.y=this.scale.y*(1/input.frame.height);var shader=this.getShader(renderer);filterManager.applyFilter(shader,input,output);
},Object.defineProperties(DisplacementFilter.prototype,{map:{get:function(){return this.uniforms.mapSampler.value},set:function(value){this.uniforms.mapSampler.value=value}}})},{"../../core":36}],105:[function(require,module,exports){function DotScreenFilter(){core.AbstractFilter.call(this,null,"precision mediump float;\n\nvarying vec2 vTextureCoord;\nvarying vec4 vColor;\n\nuniform vec4 dimensions;\nuniform sampler2D uSampler;\n\nuniform float angle;\nuniform float scale;\n\nfloat pattern()\n{\n   float s = sin(angle), c = cos(angle);\n   vec2 tex = vTextureCoord * dimensions.xy;\n   vec2 point = vec2(\n       c * tex.x - s * tex.y,\n       s * tex.x + c * tex.y\n   ) * scale;\n   return (sin(point.x) * sin(point.y)) * 4.0;\n}\n\nvoid main()\n{\n   vec4 color = texture2D(uSampler, vTextureCoord);\n   float average = (color.r + color.g + color.b) / 3.0;\n   gl_FragColor = vec4(vec3(average * 10.0 - 5.0 + pattern()), color.a);\n}\n",{scale:{type:"1f",value:1},angle:{type:"1f",value:5},dimensions:{type:"4fv",value:[0,0,0,0]}})}var core=require("../../core");DotScreenFilter.prototype=Object.create(core.AbstractFilter.prototype),DotScreenFilter.prototype.constructor=DotScreenFilter,module.exports=DotScreenFilter,Object.defineProperties(DotScreenFilter.prototype,{scale:{get:function(){return this.uniforms.scale.value},set:function(value){this.uniforms.scale.value=value}},angle:{get:function(){return this.uniforms.angle.value},set:function(value){this.uniforms.angle.value=value}}})},{"../../core":36}],106:[function(require,module,exports){function BlurYTintFilter(){core.AbstractFilter.call(this,"attribute vec2 aVertexPosition;\nattribute vec2 aTextureCoord;\nattribute vec4 aColor;\n\nuniform float strength;\nuniform vec2 offset;\n\nuniform mat3 projectionMatrix;\n\nvarying vec2 vTextureCoord;\nvarying vec4 vColor;\nvarying vec2 vBlurTexCoords[6];\n\nvoid main(void)\n{\n    gl_Position = vec4((projectionMatrix * vec3((aVertexPosition+offset), 1.0)).xy, 0.0, 1.0);\n    vTextureCoord = aTextureCoord;\n\n    vBlurTexCoords[ 0] = aTextureCoord + vec2(0.0, -0.012 * strength);\n    vBlurTexCoords[ 1] = aTextureCoord + vec2(0.0, -0.008 * strength);\n    vBlurTexCoords[ 2] = aTextureCoord + vec2(0.0, -0.004 * strength);\n    vBlurTexCoords[ 3] = aTextureCoord + vec2(0.0,  0.004 * strength);\n    vBlurTexCoords[ 4] = aTextureCoord + vec2(0.0,  0.008 * strength);\n    vBlurTexCoords[ 5] = aTextureCoord + vec2(0.0,  0.012 * strength);\n\n   vColor = vec4(aColor.rgb * aColor.a, aColor.a);\n}\n","precision lowp float;\n\nvarying vec2 vTextureCoord;\nvarying vec2 vBlurTexCoords[6];\nvarying vec4 vColor;\n\nuniform vec3 color;\nuniform float alpha;\n\nuniform sampler2D uSampler;\n\nvoid main(void)\n{\n    vec4 sum = vec4(0.0);\n\n    sum += texture2D(uSampler, vBlurTexCoords[ 0])*0.004431848411938341;\n    sum += texture2D(uSampler, vBlurTexCoords[ 1])*0.05399096651318985;\n    sum += texture2D(uSampler, vBlurTexCoords[ 2])*0.2419707245191454;\n    sum += texture2D(uSampler, vTextureCoord     )*0.3989422804014327;\n    sum += texture2D(uSampler, vBlurTexCoords[ 3])*0.2419707245191454;\n    sum += texture2D(uSampler, vBlurTexCoords[ 4])*0.05399096651318985;\n    sum += texture2D(uSampler, vBlurTexCoords[ 5])*0.004431848411938341;\n\n    gl_FragColor = vec4( color.rgb * sum.a * alpha, sum.a * alpha );\n}\n",{blur:{type:"1f",value:1/512},color:{type:"c",value:[0,0,0]},alpha:{type:"1f",value:.7},offset:{type:"2f",value:[5,5]},strength:{type:"1f",value:1}}),this.passes=1,this.strength=4}var core=require("../../core");BlurYTintFilter.prototype=Object.create(core.AbstractFilter.prototype),BlurYTintFilter.prototype.constructor=BlurYTintFilter,module.exports=BlurYTintFilter,BlurYTintFilter.prototype.applyFilter=function(renderer,input,output,clear){var shader=this.getShader(renderer);if(this.uniforms.strength.value=this.strength/4/this.passes*(input.frame.height/input.size.height),1===this.passes)renderer.filterManager.applyFilter(shader,input,output,clear);else{for(var renderTarget=renderer.filterManager.getRenderTarget(!0),flip=input,flop=renderTarget,i=0;i<this.passes-1;i++){renderer.filterManager.applyFilter(shader,flip,flop,clear);var temp=flop;flop=flip,flip=temp}renderer.filterManager.applyFilter(shader,flip,output,clear),renderer.filterManager.returnRenderTarget(renderTarget)}},Object.defineProperties(BlurYTintFilter.prototype,{blur:{get:function(){return this.strength},set:function(value){this.padding=.5*value,this.strength=value}}})},{"../../core":36}],107:[function(require,module,exports){function DropShadowFilter(){core.AbstractFilter.call(this),this.blurXFilter=new BlurXFilter,this.blurYTintFilter=new BlurYTintFilter,this.defaultFilter=new core.AbstractFilter,this.padding=30,this._dirtyPosition=!0,this._angle=45*Math.PI/180,this._distance=10,this.alpha=.75,this.hideObject=!1,this.blendMode=core.BLEND_MODES.MULTIPLY}var core=require("../../core"),BlurXFilter=require("../blur/BlurXFilter"),BlurYTintFilter=require("./BlurYTintFilter");DropShadowFilter.prototype=Object.create(core.AbstractFilter.prototype),DropShadowFilter.prototype.constructor=DropShadowFilter,module.exports=DropShadowFilter,DropShadowFilter.prototype.applyFilter=function(renderer,input,output){var renderTarget=renderer.filterManager.getRenderTarget(!0);this._dirtyPosition&&(this._dirtyPosition=!1,this.blurYTintFilter.uniforms.offset.value[0]=Math.sin(this._angle)*this._distance,this.blurYTintFilter.uniforms.offset.value[1]=Math.cos(this._angle)*this._distance),this.blurXFilter.applyFilter(renderer,input,renderTarget),renderer.blendModeManager.setBlendMode(this.blendMode),this.blurYTintFilter.applyFilter(renderer,renderTarget,output),renderer.blendModeManager.setBlendMode(core.BLEND_MODES.NORMAL),this.hideObject||this.defaultFilter.applyFilter(renderer,input,output),renderer.filterManager.returnRenderTarget(renderTarget)},Object.defineProperties(DropShadowFilter.prototype,{blur:{get:function(){return this.blurXFilter.blur},set:function(value){this.blurXFilter.blur=this.blurYTintFilter.blur=value}},blurX:{get:function(){return this.blurXFilter.blur},set:function(value){this.blurXFilter.blur=value}},blurY:{get:function(){return this.blurYTintFilter.blur},set:function(value){this.blurYTintFilter.blur=value}},color:{get:function(){return core.utils.rgb2hex(this.blurYTintFilter.uniforms.color.value)},set:function(value){this.blurYTintFilter.uniforms.color.value=core.utils.hex2rgb(value)}},alpha:{get:function(){return this.blurYTintFilter.uniforms.alpha.value},set:function(value){this.blurYTintFilter.uniforms.alpha.value=value}},distance:{get:function(){return this._distance},set:function(value){this._dirtyPosition=!0,this._distance=value}},angle:{get:function(){return this._angle},set:function(value){this._dirtyPosition=!0,this._angle=value}}})},{"../../core":36,"../blur/BlurXFilter":97,"./BlurYTintFilter":106}],108:[function(require,module,exports){function GrayFilter(){core.AbstractFilter.call(this,null,"precision mediump float;\n\nvarying vec2 vTextureCoord;\nvarying vec4 vColor;\n\nuniform sampler2D uSampler;\nuniform float gray;\n\nvoid main(void)\n{\n   gl_FragColor = texture2D(uSampler, vTextureCoord);\n   gl_FragColor.rgb = mix(gl_FragColor.rgb, vec3(0.2126*gl_FragColor.r + 0.7152*gl_FragColor.g + 0.0722*gl_FragColor.b), gray);\n}\n",{gray:{type:"1f",value:1}})}var core=require("../../core");GrayFilter.prototype=Object.create(core.AbstractFilter.prototype),GrayFilter.prototype.constructor=GrayFilter,module.exports=GrayFilter,Object.defineProperties(GrayFilter.prototype,{gray:{get:function(){return this.uniforms.gray.value},set:function(value){this.uniforms.gray.value=value}}})},{"../../core":36}],109:[function(require,module,exports){module.exports={AsciiFilter:require("./ascii/AsciiFilter"),BloomFilter:require("./bloom/BloomFilter"),BlurFilter:require("./blur/BlurFilter"),BlurXFilter:require("./blur/BlurXFilter"),BlurYFilter:require("./blur/BlurYFilter"),BlurDirFilter:require("./blur/BlurDirFilter"),ColorMatrixFilter:require("./color/ColorMatrixFilter"),ColorStepFilter:require("./color/ColorStepFilter"),ConvolutionFilter:require("./convolution/ConvolutionFilter"),CrossHatchFilter:require("./crosshatch/CrossHatchFilter"),DisplacementFilter:require("./displacement/DisplacementFilter"),DotScreenFilter:require("./dot/DotScreenFilter"),GrayFilter:require("./gray/GrayFilter"),DropShadowFilter:require("./dropshadow/DropShadowFilter"),InvertFilter:require("./invert/InvertFilter"),NoiseFilter:require("./noise/NoiseFilter"),PixelateFilter:require("./pixelate/PixelateFilter"),RGBSplitFilter:require("./rgb/RGBSplitFilter"),ShockwaveFilter:require("./shockwave/ShockwaveFilter"),SepiaFilter:require("./sepia/SepiaFilter"),SmartBlurFilter:require("./blur/SmartBlurFilter"),TiltShiftFilter:require("./tiltshift/TiltShiftFilter"),TiltShiftXFilter:require("./tiltshift/TiltShiftXFilter"),TiltShiftYFilter:require("./tiltshift/TiltShiftYFilter"),TwistFilter:require("./twist/TwistFilter")}},{"./ascii/AsciiFilter":93,"./bloom/BloomFilter":94,"./blur/BlurDirFilter":95,"./blur/BlurFilter":96,"./blur/BlurXFilter":97,"./blur/BlurYFilter":98,"./blur/SmartBlurFilter":99,"./color/ColorMatrixFilter":100,"./color/ColorStepFilter":101,"./convolution/ConvolutionFilter":102,"./crosshatch/CrossHatchFilter":103,"./displacement/DisplacementFilter":104,"./dot/DotScreenFilter":105,"./dropshadow/DropShadowFilter":107,"./gray/GrayFilter":108,"./invert/InvertFilter":110,"./noise/NoiseFilter":111,"./pixelate/PixelateFilter":112,"./rgb/RGBSplitFilter":113,"./sepia/SepiaFilter":114,"./shockwave/ShockwaveFilter":115,"./tiltshift/TiltShiftFilter":117,"./tiltshift/TiltShiftXFilter":118,"./tiltshift/TiltShiftYFilter":119,"./twist/TwistFilter":120}],110:[function(require,module,exports){function InvertFilter(){core.AbstractFilter.call(this,null,"precision mediump float;\n\nvarying vec2 vTextureCoord;\n\nuniform float invert;\nuniform sampler2D uSampler;\n\nvoid main(void)\n{\n    gl_FragColor = texture2D(uSampler, vTextureCoord);\n\n    gl_FragColor.rgb = mix( (vec3(1)-gl_FragColor.rgb) * gl_FragColor.a, gl_FragColor.rgb, 1.0 - invert);\n}\n",{invert:{type:"1f",value:1}})}var core=require("../../core");InvertFilter.prototype=Object.create(core.AbstractFilter.prototype),InvertFilter.prototype.constructor=InvertFilter,module.exports=InvertFilter,Object.defineProperties(InvertFilter.prototype,{invert:{get:function(){return this.uniforms.invert.value},set:function(value){this.uniforms.invert.value=value}}})},{"../../core":36}],111:[function(require,module,exports){function NoiseFilter(){core.AbstractFilter.call(this,null,"precision highp float;\n\nvarying vec2 vTextureCoord;\nvarying vec4 vColor;\n\nuniform float noise;\nuniform sampler2D uSampler;\n\nfloat rand(vec2 co)\n{\n    return fract(sin(dot(co.xy, vec2(12.9898, 78.233))) * 43758.5453);\n}\n\nvoid main()\n{\n    vec4 color = texture2D(uSampler, vTextureCoord);\n\n    float diff = (rand(vTextureCoord) - 0.5) * noise;\n\n    color.r += diff;\n    color.g += diff;\n    color.b += diff;\n\n    gl_FragColor = color;\n}\n",{noise:{type:"1f",value:.5}})}var core=require("../../core");NoiseFilter.prototype=Object.create(core.AbstractFilter.prototype),NoiseFilter.prototype.constructor=NoiseFilter,module.exports=NoiseFilter,Object.defineProperties(NoiseFilter.prototype,{noise:{get:function(){return this.uniforms.noise.value},set:function(value){this.uniforms.noise.value=value}}})},{"../../core":36}],112:[function(require,module,exports){function PixelateFilter(){core.AbstractFilter.call(this,null,"precision mediump float;\n\nvarying vec2 vTextureCoord;\n\nuniform vec4 dimensions;\nuniform vec2 pixelSize;\nuniform sampler2D uSampler;\n\nvoid main(void)\n{\n    vec2 coord = vTextureCoord;\n\n    vec2 size = dimensions.xy / pixelSize;\n\n    vec2 color = floor( ( vTextureCoord * size ) ) / size + pixelSize/dimensions.xy * 0.5;\n\n    gl_FragColor = texture2D(uSampler, color);\n}\n",{dimensions:{type:"4fv",value:new Float32Array([0,0,0,0])},pixelSize:{type:"v2",value:{x:10,y:10}}})}var core=require("../../core");PixelateFilter.prototype=Object.create(core.AbstractFilter.prototype),PixelateFilter.prototype.constructor=PixelateFilter,module.exports=PixelateFilter,Object.defineProperties(PixelateFilter.prototype,{size:{get:function(){return this.uniforms.pixelSize.value},set:function(value){this.uniforms.pixelSize.value=value}}})},{"../../core":36}],113:[function(require,module,exports){function RGBSplitFilter(){core.AbstractFilter.call(this,null,"precision mediump float;\n\nvarying vec2 vTextureCoord;\n\nuniform sampler2D uSampler;\nuniform vec4 dimensions;\nuniform vec2 red;\nuniform vec2 green;\nuniform vec2 blue;\n\nvoid main(void)\n{\n   gl_FragColor.r = texture2D(uSampler, vTextureCoord + red/dimensions.xy).r;\n   gl_FragColor.g = texture2D(uSampler, vTextureCoord + green/dimensions.xy).g;\n   gl_FragColor.b = texture2D(uSampler, vTextureCoord + blue/dimensions.xy).b;\n   gl_FragColor.a = texture2D(uSampler, vTextureCoord).a;\n}\n",{red:{type:"v2",value:{x:20,y:20}},green:{type:"v2",value:{x:-20,y:20}},blue:{type:"v2",value:{x:20,y:-20}},dimensions:{type:"4fv",value:[0,0,0,0]}})}var core=require("../../core");RGBSplitFilter.prototype=Object.create(core.AbstractFilter.prototype),RGBSplitFilter.prototype.constructor=RGBSplitFilter,module.exports=RGBSplitFilter,Object.defineProperties(RGBSplitFilter.prototype,{red:{get:function(){return this.uniforms.red.value},set:function(value){this.uniforms.red.value=value}},green:{get:function(){return this.uniforms.green.value},set:function(value){this.uniforms.green.value=value}},blue:{get:function(){return this.uniforms.blue.value},set:function(value){this.uniforms.blue.value=value}}})},{"../../core":36}],114:[function(require,module,exports){function SepiaFilter(){core.AbstractFilter.call(this,null,"precision mediump float;\n\nvarying vec2 vTextureCoord;\n\nuniform sampler2D uSampler;\nuniform float sepia;\n\nconst mat3 sepiaMatrix = mat3(0.3588, 0.7044, 0.1368, 0.2990, 0.5870, 0.1140, 0.2392, 0.4696, 0.0912);\n\nvoid main(void)\n{\n   gl_FragColor = texture2D(uSampler, vTextureCoord);\n   gl_FragColor.rgb = mix( gl_FragColor.rgb, gl_FragColor.rgb * sepiaMatrix, sepia);\n}\n",{sepia:{type:"1f",value:1}})}var core=require("../../core");SepiaFilter.prototype=Object.create(core.AbstractFilter.prototype),SepiaFilter.prototype.constructor=SepiaFilter,module.exports=SepiaFilter,Object.defineProperties(SepiaFilter.prototype,{sepia:{get:function(){return this.uniforms.sepia.value},set:function(value){this.uniforms.sepia.value=value}}})},{"../../core":36}],115:[function(require,module,exports){function ShockwaveFilter(){core.AbstractFilter.call(this,null,"precision lowp float;\n\nvarying vec2 vTextureCoord;\n\nuniform sampler2D uSampler;\n\nuniform vec2 center;\nuniform vec3 params; // 10.0, 0.8, 0.1\nuniform float time;\n\nvoid main()\n{\n    vec2 uv = vTextureCoord;\n    vec2 texCoord = uv;\n\n    float dist = distance(uv, center);\n\n    if ( (dist <= (time + params.z)) && (dist >= (time - params.z)) )\n    {\n        float diff = (dist - time);\n        float powDiff = 1.0 - pow(abs(diff*params.x), params.y);\n\n        float diffTime = diff  * powDiff;\n        vec2 diffUV = normalize(uv - center);\n        texCoord = uv + (diffUV * diffTime);\n    }\n\n    gl_FragColor = texture2D(uSampler, texCoord);\n}\n",{center:{type:"v2",value:{x:.5,y:.5}},params:{type:"v3",value:{x:10,y:.8,z:.1}},time:{type:"1f",value:0}})}var core=require("../../core");ShockwaveFilter.prototype=Object.create(core.AbstractFilter.prototype),ShockwaveFilter.prototype.constructor=ShockwaveFilter,module.exports=ShockwaveFilter,Object.defineProperties(ShockwaveFilter.prototype,{center:{get:function(){return this.uniforms.center.value},set:function(value){this.uniforms.center.value=value}},params:{get:function(){return this.uniforms.params.value},set:function(value){this.uniforms.params.value=value}},time:{get:function(){return this.uniforms.time.value},set:function(value){this.uniforms.time.value=value}}})},{"../../core":36}],116:[function(require,module,exports){function TiltShiftAxisFilter(){core.AbstractFilter.call(this,null,"precision mediump float;\n\nvarying vec2 vTextureCoord;\n\nuniform sampler2D uSampler;\nuniform float blur;\nuniform float gradientBlur;\nuniform vec2 start;\nuniform vec2 end;\nuniform vec2 delta;\nuniform vec2 texSize;\n\nfloat random(vec3 scale, float seed)\n{\n    return fract(sin(dot(gl_FragCoord.xyz + seed, scale)) * 43758.5453 + seed);\n}\n\nvoid main(void)\n{\n    vec4 color = vec4(0.0);\n    float total = 0.0;\n\n    float offset = random(vec3(12.9898, 78.233, 151.7182), 0.0);\n    vec2 normal = normalize(vec2(start.y - end.y, end.x - start.x));\n    float radius = smoothstep(0.0, 1.0, abs(dot(vTextureCoord * texSize - start, normal)) / gradientBlur) * blur;\n\n    for (float t = -30.0; t <= 30.0; t++)\n    {\n        float percent = (t + offset - 0.5) / 30.0;\n        float weight = 1.0 - abs(percent);\n        vec4 sample = texture2D(uSampler, vTextureCoord + delta / texSize * percent * radius);\n        sample.rgb *= sample.a;\n        color += sample * weight;\n        total += weight;\n    }\n\n    gl_FragColor = color / total;\n    gl_FragColor.rgb /= gl_FragColor.a + 0.00001;\n}\n",{blur:{type:"1f",value:100},gradientBlur:{type:"1f",value:600},start:{type:"v2",value:{x:0,y:window.innerHeight/2}},end:{type:"v2",value:{x:600,y:window.innerHeight/2}},delta:{type:"v2",value:{x:30,y:30}},texSize:{type:"v2",value:{x:window.innerWidth,y:window.innerHeight}}}),this.updateDelta()}var core=require("../../core");TiltShiftAxisFilter.prototype=Object.create(core.AbstractFilter.prototype),TiltShiftAxisFilter.prototype.constructor=TiltShiftAxisFilter,module.exports=TiltShiftAxisFilter,TiltShiftAxisFilter.prototype.updateDelta=function(){this.uniforms.delta.value.x=0,this.uniforms.delta.value.y=0},Object.defineProperties(TiltShiftAxisFilter.prototype,{blur:{get:function(){return this.uniforms.blur.value},set:function(value){this.uniforms.blur.value=value}},gradientBlur:{get:function(){return this.uniforms.gradientBlur.value},set:function(value){this.uniforms.gradientBlur.value=value}},start:{get:function(){return this.uniforms.start.value},set:function(value){this.uniforms.start.value=value,this.updateDelta()}},end:{get:function(){return this.uniforms.end.value},set:function(value){this.uniforms.end.value=value,this.updateDelta()}}})},{"../../core":36}],117:[function(require,module,exports){function TiltShiftFilter(){core.AbstractFilter.call(this),this.tiltShiftXFilter=new TiltShiftXFilter,this.tiltShiftYFilter=new TiltShiftYFilter}var core=require("../../core"),TiltShiftXFilter=require("./TiltShiftXFilter"),TiltShiftYFilter=require("./TiltShiftYFilter");TiltShiftFilter.prototype=Object.create(core.AbstractFilter.prototype),TiltShiftFilter.prototype.constructor=TiltShiftFilter,module.exports=TiltShiftFilter,TiltShiftFilter.prototype.applyFilter=function(renderer,input,output){var renderTarget=renderer.filterManager.getRenderTarget(!0);this.tiltShiftXFilter.applyFilter(renderer,input,renderTarget),this.tiltShiftYFilter.applyFilter(renderer,renderTarget,output),renderer.filterManager.returnRenderTarget(renderTarget)},Object.defineProperties(TiltShiftFilter.prototype,{blur:{get:function(){return this.tiltShiftXFilter.blur},set:function(value){this.tiltShiftXFilter.blur=this.tiltShiftYFilter.blur=value}},gradientBlur:{get:function(){return this.tiltShiftXFilter.gradientBlur},set:function(value){this.tiltShiftXFilter.gradientBlur=this.tiltShiftYFilter.gradientBlur=value}},start:{get:function(){return this.tiltShiftXFilter.start},set:function(value){this.tiltShiftXFilter.start=this.tiltShiftYFilter.start=value}},end:{get:function(){return this.tiltShiftXFilter.end},set:function(value){this.tiltShiftXFilter.end=this.tiltShiftYFilter.end=value}}})},{"../../core":36,"./TiltShiftXFilter":118,"./TiltShiftYFilter":119}],118:[function(require,module,exports){function TiltShiftXFilter(){TiltShiftAxisFilter.call(this)}var TiltShiftAxisFilter=require("./TiltShiftAxisFilter");TiltShiftXFilter.prototype=Object.create(TiltShiftAxisFilter.prototype),TiltShiftXFilter.prototype.constructor=TiltShiftXFilter,module.exports=TiltShiftXFilter,TiltShiftXFilter.prototype.updateDelta=function(){var dx=this.uniforms.end.value.x-this.uniforms.start.value.x,dy=this.uniforms.end.value.y-this.uniforms.start.value.y,d=Math.sqrt(dx*dx+dy*dy);this.uniforms.delta.value.x=dx/d,this.uniforms.delta.value.y=dy/d}},{"./TiltShiftAxisFilter":116}],119:[function(require,module,exports){function TiltShiftYFilter(){TiltShiftAxisFilter.call(this)}var TiltShiftAxisFilter=require("./TiltShiftAxisFilter");TiltShiftYFilter.prototype=Object.create(TiltShiftAxisFilter.prototype),TiltShiftYFilter.prototype.constructor=TiltShiftYFilter,module.exports=TiltShiftYFilter,TiltShiftYFilter.prototype.updateDelta=function(){var dx=this.uniforms.end.value.x-this.uniforms.start.value.x,dy=this.uniforms.end.value.y-this.uniforms.start.value.y,d=Math.sqrt(dx*dx+dy*dy);this.uniforms.delta.value.x=-dy/d,this.uniforms.delta.value.y=dx/d}},{"./TiltShiftAxisFilter":116}],120:[function(require,module,exports){function TwistFilter(){core.AbstractFilter.call(this,null,"precision mediump float;\n\nvarying vec2 vTextureCoord;\n\nuniform sampler2D uSampler;\nuniform float radius;\nuniform float angle;\nuniform vec2 offset;\n\nvoid main(void)\n{\n   vec2 coord = vTextureCoord - offset;\n   float dist = length(coord);\n\n   if (dist < radius)\n   {\n       float ratio = (radius - dist) / radius;\n       float angleMod = ratio * ratio * angle;\n       float s = sin(angleMod);\n       float c = cos(angleMod);\n       coord = vec2(coord.x * c - coord.y * s, coord.x * s + coord.y * c);\n   }\n\n   gl_FragColor = texture2D(uSampler, coord+offset);\n}\n",{radius:{type:"1f",value:.5},angle:{type:"1f",value:5},offset:{type:"v2",value:{x:.5,y:.5}}})}var core=require("../../core");TwistFilter.prototype=Object.create(core.AbstractFilter.prototype),TwistFilter.prototype.constructor=TwistFilter,module.exports=TwistFilter,Object.defineProperties(TwistFilter.prototype,{offset:{get:function(){return this.uniforms.offset.value},set:function(value){this.uniforms.offset.value=value}},radius:{get:function(){return this.uniforms.radius.value},set:function(value){this.uniforms.radius.value=value}},angle:{get:function(){return this.uniforms.angle.value},set:function(value){this.uniforms.angle.value=value}}})},{"../../core":36}],121:[function(require,module,exports){(function(global){require("./polyfill");var core=module.exports=require("./core");core.extras=require("./extras"),core.filters=require("./filters"),core.interaction=require("./interaction"),core.loaders=require("./loaders"),core.mesh=require("./mesh"),core.loader=new core.loaders.Loader,Object.assign(core,require("./deprecation")),global.PIXI=core}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{"./core":36,"./deprecation":85,"./extras":92,"./filters":109,"./interaction":124,"./loaders":127,"./mesh":133,"./polyfill":138}],122:[function(require,module,exports){function InteractionData(){this.global=new core.Point,this.target=null,this.originalEvent=null}var core=require("../core");InteractionData.prototype.constructor=InteractionData,module.exports=InteractionData,InteractionData.prototype.getLocalPosition=function(displayObject,point,globalPos){return displayObject.toLocal(globalPos?globalPos:this.global,point)}},{"../core":36}],123:[function(require,module,exports){function InteractionManager(renderer,options){options=options||{},this.renderer=renderer,this.autoPreventDefault=void 0!==options.autoPreventDefault?options.autoPreventDefault:!0,this.interactionFrequency=options.interactionFrequency||10,this.mouse=new InteractionData,this.eventData={stopped:!1,target:null,type:null,data:this.mouse,stopPropagation:function(){this.stopped=!0}},this.interactiveDataPool=[],this.interactionDOMElement=null,this.eventsAdded=!1,this.onMouseUp=this.onMouseUp.bind(this),this.processMouseUp=this.processMouseUp.bind(this),this.onMouseDown=this.onMouseDown.bind(this),this.processMouseDown=this.processMouseDown.bind(this),this.onMouseMove=this.onMouseMove.bind(this),this.processMouseMove=this.processMouseMove.bind(this),this.onMouseOut=this.onMouseOut.bind(this),this.processMouseOverOut=this.processMouseOverOut.bind(this),this.onTouchStart=this.onTouchStart.bind(this),this.processTouchStart=this.processTouchStart.bind(this),this.onTouchEnd=this.onTouchEnd.bind(this),this.processTouchEnd=this.processTouchEnd.bind(this),this.onTouchMove=this.onTouchMove.bind(this),this.processTouchMove=this.processTouchMove.bind(this),this.last=0,this.currentCursorStyle="inherit",this._tempPoint=new core.Point,this.resolution=1,this.setTargetElement(this.renderer.view,this.renderer.resolution)}var core=require("../core"),InteractionData=require("./InteractionData");Object.assign(core.DisplayObject.prototype,require("./interactiveTarget")),InteractionManager.prototype.constructor=InteractionManager,module.exports=InteractionManager,InteractionManager.prototype.setTargetElement=function(element,resolution){this.removeEvents(),this.interactionDOMElement=element,this.resolution=resolution||1,this.addEvents()},InteractionManager.prototype.addEvents=function(){this.interactionDOMElement&&(core.ticker.shared.add(this.update,this),window.navigator.msPointerEnabled&&(this.interactionDOMElement.style["-ms-content-zooming"]="none",this.interactionDOMElement.style["-ms-touch-action"]="none"),window.document.addEventListener("mousemove",this.onMouseMove,!0),this.interactionDOMElement.addEventListener("mousedown",this.onMouseDown,!0),this.interactionDOMElement.addEventListener("mouseout",this.onMouseOut,!0),this.interactionDOMElement.addEventListener("touchstart",this.onTouchStart,!0),this.interactionDOMElement.addEventListener("touchend",this.onTouchEnd,!0),this.interactionDOMElement.addEventListener("touchmove",this.onTouchMove,!0),window.addEventListener("mouseup",this.onMouseUp,!0),this.eventsAdded=!0)},InteractionManager.prototype.removeEvents=function(){this.interactionDOMElement&&(core.ticker.shared.remove(this.update),window.navigator.msPointerEnabled&&(this.interactionDOMElement.style["-ms-content-zooming"]="",this.interactionDOMElement.style["-ms-touch-action"]=""),window.document.removeEventListener("mousemove",this.onMouseMove,!0),this.interactionDOMElement.removeEventListener("mousedown",this.onMouseDown,!0),this.interactionDOMElement.removeEventListener("mouseout",this.onMouseOut,!0),this.interactionDOMElement.removeEventListener("touchstart",this.onTouchStart,!0),this.interactionDOMElement.removeEventListener("touchend",this.onTouchEnd,!0),this.interactionDOMElement.removeEventListener("touchmove",this.onTouchMove,!0),this.interactionDOMElement=null,window.removeEventListener("mouseup",this.onMouseUp,!0),this.eventsAdded=!1)},InteractionManager.prototype.update=function(deltaTime){if(this._deltaTime+=deltaTime,!(this._deltaTime<this.interactionFrequency)&&(this._deltaTime=0,this.interactionDOMElement)){if(this.didMove)return void(this.didMove=!1);this.cursor="inherit",this.processInteractive(this.mouse.global,this.renderer._lastObjectRendered,this.processMouseOverOut,!0),this.currentCursorStyle!==this.cursor&&(this.currentCursorStyle=this.cursor,this.interactionDOMElement.style.cursor=this.cursor)}},InteractionManager.prototype.dispatchEvent=function(displayObject,eventString,eventData){eventData.stopped||(eventData.target=displayObject,eventData.type=eventString,displayObject.emit(eventString,eventData),displayObject[eventString]&&displayObject[eventString](eventData))},InteractionManager.prototype.mapPositionToPoint=function(point,x,y){var rect=this.interactionDOMElement.getBoundingClientRect();point.x=(x-rect.left)*(this.interactionDOMElement.width/rect.width)/this.resolution,point.y=(y-rect.top)*(this.interactionDOMElement.height/rect.height)/this.resolution},InteractionManager.prototype.processInteractive=function(point,displayObject,func,hitTest,interactive){if(!displayObject||!displayObject.visible)return!1;var children=displayObject.children,hit=!1;if(interactive=interactive||displayObject.interactive,displayObject.interactiveChildren)for(var i=children.length-1;i>=0;i--)!hit&&hitTest?hit=this.processInteractive(point,children[i],func,!0,interactive):this.processInteractive(point,children[i],func,!1,!1);return interactive&&(hitTest&&(displayObject.hitArea?(displayObject.worldTransform.applyInverse(point,this._tempPoint),hit=displayObject.hitArea.contains(this._tempPoint.x,this._tempPoint.y)):displayObject.containsPoint&&(hit=displayObject.containsPoint(point))),displayObject.interactive&&func(displayObject,hit)),hit},InteractionManager.prototype.onMouseDown=function(event){this.mouse.originalEvent=event,this.eventData.data=this.mouse,this.eventData.stopped=!1,this.mapPositionToPoint(this.mouse.global,event.clientX,event.clientY),this.autoPreventDefault&&this.mouse.originalEvent.preventDefault(),this.processInteractive(this.mouse.global,this.renderer._lastObjectRendered,this.processMouseDown,!0)},InteractionManager.prototype.processMouseDown=function(displayObject,hit){var e=this.mouse.originalEvent,isRightButton=2===e.button||3===e.which;hit&&(displayObject[isRightButton?"_isRightDown":"_isLeftDown"]=!0,this.dispatchEvent(displayObject,isRightButton?"rightdown":"mousedown",this.eventData))},InteractionManager.prototype.onMouseUp=function(event){this.mouse.originalEvent=event,this.eventData.data=this.mouse,this.eventData.stopped=!1,this.mapPositionToPoint(this.mouse.global,event.clientX,event.clientY),this.processInteractive(this.mouse.global,this.renderer._lastObjectRendered,this.processMouseUp,!0)},InteractionManager.prototype.processMouseUp=function(displayObject,hit){var e=this.mouse.originalEvent,isRightButton=2===e.button||3===e.which,isDown=isRightButton?"_isRightDown":"_isLeftDown";hit?(this.dispatchEvent(displayObject,isRightButton?"rightup":"mouseup",this.eventData),displayObject[isDown]&&(displayObject[isDown]=!1,this.dispatchEvent(displayObject,isRightButton?"rightclick":"click",this.eventData))):displayObject[isDown]&&(displayObject[isDown]=!1,this.dispatchEvent(displayObject,isRightButton?"rightupoutside":"mouseupoutside",this.eventData))},InteractionManager.prototype.onMouseMove=function(event){this.mouse.originalEvent=event,this.eventData.data=this.mouse,this.eventData.stopped=!1,this.mapPositionToPoint(this.mouse.global,event.clientX,event.clientY),this.didMove=!0,this.cursor="inherit",this.processInteractive(this.mouse.global,this.renderer._lastObjectRendered,this.processMouseMove,!0),this.currentCursorStyle!==this.cursor&&(this.currentCursorStyle=this.cursor,this.interactionDOMElement.style.cursor=this.cursor)},InteractionManager.prototype.processMouseMove=function(displayObject,hit){this.dispatchEvent(displayObject,"mousemove",this.eventData),this.processMouseOverOut(displayObject,hit)},InteractionManager.prototype.onMouseOut=function(event){this.mouse.originalEvent=event,this.eventData.stopped=!1,this.mapPositionToPoint(this.mouse.global,event.clientX,event.clientY),this.interactionDOMElement.style.cursor="inherit",this.mapPositionToPoint(this.mouse.global,event.clientX,event.clientY),this.processInteractive(this.mouse.global,this.renderer._lastObjectRendered,this.processMouseOverOut,!1)},InteractionManager.prototype.processMouseOverOut=function(displayObject,hit){hit?(displayObject._over||(displayObject._over=!0,this.dispatchEvent(displayObject,"mouseover",this.eventData)),displayObject.buttonMode&&(this.cursor=displayObject.defaultCursor)):displayObject._over&&(displayObject._over=!1,this.dispatchEvent(displayObject,"mouseout",this.eventData))},InteractionManager.prototype.onTouchStart=function(event){this.autoPreventDefault&&event.preventDefault();for(var changedTouches=event.changedTouches,cLength=changedTouches.length,i=0;cLength>i;i++){
var touchEvent=changedTouches[i],touchData=this.getTouchData(touchEvent);touchData.originalEvent=event,this.eventData.data=touchData,this.eventData.stopped=!1,this.processInteractive(touchData.global,this.renderer._lastObjectRendered,this.processTouchStart,!0),this.returnTouchData(touchData)}},InteractionManager.prototype.processTouchStart=function(displayObject,hit){hit&&(displayObject._touchDown=!0,this.dispatchEvent(displayObject,"touchstart",this.eventData))},InteractionManager.prototype.onTouchEnd=function(event){this.autoPreventDefault&&event.preventDefault();for(var changedTouches=event.changedTouches,cLength=changedTouches.length,i=0;cLength>i;i++){var touchEvent=changedTouches[i],touchData=this.getTouchData(touchEvent);touchData.originalEvent=event,this.eventData.data=touchData,this.eventData.stopped=!1,this.processInteractive(touchData.global,this.renderer._lastObjectRendered,this.processTouchEnd,!0),this.returnTouchData(touchData)}},InteractionManager.prototype.processTouchEnd=function(displayObject,hit){hit?(this.dispatchEvent(displayObject,"touchend",this.eventData),displayObject._touchDown&&(displayObject._touchDown=!1,this.dispatchEvent(displayObject,"tap",this.eventData))):displayObject._touchDown&&(displayObject._touchDown=!1,this.dispatchEvent(displayObject,"touchendoutside",this.eventData))},InteractionManager.prototype.onTouchMove=function(event){this.autoPreventDefault&&event.preventDefault();for(var changedTouches=event.changedTouches,cLength=changedTouches.length,i=0;cLength>i;i++){var touchEvent=changedTouches[i],touchData=this.getTouchData(touchEvent);touchData.originalEvent=event,this.eventData.data=touchData,this.eventData.stopped=!1,this.processInteractive(touchData.global,this.renderer._lastObjectRendered,this.processTouchMove,!0),this.returnTouchData(touchData)}},InteractionManager.prototype.processTouchMove=function(displayObject,hit){hit=hit,this.dispatchEvent(displayObject,"touchmove",this.eventData)},InteractionManager.prototype.getTouchData=function(touchEvent){var touchData=this.interactiveDataPool.pop();return touchData||(touchData=new InteractionData),touchData.identifier=touchEvent.identifier,this.mapPositionToPoint(touchData.global,touchEvent.clientX,touchEvent.clientY),navigator.isCocoonJS&&(touchData.global.x=touchData.global.x/this.resolution,touchData.global.y=touchData.global.y/this.resolution),touchEvent.globalX=touchData.global.x,touchEvent.globalY=touchData.global.y,touchData},InteractionManager.prototype.returnTouchData=function(touchData){this.interactiveDataPool.push(touchData)},InteractionManager.prototype.destroy=function(){this.removeEvents(),this.renderer=null,this.mouse=null,this.eventData=null,this.interactiveDataPool=null,this.interactionDOMElement=null,this.onMouseUp=null,this.processMouseUp=null,this.onMouseDown=null,this.processMouseDown=null,this.onMouseMove=null,this.processMouseMove=null,this.onMouseOut=null,this.processMouseOverOut=null,this.onTouchStart=null,this.processTouchStart=null,this.onTouchEnd=null,this.processTouchEnd=null,this.onTouchMove=null,this.processTouchMove=null,this._tempPoint=null},core.WebGLRenderer.registerPlugin("interaction",InteractionManager),core.CanvasRenderer.registerPlugin("interaction",InteractionManager)},{"../core":36,"./InteractionData":122,"./interactiveTarget":125}],124:[function(require,module,exports){module.exports={InteractionData:require("./InteractionData"),InteractionManager:require("./InteractionManager"),interactiveTarget:require("./interactiveTarget")}},{"./InteractionData":122,"./InteractionManager":123,"./interactiveTarget":125}],125:[function(require,module,exports){var interactiveTarget={interactive:!1,buttonMode:!1,interactiveChildren:!0,defaultCursor:"pointer",_over:!1,_touchDown:!1};module.exports=interactiveTarget},{}],126:[function(require,module,exports){function parse(resource,texture){var data={},info=resource.data.getElementsByTagName("info")[0],common=resource.data.getElementsByTagName("common")[0];data.font=info.getAttribute("face"),data.size=parseInt(info.getAttribute("size"),10),data.lineHeight=parseInt(common.getAttribute("lineHeight"),10),data.chars={};for(var letters=resource.data.getElementsByTagName("char"),i=0;i<letters.length;i++){var charCode=parseInt(letters[i].getAttribute("id"),10),textureRect=new core.Rectangle(parseInt(letters[i].getAttribute("x"),10)+texture.frame.x,parseInt(letters[i].getAttribute("y"),10)+texture.frame.y,parseInt(letters[i].getAttribute("width"),10),parseInt(letters[i].getAttribute("height"),10));data.chars[charCode]={xOffset:parseInt(letters[i].getAttribute("xoffset"),10),yOffset:parseInt(letters[i].getAttribute("yoffset"),10),xAdvance:parseInt(letters[i].getAttribute("xadvance"),10),kerning:{},texture:new core.Texture(texture.baseTexture,textureRect)}}var kernings=resource.data.getElementsByTagName("kerning");for(i=0;i<kernings.length;i++){var first=parseInt(kernings[i].getAttribute("first"),10),second=parseInt(kernings[i].getAttribute("second"),10),amount=parseInt(kernings[i].getAttribute("amount"),10);data.chars[second].kerning[first]=amount}resource.bitmapFont=data,extras.BitmapText.fonts[data.font]=data}var Resource=require("resource-loader").Resource,core=require("../core"),extras=require("../extras"),path=require("path");module.exports=function(){return function(resource,next){if(!resource.data||!resource.isXml)return next();if(0===resource.data.getElementsByTagName("page").length||0===resource.data.getElementsByTagName("info").length||null===resource.data.getElementsByTagName("info")[0].getAttribute("face"))return next();var xmlUrl=path.dirname(resource.url);"."===xmlUrl&&(xmlUrl=""),this.baseUrl&&xmlUrl&&("/"===this.baseUrl.charAt(this.baseUrl.length-1)&&(xmlUrl+="/"),xmlUrl=xmlUrl.replace(this.baseUrl,"")),xmlUrl&&"/"!==xmlUrl.charAt(xmlUrl.length-1)&&(xmlUrl+="/");var textureUrl=xmlUrl+resource.data.getElementsByTagName("page")[0].getAttribute("file");if(core.utils.TextureCache[textureUrl])parse(resource,core.utils.TextureCache[textureUrl]),next();else{var loadOptions={crossOrigin:resource.crossOrigin,loadType:Resource.LOAD_TYPE.IMAGE};this.add(resource.name+"_image",textureUrl,loadOptions,function(res){parse(resource,res.texture),next()})}}}},{"../core":36,"../extras":92,path:27,"resource-loader":149}],127:[function(require,module,exports){module.exports={Loader:require("./loader"),bitmapFontParser:require("./bitmapFontParser"),spritesheetParser:require("./spritesheetParser"),textureParser:require("./textureParser"),Resource:require("resource-loader").Resource}},{"./bitmapFontParser":126,"./loader":128,"./spritesheetParser":129,"./textureParser":130,"resource-loader":149}],128:[function(require,module,exports){function Loader(baseUrl,concurrency){ResourceLoader.call(this,baseUrl,concurrency);for(var i=0;i<Loader._pixiMiddleware.length;++i)this.use(Loader._pixiMiddleware[i]())}var ResourceLoader=require("resource-loader"),textureParser=require("./textureParser"),spritesheetParser=require("./spritesheetParser"),bitmapFontParser=require("./bitmapFontParser");Loader.prototype=Object.create(ResourceLoader.prototype),Loader.prototype.constructor=Loader,module.exports=Loader,Loader._pixiMiddleware=[ResourceLoader.middleware.parsing.blob,textureParser,spritesheetParser,bitmapFontParser],Loader.addPixiMiddleware=function(fn){Loader._pixiMiddleware.push(fn)};var Resource=ResourceLoader.Resource;Resource.setExtensionXhrType("fnt",Resource.XHR_RESPONSE_TYPE.DOCUMENT)},{"./bitmapFontParser":126,"./spritesheetParser":129,"./textureParser":130,"resource-loader":149}],129:[function(require,module,exports){var Resource=require("resource-loader").Resource,path=require("path"),core=require("../core");module.exports=function(){return function(resource,next){if(!resource.data||!resource.isJson||!resource.data.frames)return next();var loadOptions={crossOrigin:resource.crossOrigin,loadType:Resource.LOAD_TYPE.IMAGE},route=path.dirname(resource.url.replace(this.baseUrl,"")),resolution=core.utils.getResolutionOfUrl(resource.url);this.add(resource.name+"_image",route+"/"+resource.data.meta.image,loadOptions,function(res){resource.textures={};var frames=resource.data.frames;for(var i in frames){var rect=frames[i].frame;if(rect){var size=null,trim=null;if(size=frames[i].rotated?new core.Rectangle(rect.x,rect.y,rect.h,rect.w):new core.Rectangle(rect.x,rect.y,rect.w,rect.h),frames[i].trimmed&&(trim=new core.Rectangle(frames[i].spriteSourceSize.x/resolution,frames[i].spriteSourceSize.y/resolution,frames[i].sourceSize.w/resolution,frames[i].sourceSize.h/resolution)),frames[i].rotated){var temp=size.width;size.width=size.height,size.height=temp}size.x/=resolution,size.y/=resolution,size.width/=resolution,size.height/=resolution,resource.textures[i]=new core.Texture(res.texture.baseTexture,size,size.clone(),trim,frames[i].rotated),core.utils.TextureCache[i]=resource.textures[i]}}next()})}}},{"../core":36,path:27,"resource-loader":149}],130:[function(require,module,exports){var core=require("../core");module.exports=function(){return function(resource,next){if(resource.data&&resource.isImage){var baseTexture=new core.BaseTexture(resource.data,null,core.utils.getResolutionOfUrl(resource.url));baseTexture.imageUrl=resource.url,resource.texture=new core.Texture(baseTexture),core.utils.BaseTextureCache[resource.url]=baseTexture,core.utils.TextureCache[resource.url]=resource.texture}next()}}},{"../core":36}],131:[function(require,module,exports){function Mesh(texture,vertices,uvs,indices,drawMode){core.Container.call(this),this._texture=null,this.uvs=uvs||new Float32Array([0,1,1,1,1,0,0,1]),this.vertices=vertices||new Float32Array([0,0,100,0,100,100,0,100]),this.indices=indices||new Uint16Array([0,1,2,3]),this.dirty=!0,this.blendMode=core.BLEND_MODES.NORMAL,this.canvasPadding=0,this.drawMode=drawMode||Mesh.DRAW_MODES.TRIANGLE_MESH,this.texture=texture}var core=require("../core"),tempPoint=new core.Point,tempPolygon=new core.Polygon;Mesh.prototype=Object.create(core.Container.prototype),Mesh.prototype.constructor=Mesh,module.exports=Mesh,Object.defineProperties(Mesh.prototype,{texture:{get:function(){return this._texture},set:function(value){this._texture!==value&&(this._texture=value,value&&(value.baseTexture.hasLoaded?this._onTextureUpdate():value.once("update",this._onTextureUpdate,this)))}}}),Mesh.prototype._renderWebGL=function(renderer){renderer.setObjectRenderer(renderer.plugins.mesh),renderer.plugins.mesh.render(this)},Mesh.prototype._renderCanvas=function(renderer){var context=renderer.context,transform=this.worldTransform;renderer.roundPixels?context.setTransform(transform.a,transform.b,transform.c,transform.d,0|transform.tx,0|transform.ty):context.setTransform(transform.a,transform.b,transform.c,transform.d,transform.tx,transform.ty),this.drawMode===Mesh.DRAW_MODES.TRIANGLE_MESH?this._renderCanvasTriangleMesh(context):this._renderCanvasTriangles(context)},Mesh.prototype._renderCanvasTriangleMesh=function(context){for(var vertices=this.vertices,uvs=this.uvs,length=vertices.length/2,i=0;length-2>i;i++){var index=2*i;this._renderCanvasDrawTriangle(context,vertices,uvs,index,index+2,index+4)}},Mesh.prototype._renderCanvasTriangles=function(context){for(var vertices=this.vertices,uvs=this.uvs,indices=this.indices,length=indices.length,i=0;length>i;i+=3){var index0=2*indices[i],index1=2*indices[i+1],index2=2*indices[i+2];this._renderCanvasDrawTriangle(context,vertices,uvs,index0,index1,index2)}},Mesh.prototype._renderCanvasDrawTriangle=function(context,vertices,uvs,index0,index1,index2){var textureSource=this._texture.baseTexture.source,textureWidth=this._texture.baseTexture.width,textureHeight=this._texture.baseTexture.height,x0=vertices[index0],x1=vertices[index1],x2=vertices[index2],y0=vertices[index0+1],y1=vertices[index1+1],y2=vertices[index2+1],u0=uvs[index0]*textureWidth,u1=uvs[index1]*textureWidth,u2=uvs[index2]*textureWidth,v0=uvs[index0+1]*textureHeight,v1=uvs[index1+1]*textureHeight,v2=uvs[index2+1]*textureHeight;if(this.canvasPadding>0){var paddingX=this.canvasPadding/this.worldTransform.a,paddingY=this.canvasPadding/this.worldTransform.d,centerX=(x0+x1+x2)/3,centerY=(y0+y1+y2)/3,normX=x0-centerX,normY=y0-centerY,dist=Math.sqrt(normX*normX+normY*normY);x0=centerX+normX/dist*(dist+paddingX),y0=centerY+normY/dist*(dist+paddingY),normX=x1-centerX,normY=y1-centerY,dist=Math.sqrt(normX*normX+normY*normY),x1=centerX+normX/dist*(dist+paddingX),y1=centerY+normY/dist*(dist+paddingY),normX=x2-centerX,normY=y2-centerY,dist=Math.sqrt(normX*normX+normY*normY),x2=centerX+normX/dist*(dist+paddingX),y2=centerY+normY/dist*(dist+paddingY)}context.save(),context.beginPath(),context.moveTo(x0,y0),context.lineTo(x1,y1),context.lineTo(x2,y2),context.closePath(),context.clip();var delta=u0*v1+v0*u2+u1*v2-v1*u2-v0*u1-u0*v2,deltaA=x0*v1+v0*x2+x1*v2-v1*x2-v0*x1-x0*v2,deltaB=u0*x1+x0*u2+u1*x2-x1*u2-x0*u1-u0*x2,deltaC=u0*v1*x2+v0*x1*u2+x0*u1*v2-x0*v1*u2-v0*u1*x2-u0*x1*v2,deltaD=y0*v1+v0*y2+y1*v2-v1*y2-v0*y1-y0*v2,deltaE=u0*y1+y0*u2+u1*y2-y1*u2-y0*u1-u0*y2,deltaF=u0*v1*y2+v0*y1*u2+y0*u1*v2-y0*v1*u2-v0*u1*y2-u0*y1*v2;context.transform(deltaA/delta,deltaD/delta,deltaB/delta,deltaE/delta,deltaC/delta,deltaF/delta),context.drawImage(textureSource,0,0),context.restore()},Mesh.prototype.renderMeshFlat=function(Mesh){var context=this.context,vertices=Mesh.vertices,length=vertices.length/2;context.beginPath();for(var i=1;length-2>i;i++){var index=2*i,x0=vertices[index],x1=vertices[index+2],x2=vertices[index+4],y0=vertices[index+1],y1=vertices[index+3],y2=vertices[index+5];context.moveTo(x0,y0),context.lineTo(x1,y1),context.lineTo(x2,y2)}context.fillStyle="#FF0000",context.fill(),context.closePath()},Mesh.prototype._onTextureUpdate=function(){this.updateFrame=!0},Mesh.prototype.getBounds=function(matrix){if(!this._currentBounds){for(var worldTransform=matrix||this.worldTransform,a=worldTransform.a,b=worldTransform.b,c=worldTransform.c,d=worldTransform.d,tx=worldTransform.tx,ty=worldTransform.ty,maxX=-(1/0),maxY=-(1/0),minX=1/0,minY=1/0,vertices=this.vertices,i=0,n=vertices.length;n>i;i+=2){var rawX=vertices[i],rawY=vertices[i+1],x=a*rawX+c*rawY+tx,y=d*rawY+b*rawX+ty;minX=minX>x?x:minX,minY=minY>y?y:minY,maxX=x>maxX?x:maxX,maxY=y>maxY?y:maxY}if(minX===-(1/0)||maxY===1/0)return core.Rectangle.EMPTY;var bounds=this._bounds;bounds.x=minX,bounds.width=maxX-minX,bounds.y=minY,bounds.height=maxY-minY,this._currentBounds=bounds}return this._currentBounds},Mesh.prototype.containsPoint=function(point){if(!this.getBounds().contains(point.x,point.y))return!1;this.worldTransform.applyInverse(point,tempPoint);var i,len,vertices=this.vertices,points=tempPolygon.points;if(this.drawMode===Mesh.DRAW_MODES.TRIANGLES){var indices=this.indices;for(len=this.indices.length,i=0;len>i;i+=3){var ind0=2*indices[i],ind1=2*indices[i+1],ind2=2*indices[i+2];if(points[0]=vertices[ind0],points[1]=vertices[ind0+1],points[2]=vertices[ind1],points[3]=vertices[ind1+1],points[4]=vertices[ind2],points[5]=vertices[ind2+1],tempPolygon.contains(tempPoint.x,tempPoint.y))return!0}}else for(len=vertices.length,i=0;len>i;i+=6)if(points[0]=vertices[i],points[1]=vertices[i+1],points[2]=vertices[i+2],points[3]=vertices[i+3],points[4]=vertices[i+4],points[5]=vertices[i+5],tempPolygon.contains(tempPoint.x,tempPoint.y))return!0;return!1},Mesh.DRAW_MODES={TRIANGLE_MESH:0,TRIANGLES:1}},{"../core":36}],132:[function(require,module,exports){function Rope(texture,points){Mesh.call(this,texture),this.points=points,this.vertices=new Float32Array(4*points.length),this.uvs=new Float32Array(4*points.length),this.colors=new Float32Array(2*points.length),this.indices=new Uint16Array(2*points.length),this._ready=!0,this.refresh()}var Mesh=require("./Mesh"),core=require("../core");Rope.prototype=Object.create(Mesh.prototype),Rope.prototype.constructor=Rope,module.exports=Rope,Rope.prototype.refresh=function(){var points=this.points;if(!(points.length<1)&&this._texture._uvs){var uvs=this.uvs,indices=this.indices,colors=this.colors,textureUvs=this._texture._uvs,offset=new core.Point(textureUvs.x0,textureUvs.y0),factor=new core.Point(textureUvs.x2-textureUvs.x0,textureUvs.y2-textureUvs.y0);uvs[0]=0+offset.x,uvs[1]=0+offset.y,uvs[2]=0+offset.x,uvs[3]=1*factor.y+offset.y,colors[0]=1,colors[1]=1,indices[0]=0,indices[1]=1;for(var point,index,amount,total=points.length,i=1;total>i;i++)point=points[i],index=4*i,amount=i/(total-1),uvs[index]=amount*factor.x+offset.x,uvs[index+1]=0+offset.y,uvs[index+2]=amount*factor.x+offset.x,uvs[index+3]=1*factor.y+offset.y,index=2*i,colors[index]=1,colors[index+1]=1,index=2*i,indices[index]=index,indices[index+1]=index+1;this.dirty=!0}},Rope.prototype._onTextureUpdate=function(){Mesh.prototype._onTextureUpdate.call(this),this._ready&&this.refresh()},Rope.prototype.updateTransform=function(){var points=this.points;if(!(points.length<1)){for(var nextPoint,point,index,ratio,perpLength,num,lastPoint=points[0],perpX=0,perpY=0,vertices=this.vertices,total=points.length,i=0;total>i;i++)point=points[i],index=4*i,nextPoint=i<points.length-1?points[i+1]:point,perpY=-(nextPoint.x-lastPoint.x),perpX=nextPoint.y-lastPoint.y,ratio=10*(1-i/(total-1)),ratio>1&&(ratio=1),perpLength=Math.sqrt(perpX*perpX+perpY*perpY),num=this._texture.height/2,perpX/=perpLength,perpY/=perpLength,perpX*=num,perpY*=num,vertices[index]=point.x+perpX,vertices[index+1]=point.y+perpY,vertices[index+2]=point.x-perpX,vertices[index+3]=point.y-perpY,lastPoint=point;this.containerUpdateTransform()}}},{"../core":36,"./Mesh":131}],133:[function(require,module,exports){module.exports={Mesh:require("./Mesh"),Rope:require("./Rope"),MeshRenderer:require("./webgl/MeshRenderer"),MeshShader:require("./webgl/MeshShader")}},{"./Mesh":131,"./Rope":132,"./webgl/MeshRenderer":134,"./webgl/MeshShader":135}],134:[function(require,module,exports){function MeshRenderer(renderer){core.ObjectRenderer.call(this,renderer),this.indices=new Uint16Array(15e3);for(var i=0,j=0;15e3>i;i+=6,j+=4)this.indices[i+0]=j+0,this.indices[i+1]=j+1,this.indices[i+2]=j+2,this.indices[i+3]=j+0,this.indices[i+4]=j+2,this.indices[i+5]=j+3}var core=require("../../core"),Mesh=require("../Mesh");MeshRenderer.prototype=Object.create(core.ObjectRenderer.prototype),MeshRenderer.prototype.constructor=MeshRenderer,module.exports=MeshRenderer,core.WebGLRenderer.registerPlugin("mesh",MeshRenderer),MeshRenderer.prototype.onContextChange=function(){},MeshRenderer.prototype.render=function(mesh){mesh._vertexBuffer||this._initWebGL(mesh);var renderer=this.renderer,gl=renderer.gl,texture=mesh._texture.baseTexture,shader=renderer.shaderManager.plugins.meshShader,drawMode=mesh.drawMode===Mesh.DRAW_MODES.TRIANGLE_MESH?gl.TRIANGLE_STRIP:gl.TRIANGLES;renderer.blendModeManager.setBlendMode(mesh.blendMode),gl.uniformMatrix3fv(shader.uniforms.translationMatrix._location,!1,mesh.worldTransform.toArray(!0)),gl.uniformMatrix3fv(shader.uniforms.projectionMatrix._location,!1,renderer.currentRenderTarget.projectionMatrix.toArray(!0)),gl.uniform1f(shader.uniforms.alpha._location,mesh.worldAlpha),mesh.dirty?(mesh.dirty=!1,gl.bindBuffer(gl.ARRAY_BUFFER,mesh._vertexBuffer),gl.bufferData(gl.ARRAY_BUFFER,mesh.vertices,gl.STATIC_DRAW),gl.vertexAttribPointer(shader.attributes.aVertexPosition,2,gl.FLOAT,!1,0,0),gl.bindBuffer(gl.ARRAY_BUFFER,mesh._uvBuffer),gl.bufferData(gl.ARRAY_BUFFER,mesh.uvs,gl.STATIC_DRAW),gl.vertexAttribPointer(shader.attributes.aTextureCoord,2,gl.FLOAT,!1,0,0),gl.activeTexture(gl.TEXTURE0),texture._glTextures[gl.id]?gl.bindTexture(gl.TEXTURE_2D,texture._glTextures[gl.id]):this.renderer.updateTexture(texture),gl.bindBuffer(gl.ELEMENT_ARRAY_BUFFER,mesh._indexBuffer),gl.bufferData(gl.ELEMENT_ARRAY_BUFFER,mesh.indices,gl.STATIC_DRAW)):(gl.bindBuffer(gl.ARRAY_BUFFER,mesh._vertexBuffer),gl.bufferSubData(gl.ARRAY_BUFFER,0,mesh.vertices),gl.vertexAttribPointer(shader.attributes.aVertexPosition,2,gl.FLOAT,!1,0,0),gl.bindBuffer(gl.ARRAY_BUFFER,mesh._uvBuffer),gl.vertexAttribPointer(shader.attributes.aTextureCoord,2,gl.FLOAT,!1,0,0),gl.activeTexture(gl.TEXTURE0),texture._glTextures[gl.id]?gl.bindTexture(gl.TEXTURE_2D,texture._glTextures[gl.id]):this.renderer.updateTexture(texture),gl.bindBuffer(gl.ELEMENT_ARRAY_BUFFER,mesh._indexBuffer),gl.bufferSubData(gl.ELEMENT_ARRAY_BUFFER,0,mesh.indices)),gl.drawElements(drawMode,mesh.indices.length,gl.UNSIGNED_SHORT,0)},MeshRenderer.prototype._initWebGL=function(mesh){var gl=this.renderer.gl;mesh._vertexBuffer=gl.createBuffer(),mesh._indexBuffer=gl.createBuffer(),mesh._uvBuffer=gl.createBuffer(),gl.bindBuffer(gl.ARRAY_BUFFER,mesh._vertexBuffer),gl.bufferData(gl.ARRAY_BUFFER,mesh.vertices,gl.DYNAMIC_DRAW),gl.bindBuffer(gl.ARRAY_BUFFER,mesh._uvBuffer),gl.bufferData(gl.ARRAY_BUFFER,mesh.uvs,gl.STATIC_DRAW),mesh.colors&&(mesh._colorBuffer=gl.createBuffer(),gl.bindBuffer(gl.ARRAY_BUFFER,mesh._colorBuffer),gl.bufferData(gl.ARRAY_BUFFER,mesh.colors,gl.STATIC_DRAW)),gl.bindBuffer(gl.ELEMENT_ARRAY_BUFFER,mesh._indexBuffer),gl.bufferData(gl.ELEMENT_ARRAY_BUFFER,mesh.indices,gl.STATIC_DRAW)},MeshRenderer.prototype.flush=function(){},MeshRenderer.prototype.start=function(){var shader=this.renderer.shaderManager.plugins.meshShader;this.renderer.shaderManager.setShader(shader)},MeshRenderer.prototype.destroy=function(){core.ObjectRenderer.prototype.destroy.call(this)}},{"../../core":36,"../Mesh":131}],135:[function(require,module,exports){function MeshShader(shaderManager){core.Shader.call(this,shaderManager,["precision lowp float;","attribute vec2 aVertexPosition;","attribute vec2 aTextureCoord;","uniform mat3 translationMatrix;","uniform mat3 projectionMatrix;","varying vec2 vTextureCoord;","void main(void){","   gl_Position = vec4((projectionMatrix * translationMatrix * vec3(aVertexPosition, 1.0)).xy, 0.0, 1.0);","   vTextureCoord = aTextureCoord;","}"].join("\n"),["precision lowp float;","varying vec2 vTextureCoord;","uniform float alpha;","uniform sampler2D uSampler;","void main(void){","   gl_FragColor = texture2D(uSampler, vTextureCoord) * alpha ;","}"].join("\n"),{alpha:{type:"1f",value:0},translationMatrix:{type:"mat3",value:new Float32Array(9)},projectionMatrix:{type:"mat3",value:new Float32Array(9)}},{aVertexPosition:0,aTextureCoord:0})}var core=require("../../core");MeshShader.prototype=Object.create(core.Shader.prototype),MeshShader.prototype.constructor=MeshShader,module.exports=MeshShader,core.ShaderManager.registerPlugin("meshShader",MeshShader)},{"../../core":36}],136:[function(require,module,exports){Math.sign||(Math.sign=function(x){return x=+x,0===x||isNaN(x)?x:x>0?1:-1})},{}],137:[function(require,module,exports){Object.assign||(Object.assign=require("object-assign"))},{"object-assign":26}],138:[function(require,module,exports){require("./Object.assign"),require("./requestAnimationFrame"),require("./Math.sign")},{"./Math.sign":136,"./Object.assign":137,"./requestAnimationFrame":139}],139:[function(require,module,exports){(function(global){if(Date.now&&Date.prototype.getTime||(Date.now=function(){return(new Date).getTime()}),!global.performance||!global.performance.now){var startTime=Date.now();global.performance||(global.performance={}),global.performance.now=function(){return Date.now()-startTime}}for(var lastTime=Date.now(),vendors=["ms","moz","webkit","o"],x=0;x<vendors.length&&!global.requestAnimationFrame;++x)global.requestAnimationFrame=global[vendors[x]+"RequestAnimationFrame"],global.cancelAnimationFrame=global[vendors[x]+"CancelAnimationFrame"]||global[vendors[x]+"CancelRequestAnimationFrame"];global.requestAnimationFrame||(global.requestAnimationFrame=function(callback){if("function"!=typeof callback)throw new TypeError(callback+"is not a function");var currentTime=Date.now(),delay=16+lastTime-currentTime;return 0>delay&&(delay=0),lastTime=currentTime,setTimeout(function(){lastTime=Date.now(),callback(performance.now())},delay)}),global.cancelAnimationFrame||(global.cancelAnimationFrame=function(id){clearTimeout(id)})}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{}],140:[function(require,module,exports){function cleanUpNextTick(){draining=!1,currentQueue.length?queue=currentQueue.concat(queue):queueIndex=-1,queue.length&&drainQueue()}function drainQueue(){if(!draining){var timeout=setTimeout(cleanUpNextTick);draining=!0;for(var len=queue.length;len;){for(currentQueue=queue,queue=[];++queueIndex<len;)currentQueue&&currentQueue[queueIndex].run();queueIndex=-1,len=queue.length}currentQueue=null,draining=!1,clearTimeout(timeout)}}function Item(fun,array){this.fun=fun,this.array=array}function noop(){}var currentQueue,process=module.exports={},queue=[],draining=!1,queueIndex=-1;process.nextTick=function(fun){var args=new Array(arguments.length-1);if(arguments.length>1)for(var i=1;i<arguments.length;i++)args[i-1]=arguments[i];queue.push(new Item(fun,args)),1!==queue.length||draining||setTimeout(drainQueue,0)},Item.prototype.run=function(){this.fun.apply(null,this.array)},process.title="browser",process.browser=!0,process.env={},process.argv=[],process.version="",process.versions={},process.on=noop,process.addListener=noop,process.once=noop,process.off=noop,process.removeListener=noop,process.removeAllListeners=noop,process.emit=noop,process.binding=function(name){throw new Error("process.binding is not supported")},process.cwd=function(){return"/"},process.chdir=function(dir){throw new Error("process.chdir is not supported")},process.umask=function(){return 0}},{}],141:[function(require,module,exports){(function(global){!function(root){function error(type){throw RangeError(errors[type])}function map(array,fn){for(var length=array.length,result=[];length--;)result[length]=fn(array[length]);return result}function mapDomain(string,fn){var parts=string.split("@"),result="";parts.length>1&&(result=parts[0]+"@",string=parts[1]),string=string.replace(regexSeparators,".");var labels=string.split("."),encoded=map(labels,fn).join(".");return result+encoded}function ucs2decode(string){for(var value,extra,output=[],counter=0,length=string.length;length>counter;)value=string.charCodeAt(counter++),value>=55296&&56319>=value&&length>counter?(extra=string.charCodeAt(counter++),56320==(64512&extra)?output.push(((1023&value)<<10)+(1023&extra)+65536):(output.push(value),counter--)):output.push(value);return output}function ucs2encode(array){return map(array,function(value){var output="";return value>65535&&(value-=65536,output+=stringFromCharCode(value>>>10&1023|55296),value=56320|1023&value),output+=stringFromCharCode(value)}).join("")}function basicToDigit(codePoint){return 10>codePoint-48?codePoint-22:26>codePoint-65?codePoint-65:26>codePoint-97?codePoint-97:base}function digitToBasic(digit,flag){return digit+22+75*(26>digit)-((0!=flag)<<5)}function adapt(delta,numPoints,firstTime){var k=0;for(delta=firstTime?floor(delta/damp):delta>>1,delta+=floor(delta/numPoints);delta>baseMinusTMin*tMax>>1;k+=base)delta=floor(delta/baseMinusTMin);return floor(k+(baseMinusTMin+1)*delta/(delta+skew))}function decode(input){var out,basic,j,index,oldi,w,k,digit,t,baseMinusT,output=[],inputLength=input.length,i=0,n=initialN,bias=initialBias;for(basic=input.lastIndexOf(delimiter),0>basic&&(basic=0),j=0;basic>j;++j)input.charCodeAt(j)>=128&&error("not-basic"),output.push(input.charCodeAt(j));for(index=basic>0?basic+1:0;inputLength>index;){for(oldi=i,w=1,k=base;index>=inputLength&&error("invalid-input"),digit=basicToDigit(input.charCodeAt(index++)),(digit>=base||digit>floor((maxInt-i)/w))&&error("overflow"),i+=digit*w,t=bias>=k?tMin:k>=bias+tMax?tMax:k-bias,!(t>digit);k+=base)baseMinusT=base-t,w>floor(maxInt/baseMinusT)&&error("overflow"),w*=baseMinusT;out=output.length+1,bias=adapt(i-oldi,out,0==oldi),floor(i/out)>maxInt-n&&error("overflow"),n+=floor(i/out),i%=out,output.splice(i++,0,n)}return ucs2encode(output)}function encode(input){var n,delta,handledCPCount,basicLength,bias,j,m,q,k,t,currentValue,inputLength,handledCPCountPlusOne,baseMinusT,qMinusT,output=[];for(input=ucs2decode(input),inputLength=input.length,n=initialN,delta=0,bias=initialBias,j=0;inputLength>j;++j)currentValue=input[j],128>currentValue&&output.push(stringFromCharCode(currentValue));for(handledCPCount=basicLength=output.length,basicLength&&output.push(delimiter);inputLength>handledCPCount;){for(m=maxInt,j=0;inputLength>j;++j)currentValue=input[j],currentValue>=n&&m>currentValue&&(m=currentValue);for(handledCPCountPlusOne=handledCPCount+1,m-n>floor((maxInt-delta)/handledCPCountPlusOne)&&error("overflow"),delta+=(m-n)*handledCPCountPlusOne,n=m,j=0;inputLength>j;++j)if(currentValue=input[j],n>currentValue&&++delta>maxInt&&error("overflow"),currentValue==n){for(q=delta,k=base;t=bias>=k?tMin:k>=bias+tMax?tMax:k-bias,!(t>q);k+=base)qMinusT=q-t,baseMinusT=base-t,output.push(stringFromCharCode(digitToBasic(t+qMinusT%baseMinusT,0))),q=floor(qMinusT/baseMinusT);output.push(stringFromCharCode(digitToBasic(q,0))),bias=adapt(delta,handledCPCountPlusOne,handledCPCount==basicLength),delta=0,++handledCPCount}++delta,++n}return output.join("")}function toUnicode(input){return mapDomain(input,function(string){return regexPunycode.test(string)?decode(string.slice(4).toLowerCase()):string})}function toASCII(input){return mapDomain(input,function(string){return regexNonASCII.test(string)?"xn--"+encode(string):string})}var freeExports="object"==typeof exports&&exports&&!exports.nodeType&&exports,freeModule="object"==typeof module&&module&&!module.nodeType&&module,freeGlobal="object"==typeof global&&global;(freeGlobal.global===freeGlobal||freeGlobal.window===freeGlobal||freeGlobal.self===freeGlobal)&&(root=freeGlobal);var punycode,key,maxInt=2147483647,base=36,tMin=1,tMax=26,skew=38,damp=700,initialBias=72,initialN=128,delimiter="-",regexPunycode=/^xn--/,regexNonASCII=/[^\x20-\x7E]/,regexSeparators=/[\x2E\u3002\uFF0E\uFF61]/g,errors={overflow:"Overflow: input needs wider integers to process","not-basic":"Illegal input >= 0x80 (not a basic code point)","invalid-input":"Invalid input"},baseMinusTMin=base-tMin,floor=Math.floor,stringFromCharCode=String.fromCharCode;if(punycode={version:"1.3.2",ucs2:{decode:ucs2decode,encode:ucs2encode},decode:decode,encode:encode,toASCII:toASCII,toUnicode:toUnicode},"function"==typeof define&&"object"==typeof define.amd&&define.amd)define("punycode",function(){return punycode});else if(freeExports&&freeModule)if(module.exports==freeExports)freeModule.exports=punycode;else for(key in punycode)punycode.hasOwnProperty(key)&&(freeExports[key]=punycode[key]);else root.punycode=punycode}(this)}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{}],142:[function(require,module,exports){"use strict";function hasOwnProperty(obj,prop){return Object.prototype.hasOwnProperty.call(obj,prop)}module.exports=function(qs,sep,eq,options){sep=sep||"&",eq=eq||"=";var obj={};if("string"!=typeof qs||0===qs.length)return obj;var regexp=/\+/g;qs=qs.split(sep);var maxKeys=1e3;options&&"number"==typeof options.maxKeys&&(maxKeys=options.maxKeys);var len=qs.length;maxKeys>0&&len>maxKeys&&(len=maxKeys);for(var i=0;len>i;++i){var kstr,vstr,k,v,x=qs[i].replace(regexp,"%20"),idx=x.indexOf(eq);idx>=0?(kstr=x.substr(0,idx),vstr=x.substr(idx+1)):(kstr=x,vstr=""),k=decodeURIComponent(kstr),v=decodeURIComponent(vstr),hasOwnProperty(obj,k)?isArray(obj[k])?obj[k].push(v):obj[k]=[obj[k],v]:obj[k]=v}return obj};var isArray=Array.isArray||function(xs){return"[object Array]"===Object.prototype.toString.call(xs)}},{}],143:[function(require,module,exports){"use strict";function map(xs,f){if(xs.map)return xs.map(f);for(var res=[],i=0;i<xs.length;i++)res.push(f(xs[i],i));return res}var stringifyPrimitive=function(v){switch(typeof v){case"string":return v;case"boolean":return v?"true":"false";case"number":return isFinite(v)?v:"";default:return""}};module.exports=function(obj,sep,eq,name){return sep=sep||"&",eq=eq||"=",null===obj&&(obj=void 0),"object"==typeof obj?map(objectKeys(obj),function(k){var ks=encodeURIComponent(stringifyPrimitive(k))+eq;
return isArray(obj[k])?map(obj[k],function(v){return ks+encodeURIComponent(stringifyPrimitive(v))}).join(sep):ks+encodeURIComponent(stringifyPrimitive(obj[k]))}).join(sep):name?encodeURIComponent(stringifyPrimitive(name))+eq+encodeURIComponent(stringifyPrimitive(obj)):""};var isArray=Array.isArray||function(xs){return"[object Array]"===Object.prototype.toString.call(xs)},objectKeys=Object.keys||function(obj){var res=[];for(var key in obj)Object.prototype.hasOwnProperty.call(obj,key)&&res.push(key);return res}},{}],144:[function(require,module,exports){"use strict";exports.decode=exports.parse=require("./decode"),exports.encode=exports.stringify=require("./encode")},{"./decode":142,"./encode":143}],145:[function(require,module,exports){(function(process){!function(){function only_once(fn){var called=!1;return function(){if(called)throw new Error("Callback was already called.");called=!0,fn.apply(root,arguments)}}var root,previous_async,async={};root=this,null!=root&&(previous_async=root.async),async.noConflict=function(){return root.async=previous_async,async};var _toString=Object.prototype.toString,_isArray=Array.isArray||function(obj){return"[object Array]"===_toString.call(obj)},_each=function(arr,iterator){for(var i=0;i<arr.length;i+=1)iterator(arr[i],i,arr)},_map=function(arr,iterator){if(arr.map)return arr.map(iterator);var results=[];return _each(arr,function(x,i,a){results.push(iterator(x,i,a))}),results},_reduce=function(arr,iterator,memo){return arr.reduce?arr.reduce(iterator,memo):(_each(arr,function(x,i,a){memo=iterator(memo,x,i,a)}),memo)},_keys=function(obj){if(Object.keys)return Object.keys(obj);var keys=[];for(var k in obj)obj.hasOwnProperty(k)&&keys.push(k);return keys};"undefined"!=typeof process&&process.nextTick?(async.nextTick=process.nextTick,"undefined"!=typeof setImmediate?async.setImmediate=function(fn){setImmediate(fn)}:async.setImmediate=async.nextTick):"function"==typeof setImmediate?(async.nextTick=function(fn){setImmediate(fn)},async.setImmediate=async.nextTick):(async.nextTick=function(fn){setTimeout(fn,0)},async.setImmediate=async.nextTick),async.each=function(arr,iterator,callback){function done(err){err?(callback(err),callback=function(){}):(completed+=1,completed>=arr.length&&callback())}if(callback=callback||function(){},!arr.length)return callback();var completed=0;_each(arr,function(x){iterator(x,only_once(done))})},async.forEach=async.each,async.eachSeries=function(arr,iterator,callback){if(callback=callback||function(){},!arr.length)return callback();var completed=0,iterate=function(){iterator(arr[completed],function(err){err?(callback(err),callback=function(){}):(completed+=1,completed>=arr.length?callback():iterate())})};iterate()},async.forEachSeries=async.eachSeries,async.eachLimit=function(arr,limit,iterator,callback){var fn=_eachLimit(limit);fn.apply(null,[arr,iterator,callback])},async.forEachLimit=async.eachLimit;var _eachLimit=function(limit){return function(arr,iterator,callback){if(callback=callback||function(){},!arr.length||0>=limit)return callback();var completed=0,started=0,running=0;!function replenish(){if(completed>=arr.length)return callback();for(;limit>running&&started<arr.length;)started+=1,running+=1,iterator(arr[started-1],function(err){err?(callback(err),callback=function(){}):(completed+=1,running-=1,completed>=arr.length?callback():replenish())})}()}},doParallel=function(fn){return function(){var args=Array.prototype.slice.call(arguments);return fn.apply(null,[async.each].concat(args))}},doParallelLimit=function(limit,fn){return function(){var args=Array.prototype.slice.call(arguments);return fn.apply(null,[_eachLimit(limit)].concat(args))}},doSeries=function(fn){return function(){var args=Array.prototype.slice.call(arguments);return fn.apply(null,[async.eachSeries].concat(args))}},_asyncMap=function(eachfn,arr,iterator,callback){if(arr=_map(arr,function(x,i){return{index:i,value:x}}),callback){var results=[];eachfn(arr,function(x,callback){iterator(x.value,function(err,v){results[x.index]=v,callback(err)})},function(err){callback(err,results)})}else eachfn(arr,function(x,callback){iterator(x.value,function(err){callback(err)})})};async.map=doParallel(_asyncMap),async.mapSeries=doSeries(_asyncMap),async.mapLimit=function(arr,limit,iterator,callback){return _mapLimit(limit)(arr,iterator,callback)};var _mapLimit=function(limit){return doParallelLimit(limit,_asyncMap)};async.reduce=function(arr,memo,iterator,callback){async.eachSeries(arr,function(x,callback){iterator(memo,x,function(err,v){memo=v,callback(err)})},function(err){callback(err,memo)})},async.inject=async.reduce,async.foldl=async.reduce,async.reduceRight=function(arr,memo,iterator,callback){var reversed=_map(arr,function(x){return x}).reverse();async.reduce(reversed,memo,iterator,callback)},async.foldr=async.reduceRight;var _filter=function(eachfn,arr,iterator,callback){var results=[];arr=_map(arr,function(x,i){return{index:i,value:x}}),eachfn(arr,function(x,callback){iterator(x.value,function(v){v&&results.push(x),callback()})},function(err){callback(_map(results.sort(function(a,b){return a.index-b.index}),function(x){return x.value}))})};async.filter=doParallel(_filter),async.filterSeries=doSeries(_filter),async.select=async.filter,async.selectSeries=async.filterSeries;var _reject=function(eachfn,arr,iterator,callback){var results=[];arr=_map(arr,function(x,i){return{index:i,value:x}}),eachfn(arr,function(x,callback){iterator(x.value,function(v){v||results.push(x),callback()})},function(err){callback(_map(results.sort(function(a,b){return a.index-b.index}),function(x){return x.value}))})};async.reject=doParallel(_reject),async.rejectSeries=doSeries(_reject);var _detect=function(eachfn,arr,iterator,main_callback){eachfn(arr,function(x,callback){iterator(x,function(result){result?(main_callback(x),main_callback=function(){}):callback()})},function(err){main_callback()})};async.detect=doParallel(_detect),async.detectSeries=doSeries(_detect),async.some=function(arr,iterator,main_callback){async.each(arr,function(x,callback){iterator(x,function(v){v&&(main_callback(!0),main_callback=function(){}),callback()})},function(err){main_callback(!1)})},async.any=async.some,async.every=function(arr,iterator,main_callback){async.each(arr,function(x,callback){iterator(x,function(v){v||(main_callback(!1),main_callback=function(){}),callback()})},function(err){main_callback(!0)})},async.all=async.every,async.sortBy=function(arr,iterator,callback){async.map(arr,function(x,callback){iterator(x,function(err,criteria){err?callback(err):callback(null,{value:x,criteria:criteria})})},function(err,results){if(err)return callback(err);var fn=function(left,right){var a=left.criteria,b=right.criteria;return b>a?-1:a>b?1:0};callback(null,_map(results.sort(fn),function(x){return x.value}))})},async.auto=function(tasks,callback){callback=callback||function(){};var keys=_keys(tasks),remainingTasks=keys.length;if(!remainingTasks)return callback();var results={},listeners=[],addListener=function(fn){listeners.unshift(fn)},removeListener=function(fn){for(var i=0;i<listeners.length;i+=1)if(listeners[i]===fn)return void listeners.splice(i,1)},taskComplete=function(){remainingTasks--,_each(listeners.slice(0),function(fn){fn()})};addListener(function(){if(!remainingTasks){var theCallback=callback;callback=function(){},theCallback(null,results)}}),_each(keys,function(k){var task=_isArray(tasks[k])?tasks[k]:[tasks[k]],taskCallback=function(err){var args=Array.prototype.slice.call(arguments,1);if(args.length<=1&&(args=args[0]),err){var safeResults={};_each(_keys(results),function(rkey){safeResults[rkey]=results[rkey]}),safeResults[k]=args,callback(err,safeResults),callback=function(){}}else results[k]=args,async.setImmediate(taskComplete)},requires=task.slice(0,Math.abs(task.length-1))||[],ready=function(){return _reduce(requires,function(a,x){return a&&results.hasOwnProperty(x)},!0)&&!results.hasOwnProperty(k)};if(ready())task[task.length-1](taskCallback,results);else{var listener=function(){ready()&&(removeListener(listener),task[task.length-1](taskCallback,results))};addListener(listener)}})},async.retry=function(times,task,callback){var DEFAULT_TIMES=5,attempts=[];"function"==typeof times&&(callback=task,task=times,times=DEFAULT_TIMES),times=parseInt(times,10)||DEFAULT_TIMES;var wrappedTask=function(wrappedCallback,wrappedResults){for(var retryAttempt=function(task,finalAttempt){return function(seriesCallback){task(function(err,result){seriesCallback(!err||finalAttempt,{err:err,result:result})},wrappedResults)}};times;)attempts.push(retryAttempt(task,!(times-=1)));async.series(attempts,function(done,data){data=data[data.length-1],(wrappedCallback||callback)(data.err,data.result)})};return callback?wrappedTask():wrappedTask},async.waterfall=function(tasks,callback){if(callback=callback||function(){},!_isArray(tasks)){var err=new Error("First argument to waterfall must be an array of functions");return callback(err)}if(!tasks.length)return callback();var wrapIterator=function(iterator){return function(err){if(err)callback.apply(null,arguments),callback=function(){};else{var args=Array.prototype.slice.call(arguments,1),next=iterator.next();next?args.push(wrapIterator(next)):args.push(callback),async.setImmediate(function(){iterator.apply(null,args)})}}};wrapIterator(async.iterator(tasks))()};var _parallel=function(eachfn,tasks,callback){if(callback=callback||function(){},_isArray(tasks))eachfn.map(tasks,function(fn,callback){fn&&fn(function(err){var args=Array.prototype.slice.call(arguments,1);args.length<=1&&(args=args[0]),callback.call(null,err,args)})},callback);else{var results={};eachfn.each(_keys(tasks),function(k,callback){tasks[k](function(err){var args=Array.prototype.slice.call(arguments,1);args.length<=1&&(args=args[0]),results[k]=args,callback(err)})},function(err){callback(err,results)})}};async.parallel=function(tasks,callback){_parallel({map:async.map,each:async.each},tasks,callback)},async.parallelLimit=function(tasks,limit,callback){_parallel({map:_mapLimit(limit),each:_eachLimit(limit)},tasks,callback)},async.series=function(tasks,callback){if(callback=callback||function(){},_isArray(tasks))async.mapSeries(tasks,function(fn,callback){fn&&fn(function(err){var args=Array.prototype.slice.call(arguments,1);args.length<=1&&(args=args[0]),callback.call(null,err,args)})},callback);else{var results={};async.eachSeries(_keys(tasks),function(k,callback){tasks[k](function(err){var args=Array.prototype.slice.call(arguments,1);args.length<=1&&(args=args[0]),results[k]=args,callback(err)})},function(err){callback(err,results)})}},async.iterator=function(tasks){var makeCallback=function(index){var fn=function(){return tasks.length&&tasks[index].apply(null,arguments),fn.next()};return fn.next=function(){return index<tasks.length-1?makeCallback(index+1):null},fn};return makeCallback(0)},async.apply=function(fn){var args=Array.prototype.slice.call(arguments,1);return function(){return fn.apply(null,args.concat(Array.prototype.slice.call(arguments)))}};var _concat=function(eachfn,arr,fn,callback){var r=[];eachfn(arr,function(x,cb){fn(x,function(err,y){r=r.concat(y||[]),cb(err)})},function(err){callback(err,r)})};async.concat=doParallel(_concat),async.concatSeries=doSeries(_concat),async.whilst=function(test,iterator,callback){test()?iterator(function(err){return err?callback(err):void async.whilst(test,iterator,callback)}):callback()},async.doWhilst=function(iterator,test,callback){iterator(function(err){if(err)return callback(err);var args=Array.prototype.slice.call(arguments,1);test.apply(null,args)?async.doWhilst(iterator,test,callback):callback()})},async.until=function(test,iterator,callback){test()?callback():iterator(function(err){return err?callback(err):void async.until(test,iterator,callback)})},async.doUntil=function(iterator,test,callback){iterator(function(err){if(err)return callback(err);var args=Array.prototype.slice.call(arguments,1);test.apply(null,args)?callback():async.doUntil(iterator,test,callback)})},async.queue=function(worker,concurrency){function _insert(q,data,pos,callback){return q.started||(q.started=!0),_isArray(data)||(data=[data]),0==data.length?async.setImmediate(function(){q.drain&&q.drain()}):void _each(data,function(task){var item={data:task,callback:"function"==typeof callback?callback:null};pos?q.tasks.unshift(item):q.tasks.push(item),q.saturated&&q.tasks.length===q.concurrency&&q.saturated(),async.setImmediate(q.process)})}void 0===concurrency&&(concurrency=1);var workers=0,q={tasks:[],concurrency:concurrency,saturated:null,empty:null,drain:null,started:!1,paused:!1,push:function(data,callback){_insert(q,data,!1,callback)},kill:function(){q.drain=null,q.tasks=[]},unshift:function(data,callback){_insert(q,data,!0,callback)},process:function(){if(!q.paused&&workers<q.concurrency&&q.tasks.length){var task=q.tasks.shift();q.empty&&0===q.tasks.length&&q.empty(),workers+=1;var next=function(){workers-=1,task.callback&&task.callback.apply(task,arguments),q.drain&&q.tasks.length+workers===0&&q.drain(),q.process()},cb=only_once(next);worker(task.data,cb)}},length:function(){return q.tasks.length},running:function(){return workers},idle:function(){return q.tasks.length+workers===0},pause:function(){q.paused!==!0&&(q.paused=!0)},resume:function(){if(q.paused!==!1){q.paused=!1;for(var w=1;w<=q.concurrency;w++)async.setImmediate(q.process)}}};return q},async.priorityQueue=function(worker,concurrency){function _compareTasks(a,b){return a.priority-b.priority}function _binarySearch(sequence,item,compare){for(var beg=-1,end=sequence.length-1;end>beg;){var mid=beg+(end-beg+1>>>1);compare(item,sequence[mid])>=0?beg=mid:end=mid-1}return beg}function _insert(q,data,priority,callback){return q.started||(q.started=!0),_isArray(data)||(data=[data]),0==data.length?async.setImmediate(function(){q.drain&&q.drain()}):void _each(data,function(task){var item={data:task,priority:priority,callback:"function"==typeof callback?callback:null};q.tasks.splice(_binarySearch(q.tasks,item,_compareTasks)+1,0,item),q.saturated&&q.tasks.length===q.concurrency&&q.saturated(),async.setImmediate(q.process)})}var q=async.queue(worker,concurrency);return q.push=function(data,priority,callback){_insert(q,data,priority,callback)},delete q.unshift,q},async.cargo=function(worker,payload){var working=!1,tasks=[],cargo={tasks:tasks,payload:payload,saturated:null,empty:null,drain:null,drained:!0,push:function(data,callback){_isArray(data)||(data=[data]),_each(data,function(task){tasks.push({data:task,callback:"function"==typeof callback?callback:null}),cargo.drained=!1,cargo.saturated&&tasks.length===payload&&cargo.saturated()}),async.setImmediate(cargo.process)},process:function process(){if(!working){if(0===tasks.length)return cargo.drain&&!cargo.drained&&cargo.drain(),void(cargo.drained=!0);var ts="number"==typeof payload?tasks.splice(0,payload):tasks.splice(0,tasks.length),ds=_map(ts,function(task){return task.data});cargo.empty&&cargo.empty(),working=!0,worker(ds,function(){working=!1;var args=arguments;_each(ts,function(data){data.callback&&data.callback.apply(null,args)}),process()})}},length:function(){return tasks.length},running:function(){return working}};return cargo};var _console_fn=function(name){return function(fn){var args=Array.prototype.slice.call(arguments,1);fn.apply(null,args.concat([function(err){var args=Array.prototype.slice.call(arguments,1);"undefined"!=typeof console&&(err?console.error&&console.error(err):console[name]&&_each(args,function(x){console[name](x)}))}]))}};async.log=_console_fn("log"),async.dir=_console_fn("dir"),async.memoize=function(fn,hasher){var memo={},queues={};hasher=hasher||function(x){return x};var memoized=function(){var args=Array.prototype.slice.call(arguments),callback=args.pop(),key=hasher.apply(null,args);key in memo?async.nextTick(function(){callback.apply(null,memo[key])}):key in queues?queues[key].push(callback):(queues[key]=[callback],fn.apply(null,args.concat([function(){memo[key]=arguments;var q=queues[key];delete queues[key];for(var i=0,l=q.length;l>i;i++)q[i].apply(null,arguments)}])))};return memoized.memo=memo,memoized.unmemoized=fn,memoized},async.unmemoize=function(fn){return function(){return(fn.unmemoized||fn).apply(null,arguments)}},async.times=function(count,iterator,callback){for(var counter=[],i=0;count>i;i++)counter.push(i);return async.map(counter,iterator,callback)},async.timesSeries=function(count,iterator,callback){for(var counter=[],i=0;count>i;i++)counter.push(i);return async.mapSeries(counter,iterator,callback)},async.seq=function(){var fns=arguments;return function(){var that=this,args=Array.prototype.slice.call(arguments),callback=args.pop();async.reduce(fns,args,function(newargs,fn,cb){fn.apply(that,newargs.concat([function(){var err=arguments[0],nextargs=Array.prototype.slice.call(arguments,1);cb(err,nextargs)}]))},function(err,results){callback.apply(that,[err].concat(results))})}},async.compose=function(){return async.seq.apply(null,Array.prototype.reverse.call(arguments))};var _applyEach=function(eachfn,fns){var go=function(){var that=this,args=Array.prototype.slice.call(arguments),callback=args.pop();return eachfn(fns,function(fn,cb){fn.apply(that,args.concat([cb]))},callback)};if(arguments.length>2){var args=Array.prototype.slice.call(arguments,2);return go.apply(this,args)}return go};async.applyEach=doParallel(_applyEach),async.applyEachSeries=doSeries(_applyEach),async.forever=function(fn,callback){function next(err){if(err){if(callback)return callback(err);throw err}fn(next)}next()},"undefined"!=typeof module&&module.exports?module.exports=async:"undefined"!=typeof define&&define.amd?define([],function(){return async}):root.async=async}()}).call(this,require("_process"))},{_process:140}],146:[function(require,module,exports){function Loader(baseUrl,concurrency){EventEmitter.call(this),concurrency=concurrency||10,this.baseUrl=baseUrl||"",this.progress=0,this.loading=!1,this._progressChunk=0,this._beforeMiddleware=[],this._afterMiddleware=[],this._boundLoadResource=this._loadResource.bind(this),this._boundOnLoad=this._onLoad.bind(this),this._buffer=[],this._numToLoad=0,this._queue=async.queue(this._boundLoadResource,concurrency),this.resources={}}var async=require("async"),urlParser=require("url"),Resource=require("./Resource"),EventEmitter=require("eventemitter3");Loader.prototype=Object.create(EventEmitter.prototype),Loader.prototype.constructor=Loader,module.exports=Loader,Loader.prototype.add=Loader.prototype.enqueue=function(name,url,options,cb){if(Array.isArray(name)){for(var i=0;i<name.length;++i)this.add(name[i]);return this}if("object"==typeof name&&(cb=url||name.callback||name.onComplete,options=name,url=name.url,name=name.name||name.key||name.url),"string"!=typeof url&&(cb=options,options=url,url=name),"string"!=typeof url)throw new Error("No url passed to add resource to loader.");if("function"==typeof options&&(cb=options,options=null),this.resources[name])throw new Error('Resource with name "'+name+'" already exists.');return url=this._handleBaseUrl(url),this.resources[name]=new Resource(name,url,options),"function"==typeof cb&&this.resources[name].once("afterMiddleware",cb),this._numToLoad++,this._queue.started?(this._queue.push(this.resources[name]),this._progressChunk=(100-this.progress)/(this._queue.length()+this._queue.running())):(this._buffer.push(this.resources[name]),this._progressChunk=100/this._buffer.length),this},Loader.prototype._handleBaseUrl=function(url){var parsedUrl=urlParser.parse(url);return parsedUrl.protocol||0===parsedUrl.pathname.indexOf("//")?url:this.baseUrl.length&&this.baseUrl.lastIndexOf("/")!==this.baseUrl.length-1&&url.lastIndexOf("/")!==url.length-1?this.baseUrl+"/"+url:this.baseUrl+url},Loader.prototype.before=Loader.prototype.pre=function(fn){return this._beforeMiddleware.push(fn),this},Loader.prototype.after=Loader.prototype.use=function(fn){return this._afterMiddleware.push(fn),this},Loader.prototype.reset=function(){this.progress=0,this.loading=!1,this._progressChunk=0,this._buffer.length=0,this._numToLoad=0,this._queue.kill(),this._queue.started=!1,this.resources={}},Loader.prototype.load=function(cb){if("function"==typeof cb&&this.once("complete",cb),this._queue.started)return this;this.emit("start",this);for(var i=0;i<this._buffer.length;++i)this._queue.push(this._buffer[i]);return this._buffer.length=0,this},Loader.prototype._loadResource=function(resource,dequeue){var self=this;resource._dequeue=dequeue,this._runMiddleware(resource,this._beforeMiddleware,function(){resource.load(self._boundOnLoad)})},Loader.prototype._onComplete=function(){this.emit("complete",this,this.resources)},Loader.prototype._onLoad=function(resource){this.progress+=this._progressChunk,this.emit("progress",this,resource),this._runMiddleware(resource,this._afterMiddleware,function(){resource.emit("afterMiddleware",resource),this._numToLoad--,0===this._numToLoad&&(this.progress=100,this._onComplete()),resource.error?this.emit("error",resource.error,this,resource):this.emit("load",this,resource)}),resource._dequeue()},Loader.prototype._runMiddleware=function(resource,fns,cb){var self=this;async.eachSeries(fns,function(fn,next){fn.call(self,resource,next)},cb.bind(this,resource))},Loader.LOAD_TYPE=Resource.LOAD_TYPE,Loader.XHR_READY_STATE=Resource.XHR_READY_STATE,Loader.XHR_RESPONSE_TYPE=Resource.XHR_RESPONSE_TYPE},{"./Resource":147,async:145,eventemitter3:22,url:152}],147:[function(require,module,exports){function Resource(name,url,options){if(EventEmitter.call(this),options=options||{},"string"!=typeof name||"string"!=typeof url)throw new Error("Both name and url are required for constructing a resource.");this.name=name,this.url=url,this.isDataUrl=0===this.url.indexOf("data:"),this.data=null,this.crossOrigin=options.crossOrigin===!0?"anonymous":null,this.loadType=options.loadType||this._determineLoadType(),this.xhrType=options.xhrType,this.error=null,this.xhr=null,this.isJson=!1,this.isXml=!1,this.isImage=!1,this.isAudio=!1,this.isVideo=!1,this._dequeue=null,this._boundComplete=this.complete.bind(this),this._boundOnError=this._onError.bind(this),this._boundOnProgress=this._onProgress.bind(this),this._boundXhrOnError=this._xhrOnError.bind(this),this._boundXhrOnAbort=this._xhrOnAbort.bind(this),this._boundXhrOnLoad=this._xhrOnLoad.bind(this),this._boundXdrOnTimeout=this._xdrOnTimeout.bind(this)}function reqType(xhr){return xhr.toString().replace("object ","")}function setExtMap(map,extname,val){extname&&0===extname.indexOf(".")&&(extname=extname.substring(1)),extname&&(map[extname]=val)}var EventEmitter=require("eventemitter3"),_url=require("url"),useXdr=!(!window.XDomainRequest||"withCredentials"in new XMLHttpRequest),tempAnchor=null;Resource.prototype=Object.create(EventEmitter.prototype),Resource.prototype.constructor=Resource,module.exports=Resource,Resource.prototype.complete=function(){this.data&&this.data.removeEventListener&&(this.data.removeEventListener("error",this._boundOnError),this.data.removeEventListener("load",this._boundComplete),this.data.removeEventListener("progress",this._boundOnProgress),this.data.removeEventListener("canplaythrough",this._boundComplete)),this.xhr&&(this.xhr.removeEventListener?(this.xhr.removeEventListener("error",this._boundXhrOnError),this.xhr.removeEventListener("abort",this._boundXhrOnAbort),this.xhr.removeEventListener("progress",this._boundOnProgress),this.xhr.removeEventListener("load",this._boundXhrOnLoad)):(this.xhr.onerror=null,this.xhr.ontimeout=null,this.xhr.onprogress=null,this.xhr.onload=null)),this.emit("complete",this)},Resource.prototype.load=function(cb){switch(this.emit("start",this),cb&&this.once("complete",cb),"string"!=typeof this.crossOrigin&&(this.crossOrigin=this._determineCrossOrigin(this.url)),this.loadType){case Resource.LOAD_TYPE.IMAGE:this._loadImage();break;case Resource.LOAD_TYPE.AUDIO:this._loadElement("audio");break;case Resource.LOAD_TYPE.VIDEO:this._loadElement("video");break;case Resource.LOAD_TYPE.XHR:default:useXdr&&this.crossOrigin?this._loadXdr():this._loadXhr()}},Resource.prototype._loadImage=function(){this.data=new Image,this.crossOrigin&&(this.data.crossOrigin=this.crossOrigin),this.data.src=this.url,this.isImage=!0,this.data.addEventListener("error",this._boundOnError,!1),this.data.addEventListener("load",this._boundComplete,!1),this.data.addEventListener("progress",this._boundOnProgress,!1)},Resource.prototype._loadElement=function(type){if("audio"===type&&"undefined"!=typeof Audio?this.data=new Audio:this.data=document.createElement(type),null===this.data)return this.error=new Error("Unsupported element "+type),void this.complete();if(navigator.isCocoonJS)this.data.src=Array.isArray(this.url)?this.url[0]:this.url;else if(Array.isArray(this.url))for(var i=0;i<this.url.length;++i)this.data.appendChild(this._createSource(type,this.url[i]));else this.data.appendChild(this._createSource(type,this.url));this["is"+type[0].toUpperCase()+type.substring(1)]=!0,this.data.addEventListener("error",this._boundOnError,!1),this.data.addEventListener("load",this._boundComplete,!1),this.data.addEventListener("progress",this._boundOnProgress,!1),this.data.addEventListener("canplaythrough",this._boundComplete,!1),this.data.load()},Resource.prototype._loadXhr=function(){"string"!=typeof this.xhrType&&(this.xhrType=this._determineXhrType());var xhr=this.xhr=new XMLHttpRequest;xhr.open("GET",this.url,!0),this.xhrType===Resource.XHR_RESPONSE_TYPE.JSON||this.xhrType===Resource.XHR_RESPONSE_TYPE.DOCUMENT?xhr.responseType=Resource.XHR_RESPONSE_TYPE.TEXT:xhr.responseType=this.xhrType,xhr.addEventListener("error",this._boundXhrOnError,!1),xhr.addEventListener("abort",this._boundXhrOnAbort,!1),xhr.addEventListener("progress",this._boundOnProgress,!1),xhr.addEventListener("load",this._boundXhrOnLoad,!1),xhr.send()},Resource.prototype._loadXdr=function(){"string"!=typeof this.xhrType&&(this.xhrType=this._determineXhrType());var xdr=this.xhr=new XDomainRequest;xdr.timeout=5e3,xdr.onerror=this._boundXhrOnError,xdr.ontimeout=this._boundXdrOnTimeout,xdr.onprogress=this._boundOnProgress,xdr.onload=this._boundXhrOnLoad,xdr.open("GET",this.url,!0),setTimeout(function(){xdr.send()},0)},Resource.prototype._createSource=function(type,url,mime){mime||(mime=type+"/"+url.substr(url.lastIndexOf(".")+1));var source=document.createElement("source");return source.src=url,source.type=mime,source},Resource.prototype._onError=function(event){this.error=new Error("Failed to load element using "+event.target.nodeName),this.complete()},Resource.prototype._onProgress=function(event){event&&event.lengthComputable&&this.emit("progress",this,event.loaded/event.total)},Resource.prototype._xhrOnError=function(){this.error=new Error(reqType(this.xhr)+" Request failed. Status: "+this.xhr.status+', text: "'+this.xhr.statusText+'"'),this.complete()},Resource.prototype._xhrOnAbort=function(){this.error=new Error(reqType(this.xhr)+" Request was aborted by the user."),this.complete()},Resource.prototype._xdrOnTimeout=function(){this.error=new Error(reqType(this.xhr)+" Request timed out."),this.complete()},Resource.prototype._xhrOnLoad=function(){var xhr=this.xhr,status=void 0!==xhr.status?xhr.status:200;if(200===status||204===status||0===status&&xhr.responseText.length>0)if(this.xhrType===Resource.XHR_RESPONSE_TYPE.TEXT)this.data=xhr.responseText;else if(this.xhrType===Resource.XHR_RESPONSE_TYPE.JSON)try{this.data=JSON.parse(xhr.responseText),this.isJson=!0}catch(e){this.error=new Error("Error trying to parse loaded json:",e)}else if(this.xhrType===Resource.XHR_RESPONSE_TYPE.DOCUMENT)try{if(window.DOMParser){var domparser=new DOMParser;this.data=domparser.parseFromString(xhr.responseText,"text/xml")}else{var div=document.createElement("div");div.innerHTML=xhr.responseText,this.data=div}this.isXml=!0}catch(e){this.error=new Error("Error trying to parse loaded xml:",e)}else this.data=xhr.response||xhr.responseText;else this.error=new Error("["+xhr.status+"]"+xhr.statusText+":"+xhr.responseURL);this.complete()},Resource.prototype._determineCrossOrigin=function(url,loc){if(0===url.indexOf("data:"))return"";loc=loc||window.location,tempAnchor||(tempAnchor=document.createElement("a")),tempAnchor.href=url,url=_url.parse(tempAnchor.href);var samePort=!url.port&&""===loc.port||url.port===loc.port;return url.hostname===loc.hostname&&samePort&&url.protocol===loc.protocol?"":"anonymous"},Resource.prototype._determineXhrType=function(){return Resource._xhrTypeMap[this._getExtension()]||Resource.XHR_RESPONSE_TYPE.TEXT},Resource.prototype._determineLoadType=function(){return Resource._loadTypeMap[this._getExtension()]||Resource.LOAD_TYPE.XHR},Resource.prototype._getExtension=function(){var ext,url=this.url;if(this.isDataUrl){var slashIndex=url.indexOf("/");ext=url.substring(slashIndex+1,url.indexOf(";",slashIndex))}else{var queryStart=url.indexOf("?");-1!==queryStart&&(url=url.substring(0,queryStart)),ext=url.substring(url.lastIndexOf(".")+1)}return ext},Resource.prototype._getMimeFromXhrType=function(type){switch(type){case Resource.XHR_RESPONSE_TYPE.BUFFER:return"application/octet-binary";case Resource.XHR_RESPONSE_TYPE.BLOB:return"application/blob";case Resource.XHR_RESPONSE_TYPE.DOCUMENT:return"application/xml";case Resource.XHR_RESPONSE_TYPE.JSON:return"application/json";case Resource.XHR_RESPONSE_TYPE.DEFAULT:case Resource.XHR_RESPONSE_TYPE.TEXT:default:return"text/plain"}},Resource.LOAD_TYPE={XHR:1,IMAGE:2,AUDIO:3,VIDEO:4},Resource.XHR_READY_STATE={UNSENT:0,OPENED:1,HEADERS_RECEIVED:2,LOADING:3,DONE:4},Resource.XHR_RESPONSE_TYPE={DEFAULT:"text",BUFFER:"arraybuffer",BLOB:"blob",DOCUMENT:"document",JSON:"json",TEXT:"text"},Resource._loadTypeMap={gif:Resource.LOAD_TYPE.IMAGE,png:Resource.LOAD_TYPE.IMAGE,bmp:Resource.LOAD_TYPE.IMAGE,jpg:Resource.LOAD_TYPE.IMAGE,jpeg:Resource.LOAD_TYPE.IMAGE,tif:Resource.LOAD_TYPE.IMAGE,tiff:Resource.LOAD_TYPE.IMAGE,webp:Resource.LOAD_TYPE.IMAGE,tga:Resource.LOAD_TYPE.IMAGE},Resource._xhrTypeMap={xhtml:Resource.XHR_RESPONSE_TYPE.DOCUMENT,html:Resource.XHR_RESPONSE_TYPE.DOCUMENT,htm:Resource.XHR_RESPONSE_TYPE.DOCUMENT,xml:Resource.XHR_RESPONSE_TYPE.DOCUMENT,tmx:Resource.XHR_RESPONSE_TYPE.DOCUMENT,tsx:Resource.XHR_RESPONSE_TYPE.DOCUMENT,svg:Resource.XHR_RESPONSE_TYPE.DOCUMENT,gif:Resource.XHR_RESPONSE_TYPE.BLOB,png:Resource.XHR_RESPONSE_TYPE.BLOB,bmp:Resource.XHR_RESPONSE_TYPE.BLOB,jpg:Resource.XHR_RESPONSE_TYPE.BLOB,jpeg:Resource.XHR_RESPONSE_TYPE.BLOB,tif:Resource.XHR_RESPONSE_TYPE.BLOB,tiff:Resource.XHR_RESPONSE_TYPE.BLOB,webp:Resource.XHR_RESPONSE_TYPE.BLOB,tga:Resource.XHR_RESPONSE_TYPE.BLOB,json:Resource.XHR_RESPONSE_TYPE.JSON,text:Resource.XHR_RESPONSE_TYPE.TEXT,txt:Resource.XHR_RESPONSE_TYPE.TEXT},Resource.setExtensionLoadType=function(extname,loadType){setExtMap(Resource._loadTypeMap,extname,loadType)},Resource.setExtensionXhrType=function(extname,xhrType){setExtMap(Resource._xhrTypeMap,extname,xhrType)}},{eventemitter3:22,url:152}],148:[function(require,module,exports){module.exports={_keyStr:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",encodeBinary:function(input){for(var bytebuffer,output="",encodedCharIndexes=new Array(4),inx=0,jnx=0,paddingBytes=0;inx<input.length;){for(bytebuffer=new Array(3),jnx=0;jnx<bytebuffer.length;jnx++)inx<input.length?bytebuffer[jnx]=255&input.charCodeAt(inx++):bytebuffer[jnx]=0;switch(encodedCharIndexes[0]=bytebuffer[0]>>2,encodedCharIndexes[1]=(3&bytebuffer[0])<<4|bytebuffer[1]>>4,encodedCharIndexes[2]=(15&bytebuffer[1])<<2|bytebuffer[2]>>6,encodedCharIndexes[3]=63&bytebuffer[2],paddingBytes=inx-(input.length-1)){case 2:encodedCharIndexes[3]=64,encodedCharIndexes[2]=64;break;case 1:encodedCharIndexes[3]=64}for(jnx=0;jnx<encodedCharIndexes.length;jnx++)output+=this._keyStr.charAt(encodedCharIndexes[jnx])}return output}}},{}],149:[function(require,module,exports){module.exports=require("./Loader"),module.exports.Resource=require("./Resource"),module.exports.middleware={caching:{memory:require("./middlewares/caching/memory")
},parsing:{blob:require("./middlewares/parsing/blob")}}},{"./Loader":146,"./Resource":147,"./middlewares/caching/memory":150,"./middlewares/parsing/blob":151}],150:[function(require,module,exports){var cache={};module.exports=function(){return function(resource,next){cache[resource.url]?(resource.data=cache[resource.url],resource.complete()):(resource.once("complete",function(){cache[this.url]=this.data}),next())}}},{}],151:[function(require,module,exports){var Resource=require("../../Resource"),b64=require("../../b64");window.URL=window.URL||window.webkitURL,module.exports=function(){return function(resource,next){if(!resource.data)return next();if(resource.xhr&&resource.xhrType===Resource.XHR_RESPONSE_TYPE.BLOB)if(window.Blob&&"string"!=typeof resource.data){if(0===resource.data.type.indexOf("image")){var src=URL.createObjectURL(resource.data);resource.blob=resource.data,resource.data=new Image,resource.data.src=src,resource.isImage=!0,resource.data.onload=function(){URL.revokeObjectURL(src),resource.data.onload=null,next()}}}else{var type=resource.xhr.getResponseHeader("content-type");type&&0===type.indexOf("image")&&(resource.data=new Image,resource.data.src="data:"+type+";base64,"+b64.encodeBinary(resource.xhr.responseText),resource.isImage=!0,resource.data.onload=function(){resource.data.onload=null,next()})}else next()}}},{"../../Resource":147,"../../b64":148}],152:[function(require,module,exports){"use strict";function Url(){this.protocol=null,this.slashes=null,this.auth=null,this.host=null,this.port=null,this.hostname=null,this.hash=null,this.search=null,this.query=null,this.pathname=null,this.path=null,this.href=null}function urlParse(url,parseQueryString,slashesDenoteHost){if(url&&util.isObject(url)&&url instanceof Url)return url;var u=new Url;return u.parse(url,parseQueryString,slashesDenoteHost),u}function urlFormat(obj){return util.isString(obj)&&(obj=urlParse(obj)),obj instanceof Url?obj.format():Url.prototype.format.call(obj)}function urlResolve(source,relative){return urlParse(source,!1,!0).resolve(relative)}function urlResolveObject(source,relative){return source?urlParse(source,!1,!0).resolveObject(relative):relative}var punycode=require("punycode"),util=require("./util");exports.parse=urlParse,exports.resolve=urlResolve,exports.resolveObject=urlResolveObject,exports.format=urlFormat,exports.Url=Url;var protocolPattern=/^([a-z0-9.+-]+:)/i,portPattern=/:[0-9]*$/,simplePathPattern=/^(\/\/?(?!\/)[^\?\s]*)(\?[^\s]*)?$/,delims=["<",">",'"',"`"," ","\r","\n","	"],unwise=["{","}","|","\\","^","`"].concat(delims),autoEscape=["'"].concat(unwise),nonHostChars=["%","/","?",";","#"].concat(autoEscape),hostEndingChars=["/","?","#"],hostnameMaxLen=255,hostnamePartPattern=/^[+a-z0-9A-Z_-]{0,63}$/,hostnamePartStart=/^([+a-z0-9A-Z_-]{0,63})(.*)$/,unsafeProtocol={javascript:!0,"javascript:":!0},hostlessProtocol={javascript:!0,"javascript:":!0},slashedProtocol={http:!0,https:!0,ftp:!0,gopher:!0,file:!0,"http:":!0,"https:":!0,"ftp:":!0,"gopher:":!0,"file:":!0},querystring=require("querystring");Url.prototype.parse=function(url,parseQueryString,slashesDenoteHost){if(!util.isString(url))throw new TypeError("Parameter 'url' must be a string, not "+typeof url);var queryIndex=url.indexOf("?"),splitter=-1!==queryIndex&&queryIndex<url.indexOf("#")?"?":"#",uSplit=url.split(splitter),slashRegex=/\\/g;uSplit[0]=uSplit[0].replace(slashRegex,"/"),url=uSplit.join(splitter);var rest=url;if(rest=rest.trim(),!slashesDenoteHost&&1===url.split("#").length){var simplePath=simplePathPattern.exec(rest);if(simplePath)return this.path=rest,this.href=rest,this.pathname=simplePath[1],simplePath[2]?(this.search=simplePath[2],parseQueryString?this.query=querystring.parse(this.search.substr(1)):this.query=this.search.substr(1)):parseQueryString&&(this.search="",this.query={}),this}var proto=protocolPattern.exec(rest);if(proto){proto=proto[0];var lowerProto=proto.toLowerCase();this.protocol=lowerProto,rest=rest.substr(proto.length)}if(slashesDenoteHost||proto||rest.match(/^\/\/[^@\/]+@[^@\/]+/)){var slashes="//"===rest.substr(0,2);!slashes||proto&&hostlessProtocol[proto]||(rest=rest.substr(2),this.slashes=!0)}if(!hostlessProtocol[proto]&&(slashes||proto&&!slashedProtocol[proto])){for(var hostEnd=-1,i=0;i<hostEndingChars.length;i++){var hec=rest.indexOf(hostEndingChars[i]);-1!==hec&&(-1===hostEnd||hostEnd>hec)&&(hostEnd=hec)}var auth,atSign;atSign=-1===hostEnd?rest.lastIndexOf("@"):rest.lastIndexOf("@",hostEnd),-1!==atSign&&(auth=rest.slice(0,atSign),rest=rest.slice(atSign+1),this.auth=decodeURIComponent(auth)),hostEnd=-1;for(var i=0;i<nonHostChars.length;i++){var hec=rest.indexOf(nonHostChars[i]);-1!==hec&&(-1===hostEnd||hostEnd>hec)&&(hostEnd=hec)}-1===hostEnd&&(hostEnd=rest.length),this.host=rest.slice(0,hostEnd),rest=rest.slice(hostEnd),this.parseHost(),this.hostname=this.hostname||"";var ipv6Hostname="["===this.hostname[0]&&"]"===this.hostname[this.hostname.length-1];if(!ipv6Hostname)for(var hostparts=this.hostname.split(/\./),i=0,l=hostparts.length;l>i;i++){var part=hostparts[i];if(part&&!part.match(hostnamePartPattern)){for(var newpart="",j=0,k=part.length;k>j;j++)newpart+=part.charCodeAt(j)>127?"x":part[j];if(!newpart.match(hostnamePartPattern)){var validParts=hostparts.slice(0,i),notHost=hostparts.slice(i+1),bit=part.match(hostnamePartStart);bit&&(validParts.push(bit[1]),notHost.unshift(bit[2])),notHost.length&&(rest="/"+notHost.join(".")+rest),this.hostname=validParts.join(".");break}}}this.hostname.length>hostnameMaxLen?this.hostname="":this.hostname=this.hostname.toLowerCase(),ipv6Hostname||(this.hostname=punycode.toASCII(this.hostname));var p=this.port?":"+this.port:"",h=this.hostname||"";this.host=h+p,this.href+=this.host,ipv6Hostname&&(this.hostname=this.hostname.substr(1,this.hostname.length-2),"/"!==rest[0]&&(rest="/"+rest))}if(!unsafeProtocol[lowerProto])for(var i=0,l=autoEscape.length;l>i;i++){var ae=autoEscape[i];if(-1!==rest.indexOf(ae)){var esc=encodeURIComponent(ae);esc===ae&&(esc=escape(ae)),rest=rest.split(ae).join(esc)}}var hash=rest.indexOf("#");-1!==hash&&(this.hash=rest.substr(hash),rest=rest.slice(0,hash));var qm=rest.indexOf("?");if(-1!==qm?(this.search=rest.substr(qm),this.query=rest.substr(qm+1),parseQueryString&&(this.query=querystring.parse(this.query)),rest=rest.slice(0,qm)):parseQueryString&&(this.search="",this.query={}),rest&&(this.pathname=rest),slashedProtocol[lowerProto]&&this.hostname&&!this.pathname&&(this.pathname="/"),this.pathname||this.search){var p=this.pathname||"",s=this.search||"";this.path=p+s}return this.href=this.format(),this},Url.prototype.format=function(){var auth=this.auth||"";auth&&(auth=encodeURIComponent(auth),auth=auth.replace(/%3A/i,":"),auth+="@");var protocol=this.protocol||"",pathname=this.pathname||"",hash=this.hash||"",host=!1,query="";this.host?host=auth+this.host:this.hostname&&(host=auth+(-1===this.hostname.indexOf(":")?this.hostname:"["+this.hostname+"]"),this.port&&(host+=":"+this.port)),this.query&&util.isObject(this.query)&&Object.keys(this.query).length&&(query=querystring.stringify(this.query));var search=this.search||query&&"?"+query||"";return protocol&&":"!==protocol.substr(-1)&&(protocol+=":"),this.slashes||(!protocol||slashedProtocol[protocol])&&host!==!1?(host="//"+(host||""),pathname&&"/"!==pathname.charAt(0)&&(pathname="/"+pathname)):host||(host=""),hash&&"#"!==hash.charAt(0)&&(hash="#"+hash),search&&"?"!==search.charAt(0)&&(search="?"+search),pathname=pathname.replace(/[?#]/g,function(match){return encodeURIComponent(match)}),search=search.replace("#","%23"),protocol+host+pathname+search+hash},Url.prototype.resolve=function(relative){return this.resolveObject(urlParse(relative,!1,!0)).format()},Url.prototype.resolveObject=function(relative){if(util.isString(relative)){var rel=new Url;rel.parse(relative,!1,!0),relative=rel}for(var result=new Url,tkeys=Object.keys(this),tk=0;tk<tkeys.length;tk++){var tkey=tkeys[tk];result[tkey]=this[tkey]}if(result.hash=relative.hash,""===relative.href)return result.href=result.format(),result;if(relative.slashes&&!relative.protocol){for(var rkeys=Object.keys(relative),rk=0;rk<rkeys.length;rk++){var rkey=rkeys[rk];"protocol"!==rkey&&(result[rkey]=relative[rkey])}return slashedProtocol[result.protocol]&&result.hostname&&!result.pathname&&(result.path=result.pathname="/"),result.href=result.format(),result}if(relative.protocol&&relative.protocol!==result.protocol){if(!slashedProtocol[relative.protocol]){for(var keys=Object.keys(relative),v=0;v<keys.length;v++){var k=keys[v];result[k]=relative[k]}return result.href=result.format(),result}if(result.protocol=relative.protocol,relative.host||hostlessProtocol[relative.protocol])result.pathname=relative.pathname;else{for(var relPath=(relative.pathname||"").split("/");relPath.length&&!(relative.host=relPath.shift()););relative.host||(relative.host=""),relative.hostname||(relative.hostname=""),""!==relPath[0]&&relPath.unshift(""),relPath.length<2&&relPath.unshift(""),result.pathname=relPath.join("/")}if(result.search=relative.search,result.query=relative.query,result.host=relative.host||"",result.auth=relative.auth,result.hostname=relative.hostname||relative.host,result.port=relative.port,result.pathname||result.search){var p=result.pathname||"",s=result.search||"";result.path=p+s}return result.slashes=result.slashes||relative.slashes,result.href=result.format(),result}var isSourceAbs=result.pathname&&"/"===result.pathname.charAt(0),isRelAbs=relative.host||relative.pathname&&"/"===relative.pathname.charAt(0),mustEndAbs=isRelAbs||isSourceAbs||result.host&&relative.pathname,removeAllDots=mustEndAbs,srcPath=result.pathname&&result.pathname.split("/")||[],relPath=relative.pathname&&relative.pathname.split("/")||[],psychotic=result.protocol&&!slashedProtocol[result.protocol];if(psychotic&&(result.hostname="",result.port=null,result.host&&(""===srcPath[0]?srcPath[0]=result.host:srcPath.unshift(result.host)),result.host="",relative.protocol&&(relative.hostname=null,relative.port=null,relative.host&&(""===relPath[0]?relPath[0]=relative.host:relPath.unshift(relative.host)),relative.host=null),mustEndAbs=mustEndAbs&&(""===relPath[0]||""===srcPath[0])),isRelAbs)result.host=relative.host||""===relative.host?relative.host:result.host,result.hostname=relative.hostname||""===relative.hostname?relative.hostname:result.hostname,result.search=relative.search,result.query=relative.query,srcPath=relPath;else if(relPath.length)srcPath||(srcPath=[]),srcPath.pop(),srcPath=srcPath.concat(relPath),result.search=relative.search,result.query=relative.query;else if(!util.isNullOrUndefined(relative.search)){if(psychotic){result.hostname=result.host=srcPath.shift();var authInHost=result.host&&result.host.indexOf("@")>0?result.host.split("@"):!1;authInHost&&(result.auth=authInHost.shift(),result.host=result.hostname=authInHost.shift())}return result.search=relative.search,result.query=relative.query,util.isNull(result.pathname)&&util.isNull(result.search)||(result.path=(result.pathname?result.pathname:"")+(result.search?result.search:"")),result.href=result.format(),result}if(!srcPath.length)return result.pathname=null,result.search?result.path="/"+result.search:result.path=null,result.href=result.format(),result;for(var last=srcPath.slice(-1)[0],hasTrailingSlash=(result.host||relative.host||srcPath.length>1)&&("."===last||".."===last)||""===last,up=0,i=srcPath.length;i>=0;i--)last=srcPath[i],"."===last?srcPath.splice(i,1):".."===last?(srcPath.splice(i,1),up++):up&&(srcPath.splice(i,1),up--);if(!mustEndAbs&&!removeAllDots)for(;up--;up)srcPath.unshift("..");!mustEndAbs||""===srcPath[0]||srcPath[0]&&"/"===srcPath[0].charAt(0)||srcPath.unshift(""),hasTrailingSlash&&"/"!==srcPath.join("/").substr(-1)&&srcPath.push("");var isAbsolute=""===srcPath[0]||srcPath[0]&&"/"===srcPath[0].charAt(0);if(psychotic){result.hostname=result.host=isAbsolute?"":srcPath.length?srcPath.shift():"";var authInHost=result.host&&result.host.indexOf("@")>0?result.host.split("@"):!1;authInHost&&(result.auth=authInHost.shift(),result.host=result.hostname=authInHost.shift())}return mustEndAbs=mustEndAbs||result.host&&srcPath.length,mustEndAbs&&!isAbsolute&&srcPath.unshift(""),srcPath.length?result.pathname=srcPath.join("/"):(result.pathname=null,result.path=null),util.isNull(result.pathname)&&util.isNull(result.search)||(result.path=(result.pathname?result.pathname:"")+(result.search?result.search:"")),result.auth=relative.auth||result.auth,result.slashes=result.slashes||relative.slashes,result.href=result.format(),result},Url.prototype.parseHost=function(){var host=this.host,port=portPattern.exec(host);port&&(port=port[0],":"!==port&&(this.port=port.substr(1)),host=host.substr(0,host.length-port.length)),host&&(this.hostname=host)}},{"./util":153,punycode:141,querystring:144}],153:[function(require,module,exports){"use strict";module.exports={isString:function(arg){return"string"==typeof arg},isObject:function(arg){return"object"==typeof arg&&null!==arg},isNull:function(arg){return null===arg},isNullOrUndefined:function(arg){return null==arg}}},{}],154:[function(require,module,exports){function loadBuffers(paths,context,cb){Array.isArray(paths)?async.map(paths,loadBuffer(context),cb):loadBuffer(context)(paths,cb)}function loadBuffer(context){return function(path,cb){var request=new XMLHttpRequest;request.open("GET",path,!0),request.responseType="arraybuffer",request.onload=function(){context.decodeAudioData(request.response,function(theBuffer){cb(null,theBuffer)},function(err){cb(err)})},request.send()}}var async=require("async");module.exports=loadBuffers},{async:155}],155:[function(require,module,exports){(function(process){!function(){function only_once(fn){var called=!1;return function(){if(called)throw new Error("Callback was already called.");called=!0,fn.apply(root,arguments)}}var root,previous_async,async={};root=this,null!=root&&(previous_async=root.async),async.noConflict=function(){return root.async=previous_async,async};var _toString=Object.prototype.toString,_isArray=Array.isArray||function(obj){return"[object Array]"===_toString.call(obj)},_each=function(arr,iterator){if(arr.forEach)return arr.forEach(iterator);for(var i=0;i<arr.length;i+=1)iterator(arr[i],i,arr)},_map=function(arr,iterator){if(arr.map)return arr.map(iterator);var results=[];return _each(arr,function(x,i,a){results.push(iterator(x,i,a))}),results},_reduce=function(arr,iterator,memo){return arr.reduce?arr.reduce(iterator,memo):(_each(arr,function(x,i,a){memo=iterator(memo,x,i,a)}),memo)},_keys=function(obj){if(Object.keys)return Object.keys(obj);var keys=[];for(var k in obj)obj.hasOwnProperty(k)&&keys.push(k);return keys};"undefined"!=typeof process&&process.nextTick?(async.nextTick=process.nextTick,"undefined"!=typeof setImmediate?async.setImmediate=function(fn){setImmediate(fn)}:async.setImmediate=async.nextTick):"function"==typeof setImmediate?(async.nextTick=function(fn){setImmediate(fn)},async.setImmediate=async.nextTick):(async.nextTick=function(fn){setTimeout(fn,0)},async.setImmediate=async.nextTick),async.each=function(arr,iterator,callback){function done(err){err?(callback(err),callback=function(){}):(completed+=1,completed>=arr.length&&callback())}if(callback=callback||function(){},!arr.length)return callback();var completed=0;_each(arr,function(x){iterator(x,only_once(done))})},async.forEach=async.each,async.eachSeries=function(arr,iterator,callback){if(callback=callback||function(){},!arr.length)return callback();var completed=0,iterate=function(){iterator(arr[completed],function(err){err?(callback(err),callback=function(){}):(completed+=1,completed>=arr.length?callback():iterate())})};iterate()},async.forEachSeries=async.eachSeries,async.eachLimit=function(arr,limit,iterator,callback){var fn=_eachLimit(limit);fn.apply(null,[arr,iterator,callback])},async.forEachLimit=async.eachLimit;var _eachLimit=function(limit){return function(arr,iterator,callback){if(callback=callback||function(){},!arr.length||0>=limit)return callback();var completed=0,started=0,running=0;!function replenish(){if(completed>=arr.length)return callback();for(;limit>running&&started<arr.length;)started+=1,running+=1,iterator(arr[started-1],function(err){err?(callback(err),callback=function(){}):(completed+=1,running-=1,completed>=arr.length?callback():replenish())})}()}},doParallel=function(fn){return function(){var args=Array.prototype.slice.call(arguments);return fn.apply(null,[async.each].concat(args))}},doParallelLimit=function(limit,fn){return function(){var args=Array.prototype.slice.call(arguments);return fn.apply(null,[_eachLimit(limit)].concat(args))}},doSeries=function(fn){return function(){var args=Array.prototype.slice.call(arguments);return fn.apply(null,[async.eachSeries].concat(args))}},_asyncMap=function(eachfn,arr,iterator,callback){if(arr=_map(arr,function(x,i){return{index:i,value:x}}),callback){var results=[];eachfn(arr,function(x,callback){iterator(x.value,function(err,v){results[x.index]=v,callback(err)})},function(err){callback(err,results)})}else eachfn(arr,function(x,callback){iterator(x.value,function(err){callback(err)})})};async.map=doParallel(_asyncMap),async.mapSeries=doSeries(_asyncMap),async.mapLimit=function(arr,limit,iterator,callback){return _mapLimit(limit)(arr,iterator,callback)};var _mapLimit=function(limit){return doParallelLimit(limit,_asyncMap)};async.reduce=function(arr,memo,iterator,callback){async.eachSeries(arr,function(x,callback){iterator(memo,x,function(err,v){memo=v,callback(err)})},function(err){callback(err,memo)})},async.inject=async.reduce,async.foldl=async.reduce,async.reduceRight=function(arr,memo,iterator,callback){var reversed=_map(arr,function(x){return x}).reverse();async.reduce(reversed,memo,iterator,callback)},async.foldr=async.reduceRight;var _filter=function(eachfn,arr,iterator,callback){var results=[];arr=_map(arr,function(x,i){return{index:i,value:x}}),eachfn(arr,function(x,callback){iterator(x.value,function(v){v&&results.push(x),callback()})},function(err){callback(_map(results.sort(function(a,b){return a.index-b.index}),function(x){return x.value}))})};async.filter=doParallel(_filter),async.filterSeries=doSeries(_filter),async.select=async.filter,async.selectSeries=async.filterSeries;var _reject=function(eachfn,arr,iterator,callback){var results=[];arr=_map(arr,function(x,i){return{index:i,value:x}}),eachfn(arr,function(x,callback){iterator(x.value,function(v){v||results.push(x),callback()})},function(err){callback(_map(results.sort(function(a,b){return a.index-b.index}),function(x){return x.value}))})};async.reject=doParallel(_reject),async.rejectSeries=doSeries(_reject);var _detect=function(eachfn,arr,iterator,main_callback){eachfn(arr,function(x,callback){iterator(x,function(result){result?(main_callback(x),main_callback=function(){}):callback()})},function(err){main_callback()})};async.detect=doParallel(_detect),async.detectSeries=doSeries(_detect),async.some=function(arr,iterator,main_callback){async.each(arr,function(x,callback){iterator(x,function(v){v&&(main_callback(!0),main_callback=function(){}),callback()})},function(err){main_callback(!1)})},async.any=async.some,async.every=function(arr,iterator,main_callback){async.each(arr,function(x,callback){iterator(x,function(v){v||(main_callback(!1),main_callback=function(){}),callback()})},function(err){main_callback(!0)})},async.all=async.every,async.sortBy=function(arr,iterator,callback){async.map(arr,function(x,callback){iterator(x,function(err,criteria){err?callback(err):callback(null,{value:x,criteria:criteria})})},function(err,results){if(err)return callback(err);var fn=function(left,right){var a=left.criteria,b=right.criteria;return b>a?-1:a>b?1:0};callback(null,_map(results.sort(fn),function(x){return x.value}))})},async.auto=function(tasks,callback){callback=callback||function(){};var keys=_keys(tasks),remainingTasks=keys.length;if(!remainingTasks)return callback();var results={},listeners=[],addListener=function(fn){listeners.unshift(fn)},removeListener=function(fn){for(var i=0;i<listeners.length;i+=1)if(listeners[i]===fn)return void listeners.splice(i,1)},taskComplete=function(){remainingTasks--,_each(listeners.slice(0),function(fn){fn()})};addListener(function(){if(!remainingTasks){var theCallback=callback;callback=function(){},theCallback(null,results)}}),_each(keys,function(k){var task=_isArray(tasks[k])?tasks[k]:[tasks[k]],taskCallback=function(err){var args=Array.prototype.slice.call(arguments,1);if(args.length<=1&&(args=args[0]),err){var safeResults={};_each(_keys(results),function(rkey){safeResults[rkey]=results[rkey]}),safeResults[k]=args,callback(err,safeResults),callback=function(){}}else results[k]=args,async.setImmediate(taskComplete)},requires=task.slice(0,Math.abs(task.length-1))||[],ready=function(){return _reduce(requires,function(a,x){return a&&results.hasOwnProperty(x)},!0)&&!results.hasOwnProperty(k)};if(ready())task[task.length-1](taskCallback,results);else{var listener=function(){ready()&&(removeListener(listener),task[task.length-1](taskCallback,results))};addListener(listener)}})},async.retry=function(times,task,callback){var DEFAULT_TIMES=5,attempts=[];"function"==typeof times&&(callback=task,task=times,times=DEFAULT_TIMES),times=parseInt(times,10)||DEFAULT_TIMES;var wrappedTask=function(wrappedCallback,wrappedResults){for(var retryAttempt=function(task,finalAttempt){return function(seriesCallback){task(function(err,result){seriesCallback(!err||finalAttempt,{err:err,result:result})},wrappedResults)}};times;)attempts.push(retryAttempt(task,!(times-=1)));async.series(attempts,function(done,data){data=data[data.length-1],(wrappedCallback||callback)(data.err,data.result)})};return callback?wrappedTask():wrappedTask},async.waterfall=function(tasks,callback){if(callback=callback||function(){},!_isArray(tasks)){var err=new Error("First argument to waterfall must be an array of functions");return callback(err)}if(!tasks.length)return callback();var wrapIterator=function(iterator){return function(err){if(err)callback.apply(null,arguments),callback=function(){};else{var args=Array.prototype.slice.call(arguments,1),next=iterator.next();next?args.push(wrapIterator(next)):args.push(callback),async.setImmediate(function(){iterator.apply(null,args)})}}};wrapIterator(async.iterator(tasks))()};var _parallel=function(eachfn,tasks,callback){if(callback=callback||function(){},_isArray(tasks))eachfn.map(tasks,function(fn,callback){fn&&fn(function(err){var args=Array.prototype.slice.call(arguments,1);args.length<=1&&(args=args[0]),callback.call(null,err,args)})},callback);else{var results={};eachfn.each(_keys(tasks),function(k,callback){tasks[k](function(err){var args=Array.prototype.slice.call(arguments,1);args.length<=1&&(args=args[0]),results[k]=args,callback(err)})},function(err){callback(err,results)})}};async.parallel=function(tasks,callback){_parallel({map:async.map,each:async.each},tasks,callback)},async.parallelLimit=function(tasks,limit,callback){_parallel({map:_mapLimit(limit),each:_eachLimit(limit)},tasks,callback)},async.series=function(tasks,callback){if(callback=callback||function(){},_isArray(tasks))async.mapSeries(tasks,function(fn,callback){fn&&fn(function(err){var args=Array.prototype.slice.call(arguments,1);args.length<=1&&(args=args[0]),callback.call(null,err,args)})},callback);else{var results={};async.eachSeries(_keys(tasks),function(k,callback){tasks[k](function(err){var args=Array.prototype.slice.call(arguments,1);args.length<=1&&(args=args[0]),results[k]=args,callback(err)})},function(err){callback(err,results)})}},async.iterator=function(tasks){var makeCallback=function(index){var fn=function(){return tasks.length&&tasks[index].apply(null,arguments),fn.next()};return fn.next=function(){return index<tasks.length-1?makeCallback(index+1):null},fn};return makeCallback(0)},async.apply=function(fn){var args=Array.prototype.slice.call(arguments,1);return function(){return fn.apply(null,args.concat(Array.prototype.slice.call(arguments)))}};var _concat=function(eachfn,arr,fn,callback){var r=[];eachfn(arr,function(x,cb){fn(x,function(err,y){r=r.concat(y||[]),cb(err)})},function(err){callback(err,r)})};async.concat=doParallel(_concat),async.concatSeries=doSeries(_concat),async.whilst=function(test,iterator,callback){test()?iterator(function(err){return err?callback(err):void async.whilst(test,iterator,callback)}):callback()},async.doWhilst=function(iterator,test,callback){iterator(function(err){if(err)return callback(err);var args=Array.prototype.slice.call(arguments,1);test.apply(null,args)?async.doWhilst(iterator,test,callback):callback()})},async.until=function(test,iterator,callback){test()?callback():iterator(function(err){return err?callback(err):void async.until(test,iterator,callback)})},async.doUntil=function(iterator,test,callback){iterator(function(err){if(err)return callback(err);var args=Array.prototype.slice.call(arguments,1);test.apply(null,args)?callback():async.doUntil(iterator,test,callback)})},async.queue=function(worker,concurrency){function _insert(q,data,pos,callback){return q.started||(q.started=!0),_isArray(data)||(data=[data]),0==data.length?async.setImmediate(function(){q.drain&&q.drain()}):void _each(data,function(task){var item={data:task,callback:"function"==typeof callback?callback:null};pos?q.tasks.unshift(item):q.tasks.push(item),q.saturated&&q.tasks.length===q.concurrency&&q.saturated(),async.setImmediate(q.process)})}void 0===concurrency&&(concurrency=1);var workers=0,q={tasks:[],concurrency:concurrency,saturated:null,empty:null,drain:null,started:!1,paused:!1,push:function(data,callback){_insert(q,data,!1,callback)},kill:function(){q.drain=null,q.tasks=[]},unshift:function(data,callback){_insert(q,data,!0,callback)},process:function(){if(!q.paused&&workers<q.concurrency&&q.tasks.length){var task=q.tasks.shift();q.empty&&0===q.tasks.length&&q.empty(),workers+=1;var next=function(){workers-=1,task.callback&&task.callback.apply(task,arguments),q.drain&&q.tasks.length+workers===0&&q.drain(),q.process()},cb=only_once(next);worker(task.data,cb)}},length:function(){return q.tasks.length},running:function(){return workers},idle:function(){return q.tasks.length+workers===0},pause:function(){q.paused!==!0&&(q.paused=!0,q.process())},resume:function(){q.paused!==!1&&(q.paused=!1,q.process())}};return q},async.priorityQueue=function(worker,concurrency){function _compareTasks(a,b){return a.priority-b.priority}function _binarySearch(sequence,item,compare){for(var beg=-1,end=sequence.length-1;end>beg;){var mid=beg+(end-beg+1>>>1);compare(item,sequence[mid])>=0?beg=mid:end=mid-1}return beg}function _insert(q,data,priority,callback){return q.started||(q.started=!0),_isArray(data)||(data=[data]),0==data.length?async.setImmediate(function(){q.drain&&q.drain()}):void _each(data,function(task){var item={data:task,priority:priority,callback:"function"==typeof callback?callback:null};q.tasks.splice(_binarySearch(q.tasks,item,_compareTasks)+1,0,item),q.saturated&&q.tasks.length===q.concurrency&&q.saturated(),async.setImmediate(q.process)})}var q=async.queue(worker,concurrency);return q.push=function(data,priority,callback){_insert(q,data,priority,callback)},delete q.unshift,q},async.cargo=function(worker,payload){var working=!1,tasks=[],cargo={tasks:tasks,payload:payload,saturated:null,empty:null,drain:null,drained:!0,push:function(data,callback){_isArray(data)||(data=[data]),_each(data,function(task){tasks.push({data:task,callback:"function"==typeof callback?callback:null}),cargo.drained=!1,cargo.saturated&&tasks.length===payload&&cargo.saturated()}),async.setImmediate(cargo.process)},process:function process(){if(!working){if(0===tasks.length)return cargo.drain&&!cargo.drained&&cargo.drain(),void(cargo.drained=!0);var ts="number"==typeof payload?tasks.splice(0,payload):tasks.splice(0,tasks.length),ds=_map(ts,function(task){return task.data});cargo.empty&&cargo.empty(),working=!0,worker(ds,function(){working=!1;var args=arguments;_each(ts,function(data){data.callback&&data.callback.apply(null,args)}),process()})}},length:function(){return tasks.length},running:function(){return working}};return cargo};var _console_fn=function(name){return function(fn){var args=Array.prototype.slice.call(arguments,1);fn.apply(null,args.concat([function(err){var args=Array.prototype.slice.call(arguments,1);"undefined"!=typeof console&&(err?console.error&&console.error(err):console[name]&&_each(args,function(x){console[name](x)}))}]))}};async.log=_console_fn("log"),async.dir=_console_fn("dir"),async.memoize=function(fn,hasher){var memo={},queues={};hasher=hasher||function(x){return x};var memoized=function(){var args=Array.prototype.slice.call(arguments),callback=args.pop(),key=hasher.apply(null,args);key in memo?async.nextTick(function(){callback.apply(null,memo[key])}):key in queues?queues[key].push(callback):(queues[key]=[callback],fn.apply(null,args.concat([function(){memo[key]=arguments;var q=queues[key];delete queues[key];for(var i=0,l=q.length;l>i;i++)q[i].apply(null,arguments)}])))};return memoized.memo=memo,memoized.unmemoized=fn,memoized},async.unmemoize=function(fn){return function(){return(fn.unmemoized||fn).apply(null,arguments)}},async.times=function(count,iterator,callback){for(var counter=[],i=0;count>i;i++)counter.push(i);return async.map(counter,iterator,callback)},async.timesSeries=function(count,iterator,callback){for(var counter=[],i=0;count>i;i++)counter.push(i);return async.mapSeries(counter,iterator,callback)},async.seq=function(){var fns=arguments;return function(){var that=this,args=Array.prototype.slice.call(arguments),callback=args.pop();async.reduce(fns,args,function(newargs,fn,cb){fn.apply(that,newargs.concat([function(){var err=arguments[0],nextargs=Array.prototype.slice.call(arguments,1);cb(err,nextargs)}]))},function(err,results){callback.apply(that,[err].concat(results))})}},async.compose=function(){return async.seq.apply(null,Array.prototype.reverse.call(arguments))};var _applyEach=function(eachfn,fns){var go=function(){var that=this,args=Array.prototype.slice.call(arguments),callback=args.pop();return eachfn(fns,function(fn,cb){fn.apply(that,args.concat([cb]))},callback)};if(arguments.length>2){var args=Array.prototype.slice.call(arguments,2);return go.apply(this,args)}return go};async.applyEach=doParallel(_applyEach),async.applyEachSeries=doSeries(_applyEach),async.forever=function(fn,callback){function next(err){if(err){if(callback)return callback(err);throw err}fn(next)}next()},"undefined"!=typeof module&&module.exports?module.exports=async:"undefined"!=typeof define&&define.amd?define([],function(){return async}):root.async=async}()}).call(this,require("_process"))},{_process:140}]},{},[8]);